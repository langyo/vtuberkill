/*! For license information please see mode.js.LICENSE.txt */
(function(){"use strict";var __webpack_modules__={"./src/mode/strategy.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _strategy_situate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./strategy_situate */ \"./src/mode/strategy_situate.ts\");\n\r\nwindow.game.import('mode', function (lib, game, ui, get, ai, _status) {\r\n    return {\r\n        name: 'strategy',\r\n        characterPack: {\r\n            STG: {\r\n                Ava: ['female', 'asoul', 4, ['yiqu', 'wanxian'], ['guoV']],\r\n                Bella: ['female', 'asoul', '3/4', ['aswusheng', 'gunxun'], ['guoV']],\r\n                Carol: ['female', 'asoul', 4, ['shixi', 'xueta', 'yuezhi'], ['guoV']],\r\n                Diana: ['female', 'asoul', 4, ['quanyu', 'wulian'], ['guoV']],\r\n                EQueen: ['female', 'asoul', 4, ['yehua', 'fengqing'], ['guoV']],\r\n            },\r\n            drama: {\r\n                testDrama: ['none', '', 1, ['Date:2X21'], ['Date:2X21.1', 'unseen'], '2X21.1']\r\n            }\r\n        },\r\n        cardPack: {\r\n            STG: [],\r\n            recommendGroups: [\r\n                'group_VirtuaReal',\r\n                'group_asoul',\r\n                'group_psp',\r\n                'group_xuyan',\r\n                'group_Providence',\r\n            ],\r\n            groups: [\r\n                'group_VirtuaReal',\r\n                'group_psp',\r\n                'group_asoul',\r\n                'group_chaos',\r\n                'group_xuyan',\r\n                'group_xuefeng',\r\n                'group_Providence',\r\n                'group_HappyEl',\r\n                'group_RedC',\r\n            ]\r\n        },\r\n        start: function () {\r\n            \"step 0\";\r\n            var playback = localStorage.getItem(lib.configprefix + 'playback');\r\n            if (playback) {\r\n                Evt.finish();\r\n                return;\r\n            }\r\n            _status.drama = {};\r\n            lib.character = lib.characterPack.STG;\r\n            for (var i in lib.character) {\r\n                if (!lib.character[i][4]) {\r\n                    lib.character[i][4] = [];\r\n                }\r\n            }\r\n            for (var i in lib.skill) {\r\n                if (lib.skill[i].changeSeat) {\r\n                    lib.skill[i] = {};\r\n                    if (lib.translate[i + '_info']) {\r\n                        lib.translate[i + '_info'] = '此模式下不可用';\r\n                    }\r\n                }\r\n            }\r\n            if (ui.auto) {\r\n                ui.auto.style.display = 'none';\r\n                ui.sortCard.style.display = 'none';\r\n            }\r\n            lib.translate.restart = '返回';\r\n            ui.STG_start = lib.init.css(`${lib.assetURL}layout/mode`, 'strategy1');\r\n            game.delay(0.1);\r\n            lib.skill = Object.assign(Object.assign({}, lib.skill), { 'Date:2X21': {} });\r\n            lib.translate = Object.assign(Object.assign({}, lib.translate), { testDrama: '新游戏', 'Date:2X21': '筚路蓝缕', 'Date:2X21_info': `公元2021年初，冲蝗的号角不再响彻、鲸落的潮水也逐渐退去，\r\n\t\t\t\t在摇摇欲坠的新科帝国治下，国V大陆一时间进入群雄割据、豪强并起、勃勃生机万物竞发的局面。<br>\r\n\t\t\t\t新人的登场、老人的离去，国V大陆自古没有永恒的主，只有一轮又一轮的版本更新换代。然而，这份“传统”真的会延续下去吗？` });\r\n            \"step 1\";\r\n            var bosslist = ui.create.div('#bosslist.hidden');\r\n            Evt.bosslist = bosslist;\r\n            _status.drama.bosslist = bosslist;\r\n            lib.setScroll(bosslist);\r\n            if (!lib.config.touchscreen && lib.config.mousewheel) {\r\n                bosslist._scrollspeed = 30;\r\n                bosslist._scrollnum = 10;\r\n                bosslist.onmousewheel = ui.click.mousewheel;\r\n            }\r\n            var onpause = function () {\r\n                ui.window.classList.add('bosspaused');\r\n            };\r\n            var onresume = function () {\r\n                ui.window.classList.remove('bosspaused');\r\n            };\r\n            game.onpause = onpause;\r\n            game.onpause2 = onpause;\r\n            game.onresume = onresume;\r\n            game.onresume2 = onresume;\r\n            ui.create.div(bosslist);\r\n            Evt.currentDrama = null;\r\n            for (let i in lib.characterPack.drama) {\r\n                let info = lib.characterPack.drama[i];\r\n                let player = ui.create.player(bosslist).init(i);\r\n                console.log(player);\r\n                player.node.hp.classList.add('text');\r\n                player.node.hp.dataset.condition = '';\r\n                player.node.hp.style.left = 'auto';\r\n                player.node.hp.innerHTML = info[5];\r\n                player.setIdentity(player.name);\r\n                player.node.identity.dataset.color = 'qun';\r\n                player.classList.add('bossplayer');\r\n                if (lib.storage.currentDrama == i) {\r\n                    Evt.currentDrama = player;\r\n                    player.classList.add('highlight');\r\n                    if (!lib.config.continue_name_boss && lib.drama[i] && lib.drama[i].control) {\r\n                        _status.dramaChoice = lib.drama[i].control();\r\n                        _status.dramaChoice.name = i;\r\n                        _status.dramaChoice.link = lib.drama[i].controlid || i;\r\n                    }\r\n                }\r\n            }\r\n            if (!Evt.currentDrama) {\r\n                Evt.currentDrama = bosslist.childNodes[1];\r\n                Evt.currentDrama.classList.add('highlight');\r\n            }\r\n            ui.create.div(bosslist);\r\n            ui.create.cardsAsync();\r\n            game.finishCards();\r\n            game.addGlobalSkill('autoswap');\r\n            ui.arena.setNumber(8);\r\n            ui.control.style.transitionProperty = 'opacity';\r\n            ui.control.classList.add('bosslist');\r\n            setTimeout(function () {\r\n                ui.control.style.transitionProperty = '';\r\n            }, 1000);\r\n            ui.window.appendChild(bosslist);\r\n            setTimeout(function () {\r\n                if (Evt.currentDrama) {\r\n                    var left = Evt.currentDrama.offsetLeft - (ui.window.offsetWidth - 180) / 2;\r\n                    if (bosslist.scrollLeft < left) {\r\n                        bosslist.scrollLeft = left;\r\n                    }\r\n                }\r\n                bosslist.show();\r\n            }, 200);\r\n            game.me = ui.create.player();\r\n            if (lib.config.continue_name_boss) {\r\n                Evt.noslide = true;\r\n                lib.init.onfree();\r\n            }\r\n            else {\r\n                game.chooseCharacter(function (target) {\r\n                    if (Evt.currentDrama) {\r\n                        Evt.currentDrama.classList.remove('highlight');\r\n                    }\r\n                    Evt.currentDrama = target;\r\n                    game.save('currentDrama', target.name);\r\n                    target.classList.add('highlight');\r\n                    if (_status.dramaChoice) {\r\n                        var name = target.name;\r\n                        if (lib.drama[target.name] && lib.drama[target.name].controlid) {\r\n                            name = lib.drama[target.name].controlid;\r\n                        }\r\n                        if (_status.dramaChoice.link != name) {\r\n                            lib.drama[_status.dramaChoice.name].control('cancel', _status.dramaChoice);\r\n                            _status.dramaChoice.classList.remove('disabled');\r\n                            _status.dramaChoice.close();\r\n                            delete _status.dramaChoice;\r\n                        }\r\n                        else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    if (lib.drama[target.name] && lib.drama[target.name].control) {\r\n                        _status.createControl = ui.control.firstChild;\r\n                        _status.dramaChoice = lib.drama[target.name].control();\r\n                        _status.dramaChoice.name = target.name;\r\n                        _status.dramaChoice.link = lib.drama[target.name].controlid || target.name;\r\n                        if (ui.cheat2 && ui.cheat2.dialog == _status.event.dialog) {\r\n                            _status.dramaChoice.classList.add('disabled');\r\n                        }\r\n                        delete _status.createControl;\r\n                    }\r\n                });\r\n            }\r\n            if (lib.config.test_game) {\r\n                Evt.currentDrama.classList.remove('highlight');\r\n                if (Evt.currentDrama.nextSibling && Evt.currentDrama.nextSibling.classList.contains('player')) {\r\n                    Evt.currentDrama = Evt.currentDrama.nextSibling;\r\n                }\r\n                else {\r\n                    Evt.currentDrama = Evt.currentDrama.parentNode.childNodes[1];\r\n                }\r\n                game.save('currentDrama', Evt.currentDrama.name);\r\n            }\r\n            \"step 2\";\r\n            game.bossinfo = lib.drama.global;\r\n            for (var i in lib.drama[Evt.currentDrama.name]) {\r\n                game.bossinfo[i] = lib.drama[Evt.currentDrama.name][i];\r\n            }\r\n            setTimeout(function () {\r\n                ui.control.classList.remove('bosslist');\r\n            }, 500);\r\n            var boss = ui.create.player();\r\n            boss.getId();\r\n            game.boss = boss;\r\n            boss.init(Evt.currentDrama.name);\r\n            boss.side = true;\r\n            if (!Evt.noslide) {\r\n                var rect = Evt.currentDrama.getBoundingClientRect();\r\n                boss.animate('bossing');\r\n                boss.node.hp.animate('start');\r\n                boss.bossinginfo = [rect.left + rect.width / 2, rect.top + rect.height / 2];\r\n                boss.style.transition = 'all 0s';\r\n                boss.node.equips.style.opacity = '0';\r\n            }\r\n            else {\r\n                boss.animate('start');\r\n            }\r\n            boss.setIdentity('zhu');\r\n            boss.identity = 'zhu';\r\n            if (lib.config.continue_name_boss) {\r\n                result = lib.config.continue_name_boss;\r\n                game.saveConfig('continue_name_boss');\r\n            }\r\n            for (let i = 0; i < result.links.length; i++) {\r\n                var player = ui.create.player();\r\n                player.getId();\r\n                player.init(result.links[i]).animate('start');\r\n                player.setIdentity('cai');\r\n                player.identity = 'cai';\r\n                player.side = false;\r\n                game.players.push(player);\r\n                if (result.boss) {\r\n                    if (game.bossinfo.minion) {\r\n                        player.dataset.position = i + 3;\r\n                    }\r\n                    else {\r\n                        player.dataset.position = (i + 1) * 2;\r\n                    }\r\n                }\r\n                else {\r\n                    player.dataset.position = i + 1;\r\n                }\r\n                ui.arena.appendChild(player);\r\n            }\r\n            if (result.boss) {\r\n                game.players.unshift(boss);\r\n                boss.dataset.position = 0;\r\n            }\r\n            else {\r\n                game.players.push(boss);\r\n                boss.dataset.position = 7;\r\n            }\r\n            if (game.bossinfo.minion) {\r\n                if (!result.boss) {\r\n                    boss.dataset.position = 6;\r\n                }\r\n                for (var i in game.bossinfo.minion) {\r\n                    var player = ui.create.player();\r\n                    player.getId();\r\n                    player.init(game.bossinfo.minion[i]);\r\n                    if (boss.bossinginfo) {\r\n                        player.animate('bossing');\r\n                        player.node.hp.animate('start');\r\n                        player.style.transition = 'all 0s';\r\n                    }\r\n                    else {\r\n                        player.animate('start');\r\n                    }\r\n                    player.setIdentity('zhong');\r\n                    player.identity = 'zhong';\r\n                    player.side = true;\r\n                    game.players.push(player);\r\n                    var num = parseInt(i);\r\n                    if (result.boss) {\r\n                        player.dataset.position = num - 1;\r\n                    }\r\n                    else {\r\n                        if (num == 2) {\r\n                            player.dataset.position = 7;\r\n                        }\r\n                        else {\r\n                            player.dataset.position = num - 3;\r\n                        }\r\n                    }\r\n                    ui.arena.appendChild(player);\r\n                    if (boss.bossinginfo) {\r\n                        var rect = player.getBoundingClientRect();\r\n                        player.style.transform = 'translate(' + (boss.bossinginfo[0] - rect.left - rect.width / 2) + 'px,' + (boss.bossinginfo[1] - rect.top - rect.height / 2) + 'px) scale(1.1)';\r\n                        ui.refresh(player);\r\n                        player.style.transition = '';\r\n                        player.style.transform = '';\r\n                    }\r\n                }\r\n            }\r\n            ui.create.me();\r\n            ui.fakeme = ui.create.div('.fakeme.avatar', ui.me);\r\n            if (game.me !== boss) {\r\n                game.singleHandcard = true;\r\n                ui.arena.classList.add('single-handcard');\r\n                ui.window.classList.add('single-handcard');\r\n                game.onSwapControl();\r\n                if (lib.config.show_handcardbutton) {\r\n                    lib.setPopped(ui.create.system('手牌', null, true), function () {\r\n                        var uiintro = ui.create.dialog('hidden');\r\n                        var players = game.players.concat(game.dead);\r\n                        for (var i = 0; i < players.length; i++) {\r\n                            if (players[i].side == game.me.side && players[i] != game.me) {\r\n                                uiintro.add(get.translation(players[i]));\r\n                                var cards = players[i].getCards('h');\r\n                                if (cards.length) {\r\n                                    uiintro.addSmall(cards, true);\r\n                                }\r\n                                else {\r\n                                    uiintro.add('（无）');\r\n                                }\r\n                            }\r\n                        }\r\n                        return uiintro;\r\n                    }, 220);\r\n                }\r\n            }\r\n            else {\r\n                ui.fakeme.style.display = 'none';\r\n            }\r\n            if (game.bossinfo.chongzheng) {\r\n                lib.setPopped(ui.create.system('重整', null, true), function () {\r\n                    var uiintro = ui.create.dialog('hidden');\r\n                    uiintro.add('重整');\r\n                    var table = ui.create.div('.bosschongzheng');\r\n                    var tr, td, added = false;\r\n                    for (var i = 0; i < game.dead.length; i++) {\r\n                        if (typeof game.dead[i].storage.boss_chongzheng !== 'number')\r\n                            continue;\r\n                        added = true;\r\n                        tr = ui.create.div(table);\r\n                        td = ui.create.div(tr);\r\n                        td.innerHTML = get.translation(game.dead[i]);\r\n                        td = ui.create.div(tr);\r\n                        if (game.dead[i].maxHp > 0) {\r\n                            td.innerHTML = '剩余' + (game.bossinfo.chongzheng - game.dead[i].storage.boss_chongzheng) + '回合';\r\n                        }\r\n                        else {\r\n                            td.innerHTML = '无法重整';\r\n                        }\r\n                    }\r\n                    if (!added) {\r\n                        uiintro.add('<div class=\"text center\">（无重整角色）</div>');\r\n                        uiintro.add(ui.create.div('.placeholder.slim'));\r\n                    }\r\n                    else {\r\n                        uiintro.add(table);\r\n                    }\r\n                    return uiintro;\r\n                }, 180);\r\n            }\r\n            ui.single_swap = ui.create.system('换人', function () {\r\n                var players = get.players(game.me);\r\n                players.remove(game.boss);\r\n                if (players.length > 1) {\r\n                    if (ui.auto.classList.contains('hidden')) {\r\n                        game.me.popup('请稍后换人');\r\n                        return;\r\n                    }\r\n                    if (_status.event.isMine()) {\r\n                        ui.click.auto();\r\n                        setTimeout(function () {\r\n                            ui.click.auto();\r\n                        }, 500);\r\n                    }\r\n                    game.modeSwapPlayer(players[1]);\r\n                }\r\n            }, true);\r\n            if (get.config('single_control') || game.me == game.boss) {\r\n                ui.single_swap.style.display = 'none';\r\n            }\r\n            ui.arena.appendChild(boss);\r\n            if (boss.bossinginfo) {\r\n                var rect = boss.getBoundingClientRect();\r\n                boss.style.transform = 'translate(' + (boss.bossinginfo[0] - rect.left - rect.width / 2) + 'px,' + (boss.bossinginfo[1] - rect.top - rect.height / 2) + 'px) scale(1.1)';\r\n                ui.refresh(boss);\r\n                boss.style.transition = '';\r\n                boss.style.transform = '';\r\n                delete boss.bossinginfo;\r\n                setTimeout(function () {\r\n                    boss.node.equips.style.opacity = '';\r\n                }, 500);\r\n            }\r\n            Evt.bosslist.delete();\r\n            game.arrangePlayers();\r\n            for (let i = 0; i < game.players.length; i++) {\r\n                game.players[i].node.action.innerHTML = '行动';\r\n            }\r\n            let players = get.players(lib.sort.position);\r\n            let info = [];\r\n            for (let i = 0; i < players.length; i++) {\r\n                info.push({\r\n                    name: players[i].name1,\r\n                    identity: players[i].identity,\r\n                    position: players[i].dataset.position\r\n                });\r\n            }\r\n            _status.videoInited = true;\r\n            game.addVideo('init', null, info);\r\n            if (game.bossinfo.init) {\r\n                game.bossinfo.init();\r\n            }\r\n            delete lib.drama;\r\n            \"step 3\";\r\n            if (get.config('single_control')) {\r\n                for (let i = 0; i < game.players.length; i++) {\r\n                    if (game.players[i].side == game.me.side) {\r\n                        game.addRecentCharacter(game.players[i].name);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                game.addRecentCharacter(game.me.name);\r\n            }\r\n            Evt.trigger('gameStart');\r\n            game.gameDraw(game.boss, game.bossinfo.gameDraw || 4);\r\n            game.bossPhaseLoop();\r\n            setTimeout(function () {\r\n                ui.updatehl();\r\n            }, 200);\r\n        },\r\n        element: {\r\n            player: {\r\n                dieAfter: function () {\r\n                    if (this != game.boss) {\r\n                        this.$.boss_chongzheng = 0;\r\n                    }\r\n                    if (game.bossinfo.checkResult && game.bossinfo.checkResult(this) === false) {\r\n                        return;\r\n                    }\r\n                    if (this == game.boss || !game.hasPlayer(function (cur) {\r\n                        return !cur.side;\r\n                    })) {\r\n                        game.checkResult();\r\n                    }\r\n                },\r\n            }\r\n        },\r\n        card: {},\r\n        init: function () {\r\n            for (var i in lib.characterPack.mode_boss) {\r\n                if (lib.characterPack.mode_boss[i][4].contains('hiddenboss'))\r\n                    continue;\r\n                lib.mode.boss.config[i + '_boss_config'] = {\r\n                    name: get.translation(i),\r\n                    init: true,\r\n                    unfrequent: true,\r\n                };\r\n            }\r\n        },\r\n        game: {\r\n            initMap: () => {\r\n                if (!lib.config.touchscreen) {\r\n                    ui.chessMap.addEventListener('mousedown', function (e) {\r\n                        if (Array.isArray(e.path)) {\r\n                            for (var i = 0; i < e.path.length; i++) {\r\n                                var itemtype = get.itemtype(e.path[i]);\r\n                                if (itemtype == 'button' || itemtype == 'card' || itemtype == 'player') {\r\n                                    return;\r\n                                }\r\n                            }\r\n                        }\r\n                        this._chessdrag = [e, this.parentNode.chessLeft, this.parentNode.chessTop];\r\n                    });\r\n                    ui.chessMap.addEventListener('mouseleave', function () {\r\n                        this._chessdrag = null;\r\n                    });\r\n                    ui.chessMap.addEventListener('mouseup', function () {\r\n                        if (this._chessdrag) {\r\n                            this._chessdrag = null;\r\n                        }\r\n                    });\r\n                    ui.chessMap.addEventListener('mousemove', function (e) {\r\n                        if (_status.mousedragging)\r\n                            return;\r\n                        if (this._chessdrag) {\r\n                            ui.dramaContainer.move(this._chessdrag[1] - e.x + this._chessdrag[0].x - ui.dramaContainer.chessLeft, this._chessdrag[2] - e.y + this._chessdrag[0].y - ui.dramaContainer.chessTop);\r\n                            _status.clicked = true;\r\n                        }\r\n                        e.preventDefault();\r\n                    });\r\n                    ui.chessMap.addEventListener('wheel', function (e) {\r\n                        ui.dramaContainer.move(e.deltaX, e.deltaY);\r\n                        e.preventDefault();\r\n                    });\r\n                }\r\n                else {\r\n                    ui.chessMap.addEventListener('touchstart', function (e) {\r\n                        if (e.touches.length == 1) {\r\n                            this._chessdrag = [e, this.parentNode.chessLeft, this.parentNode.chessTop];\r\n                        }\r\n                    });\r\n                    ui.chessMap.addEventListener('touchend', function () {\r\n                        this._chessdrag = null;\r\n                    });\r\n                    ui.chessMap.addEventListener('touchmove', function (e) {\r\n                        if (_status.mousedragging)\r\n                            return;\r\n                        if (this._chessdrag && e.touches.length == 1) {\r\n                            ui.dramaContainer.move(this._chessdrag[1] - e.touches[0].clientX + this._chessdrag[0].touches[0].clientX - ui.dramaContainer.chessLeft, this._chessdrag[2] - e.touches[0].clientY + this._chessdrag[0].touches[0].clientY - ui.dramaContainer.chessTop);\r\n                            _status.clicked = true;\r\n                        }\r\n                        e.preventDefault();\r\n                    });\r\n                }\r\n            },\r\n            reserveDead: true,\r\n            addBossFellow: function (position, name) {\r\n                var fellow = game.addFellow(position, name, 'zoominanim');\r\n                fellow.directgain(get.cards(4));\r\n                fellow.side = true;\r\n                fellow.identity = 'zhong';\r\n                fellow.setIdentity('zhong');\r\n                game.addVideo('setIdentity', fellow, 'zhong');\r\n            },\r\n            changeBoss: function (name, player) {\r\n                if (!player) {\r\n                    if (game.additionaldead) {\r\n                        game.additionaldead.push(game.boss);\r\n                    }\r\n                    else {\r\n                        game.additionaldead = [game.boss];\r\n                    }\r\n                    player = game.boss;\r\n                    delete game.boss;\r\n                }\r\n                player.delete();\r\n                game.players.remove(player);\r\n                game.dead.remove(player);\r\n                var boss = ui.create.player();\r\n                boss.getId();\r\n                boss.init(name);\r\n                boss.side = true;\r\n                game.addVideo('bossSwap', player, (game.boss ? '_' : '') + boss.name);\r\n                boss.dataset.position = player.dataset.position;\r\n                if (game.me == player) {\r\n                    game.swapControl(boss);\r\n                }\r\n                game.players.push(boss.animate('zoominanim'));\r\n                game.arrangePlayers();\r\n                if (!game.boss) {\r\n                    game.boss = boss;\r\n                    boss.setIdentity('zhu');\r\n                    boss.identity = 'zhu';\r\n                }\r\n                else {\r\n                    boss.setIdentity('zhong');\r\n                    boss.identity = 'zhong';\r\n                }\r\n                ui.arena.appendChild(boss);\r\n                boss.directgain(get.cards(4));\r\n            },\r\n            checkResult: function () {\r\n                if (game.boss == game.me) {\r\n                    game.over(game.boss.isAlive());\r\n                }\r\n                else {\r\n                    game.over(!game.boss.isAlive());\r\n                }\r\n            },\r\n            getVideoName: function () {\r\n                var str = get.translation(game.me.name);\r\n                if (game.me.name2) {\r\n                    str += '/' + get.translation(game.me.name2);\r\n                }\r\n                var str2 = '挑战';\r\n                if (game.me != game.boss) {\r\n                    str2 += ' - ' + get.translation(game.boss);\r\n                }\r\n                var name = [str, str2];\r\n                return name;\r\n            },\r\n            bossPhaseLoop: function () {\r\n                var next = game.createEvent('phaseLoop');\r\n                if (game.bossinfo.loopFirst) {\r\n                    next.player = game.bossinfo.loopFirst();\r\n                }\r\n                else {\r\n                    next.player = game.boss;\r\n                }\r\n                _status.looped = true;\r\n                next.setContent(function () {\r\n                    \"step 0\";\r\n                    if (player.chongzheng) {\r\n                        player.chongzheng = false;\r\n                    }\r\n                    else if (player.isDead()) {\r\n                        if (player.hp < 0)\r\n                            player.hp = 0;\r\n                        player.$.boss_chongzheng++;\r\n                        if (player.maxHp > 0 && game.bossinfo.chongzheng) {\r\n                            if (player.hp < player.maxHp) {\r\n                                player.hp++;\r\n                            }\r\n                            else if (player.countCards('h') < 4) {\r\n                                var card = get.cards()[0];\r\n                                var sort = lib.config.sort_card(card);\r\n                                var position = sort > 0 ? player.node.handcards1 : player.node.handcards2;\r\n                                card.fix();\r\n                                card.animate('start');\r\n                                position.insertBefore(card, position.firstChild);\r\n                            }\r\n                            player.update();\r\n                            if (player.$.boss_chongzheng >= game.bossinfo.chongzheng) {\r\n                                player.revive(player.hp);\r\n                            }\r\n                        }\r\n                        if (game.bossinfo.loopType == 2) {\r\n                            game.boss.chongzheng = true;\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (player.identity == 'zhu' && game.boss != player) {\r\n                            player = game.boss;\r\n                        }\r\n                        player.phase();\r\n                    }\r\n                    \"step 1\";\r\n                    if (game.bossinfo.loopType == 2) {\r\n                        _status.roundStart = true;\r\n                        if (Evt.player == game.boss) {\r\n                            if (!_status.last || _status.last.nextSeat == game.boss) {\r\n                                Evt.player = game.boss.nextSeat;\r\n                            }\r\n                            else {\r\n                                Evt.player = _status.last.nextSeat;\r\n                            }\r\n                        }\r\n                        else {\r\n                            _status.last = player;\r\n                            Evt.player = game.boss;\r\n                            if (player.nextSeat == game.boss) {\r\n                                delete _status.roundStart;\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        Evt.player = Evt.player.nextSeat;\r\n                    }\r\n                    Evt.goto(0);\r\n                });\r\n            },\r\n            onSwapControl: function () {\r\n                if (game.me == game.boss)\r\n                    return;\r\n                game.addVideo('onSwapControl');\r\n                var name = game.me.name;\r\n                if (ui.fakeme && ui.fakeme.current != name) {\r\n                    ui.fakeme.current = name;\r\n                    if (ui.versushighlight && ui.versushighlight != game.me) {\r\n                        ui.versushighlight.classList.remove('current_action');\r\n                    }\r\n                    ui.versushighlight = game.me;\r\n                    game.me.classList.add('current_action');\r\n                    ui.fakeme.style.backgroundImage = game.me.node.avatar.style.backgroundImage;\r\n                }\r\n                ui.updatehl();\r\n            },\r\n            modeSwapPlayer: function (player) {\r\n                var bool = (game.me == game.boss || player == game.boss);\r\n                game.swapControl(player);\r\n                game.onSwapControl();\r\n                if (!bool)\r\n                    return;\r\n                if (game.me == game.boss) {\r\n                    game.singleHandcard = false;\r\n                    ui.arena.classList.remove('single-handcard');\r\n                    ui.window.classList.remove('single-handcard');\r\n                    ui.fakeme.style.display = 'none';\r\n                    game.me.dataset.position = 0;\r\n                    game.me.nextSeat.dataset.position = 2;\r\n                    game.me.nextSeat.nextSeat.dataset.position = 4;\r\n                    game.me.nextSeat.nextSeat.nextSeat.dataset.position = 6;\r\n                }\r\n                else {\r\n                    game.singleHandcard = true;\r\n                    ui.arena.classList.add('single-handcard');\r\n                    ui.window.classList.add('single-handcard');\r\n                    ui.fakeme.style.display = '';\r\n                    game.boss.dataset.position = 7;\r\n                    game.boss.nextSeat.dataset.position = 1;\r\n                    game.boss.nextSeat.nextSeat.dataset.position = 2;\r\n                    game.boss.nextSeat.nextSeat.nextSeat.dataset.position = 3;\r\n                    if (game.me && game.me.node.handcards2.childNodes.length) {\r\n                        while (game.me.node.handcards2.childNodes.length) {\r\n                            game.me.node.handcards1.appendChild(game.me.node.handcards2.firstChild);\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            chooseCharacter: function (func) {\r\n                var next = game.createEvent('chooseCharacter', false);\r\n                next.showConfig = true;\r\n                next.customreplacetarget = func;\r\n                next.ai = function (player, list) {\r\n                    if (get.config('double_character')) {\r\n                        player.init(list[0], list[1]);\r\n                    }\r\n                    else {\r\n                        player.init(list[0]);\r\n                    }\r\n                };\r\n                next.setContent(function () {\r\n                    \"step 0\";\r\n                    let list = lib.cardPack.groups.slice(0);\r\n                    Evt.list = list;\r\n                    list.randomSort();\r\n                    var dialog = ui.create.dialog('推荐势力', 'hidden');\r\n                    _status.drama.dialog = dialog;\r\n                    dialog.classList.add('fixed');\r\n                    ui.window.appendChild(dialog);\r\n                    dialog.classList.add('stgcharacter');\r\n                    dialog.classList.add('modeshortcutpause');\r\n                    dialog.classList.add('withbg');\r\n                    dialog.add([lib.cardPack.recommendGroups.slice(0), 'vcard']);\r\n                    dialog.noopen = true;\r\n                    var next = game.me.chooseButton(dialog, true).set('onfree', true);\r\n                    next._triggered = null;\r\n                    next.custom.replace.target = Evt.customreplacetarget;\r\n                    var createCharacterDialog = function () {\r\n                        Evt.dialogxx = ui.create.cardDialog(v => {\r\n                            if (v.indexOf('group_') >= 0) {\r\n                                for (let i of ['wei', 'shu', 'wu', 'jin', 'western', 'key', 'vtuber', 'clubs']) {\r\n                                    if (v.indexOf(i) === 6)\r\n                                        return true;\r\n                                }\r\n                                return false;\r\n                            }\r\n                            return true;\r\n                        });\r\n                        Evt.dialogxx.classList.add('bosscharacter');\r\n                        Evt.dialogxx.classList.add('withbg');\r\n                        Evt.dialogxx.classList.add('fixed');\r\n                        if (ui.cheat2) {\r\n                            ui.cheat2.animate('controlpressdownx', 500);\r\n                            ui.cheat2.classList.remove('disabled');\r\n                        }\r\n                    };\r\n                    if (lib.onfree) {\r\n                        lib.onfree.push(createCharacterDialog);\r\n                    }\r\n                    else {\r\n                        createCharacterDialog();\r\n                    }\r\n                    ui.create.cheat2 = function () {\r\n                        _status.createControl = ui.watchDrama;\r\n                        ui.cheat2 = ui.create.control('全部势力', function () {\r\n                            ui.cheat2.classList.toggle('glow');\r\n                            if (this.dialog == _status.event.dialog) {\r\n                                if (game.changeCoin) {\r\n                                    game.changeCoin(50);\r\n                                }\r\n                                this.dialog.close();\r\n                                _status.event.dialog = this.backup;\r\n                                ui.window.appendChild(this.backup);\r\n                                _status.drama.dialog = _status.event.dialog;\r\n                                delete this.backup;\r\n                                game.uncheck();\r\n                                game.check();\r\n                                if (_status.dramaChoice) {\r\n                                    _status.dramaChoice.animate('controlpressdownx', 500);\r\n                                    _status.dramaChoice.classList.remove('disabled');\r\n                                }\r\n                            }\r\n                            else {\r\n                                if (game.changeCoin) {\r\n                                    game.changeCoin(-10);\r\n                                }\r\n                                this.backup = _status.event.dialog;\r\n                                _status.event.dialog.close();\r\n                                _status.event.dialog = _status.event.parent.dialogxx;\r\n                                this.dialog = _status.event.dialog;\r\n                                _status.drama.dialog = _status.event.dialog;\r\n                                ui.window.appendChild(this.dialog);\r\n                                game.uncheck();\r\n                                game.check();\r\n                                if (_status.dramaChoice) {\r\n                                    _status.dramaChoice.classList.add('disabled');\r\n                                }\r\n                            }\r\n                        });\r\n                        if (lib.onfree) {\r\n                            ui.cheat2.classList.add('disabled');\r\n                        }\r\n                        delete _status.createControl;\r\n                    };\r\n                    ui.create.cheat2();\r\n                    ui.watchDrama = ui.create.control('查看地图', function () {\r\n                        ui.watchDrama.classList.toggle('glow');\r\n                        if (lib.storage.currentDrama) {\r\n                            if (_status.drama.watch) {\r\n                                _status.drama.watch = false;\r\n                                game.showChoose();\r\n                                lib.drama[lib.storage.currentDrama].situation.hide();\r\n                                if (ui.cheat2) {\r\n                                    ui.cheat2.animate('controlpressdownx', 500);\r\n                                    ui.cheat2.classList.remove('disabled');\r\n                                }\r\n                            }\r\n                            else {\r\n                                _status.drama.watch = true;\r\n                                game.hideChoose();\r\n                                lib.drama[lib.storage.currentDrama].situation.show();\r\n                                if (ui.cheat2) {\r\n                                    ui.cheat2.classList.add('disabled');\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n                    \"step 1\";\r\n                    if (ui.cheat2) {\r\n                        ui.cheat2.close();\r\n                        delete ui.cheat2;\r\n                    }\r\n                    if (ui.watchDrama) {\r\n                        ui.watchDrama.close();\r\n                        delete ui.watchDrama;\r\n                    }\r\n                    if (_status.dramaChoice) {\r\n                        _status.dramaChoice.close();\r\n                        delete _status.dramaChoice;\r\n                    }\r\n                    if (Evt.watcher) {\r\n                        Evt.result = {\r\n                            watcher: true,\r\n                            links: Evt.enemy\r\n                        };\r\n                    }\r\n                    else {\r\n                        Evt.result = {\r\n                            watcher: false,\r\n                            links: result.links\r\n                        };\r\n                        _status.coinCoeff = get.coinCoeff(result.links);\r\n                        delete _status.drama.bosslist;\r\n                    }\r\n                });\r\n                return next;\r\n            },\r\n            hideChoose: () => {\r\n                if (_status.drama.bosslist)\r\n                    _status.drama.bosslist.hide();\r\n                if (_status.drama.dialog)\r\n                    _status.drama.dialog.hide();\r\n            },\r\n            showChoose: () => {\r\n                if (_status.drama.bosslist)\r\n                    _status.drama.bosslist.show();\r\n                if (_status.drama.dialog)\r\n                    _status.drama.dialog.show();\r\n            }\r\n        },\r\n        ui: {\r\n            click: {\r\n                moveContainer: function (x, y, scroll) {\r\n                    if (scroll) {\r\n                        clearTimeout(ui.dramaContainer._scrolling);\r\n                        ui.dramaContainer._scrolling = true;\r\n                        ui.chessMap.style.transition = 'transform 0.5s';\r\n                        ui.refresh(ui.chessMap);\r\n                    }\r\n                    else if (ui.dramaContainer._scrolling) {\r\n                        return;\r\n                    }\r\n                    if (typeof x === 'number')\r\n                        ui.dramaContainer.chessLeft += x;\r\n                    if (typeof y === 'number')\r\n                        ui.dramaContainer.chessTop += y;\r\n                    var xmin = 0;\r\n                    if (lib.config.show_history == 'left') {\r\n                        xmin = -50;\r\n                    }\r\n                    if (ui.dramaContainer.chessLeft < xmin)\r\n                        ui.dramaContainer.chessLeft = xmin;\r\n                    if (ui.dramaContainer.chessTop < 0)\r\n                        ui.dramaContainer.chessTop = 0;\r\n                    var xmax = ui.dramaContainer.xmax;\r\n                    var ymax = ui.dramaContainer.ymax;\r\n                    if (ui.dramaContainer.chessLeft > xmax)\r\n                        ui.dramaContainer.chessLeft = xmax;\r\n                    if (ui.dramaContainer.chessTop > ymax)\r\n                        ui.dramaContainer.chessTop = ymax;\r\n                    ui.chessMap.style.transform = 'translate(' + (-ui.dramaContainer.chessLeft) + 'px,' + (-ui.dramaContainer.chessTop) + 'px)';\r\n                    if (scroll) {\r\n                        var ending = ui.chessMap.listenTransition(function () {\r\n                            if (ui.chessMap._ending == ending) {\r\n                                clearTimeout(ui.dramaContainer._scrolling);\r\n                                delete ui.chessMap._ending;\r\n                                ui.chessMap._scrolling = setTimeout(function () {\r\n                                    ui.dramaContainer._scrolling = null;\r\n                                    ui.chessMap.style.transition = '';\r\n                                }, 500);\r\n                            }\r\n                        });\r\n                        ui.chessMap._ending = ending;\r\n                    }\r\n                },\r\n                chessInfo: function (e) {\r\n                    if (this.link.isAlive()) {\r\n                        this.link.chessFocus();\r\n                        if (this.link.classList.contains('selectable') ||\r\n                            this.link.classList.contains('selected')) {\r\n                            ui.click.target.call(this.link, e);\r\n                            ui.click.window.call(ui.window, e);\r\n                        }\r\n                        e.stopPropagation();\r\n                    }\r\n                },\r\n                playergrid: function () {\r\n                    if (!_status.paused)\r\n                        return;\r\n                    var pos = parseInt(this.dataset.position);\r\n                    this.link.moveTo(pos % ui.chesswidth, Math.floor(pos / ui.chesswidth));\r\n                    if (ui.movegrids) {\r\n                        while (ui.movegrids.length) {\r\n                            ui.movegrids.shift().delete();\r\n                        }\r\n                    }\r\n                    _status.event.result = {\r\n                        bool: true,\r\n                        move: this.link.dataset.position\r\n                    };\r\n                    game.resume();\r\n                },\r\n                obstacle: function () {\r\n                    if (_status.event.chooseObstacle && _status.paused &&\r\n                        _status.event.obstacles && _status.event.obstacles.contains(this)) {\r\n                        _status.event.obstacle = this;\r\n                        game.resume();\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        drama: {\r\n            testDrama: {\r\n                size: [[5, 12], [27, 34]],\r\n                situation: {\r\n                    show: () => {\r\n                        if (ui.STG_start) {\r\n                            let preUi = ui.STG_start;\r\n                            ui.STG_start = lib.init.css(`${lib.assetURL}layout/mode`, 'strategy2');\r\n                            preUi.remove();\r\n                        }\r\n                        else {\r\n                            lib.init.css(`${lib.assetURL}layout/mode`, 'strategy2');\r\n                        }\r\n                        ui.mapContainer = ui.create.div('#map-container', ui.arena);\r\n                        ui.dramaContainer = ui.create.div('#chess-container', ui.mapContainer);\r\n                        ui.dramaContainer.move = ui.click.moveContainer;\r\n                        ui.dramaContainer.chessLeft = 0;\r\n                        ui.dramaContainer.chessTop = 0;\r\n                        ui.chessMap = ui.create.div('#chessMap', ui.dramaContainer);\r\n                        game.initMap();\r\n                        ui.canvas2 = document.createElement('canvas');\r\n                        ui.canvas2.id = 'canvas2';\r\n                        ui.chessMap.appendChild(ui.canvas2);\r\n                        ui.ctx2 = ui.canvas2.getContext('2d');\r\n                        ui.arena.classList.add('chess');\r\n                        let size = lib.drama[lib.storage.currentDrama].size;\r\n                        let width = (size[1][0] - size[0][0]) * 80;\r\n                        let height = (size[1][1] - size[0][1]) * 80;\r\n                        ui.canvas2.width = width;\r\n                        ui.canvas2.height = height;\r\n                        ui.chessMap.width = width;\r\n                        ui.chessMap.height = height;\r\n                        lib.situate.control.init(ui.canvas2, size, 0.06);\r\n                        ui.mapControl = ui.create.div('#map-control', ui.mapContainer);\r\n                        lib.situate.control.setMapControl(ui.mapControl);\r\n                        ui.mapZoom = ui.create.div('#map-zoom', ui.mapContainer);\r\n                        lib.situate.control.setMapControl(ui.mapZoom, { type: 'zoom' });\r\n                    },\r\n                    hide: () => {\r\n                        lib.situate.control.close();\r\n                        if (ui.STG_start) {\r\n                            let preUi = ui.STG_start;\r\n                            ui.STG_start = lib.init.css(`${lib.assetURL}layout/mode`, 'strategy1');\r\n                            preUi.remove();\r\n                        }\r\n                        else {\r\n                            lib.init.css(`${lib.assetURL}layout/mode`, 'strategy1');\r\n                        }\r\n                        ui.mapControl.delete(100, () => {\r\n                            ui.dramaContainer.delete(200, () => {\r\n                                delete ui.dramaContainer;\r\n                                delete ui.chessMap;\r\n                                delete ui.canvas2;\r\n                                delete ui.ctx2;\r\n                                ui.mapContainer.delete(200, () => {\r\n                                    delete ui.mapContainer;\r\n                                });\r\n                            });\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        situate: Object.assign({}, _strategy_situate__WEBPACK_IMPORTED_MODULE_0__[\"default\"]),\r\n        skill: {},\r\n        translate: {\r\n            group_VirtuaReal_info: `难易度：简单<br><br>\r\n\t\t\t百科：VirtuaReal，是にじさんじ（通称“彩虹社”）和Bilibili联合推出的虚拟主播企划，\r\n\t\t\t于2019年4月19日在Bilibili专栏发布初次招募信息，包含了VirtuaReal Project、VirtuaReal Star、VirtuaReal Link等多个分支企划。\r\n\t\t\t截至2021年11月，旗下共拥有成员70余位，主要在微博和Bilibili等网站进行活动。`,\r\n            group_psp_info: `难易度：简单<br><br>\r\n\t\t\t百科：Project SP（又称psplive，简称P-SP）是中国的虚拟艺人团体，旗下拥有数位个性鲜明的虚拟艺人，\r\n\t\t\t志在为大家提供更多优质的音乐、游戏、视频以及直播内容。\r\n\t\t\t只要不停下脚步，道路就会不断延伸。`,\r\n            group_asoul_info: `难易度：简单<br><br>\r\n\t\t\t百科：A-SOUL是2020年11月23日公开的乐华娱乐旗下虚拟偶像团体，由字节跳动朝夕光年工作室负责技术支持和日常运营，主要于Bilibili和抖音上开展活动。\r\n\t\t\t企划前身为“Project V”虚拟偶像女团，未证实疑似前身企划为虚拟偶像“蓝闪Menelaus” ，这也是为什么偶尔评论会有蓝闪，小一等的出现。\r\n\t\t\t<br><br>\r\n\t\t\t背景：（被官方遗忘许久的设定里）来自枝江大学的5个性格迥异、各怀才艺的女生在一次临时的救场演出中邂逅彼此，\r\n\t\t\t因共同的星梦，每个人都充满热情。过着快乐而充实的校园生活，也为能踏上梦想的舞台而努力发光。`,\r\n            group_chaos_info: `难易度：普通<br><br>\r\n\t\t\t百科：ChaosLive是在Bilibili上活动的虚拟主播企划，于2019年10月31正式启动企业活动。\r\n\t\t\t2020年4月25日，ChaosLive・Sprout个人势互助社团企划正式启动。`,\r\n            group_xuyan_info: `难易度：普通<br><br>\r\n\t\t\t百科：虚研社是中国一家较早开始活动的虚拟UP主社团，由微笑科技创建，\r\n\t\t\t最初只制作了“虚拟次元计划”（小希小桃Channel的前身）这一企划，\r\n\t\t\t后来通过帮助转生为虚拟UP主的方式，招募了木糖纯、冰糖、子辰等成员。`,\r\n            group_xuefeng_info: `难易度：困难<br><br>\r\n\t\t\t百科：雪风军团是活跃于bilibili的虚拟主播社团，为SMG旗下的专业虚拟主播运营机构与CG动画制作团队。\r\n\t\t\t雪风军团于2019年1月21日，随小虾鱼出道视频出现。\r\n\t\t\tstaff代称为雪风，形象为一群屁股会发光的二次元萤火虫，被称为屁光虫。\r\n\t\t\t实际上却是一群拥有极强开发实力的大神，策划整活、视频制作、3D建模、代播，甚至举办虚拟演唱会。`,\r\n            group_Providence_info: `难易度：普通<br><br>\r\n\t\t\t百科：Providence企划是在bilibili活动的虚拟主播团体。\r\n\t\t\t<br><br>\r\n\t\t\t背景：普罗维登特区地处于新旧世界之间，三个大国的势力交错之处。在上次大战争戛然而止后，各国一致同意将普罗维登群岛划为国际永久中立特区，\r\n\t\t\t由人类联合政府代管，作为国际自由港成为各方势力交流和交锋的试验田。<br>\r\n\t\t\t特区联合政府为了振兴本岛文化娱乐业内容创作，决定成立普罗维登企划开发委员会，对使用互联网技术进行新媒体内容创作的艺术家提供政策帮助和支持。\r\n\t\t\t经过长期的招标，现由艾恩科技集团（NWSE：Aien）提供相应的技术支持。\r\n\t\t\t普罗维登企划开发委员会将全力打造受人民群众喜爱的电子艺术表演创作平台，为艺术家搭建线上、线下作品展示渠道及作品销售渠道。`,\r\n            group_HappyEl_info: `难易度：困难<br><br>\r\n\t\t\t百科：乐元素，创立于2009年，是一家以游戏研发运营为主营业务、还包含动画作品、授权商品、音乐、演唱会、广播剧等在内的知名互动娱乐公司。\r\n\t\t\t代表作品有《开心消消乐》、《战斗吧歌姬!》等。`,\r\n            group_RedC_info: `难易度：普通<br><br>\r\n\t\t\t百科：RedCircle是一个于2020年成立的新兴虚拟主播社团。\r\n\t\t\t<br><br>\r\n\t\t\t背景：大脑有两边，心房分左右。我们的灵魂，当然也可以拥有两份。大叔心和少女情是兼容的，话唠和社恐也是可以共存的。\r\n\t\t\t你是否为了融入圈子而压抑着自己的个性呢？又或者因为无法隐藏自己的独特，而感到难以融入圈子呢？\r\n\t\t\t有没有想过，某一天自己能在新的世界里以新的身份自由挥洒着光彩呢？<br>\r\n\t\t\t这只从日本归来的神秘猫咪，在饱满地吸收了异国虚拟偶像的知识后，回到祖国建立了属于自己的全新社团——Red Circle！`,\r\n        },\r\n        get: {\r\n            rawAttitude: function (from, to) {\r\n                var num = (to.identity == 'zhong') ? 5 : 6;\r\n                return (from.side === to.side ? num : -num);\r\n            }\r\n        }\r\n    };\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/strategy.ts?")},"./src/mode/strategy_situate.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\nfunction hexagonal(ctx = context.curCtx, begin, zoom = context.curZoom, angle = [0, 6]) {\r\n    begin = [(begin[0] + 1) * 560 * zoom, (begin[1] + 1) * 485 * zoom];\r\n    let center = [280, 325];\r\n    let dist = 325;\r\n    let dig = Math.PI / 3;\r\n    let line = [];\r\n    for (let a = angle[0]; a <= angle[1]; a++) {\r\n        line.push([center[0] + dist * Math.sin(a * dig), center[1] - dist * Math.cos(a * dig)]);\r\n    }\r\n    ctx.moveTo(begin[0] + line[0][0] * zoom, begin[1] + line[0][1] * zoom);\r\n    let end = [...begin];\r\n    for (let v of line.slice(1)) {\r\n        end = [begin[0] + v[0] * zoom, begin[1] + v[1] * zoom];\r\n        ctx.lineTo(...end);\r\n    }\r\n    return { begin, center, end };\r\n}\r\nfunction hexAnnulus(ctx, begin, zoom, direction, serif = true) {\r\n    begin = [(begin[0] + 1) * 560 * zoom, (begin[1] + 1) * 485 * zoom];\r\n    let center = [280, 325], dist = 325;\r\n    let dig = Math.PI / 3, map = ['0.25,-0.5', '0.5,0', '0.25,0.5', '-0.25,0.5', '-0.5,0', '-0.25,-0.5'], drcts = direction.map(d => {\r\n        return map.indexOf(d.join(\",\"));\r\n    });\r\n    function AddLine(line, a, dist) {\r\n        line.push([center[0] + dist * Math.sin(a * dig), center[1] - dist * Math.cos(a * dig)]);\r\n    }\r\n    for (let drct of drcts) {\r\n        let line = [];\r\n        AddLine(line, drct, dist);\r\n        AddLine(line, drct + 1, dist);\r\n        if (serif) {\r\n            AddLine(line, drct + 1.25, dist * Math.cos(0.5 * dig) / Math.cos(0.25 * dig));\r\n            AddLine(line, drct - 0.25, dist * Math.cos(0.5 * dig) / Math.cos(0.25 * dig));\r\n        }\r\n        else {\r\n            AddLine(line, drct + 1, dist * 0.8);\r\n            AddLine(line, drct, dist * 0.8);\r\n        }\r\n        ctx.moveTo(begin[0] + line[0][0] * zoom, begin[1] + line[0][1] * zoom);\r\n        for (let v of line.slice(1)) {\r\n            ctx.lineTo(begin[0] + v[0] * zoom, begin[1] + v[1] * zoom);\r\n        }\r\n        ctx.closePath();\r\n    }\r\n    return { begin, drcts };\r\n}\r\nfunction hexToRgba(hex, opacity, deviate) {\r\n    if (hex.indexOf('#') !== 0)\r\n        return hex;\r\n    let r = parseInt('0x' + hex.slice(1, 3)), g = parseInt('0x' + hex.slice(3, 5)), b = parseInt('0x' + hex.slice(5, 7));\r\n    if (deviate) {\r\n        let d = deviate;\r\n        let p = n => Math.max(0, n);\r\n        r += d[0];\r\n        g += d[1];\r\n        b += d[2];\r\n        r = p(r);\r\n        g = p(g);\r\n        b = p(b);\r\n    }\r\n    return `rgba(${r},${g},${b},${opacity})`;\r\n}\r\nclass Area {\r\n    constructor(pos) {\r\n        this.pos = pos;\r\n        this.blocks = [];\r\n    }\r\n    addBlocks(xs, y) {\r\n        if (xs instanceof Array) {\r\n            for (let x = xs[0]; x <= xs[1]; x++) {\r\n                this.addBlock(x, y);\r\n            }\r\n        }\r\n        else {\r\n            this.addBlock(xs, y);\r\n        }\r\n    }\r\n    addShape(shape) {\r\n        if (typeof shape[0] === 'number') {\r\n            for (let i = 1; i < shape.length; i++) {\r\n                let sy = i - 1 + shape[0];\r\n                let sx = shape[i];\r\n                if (sx instanceof Array) {\r\n                    if (sx[0] instanceof Array) {\r\n                        for (let s of sx) {\r\n                            this.addBlocks(s, sy);\r\n                        }\r\n                    }\r\n                    else {\r\n                        this.addBlocks(sx, sy);\r\n                    }\r\n                }\r\n                else {\r\n                    this.addBlocks(sx, sy);\r\n                }\r\n            }\r\n        }\r\n        else if (shape.length) {\r\n            for (let s of shape) {\r\n                this.addBlocks(s[0], s[1]);\r\n            }\r\n        }\r\n    }\r\n    tempCoord(ctx = context.curCtx, size = context.curSize, zoom = context.curZoom) {\r\n        let pos = this.pos.slice(0);\r\n        let coord = [(pos[0] - size[0][0]) * 2, (pos[1] - size[0][1]) * 2];\r\n        ctx.beginPath();\r\n        let coord2 = hexagonal(ctx, coord, zoom).begin;\r\n        ctx.beginPath();\r\n        return coord2;\r\n    }\r\n    addBlock(...args) { }\r\n    drawMap(...args) { }\r\n    get faction() {\r\n        for (let v of factions) {\r\n            if (v.areas.includes(this))\r\n                return v;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nclass City extends Area {\r\n    constructor(name, pos, config = {}) {\r\n        super(pos);\r\n        this.id = (\"000\" + ++City.cityId).slice(-3);\r\n        this.name = name;\r\n        this.level = config.level || 0;\r\n        this.region = config.region;\r\n        this.shape = config.shape;\r\n        this.color = config.color;\r\n        if (this.shape) {\r\n            this.addShape(this.shape);\r\n        }\r\n        else {\r\n            this.addBlocks(0, 0);\r\n            this.addBlocks([0, 1], -1);\r\n        }\r\n    }\r\n    drawBorder(ctx = context.curCtx, size = context.curSize, zoom = context.curZoom) {\r\n        let c = this;\r\n        let blocks = c.blocks.slice(0);\r\n        for (let b of blocks) {\r\n            let pos = b.pos;\r\n            if (pos[0] > size[0][0]\r\n                && pos[0] < size[1][0]\r\n                && pos[1] > size[0][1]\r\n                && pos[1] < size[1][1]) {\r\n                let direction = b.getAdjoinBlock((x, y) => x.cityId !== y.cityId).direction;\r\n                if (direction.length) {\r\n                    let coord = [(pos[0] - size[0][0]) * 2, (pos[1] - size[0][1]) * 2];\r\n                    hexAnnulus(ctx, coord, zoom, direction);\r\n                }\r\n            }\r\n        }\r\n        let opacity = 0.5;\r\n        ctx.save();\r\n        ctx.fillStyle = c.color ? hexToRgba(c.color, opacity, [-20, -20, -20]) : `rgba(150, 50, 255, ${opacity})`;\r\n        ctx.fill();\r\n        ctx.beginPath();\r\n        ctx.restore();\r\n    }\r\n    addBlock(x, y) {\r\n        let center = (x === 0 && y === 0) || (x === 0 && y === -1) || (x === 1 && y === -1);\r\n        this.blocks.push(new Block([this.pos[0] + x / 2 + y / 4, this.pos[1] + y / 2], {\r\n            type: center ? 'cityCenter' : 'city',\r\n            area: this,\r\n            cityId: this.id,\r\n        }));\r\n    }\r\n    drawMap(ctx = context.curCtx, size = context.curSize, zoom = context.curZoom, config = {}) {\r\n        let xy = size[0].slice(0);\r\n        let c = this;\r\n        let pos = c.pos.slice(0);\r\n        if (xy[0] < pos[0]\r\n            && pos[0] < size[1][0]\r\n            && xy[1] < pos[1]\r\n            && pos[1] < size[1][1]) {\r\n            ctx.beginPath();\r\n            ctx.save();\r\n            let blocks = c.blocks.slice(0);\r\n            for (let b of blocks) {\r\n                b.drawMap(ctx, size, zoom);\r\n            }\r\n            if (config.hiddenBorder !== true) {\r\n                c.drawBorder(ctx, size, zoom);\r\n            }\r\n            ctx.restore();\r\n            if (config.hiddenName !== true) {\r\n                let coord2 = this.tempCoord();\r\n                ctx.save();\r\n                ctx.fillStyle = c.color ? hexToRgba(c.color, config.hiddenName | 0.85) : \"rgba(150, 50, 255, 0.9)\";\r\n                ctx.fillText(translation.citys[c.name], coord2[0] + 300 * zoom, coord2[1] + 300 * zoom);\r\n                ctx.strokeStyle = \"rgba(0, 10, 255, 1)\";\r\n                ctx.shadowBlur = 10;\r\n                ctx.lineWidth = 1;\r\n                ctx.lineJoin = \"round\";\r\n                ctx.shadowColor = ctx.fillStyle;\r\n                ctx.strokeText(translation.citys[c.name], coord2[0] + 300 * zoom, coord2[1] + 300 * zoom);\r\n                ctx.beginPath();\r\n                ctx.restore();\r\n            }\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n}\r\nCity.cityId = 0;\r\nclass Mount extends Area {\r\n    constructor(name, pos, config = {}) {\r\n        super(pos);\r\n        this.id = (\"000\" + ++Mount.mountId).slice(-3);\r\n        this.name = name;\r\n        this.shape = config.shape;\r\n        this.color = config.color || '#333333';\r\n        if (this.shape) {\r\n            this.addShape(this.shape);\r\n        }\r\n    }\r\n    addBlock(x, y) {\r\n        this.blocks.push(new Block([this.pos[0] + x / 2 + y / 4, this.pos[1] + y / 2], {\r\n            type: 'mount',\r\n            area: this\r\n        }));\r\n    }\r\n    drawMap(ctx = context.curCtx, size = context.curSize, zoom = context.curZoom) {\r\n        let xy = size[0].slice(0);\r\n        let m = this;\r\n        let pos = m.pos.slice(0);\r\n        if (xy[0] < pos[0]\r\n            && pos[0] < size[1][0]\r\n            && xy[1] < pos[1]\r\n            && pos[1] < size[1][1]) {\r\n            ctx.beginPath();\r\n            let blocks = m.blocks.slice(0);\r\n            for (let b of blocks) {\r\n                b.drawMap(ctx, size, zoom, false);\r\n            }\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n}\r\nMount.mountId = 0;\r\nclass Block {\r\n    constructor(pos, config = {}) {\r\n        this.id = (\"0000\" + ++Block.blockId).slice(-4);\r\n        this.pos = pos;\r\n        this.level = config.level || 0;\r\n        this.type = config.type;\r\n        this.area = config.area;\r\n        this.cityId = config.cityId;\r\n        let adjoins = {};\r\n        for (let b of blocks) {\r\n            let bpos = b.pos;\r\n            if (bpos[1] === pos[1]) {\r\n                if (bpos[0] - pos[0] === 0.5) {\r\n                    adjoins.right = b;\r\n                    b.adjoins.left = this;\r\n                }\r\n                else if (bpos[0] - pos[0] === -0.5) {\r\n                    adjoins.left = b;\r\n                    b.adjoins.right = this;\r\n                }\r\n            }\r\n            else if (bpos[1] - pos[1] === -0.5) {\r\n                if (bpos[0] - pos[0] === 0.25) {\r\n                    adjoins.rightup = b;\r\n                    b.adjoins.leftdown = this;\r\n                }\r\n                else if (bpos[0] - pos[0] === -0.25) {\r\n                    adjoins.leftup = b;\r\n                    b.adjoins.rightdown = this;\r\n                }\r\n            }\r\n            else if (bpos[1] - pos[1] === 0.5) {\r\n                if (bpos[0] - pos[0] === 0.25) {\r\n                    adjoins.rightdown = b;\r\n                    b.adjoins.leftup = this;\r\n                }\r\n                else if (bpos[0] - pos[0] === -0.25) {\r\n                    adjoins.leftdown = b;\r\n                    b.adjoins.rightup = this;\r\n                }\r\n            }\r\n        }\r\n        this.adjoins = adjoins;\r\n        blocks.push(this);\r\n    }\r\n    drawMap(ctx = context.curCtx, size, zoom, stroke = true) {\r\n        ctx.strokeStyle = \"rgba(0, 10, 255, 0.5)\";\r\n        ctx.shadowOffsetX = 0;\r\n        ctx.shadowOffsetY = 0;\r\n        let pos = this.pos.slice(0);\r\n        if (pos[0] > size[0][0]\r\n            && pos[0] < size[1][0]\r\n            && pos[1] > size[0][1]\r\n            && pos[1] < size[1][1]) {\r\n            let coord = [(pos[0] - size[0][0]) * 2, (pos[1] - size[0][1]) * 2];\r\n            let area = this.area;\r\n            let opacity = 0.55;\r\n            if (this.cityId) {\r\n                opacity = this.type === 'cityCenter' ? 0.5 : 0.4;\r\n            }\r\n            hexagonal(ctx, coord, zoom);\r\n            if (stroke) {\r\n                ctx.stroke();\r\n            }\r\n            ctx.save();\r\n            if (this.cityId && data.map_status) {\r\n                switch (data.map_status) {\r\n                    case '省份':\r\n                        ctx.fillStyle = area.color ? hexToRgba(area.color, opacity) : `rgba(150, 50, 255, ${opacity})`;\r\n                        break;\r\n                    case '势力':\r\n                        ctx.fillStyle = area.faction ? hexToRgba(area.faction.color, opacity) : `rgba(55, 55, 65, 0.4)`;\r\n                        break;\r\n                    case '外交':\r\n                        ctx.fillStyle = area.faction ? hexToRgba(area.faction.color, opacity) : `rgba(55, 55, 65, 0.4)`;\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                ctx.fillStyle = area.color ? hexToRgba(area.color, opacity) : `rgba(150, 50, 255, ${opacity})`;\r\n            }\r\n            ctx.fill();\r\n            ctx.beginPath();\r\n            ctx.restore();\r\n        }\r\n    }\r\n    getAdjoinBlock(filter) {\r\n        let pos = this.pos;\r\n        let direction = [];\r\n        let adjoins = this.adjoins;\r\n        for (let a in adjoins) {\r\n            if (!filter(this, adjoins[a]))\r\n                continue;\r\n            let apos = adjoins[a].pos;\r\n            direction.push([apos[0] - pos[0], apos[1] - pos[1]]);\r\n        }\r\n        return { adjoins, direction };\r\n    }\r\n}\r\nBlock.blockId = 0;\r\nclass Faction {\r\n    constructor(name, citynames, info) {\r\n        this.id = (\"000\" + ++Faction.factionId).slice(-3);\r\n        this.name = name;\r\n        this.citys = citys.filter(city => citynames.includes(city.name));\r\n        this.color = info.config.color;\r\n        this.updateAreas();\r\n    }\r\n    updateAreas() {\r\n        this.areas = this.citys.slice(0);\r\n    }\r\n    drawMap(ctx = context.curCtx, size = context.curSize, zoom = context.curZoom, config) {\r\n        let f = this;\r\n        if (this.areas.length) {\r\n            let config = { hiddenName: true };\r\n            if (data.map_status === '外交')\r\n                config.hiddenBorder = true;\r\n            ctx.save();\r\n            for (let a of this.areas) {\r\n                a.drawMap(ctx, size, zoom, config);\r\n            }\r\n            ctx.restore();\r\n            let coord2 = this.tempCoord();\r\n            ctx.save();\r\n            ctx.fillStyle = f.color ? hexToRgba(f.color, 0.9) : \"rgba(150, 50, 255, 1)\";\r\n            let fontFamily = \"'hyk2gj',Arial\";\r\n            let nameText = translation.factions[f.name];\r\n            let fontSize = 36;\r\n            if (nameText.length <= 4) {\r\n                fontSize += 14;\r\n            }\r\n            else if (nameText.length <= 7) {\r\n                fontSize += 9;\r\n            }\r\n            else if (nameText.length <= 10) {\r\n                fontSize += 4;\r\n            }\r\n            if (this.citys.length >= 4) {\r\n                fontSize += 5;\r\n            }\r\n            if (this.citys.length >= 6) {\r\n                fontSize += 10;\r\n            }\r\n            ctx.font = `${fontSize}px ${fontFamily}`;\r\n            ctx.fillText(nameText, coord2[0] + 300 * zoom, coord2[1] + 300 * zoom);\r\n            ctx.strokeStyle = \"rgba(0, 10, 255, 1)\";\r\n            ctx.shadowBlur = 10;\r\n            ctx.lineWidth = 1;\r\n            ctx.lineJoin = \"round\";\r\n            ctx.shadowColor = ctx.fillStyle;\r\n            ctx.strokeText(nameText, coord2[0] + 300 * zoom, coord2[1] + 300 * zoom);\r\n            ctx.beginPath();\r\n            ctx.restore();\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    tempCoord() {\r\n        if (this.areas.length === 1) {\r\n            return this.areas[0].tempCoord();\r\n        }\r\n        if (this.areas.length > 1) {\r\n            let areaTempCoord = [];\r\n            for (let a of this.areas) {\r\n                areaTempCoord.push(a.tempCoord());\r\n            }\r\n            let temp = [0, 0];\r\n            for (let v of areaTempCoord) {\r\n                temp = [temp[0] + v[0], temp[1] + v[1]];\r\n            }\r\n            temp[0] /= areaTempCoord.length;\r\n            temp[1] /= areaTempCoord.length;\r\n            return temp;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nFaction.factionId = 0;\r\nclass Clan {\r\n    constructor(name, factions, info) {\r\n        this.name = name;\r\n        this.factions = factions;\r\n    }\r\n}\r\nClan.clanId = 0;\r\nconst blocks = [];\r\nconst translation = {\r\n    citys: {\r\n        longxi: '陇西',\r\n        wuwei: '武威',\r\n        tianshui: '天水',\r\n        anding: '安定',\r\n        beidi: '北地',\r\n        hanzhong: '汉中',\r\n        zitong: '梓潼',\r\n        chengdu: '成都',\r\n        jiangzhou: '江州',\r\n        yongan: '永安',\r\n        fuling: '涪陵',\r\n        jianning: '建宁',\r\n        yunnan: '云南',\r\n        yongchang: '永昌',\r\n        xihe: '西河',\r\n        jinyang: '晋阳',\r\n        shangdang: '上党',\r\n        changan: '长安',\r\n        wan: '宛',\r\n        shangyong: '上庸',\r\n        luoyang: '洛阳',\r\n        ye: '邺',\r\n        zhongshan: '中山',\r\n        nanpi: '南皮',\r\n        ji: '蓟',\r\n        beiping: '北平',\r\n        liucheng: '柳城',\r\n        xiangping: '襄平',\r\n        pingyuan: '平原',\r\n        beihai: '北海',\r\n        puyang: '濮阳',\r\n        chenliu: '陈留',\r\n        xiapi: '下邳',\r\n        xiaopei: '小沛',\r\n        langya: '琅琊',\r\n        guangling: '广陵',\r\n        shouchun: '寿春',\r\n        lujiang: '庐江',\r\n        xuchang: '许昌',\r\n        runan: '汝南',\r\n        xinye: '新野',\r\n        xiangyang: '襄阳',\r\n        jiangxia: '江夏',\r\n        jiangling: '江陵',\r\n        changsha: '长沙',\r\n        wuling: '武陵',\r\n        lingling: '零陵',\r\n        guiyang: '贵阳',\r\n        jianye: '建业',\r\n        wu: '吴',\r\n        chaisang: '柴桑',\r\n        kuaiji: '会稽',\r\n        jianan: '建安',\r\n        luling: '庐陵',\r\n        nanhai: '南海',\r\n        jiaozhi: '交趾',\r\n        jiuzhen: '九真',\r\n        rinan: '日南',\r\n        taibei: '台北',\r\n        taizhong: '台中',\r\n    },\r\n    factions: {\r\n        group_RedC: '红圈RedCircle',\r\n        group_MiyaFam: 'Miya Family',\r\n        group_ego: 'Egolive',\r\n        group_xuyan: '虚研社',\r\n        group_xuefeng: '雪风军团',\r\n        group_chaos: 'chaoslive',\r\n        group_NetEase: '网易',\r\n        group_chidori: '千鸟战队',\r\n        group_azhun: '天气阿准',\r\n        group_bingtang: '冰糖',\r\n    },\r\n    lands: {\r\n        Mt: '山峦',\r\n        Gb: '戈壁',\r\n        Pl: '平原',\r\n        Hl: '丘陵',\r\n        Rv: '河流',\r\n        Se: '海洋',\r\n    },\r\n};\r\nconst citys = [\r\n    new City(\"longxi\", [0, 10], { level: 2 }),\r\n    new City(\"wuwei\", [1, 6], { level: 4 }),\r\n    new City(\"tianshui\", [2, 11], { level: 3 }),\r\n    new City(\"anding\", [4, 8], { level: 1 }),\r\n    new City(\"beidi\", [5, 6], { level: 2 }),\r\n    new City(\"hanzhong\", [6, 14], {\r\n        level: 3, color: '#f3ea9d', shape: [\r\n            -4, [1, 2], [0, 1], [-4, 4], [-6, 4], [-5, 5], [-5, 4], [[-5, -4], [-2, 2]], [-1, 1]\r\n        ]\r\n    }),\r\n    new City(\"zitong\", [5, 17], { level: 1 }),\r\n    new City(\"chengdu\", [2, 20], { level: 6 }),\r\n    new City(\"jiangzhou\", [6, 22], {\r\n        level: 2, color: '#48a088', shape: [\r\n            -4, [1, 2], [-1, 2], [-2, 4], [-4, 4], [-5, 4], [-6, 2], [-6, 1], [[-7, -6], [-3, -1]]\r\n        ]\r\n    }),\r\n    new City(\"yongan\", [10, 20], {\r\n        level: 2, color: '#7ddecf', shape: [\r\n            -5, [-1, 0], [-2, 2], [-2, 3], [-3, 3], [-4, 4], [-5, 4], [[-5, -3], [1, 3]], -5\r\n        ]\r\n    }),\r\n    new City(\"fuling\", [8, 23], {\r\n        color: '#aa8844', shape: [\r\n            -2, 3, [0, 2], [-1, 1], [-2, 2], [-1, 2], [-1, 1], [-1, 1], [0, 1], [0, 1]\r\n        ]\r\n    }),\r\n    new City(\"jianning\", [5, 17], { level: 2 }),\r\n    new City(\"yunnan\", [3, 28], {\r\n        level: 1\r\n    }),\r\n    new City(\"yongchang\", [1, 29], {}),\r\n    new City(\"xihe\", [10, 6], { level: 2 }),\r\n    new City(\"jinyang\", [12, 6], { level: 4 }),\r\n    new City(\"shangdang\", [12, 8], { level: 3 }),\r\n    new City(\"changan\", [8, 11], { level: 8 }),\r\n    new City(\"wan\", [12, 14], {\r\n        level: 4, color: '#f3d48a', shape: [\r\n            -3, [0, 1], [-2, 2], [-2, 2], [-1, 2], [-2, 2], [-2, 1], [-1, 0]\r\n        ]\r\n    }),\r\n    new City(\"shangyong\", [10, 15], {\r\n        level: 2, color: '#94d685', shape: [\r\n            -2, [-1, 1], [-2, 1], [-1, 2], [-1, 3], [0, 3], 1\r\n        ]\r\n    }),\r\n    new City(\"luoyang\", [12, 11], { level: 8 }),\r\n    new City(\"ye\", [15, 7], { level: 6 }),\r\n    new City(\"zhongshan\", [16, 5], { level: 3 }),\r\n    new City(\"nanpi\", [19, 5], { level: 2 }),\r\n    new City(\"ji\", [17, 3], { level: 1 }),\r\n    new City(\"beiping\", [20, 3], { level: 4 }),\r\n    new City(\"liucheng\", [22, 2], {}),\r\n    new City(\"xiangping\", [24, 3], { level: 3 }),\r\n    new City(\"pingyuan\", [19, 8], { level: 2 }),\r\n    new City(\"beihai\", [23, 7], { level: 4 }),\r\n    new City(\"puyang\", [17, 10], { level: 2 }),\r\n    new City(\"chenliu\", [16, 12], { level: 3 }),\r\n    new City(\"xiapi\", [22, 13], {\r\n        level: 5, color: '#d07ae0', shape: [\r\n            -4, [1, 4], [-1, 4], [-1, 5], [-2, 5], [-3, 1], -3\r\n        ]\r\n    }),\r\n    new City(\"xiaopei\", [20, 12], { level: 2 }),\r\n    new City(\"langya\", [21, 10], { level: 4 }),\r\n    new City(\"guangling\", [23, 15], {\r\n        level: 4, color: '#6fa1eb', shape: [\r\n            -3, [2, 5], [-2, 5], [-3, 5], [-3, 3], [-3, -1], -3\r\n        ]\r\n    }),\r\n    new City(\"shouchun\", [19, 15], {\r\n        level: 5, color: '#f7b063', shape: [\r\n            -3, [0, 4], [-1, 4], [-2, 4], [-3, 4], [-2, 4], [-1, 4], [-1, 2]\r\n        ]\r\n    }),\r\n    new City(\"lujiang\", [21, 18], {\r\n        level: 2, color: '#e0d57a', shape: [\r\n            -3, [2, 3], [-1, 3], [-2, 2], [-4, 2], [-4, 1], [-4, -1]\r\n        ]\r\n    }),\r\n    new City(\"xuchang\", [15, 14], {\r\n        level: 4, color: '#7ec7ff', shape: [\r\n            -2, [-1, 1], [-2, 3], [-3, 5], [-3, 4], [-4, 3], [-2, 0]\r\n        ]\r\n    }),\r\n    new City(\"runan\", [17, 16], {\r\n        level: 3, color: '#8198fc', shape: [\r\n            -1, [-1, 2], [-3, 3], [-2, 3], [0, 3]\r\n        ]\r\n    }),\r\n    new City(\"xinye\", [14, 17], {\r\n        level: 2, color: '#ea9370', shape: [\r\n            -3, [0, 2], [-1, 3], [-2, 4], [-3, 5], [-1, 2]\r\n        ]\r\n    }),\r\n    new City(\"xiangyang\", [13, 19], {\r\n        level: 6, color: '#a893c8', shape: [\r\n            -4, -4, [-5, -2], [-4, -1], [-3, 1], [-3, 4], [-2, 4], [0, 4]\r\n        ]\r\n    }),\r\n    new City(\"jiangxia\", [17, 19], {\r\n        level: 4, color: '#8ecdb7', shape: [\r\n            -3, [-1, 1], [-1, 4], [-1, 4], [-1, 4], [0, 3]\r\n        ]\r\n    }),\r\n    new City(\"jiangling\", [14, 22], {\r\n        level: 3, color: '#6a84b7', shape: [\r\n            -4, [-1, 0], [-2, 5], [-3, 4], [-2, 4], [-1, 3], [0, 1]\r\n        ]\r\n    }),\r\n    new City(\"changsha\", [16, 24], {\r\n        level: 4, color: '#008877', shape: [\r\n            -2, [1, 3], [-1, 3], [-3, 4], [-4, 3], [-4, 3], [1, 2]\r\n        ]\r\n    }),\r\n    new City(\"wuling\", [12, 23], {\r\n        level: 2, color: '#95a3c6', shape: [\r\n            -3, [-4, -3], [-4, 0], [-5, 1], [-6, 2], [-5, 2], [-5, 0], [-6, -1], [-6, -5]\r\n        ]\r\n    }),\r\n    new City(\"lingling\", [13, 26], {\r\n        color: '#008844', shape: [\r\n            -3, 1, [[-3, 2]], [[-5, 2]], [[-5, 1]], [[-6, 2]], [-7, 0]\r\n        ]\r\n    }),\r\n    new City(\"guiyang\", [15, 26], {\r\n        level: 1, color: '#75ac8f', shape: [\r\n            -1, [[0, 4]], [[-1, 6]], [[-1, 5]], [[-3, -1], [4, 5]]\r\n        ]\r\n    }),\r\n    new City(\"jianye\", [24, 17], {\r\n        level: 8, color: '#ee5533', shape: [\r\n            -1, [0, 2], [-1, 2], [-1, 1], [-1, 1], [-2, -1], -2, [-4, -3], [-5, -3]\r\n        ]\r\n    }),\r\n    new City(\"wu\", [25, 20], {\r\n        level: 7, color: '#99dd33', shape: [\r\n            -6, [4, 6], [3, 5], [3, 4], [1, 4], [0, 3], [-1, 2], [-1, 2], [-3, 1]\r\n        ]\r\n    }),\r\n    new City(\"chaisang\", [19, 21], {\r\n        level: 6, color: '#c4e759', shape: [\r\n            -1, [0, 3], [-3, 3], [-4, 2], [-4, 3], [-5, 2], [-5, 1], [[-5, -4], [-2, 0]]\r\n        ]\r\n    }),\r\n    new City(\"kuaiji\", [25, 23], {\r\n        level: 4, color: '#bbddaa', shape: [\r\n            -5, [-3, -1], [-4, 1], [-4, 3], [-3, 2], [-5, 1], [-6, 1], [-6, 0], [-2, -1]\r\n        ]\r\n    }),\r\n    new City(\"jianan\", [22, 25], {\r\n        level: 3, color: '#88dddd', shape: [\r\n            -4, [[0, 1]], [[-1, 1]], [[-2, 5]], [-2, 6], [-2, 3], [-2, 2], [-3, 1], [-4, 0], [-5, -4]\r\n        ]\r\n    }),\r\n    new City(\"luling\", [20, 25], {\r\n        level: 2, color: '#aa6622', shape: [\r\n            -1, [[0, 1]], [[-1, 1]], [[-2, 1]], [[-4, 0]], [[-5, -1]]\r\n        ]\r\n    }),\r\n    new City(\"nanhai\", [17, 28], {\r\n        level: 8, color: '#9bc2e6', shape: [\r\n            -2, [[-2, 1], [4, 7]], [-5, 7], [-8, 4], [-8, -4]\r\n        ]\r\n    }),\r\n    new City(\"jiaozhi\", [11, 29], {\r\n        level: 3, color: '#7e719f', shape: [\r\n            -3, [[1, 3]], [[-2, 4]], [[-3, 4]], [[-5, 1]], [[-4, -1]], -4\r\n        ]\r\n    }),\r\n    new City(\"jiuzhen\", [9, 32], {\r\n        level: 4, color: '#945e75', shape: [\r\n            -5, [0, 2], [0, 2], [0, 2], [0, 1], [0, 1], [-1, 1], [-1, 1], [-1, 0]\r\n        ]\r\n    }),\r\n];\r\nconst mounts = [\r\n    new Mount(\"桐柏山\", [12, 16], {\r\n        shape: [\r\n            0, 1, [-1, 0]\r\n        ]\r\n    }),\r\n    new Mount(\"大别山\", [17, 17], {\r\n        shape: [\r\n            0, [[0, 0], [5, 5]], [0, 4]\r\n        ]\r\n    }),\r\n    new Mount(\"武夷山脉\", [19, 24], {\r\n        shape: [\r\n            -1, 0, [-1, 2], [-2, 0], [-2, -1], [-3, -2]\r\n        ]\r\n    }),\r\n    new Mount(\"南岭\", [13, 28], {\r\n        shape: [\r\n            -1, [-1, 2]\r\n        ]\r\n    }),\r\n];\r\nconst factions = [\r\n    new Faction('group_RedC', ['nanhai', 'jiaozhi', 'jiuzhen'], {\r\n        chara: {\r\n            leader: 'AmemachiF',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#843e65'\r\n        }\r\n    }),\r\n    new Faction('group_MiyaFam', ['changsha'], {\r\n        chara: {\r\n            leader: 'Miya',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#f1c44b'\r\n        }\r\n    }),\r\n    new Faction('group_ego', ['wuling'], {\r\n        chara: {\r\n            leader: 'UsakiNono',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#d88db7'\r\n        }\r\n    }),\r\n    new Faction('group_xuyan', ['chaisang'], {\r\n        chara: {\r\n            leader: 'XiaoxiXiaotao',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#d6ce6d'\r\n        }\r\n    }),\r\n    new Faction('group_xuefeng', ['lujiang', 'runan'], {\r\n        chara: {\r\n            leader: 'xiaoxiayu',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#a893c8'\r\n        }\r\n    }),\r\n    new Faction('group_chaos', ['xiangyang', 'jiangling', 'jiangxia', 'xinye'], {\r\n        chara: {\r\n            leader: 'Zaodaoji',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#76d7dc'\r\n        }\r\n    }),\r\n    new Faction('group_NetEase', ['guangling'], {\r\n        chara: {\r\n            leader: 'zhongguobanai',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#ff6868'\r\n        }\r\n    }),\r\n    new Faction('group_chidori', ['kuaiji'], {\r\n        chara: {\r\n            leader: 'airuisi',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#dc569c'\r\n        }\r\n    }),\r\n    new Faction('group_azhun', ['jianye'], {\r\n        chara: {\r\n            leader: 'azhun',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#85add6'\r\n        }\r\n    }),\r\n    new Faction('group_bingtang', ['wu'], {\r\n        chara: {\r\n            leader: 'bingtang',\r\n            members: [''],\r\n        },\r\n        config: {\r\n            color: '#b48469'\r\n        }\r\n    }),\r\n];\r\nconst context = {};\r\nlet data = {};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    citys,\r\n    mounts,\r\n    translation,\r\n    control: {\r\n        setMapControl(parent, methods = {}) {\r\n            if (methods.type === 'zoom') {\r\n                let map_zoom = context.curZoom;\r\n                for (let v of ['0.5', '1.5', '2']) {\r\n                    let div = document.createElement('div');\r\n                    div.innerHTML = `×${v}`;\r\n                    div.listen(() => {\r\n                        map_zoom *= Number.parseFloat(v);\r\n                        context.curZoom = map_zoom;\r\n                        this.reinit();\r\n                    });\r\n                    parent.appendChild(div);\r\n                }\r\n            }\r\n            else {\r\n                let map_status = '省份', map_status_div;\r\n                for (let v of ['省份', '势力', '外交']) {\r\n                    let div = document.createElement('div');\r\n                    if (v === map_status)\r\n                        map_status_div = div;\r\n                    div.innerHTML = `${v}模式`;\r\n                    div.listen(() => {\r\n                        if (map_status === v)\r\n                            return;\r\n                        parent.insertBefore(div, map_status_div);\r\n                        map_status = v;\r\n                        map_status_div = div;\r\n                        this.reinit();\r\n                    });\r\n                    parent.appendChild(div);\r\n                }\r\n                if (!data.map_status) {\r\n                    Object.defineProperty(data, 'map_status', {\r\n                        get() {\r\n                            return map_status;\r\n                        },\r\n                    });\r\n                }\r\n            }\r\n        },\r\n        init(cvs, size, zoom) {\r\n            context.curCvs = cvs;\r\n            context.curSize = size;\r\n            context.curZoom = zoom;\r\n            context.curCtx = cvs.getContext('2d');\r\n            let ctx = context.curCtx;\r\n            ctx.font = \"36px 'hyk2gj',Arial\";\r\n            ctx.strokeStyle = \"rgba(0, 10, 255, 0.5)\";\r\n            ctx.shadowOffsetX = 0;\r\n            ctx.shadowOffsetY = 0;\r\n            ctx.textAlign = 'center';\r\n            this.initMap();\r\n        },\r\n        reinit() {\r\n            this.clear();\r\n            if (context.curCvs && context.curCtx) {\r\n                this.initMap();\r\n            }\r\n        },\r\n        initMap() {\r\n            switch (data.map_status) {\r\n                case undefined:\r\n                case '省份':\r\n                    {\r\n                        for (let m of mounts) {\r\n                            m.drawMap();\r\n                        }\r\n                        for (let c of citys) {\r\n                            c.drawMap();\r\n                        }\r\n                    }\r\n                    break;\r\n                case '势力':\r\n                    {\r\n                        for (let m of mounts) {\r\n                            m.drawMap();\r\n                        }\r\n                        let config = { hiddenName: 0.6 };\r\n                        for (let c of citys) {\r\n                            if (c.faction === false) {\r\n                                c.drawMap(context.curCtx, context.curSize, context.curZoom, config);\r\n                            }\r\n                        }\r\n                        for (let f of factions) {\r\n                            f.drawMap();\r\n                        }\r\n                    }\r\n                    break;\r\n                case '外交':\r\n                    {\r\n                        for (let f of factions) {\r\n                            f.drawMap();\r\n                        }\r\n                    }\r\n                    break;\r\n            }\r\n        },\r\n        close() {\r\n            this.clear();\r\n            data = {};\r\n        },\r\n        clear() {\r\n            if (context.curCvs && context.curCtx) {\r\n                let ctx = context.curCtx;\r\n                let cvs = context.curCvs;\r\n                ctx.clearRect(0, 0, cvs.width, cvs.height);\r\n            }\r\n        }\r\n    }\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/strategy_situate.ts?")},"./src/mode/_entry.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _boss__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./boss */ "./src/mode/boss.js");\n/* harmony import */ var _boss__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_boss__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brawl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./brawl */ "./src/mode/brawl.js");\n/* harmony import */ var _brawl__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_brawl__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _connect__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./connect */ "./src/mode/connect.js");\n/* harmony import */ var _connect__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_connect__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _doudizhu__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./doudizhu */ "./src/mode/doudizhu.js");\n/* harmony import */ var _doudizhu__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_doudizhu__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _guozhan__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./guozhan */ "./src/mode/guozhan.js");\n/* harmony import */ var _guozhan__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_guozhan__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _identity__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./identity */ "./src/mode/identity.js");\n/* harmony import */ var _identity__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_identity__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _longlaoguan__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./longlaoguan */ "./src/mode/longlaoguan.js");\n/* harmony import */ var _longlaoguan__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_longlaoguan__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _single__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./single */ "./src/mode/single.js");\n/* harmony import */ var _single__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_single__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _versus__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./versus */ "./src/mode/versus.js");\n/* harmony import */ var _versus__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_versus__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _yindao__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./yindao */ "./src/mode/yindao.js");\n/* harmony import */ var _yindao__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_yindao__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var _strategy__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./strategy */ "./src/mode/strategy.ts");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/_entry.js?')},"./src/mode/boss.js":function(){eval("\r\ngame.import('mode', function (lib, game, ui, get, ai, _status) {\r\n\treturn {\r\n\t\tname: 'boss',\r\n\t\tstart: function () {\r\n\t\t\t\"step 0\"\r\n\t\t\tvar playback = localStorage.getItem(lib.configprefix + 'playback');\r\n\t\t\tif (playback) {\r\n\t\t\t\tui.create.me();\r\n\t\t\t\tui.arena.style.display = 'none';\r\n\t\t\t\tui.system.style.display = 'none';\r\n\t\t\t\t_status.playback = playback;\r\n\t\t\t\tlocalStorage.removeItem(lib.configprefix + 'playback');\r\n\t\t\t\tvar store = lib.db.transaction(['video'], 'readwrite').objectStore('video');\r\n\t\t\t\tstore.get(parseInt(playback)).onsuccess = function (e) {\r\n\t\t\t\t\tif (e.target.result) {\r\n\t\t\t\t\t\tgame.playVideoContent(e.target.result.video);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\talert('播放失败：找不到录像');\r\n\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tevent.finish();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i in lib.characterPack.mode_boss) {\r\n\t\t\t\tlib.character[i] = lib.characterPack.mode_boss[i];\r\n\t\t\t\tif (!lib.character[i][4]) {\r\n\t\t\t\t\tlib.character[i][4] = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// for(var i in lib.cardPack.mode_boss){\r\n\t\t\t//\t\tlib.card[i]=lib.cardPack.mode_boss[i];\r\n\t\t\t// }\r\n\t\t\tfor (var i in lib.skill) {\r\n\t\t\t\tif (lib.skill[i].changeSeat) {\r\n\t\t\t\t\tlib.skill[i] = {};\r\n\t\t\t\t\tif (lib.translate[i + '_info']) {\r\n\t\t\t\t\t\tlib.translate[i + '_info'] = '此模式下不可用';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlib.translate.restart = '返回';\r\n\t\t\tlib.init.css(lib.assetURL + 'layout/mode', 'boss');\r\n\t\t\tgame.delay(0.1);\r\n\t\t\t\"step 1\"\r\n\t\t\tvar bosslist = ui.create.div('#bosslist.hidden');\r\n\t\t\tevent.bosslist = bosslist;\r\n\t\t\tlib.setScroll(bosslist);\r\n\t\t\t// bosslist.ontouchmove = ui.click.touchScroll;\r\n\t\t\t// bosslist.style.WebkitOverflowScrolling='touch';\r\n\t\t\tif (!lib.config.touchscreen && lib.config.mousewheel) {\r\n\t\t\t\tbosslist._scrollspeed = 30;\r\n\t\t\t\tbosslist._scrollnum = 10;\r\n\t\t\t\tbosslist.onmousewheel = ui.click.mousewheel;\r\n\t\t\t}\r\n\t\t\t// var bosslistlinks={};\r\n\t\t\t// var toggleBoss=function(bool){\r\n\t\t\t//\t\tgame.saveConfig(this._link.config._name,bool,true);\r\n\t\t\t//\t\tvar node=bosslistlinks[this._link.config._name];\r\n\t\t\t//\t\tif(bool){\r\n\t\t\t//\t\t\tnode.style.display='';\r\n\t\t\t//\t\t}\r\n\t\t\t//\t\telse{\r\n\t\t\t//\t\t\tnode.style.display='none';\r\n\t\t\t//\t\t}\r\n\t\t\t// };\r\n\t\t\tvar onpause = function () {\r\n\t\t\t\tui.window.classList.add('bosspaused');\r\n\t\t\t}\r\n\t\t\tvar onresume = function () {\r\n\t\t\t\tui.window.classList.remove('bosspaused');\r\n\t\t\t}\r\n\t\t\tgame.onpause = onpause;\r\n\t\t\tgame.onpause2 = onpause;\r\n\t\t\tgame.onresume = onresume;\r\n\t\t\tgame.onresume2 = onresume;\r\n\t\t\tui.create.div(bosslist);\r\n\r\n\t\t\tevent.current = null;\r\n\t\t\tvar list = [];\r\n\t\t\tfor (var i in lib.character) {\r\n\t\t\t\tvar info = lib.character[i];\r\n\t\t\t\tif (info[4].contains('boss')) {\r\n\t\t\t\t\t// var cfg=i+'_bossconfig';\r\n\t\t\t\t\t// if(get.config(cfg)==undefined){\r\n\t\t\t\t\t//\t\tgame.saveConfig(cfg,true,true);\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t// lib.translate[cfg+'_config']=lib.translate[i];\r\n\t\t\t\t\t// lib.mode.boss.config[cfg]={\r\n\t\t\t\t\t//\t\tname:get.translation(i),\r\n\t\t\t\t\t//\t\tonclick:toggleBoss,\r\n\t\t\t\t\t//\t\tinit:true,\r\n\t\t\t\t\t// }\r\n\t\t\t\t\tvar player = ui.create.player(bosslist).init(i);\r\n\t\t\t\t\tif (lib.characterPack.mode_boss[i] && get.config(i + '_boss_config') == false) {\r\n\t\t\t\t\t\tplayer.style.display = 'none';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (player.hp == 0) {\r\n\t\t\t\t\t\tplayer.node.hp.style.display = 'none';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.push(player);\r\n\t\t\t\t\tplayer.node.hp.classList.add('text');\r\n\t\t\t\t\tplayer.node.hp.dataset.condition = '';\r\n\t\t\t\t\tplayer.node.hp.innerHTML = info[2];\r\n\t\t\t\t\tif (info[2] == Infinity) {\r\n\t\t\t\t\t\tplayer.node.hp.innerHTML = '∞';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.setIdentity(player.name);\r\n\t\t\t\t\tplayer.node.identity.dataset.color = info[5];\r\n\t\t\t\t\t// bosslistlinks[cfg]=player;\r\n\t\t\t\t\tplayer.classList.add('bossplayer');\r\n\r\n\t\t\t\t\tif (lib.storage.current == i) {\r\n\t\t\t\t\t\tevent.current = player;\r\n\t\t\t\t\t\tplayer.classList.add('highlight');\r\n\t\t\t\t\t\tif (!lib.config.continue_name_boss && lib.boss[i] && lib.boss[i].control) {\r\n\t\t\t\t\t\t\t_status.bosschoice = lib.boss[i].control();\r\n\t\t\t\t\t\t\t_status.bosschoice.name = i;\r\n\t\t\t\t\t\t\t_status.bosschoice.link = lib.boss[i].controlid || i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// if(!get.config(cfg)){\r\n\t\t\t\t\t//\t\tplayer.style.display='none';\r\n\t\t\t\t\t// }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!list.length) {\r\n\t\t\t\talert('没有可挑战的BOSS');\r\n\t\t\t\tevent.finish();\r\n\t\t\t\tlib.init.onfree();\r\n\t\t\t\t_status.over = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!event.current) {\r\n\t\t\t\tevent.current = bosslist.childNodes[1];\r\n\t\t\t\tevent.current.classList.add('highlight');\r\n\t\t\t}\r\n\t\t\tui.create.div(bosslist);\r\n\t\t\tui.create.cardsAsync();\r\n\t\t\tgame.finishCards();\r\n\t\t\tgame.addGlobalSkill('autoswap');\r\n\t\t\tui.arena.setNumber(8);\r\n\t\t\tui.control.style.transitionProperty = 'opacity';\r\n\t\t\tui.control.classList.add('bosslist');\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tui.control.style.transitionProperty = '';\r\n\t\t\t}, 1000);\r\n\r\n\t\t\tui.window.appendChild(bosslist);\r\n\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tif (event.current) {\r\n\t\t\t\t\tvar left = event.current.offsetLeft - (ui.window.offsetWidth - 180) / 2;\r\n\t\t\t\t\tif (bosslist.scrollLeft < left) {\r\n\t\t\t\t\t\tbosslist.scrollLeft = left;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbosslist.show();\r\n\t\t\t}, 200);\r\n\t\t\tgame.me = ui.create.player();\r\n\t\t\tif (lib.config.continue_name_boss) {\r\n\t\t\t\tevent.noslide = true;\r\n\t\t\t\tlib.init.onfree();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tgame.chooseCharacter(function (target) {\r\n\t\t\t\t\tif (event.current) {\r\n\t\t\t\t\t\tevent.current.classList.remove('highlight');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.current = target;\r\n\t\t\t\t\tgame.save('current', target.name);\r\n\t\t\t\t\ttarget.classList.add('highlight');\r\n\t\t\t\t\tif (_status.bosschoice) {\r\n\t\t\t\t\t\tvar name = target.name;\r\n\t\t\t\t\t\tif (lib.boss[target.name] && lib.boss[target.name].controlid) {\r\n\t\t\t\t\t\t\tname = lib.boss[target.name].controlid;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (_status.bosschoice.link != name) {\r\n\t\t\t\t\t\t\tlib.boss[_status.bosschoice.name].control('cancel', _status.bosschoice);\r\n\t\t\t\t\t\t\t_status.bosschoice.classList.remove('disabled');\r\n\t\t\t\t\t\t\t_status.bosschoice.close();\r\n\t\t\t\t\t\t\tdelete _status.bosschoice;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (lib.boss[target.name] && lib.boss[target.name].control) {\r\n\t\t\t\t\t\t_status.createControl = ui.control.firstChild;\r\n\t\t\t\t\t\t_status.bosschoice = lib.boss[target.name].control();\r\n\t\t\t\t\t\t_status.bosschoice.name = target.name;\r\n\t\t\t\t\t\t_status.bosschoice.link = lib.boss[target.name].controlid || target.name;\r\n\t\t\t\t\t\tif (ui.cheat2 && ui.cheat2.dialog == _status.event.dialog) {\r\n\t\t\t\t\t\t\t_status.bosschoice.classList.add('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (lib.config.test_game) {\r\n\t\t\t\tevent.current.classList.remove('highlight');\r\n\t\t\t\tif (event.current.nextSibling && event.current.nextSibling.classList.contains('player')) {\r\n\t\t\t\t\tevent.current = event.current.nextSibling;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tevent.current = event.current.parentNode.childNodes[1];\r\n\t\t\t\t}\r\n\t\t\t\tgame.save('current', event.current.name);\r\n\t\t\t}\r\n\t\t\t\"step 2\"\r\n\t\t\tgame.bossinfo = lib.boss.global;\r\n\t\t\tfor (var i in lib.boss[event.current.name]) {\r\n\t\t\t\tgame.bossinfo[i] = lib.boss[event.current.name][i];\r\n\t\t\t}\r\n\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tui.control.classList.remove('bosslist');\r\n\t\t\t}, 500);\r\n\t\t\tvar boss = ui.create.player();\r\n\t\t\tboss.getId();\r\n\t\t\tgame.boss = boss;\r\n\t\t\tboss.init(event.current.name);\r\n\t\t\tboss.side = true;\r\n\t\t\tif (!event.noslide) {\r\n\t\t\t\tvar rect = event.current.getBoundingClientRect();\r\n\t\t\t\tboss.animate('bossing');\r\n\t\t\t\tboss.node.hp.animate('start');\r\n\t\t\t\tboss.bossinginfo = [rect.left + rect.width / 2, rect.top + rect.height / 2];\r\n\t\t\t\tboss.style.transition = 'all 0s';\r\n\t\t\t\tboss.node.equips.style.opacity = '0';\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tboss.animate('start');\r\n\t\t\t}\r\n\t\t\tboss.setIdentity('zhu');\r\n\t\t\tboss.identity = 'zhu';\r\n\t\t\tif (lib.config.continue_name_boss) {\r\n\t\t\t\tresult = lib.config.continue_name_boss;\r\n\t\t\t\tgame.saveConfig('continue_name_boss');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < result.links.length; i++) {\r\n\t\t\t\tvar player = ui.create.player();\r\n\t\t\t\tplayer.getId();\r\n\t\t\t\tplayer.init(result.links[i]).animate('start');\r\n\t\t\t\tplayer.setIdentity('cai');\r\n\t\t\t\tplayer.identity = 'cai';\r\n\t\t\t\tplayer.side = false;\r\n\t\t\t\tgame.players.push(player);\r\n\t\t\t\tif (result.boss) {\r\n\t\t\t\t\tif (game.bossinfo.minion) {\r\n\t\t\t\t\t\tplayer.dataset.position = i + 3;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.dataset.position = (i + 1) * 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tplayer.dataset.position = i + 1;\r\n\t\t\t\t}\r\n\t\t\t\tui.arena.appendChild(player);//[todo player]\r\n\t\t\t}\r\n\t\t\tif (result.boss) {\r\n\t\t\t\tgame.players.unshift(boss);\r\n\t\t\t\tboss.dataset.position = 0;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tgame.players.push(boss);\r\n\t\t\t\tboss.dataset.position = 7;\r\n\t\t\t}\r\n\t\t\tif (game.bossinfo.minion) {\r\n\t\t\t\tif (!result.boss) {\r\n\t\t\t\t\tboss.dataset.position = 6;\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i in game.bossinfo.minion) {\r\n\t\t\t\t\tvar player = ui.create.player();\r\n\t\t\t\t\tplayer.getId();\r\n\t\t\t\t\tplayer.init(game.bossinfo.minion[i]);\r\n\t\t\t\t\tif (boss.bossinginfo) {\r\n\t\t\t\t\t\tplayer.animate('bossing');\r\n\t\t\t\t\t\tplayer.node.hp.animate('start');\r\n\t\t\t\t\t\tplayer.style.transition = 'all 0s';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.animate('start');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.setIdentity('zhong');\r\n\t\t\t\t\tplayer.identity = 'zhong';\r\n\t\t\t\t\tplayer.side = true;\r\n\t\t\t\t\tgame.players.push(player);\r\n\t\t\t\t\tvar num = parseInt(i);\r\n\t\t\t\t\tif (result.boss) {\r\n\t\t\t\t\t\tplayer.dataset.position = num - 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (num == 2) {\r\n\t\t\t\t\t\t\tplayer.dataset.position = 7;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tplayer.dataset.position = num - 3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.arena.appendChild(player);//[todo player]\r\n\t\t\t\t\tif (boss.bossinginfo) {\r\n\t\t\t\t\t\tvar rect = player.getBoundingClientRect();\r\n\t\t\t\t\t\tplayer.style.transform = 'translate(' + (boss.bossinginfo[0] - rect.left - rect.width / 2) + 'px,' + (boss.bossinginfo[1] - rect.top - rect.height / 2) + 'px) scale(1.1)';\r\n\t\t\t\t\t\tui.refresh(player);\r\n\t\t\t\t\t\tplayer.style.transition = '';\r\n\t\t\t\t\t\tplayer.style.transform = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tui.create.me();\r\n\t\t\tui.fakeme = ui.create.div('.fakeme.avatar', ui.me);\r\n\t\t\tif (game.me !== boss) {\r\n\t\t\t\tgame.singleHandcard = true;\r\n\t\t\t\tui.arena.classList.add('single-handcard');\r\n\t\t\t\tui.window.classList.add('single-handcard');\r\n\t\t\t\tgame.onSwapControl();\r\n\r\n\t\t\t\tif (lib.config.show_handcardbutton) {\r\n\t\t\t\t\tlib.setPopped(ui.create.system('手牌', null, true), function () {\r\n\t\t\t\t\t\tvar uiintro = ui.create.dialog('hidden');\r\n\r\n\t\t\t\t\t\tvar players = game.players.concat(game.dead);\r\n\t\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\t\tif (players[i].side == game.me.side && players[i] != game.me) {\r\n\t\t\t\t\t\t\t\tuiintro.add(get.translation(players[i]));\r\n\t\t\t\t\t\t\t\tvar cards = players[i].getCards('h');\r\n\t\t\t\t\t\t\t\tif (cards.length) {\r\n\t\t\t\t\t\t\t\t\tuiintro.addSmall(cards, true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tuiintro.add('（无）');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn uiintro;\r\n\t\t\t\t\t}, 220);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tui.fakeme.style.display = 'none';\r\n\t\t\t}\r\n\t\t\tif (game.bossinfo.chongzheng) {\r\n\t\t\t\tlib.setPopped(ui.create.system('重整', null, true), function () {\r\n\t\t\t\t\tvar uiintro = ui.create.dialog('hidden');\r\n\r\n\t\t\t\t\tuiintro.add('重整');\r\n\t\t\t\t\tvar table = ui.create.div('.bosschongzheng');\r\n\r\n\t\t\t\t\tvar tr, td, added = false;\r\n\t\t\t\t\tfor (var i = 0; i < game.dead.length; i++) {\r\n\t\t\t\t\t\tif (typeof game.dead[i].storage.boss_chongzheng !== 'number') continue;\r\n\t\t\t\t\t\tadded = true;\r\n\t\t\t\t\t\ttr = ui.create.div(table);\r\n\t\t\t\t\t\ttd = ui.create.div(tr);\r\n\t\t\t\t\t\ttd.innerHTML = get.translation(game.dead[i]);\r\n\t\t\t\t\t\ttd = ui.create.div(tr);\r\n\t\t\t\t\t\tif (game.dead[i].maxHp > 0) {\r\n\t\t\t\t\t\t\ttd.innerHTML = '剩余' + (game.bossinfo.chongzheng - game.dead[i].storage.boss_chongzheng) + '回合';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttd.innerHTML = '无法重整'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!added) {\r\n\t\t\t\t\t\tuiintro.add('<div class=\"text center\">（无重整角色）</div>');\r\n\t\t\t\t\t\tuiintro.add(ui.create.div('.placeholder.slim'))\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tuiintro.add(table);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn uiintro;\r\n\t\t\t\t}, 180);\r\n\t\t\t}\r\n\t\t\tui.single_swap = ui.create.system('换人', function () {\r\n\t\t\t\tvar players = get.players(game.me);\r\n\t\t\t\tplayers.remove(game.boss);\r\n\t\t\t\tif (players.length > 1) {\r\n\t\t\t\t\tif (ui.auto.classList.contains('hidden')) {\r\n\t\t\t\t\t\tgame.me.popup('请稍后换人');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (_status.event.isMine()) {\r\n\t\t\t\t\t\tui.click.auto();\r\n\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\tui.click.auto();\r\n\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.modeSwapPlayer(players[1]);\r\n\t\t\t\t}\r\n\t\t\t}, true);\r\n\t\t\tif (get.config('single_control') || game.me == game.boss) {\r\n\t\t\t\tui.single_swap.style.display = 'none';\r\n\t\t\t}\r\n\r\n\t\t\tui.arena.appendChild(boss);//[todo player]\r\n\t\t\tif (boss.bossinginfo) {\r\n\t\t\t\tvar rect = boss.getBoundingClientRect();\r\n\t\t\t\tboss.style.transform = 'translate(' + (boss.bossinginfo[0] - rect.left - rect.width / 2) + 'px,' + (boss.bossinginfo[1] - rect.top - rect.height / 2) + 'px) scale(1.1)';\r\n\t\t\t\tui.refresh(boss);\r\n\t\t\t\tboss.style.transition = '';\r\n\t\t\t\tboss.style.transform = '';\r\n\t\t\t\tdelete boss.bossinginfo;\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tboss.node.equips.style.opacity = '';\r\n\t\t\t\t}, 500);\r\n\t\t\t}\r\n\r\n\t\t\tevent.bosslist.delete();\r\n\r\n\t\t\tgame.arrangePlayers();\r\n\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\tgame.players[i].node.action.innerHTML = '行动';\r\n\t\t\t}\r\n\r\n\t\t\tvar players = get.players(lib.sort.position);\r\n\t\t\tvar info = [];\r\n\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\tinfo.push({\r\n\t\t\t\t\tname: players[i].name1,\r\n\t\t\t\t\tidentity: players[i].identity,\r\n\t\t\t\t\tposition: players[i].dataset.position\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t_status.videoInited = true,\r\n\t\t\t\tinfo.boss = (game.me == game.boss);\r\n\t\t\tgame.addVideo('init', null, info);\r\n\t\t\tif (game.bossinfo.init) {\r\n\t\t\t\tgame.bossinfo.init();\r\n\t\t\t}\r\n\t\t\tdelete lib.boss;\r\n\t\t\t\"step 3\"\r\n\t\t\tif (get.config('single_control')) {\r\n\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\tif (game.players[i].side == game.me.side) {\r\n\t\t\t\t\t\tgame.addRecentCharacter(game.players[i].name);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tgame.addRecentCharacter(game.me.name);\r\n\t\t\t}\r\n\t\t\tevent.trigger('gameStart');\r\n\t\t\tgame.gameDraw(game.boss, game.bossinfo.gameDraw || 4);\r\n\t\t\tgame.bossPhaseLoop();\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tui.updatehl();\r\n\t\t\t}, 200);\r\n\t\t},\r\n\t\telement: {\r\n\t\t\tplayer: {\r\n\t\t\t\tdieAfter: function () {\r\n\t\t\t\t\tif (this != game.boss) {\r\n\t\t\t\t\t\tthis.$.boss_chongzheng = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (game.bossinfo.checkResult && game.bossinfo.checkResult(this) === false) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this == game.boss || !game.hasPlayer(function (current) {\r\n\t\t\t\t\t\treturn !current.side;\r\n\t\t\t\t\t})) {\r\n\t\t\t\t\t\tgame.checkResult();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t},\r\n\t\tcard: {\r\n\t\t\tniaobaidaowenha: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tsubtype: 'equip5',\r\n\t\t\t\tskills: ['niaobaidaowenha_skill'],\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 7.5,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\tgoujiangdesidai: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tsubtype: 'equip1',\r\n\t\t\t\tdistance: { attackFrom: -6 },\r\n\t\t\t\tskills: ['goujiangdesidai_skill'],\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 7.5,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\tshenzhixiunvfu: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tsubtype: 'equip2',\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\tgubuzifeng: {\r\n\t\t\t\ttype: 'trick',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tenable: true,\r\n\t\t\t\tfilterTarget: function (card, player, target) {\r\n\t\t\t\t\treturn target != player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttarget.addTempSkill('gubuzifeng_disable', { player: 'phaseAfter' });\r\n\t\t\t\t\tvar skills = target.getSkills(null, false);\r\n\t\t\t\t\tfor (var i = 0; i < skills.length; i++) {\r\n\t\t\t\t\t\tif (get.info(skills[i]).charlotte) skills.splice(i--, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (skills.length) {\r\n\t\t\t\t\t\ttarget.$.gubuzifeng_disable.push(skills.randomGet());\r\n\t\t\t\t\t\ttarget.disableSkill('gubuzifeng_disable', target.$.gubuzifeng_disable);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\torder: 12,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttarget: function (player, target) {\r\n\t\t\t\t\t\t\treturn -2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlingsheji: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tsubtype: 'equip5',\r\n\t\t\t\tskills: ['lingsheji'],\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 7.5,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\tshanrangzhaoshu: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tsubtype: 'equip5',\r\n\t\t\t\tskills: ['shanrangzhaoshu'],\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 7.5,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\txingtianpojunfu: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tsubtype: 'equip1',\r\n\t\t\t\tdistance: { attackFrom: -3 },\r\n\t\t\t\tskills: ['noda_axe'],\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 7.5,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\tjinwuluorigong: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tsubtype: 'equip1',\r\n\t\t\t\tskills: ['iwasawa_crowbow'],\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tdistance: { attackFrom: -8 },\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 7.5,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\t\"boss_mengpohuihun\": {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\ttype: \"trick\",\r\n\t\t\t\tmodeimage: \"boss\",\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tselectTarget: -1,\r\n\t\t\t\tenable: true,\r\n\t\t\t\ttoself: true,\r\n\t\t\t\tmultitarget: true,\r\n\t\t\t\tglobal: ['boss_mengpohuihun1'],\r\n\t\t\t\tmodTarget: true,\r\n\t\t\t\tfilterTarget: function (card, player, target) {\r\n\t\t\t\t\treturn player == target;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tgame.countPlayer2(function (current) {\r\n\t\t\t\t\t\tcurrent.enableSkill('boss_wanghun');\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\torder: function () {\r\n\t\t\t\t\t\t\treturn 11;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tuseful: [3, 1],\r\n\t\t\t\t\t\tvalue: 10\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\tplayer: function (player, target) {\r\n\t\t\t\t\t\t\tif (player == game.boss) {\r\n\t\t\t\t\t\t\t\treturn -2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\treturn 5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"wushuangfangtianji\": {\r\n\t\t\t\ttype: \"equip\",\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tsubtype: \"equip1\",\r\n\t\t\t\tdistance: {\r\n\t\t\t\t\tattackFrom: -3,\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 2.5,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tskills: [\"wushuangfangtianji_skill\"],\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\t\"shufazijinguan\": {\r\n\t\t\t\ttype: \"equip\",\r\n\t\t\t\tsubtype: \"equip5\",\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 9,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tskills: [\"shufazijinguan_skill\"],\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\t\"hongmianbaihuapao\": {\r\n\t\t\t\ttype: \"equip\",\r\n\t\t\t\tsubtype: \"equip2\",\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 7,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tskills: [\"hongmianbaihuapao_skill\"],\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\t\"linglongshimandai\": {\r\n\t\t\t\ttype: \"equip\",\r\n\t\t\t\tsubtype: \"equip2\",\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\tequipValue: 7.5,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tskills: [\"linglongshimandai_skill\"],\r\n\t\t\t\tfullskin: true,\r\n\t\t\t},\r\n\t\t\tsadouchengbing: {\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\ttype: 'trick',\r\n\t\t\t\tenable: true,\r\n\t\t\t\tselectTarget: -1,\r\n\t\t\t\tcardcolor: 'red',\r\n\t\t\t\ttoself: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tfilterTarget: function (card, player, target) {\r\n\t\t\t\t\treturn target == player;\r\n\t\t\t\t},\r\n\t\t\t\tmodTarget: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar num = Math.min(5, target.maxHp);\r\n\t\t\t\t\tif (target.group == 'shen') {\r\n\t\t\t\t\t\ttarget.draw(num);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar nh = target.countCards('h');\r\n\t\t\t\t\t\tif (nh < num) {\r\n\t\t\t\t\t\t\ttarget.draw(num - nh);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tbasic: {\r\n\t\t\t\t\t\torder: 7.2,\r\n\t\t\t\t\t\tuseful: 4.5,\r\n\t\t\t\t\t\tvalue: 9.2\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttarget: function (player, target) {\r\n\t\t\t\t\t\t\tvar num = Math.min(5, target.maxHp);\r\n\t\t\t\t\t\t\tif (target.group == 'shen') {\r\n\t\t\t\t\t\t\t\treturn Math.sqrt(num);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tvar nh = target.countCards('h');\r\n\t\t\t\t\t\t\t\tif (target == player && player.countCards('h', 'sadouchengbing')) {\r\n\t\t\t\t\t\t\t\t\tnh--;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (nh < num) {\r\n\t\t\t\t\t\t\t\t\treturn Math.sqrt(num - nh);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttag: {\r\n\t\t\t\t\t\tdraw: 2\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyihuajiemu: {\r\n\t\t\t\ttype: 'trick',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tenable: true,\r\n\t\t\t\tfilterTarget: function (card, player, target) {\r\n\t\t\t\t\treturn target != player && target.countCards('he');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif (target.hasSha()) {\r\n\t\t\t\t\t\ttarget.chooseToUse(function (card, player, event) {\r\n\t\t\t\t\t\t\treturn get.name(card) == 'sha' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t}, '使用一张杀，或交给' + get.translation(player) + '两张牌');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.directfalse = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar nh = target.countCards('he');\r\n\t\t\t\t\tif ((event.directfalse || !result.bool) && nh) {\r\n\t\t\t\t\t\tif (nh <= 2) {\r\n\t\t\t\t\t\t\tevent.directcards = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttarget.chooseCard('he', 2, true, '将两张牌交给' + get.translation(player));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (event.directcards) {\r\n\t\t\t\t\t\ttarget.give(target.getCards('he'), player);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (result.bool && result.cards && result.cards.length) {\r\n\t\t\t\t\t\ttarget.give(result.cards, player);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\torder: 7,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttarget: function (player, target) {\r\n\t\t\t\t\t\t\tif (target.hasSha() && _status.event.getRand() < 0.5) return 1;\r\n\t\t\t\t\t\t\treturn -2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tguilongzhanyuedao: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tsubtype: 'equip1',\r\n\t\t\t\tdistance: { attackFrom: -2 },\r\n\t\t\t\tskills: ['guilongzhanyuedao'],\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 9\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tguofengyupao: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tsubtype: 'equip2',\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tskills: ['guofengyupao'],\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 9\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tqimenbagua: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tsubtype: 'equip2',\r\n\t\t\t\tskills: ['qimenbagua'],\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 9\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchixueqingfeng: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tsubtype: 'equip1',\r\n\t\t\t\tdistance: { attackFrom: -1 },\r\n\t\t\t\tskills: ['chixueqingfeng'],\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 9\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchiyanzhenhunqin: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tsubtype: 'equip1',\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tdistance: { attackFrom: -3 },\r\n\t\t\t\tskills: ['chiyanzhenhunqin'],\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 5\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjuechenjinge: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tsubtype: 'equip3',\r\n\t\t\t\tskills: ['juechenjinge'],\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 9\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txiuluolianyuji: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tsubtype: 'equip1',\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tdistance: { attackFrom: -3 },\r\n\t\t\t\tskills: ['xiuluolianyuji'],\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 9\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txuwangzhimian: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tsubtype: 'equip5',\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tskills: ['xuwangzhimian'],\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 9\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlongfenghemingjian: {\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tsubtype: 'equip1',\r\n\t\t\t\tdistance: { attackFrom: -2 },\r\n\t\t\t\tskills: ['longfenghemingjian'],\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 9\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tqicaishenlu: {\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\ttype: 'equip',\r\n\t\t\t\tsubtype: 'equip4',\r\n\t\t\t\tdistance: { globalFrom: -1 },\r\n\t\t\t\tskills: ['qicaishenlu'],\r\n\t\t\t\tnomod: true,\r\n\t\t\t\tnopower: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tai: {\r\n\t\t\t\t\tequipValue: 9\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thonghuangzhili: {\r\n\t\t\t\ttype: 'trick',\r\n\t\t\t\tenable: true,\r\n\t\t\t\tfullskin: true,\r\n\t\t\t\tfilterTarget: true,\r\n\t\t\t\tmodeimage: 'boss',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (target.group == 'shen') {\r\n\t\t\t\t\t\ttarget.addSkill('honghuangzhili');\r\n\t\t\t\t\t\tif (target.countCards('he')) {\r\n\t\t\t\t\t\t\tplayer.gainPlayerCard(target, 'he', true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttarget.turnOver();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\torder: 4,\r\n\t\t\t\t\tvalue: 10,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttarget: function (player, target) {\r\n\t\t\t\t\t\t\tif (target.group == 'shen') {\r\n\t\t\t\t\t\t\t\tif (target.countCards('he')) return -2;\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (target.isTurnedOver()) return 4;\r\n\t\t\t\t\t\t\t\treturn -3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcharacterPack: {\r\n\t\t\tmode_boss: {\r\n\t\t\t\tboss_hundun: ['male', 'qun', 25, ['boss_xiongshou', 'boss_wuzang', 'boss_xiangde', 'boss_yinzei', 'boss_yinzei_switch'], ['qun', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_qiongqi: ['male', 'qun', '20/25', ['boss_xiongshou', 'boss_zhue', 'boss_futai', 'boss_yandu', 'boss_yandu_switch'], ['qun', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_taotie: ['male', 'qun', 20, ['boss_xiongshou', 'boss_tanyu', 'boss_cangmu', 'boss_jicai', 'boss_jicai_switch'], ['qun', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_taowu: ['male', 'qun', 25, ['boss_xiongshou', 'boss_minwan', 'boss_nitai', 'boss_luanchang', 'boss_luanchang_switch'], ['qun', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_zhuyin: ['male', 'qun', 4, ['boss_xiongshou'], ['qun', 'hiddenboss', 'bossallowed'], 'qun'],\r\n\r\n\t\t\t\tboss_xiangliu: ['male', 'qun', 25, ['boss_yaoshou', 'boss_duqu', 'boss_jiushou', 'boss_echou', 'boss_echou_switch'], ['qun', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_zhuyan: ['male', 'qun', '25/30', ['boss_yaoshou', 'boss_bingxian', 'boss_juyuan', 'boss_xushi', 'boss_xushi_switch'], ['qun', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_bifang: ['male', 'qun', 25, ['boss_yaoshou', 'boss_zhaohuo', 'boss_honglianx', 'boss_yanyu', 'boss_yanyu_switch'], ['qun', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_yingzhao: ['male', 'qun', 25, ['boss_yaoshou', 'boss_fengdong', 'boss_xunyou', 'boss_sipu', 'boss_sipu_switch'], ['qun', 'boss', 'bossallowed'], 'qun'],\r\n\r\n\t\t\t\tboss_qingmushilian: ['male', '', 0, ['boss_qingmu', 'boss_qingmu_intro1', 'boss_qingmu_intro2', 'boss_qingmu_intro3'], ['boss'], 'wu'],\r\n\t\t\t\tboss_qinglong: ['male', 'qun', 4, ['boss_shenyi', 'releiji', 'boss_qingmu2'], ['wu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_mushengoumang: ['male', 'shen', 5, ['boss_shenyi', 'boss_buchun', 'boss_qingmu3'], ['wu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_shujing: ['female', 'shen', 2, ['boss_cuidu'], ['wu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_taihao: ['male', 'shen', 6, ['boss_shenyi', 'boss_shenen', 'boss_qingyi'], ['wu', 'hiddenboss', 'bossallowed']],\r\n\r\n\t\t\t\tboss_chiyanshilian: ['male', '', 0, ['boss_chiyan', 'boss_chiyan_intro1', 'boss_chiyan_intro2', 'boss_chiyan_intro3'], ['boss'], 'zhu'],\r\n\t\t\t\tboss_zhuque: ['female', 'shen', 4, ['boss_shenyi', 'boss_fentian', 'boss_chiyan2'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_huoshenzhurong: ['male', 'shen', 5, ['boss_shenyi', 'boss_xingxia', 'boss_chiyan3'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_yanling: ['male', 'shen', 4, ['boss_huihuo', 'boss_furan'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_yandi: ['male', 'shen', 6, ['boss_shenyi', 'boss_shenen', 'boss_chiyi'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\r\n\t\t\t\tboss_baimangshilian: ['male', '', 0, ['boss_baimang', 'boss_baimang_intro1', 'boss_baimang_intro2', 'boss_baimang_intro3'], ['boss'], 'qun'],\r\n\t\t\t\tboss_baihu: ['male', 'shen', 4, ['boss_shenyi', 'boss_kuangxiao', 'boss_baimang2'], ['qun', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_jinshenrushou: ['male', 'shen', 5, ['boss_shenyi', 'boss_xingqiu', 'boss_baimang3'], ['qun', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_mingxingzhu: ['female', 'shen', 3, ['boss_qingzhu', 'boss_jiazu', 'boss_jiding'], ['qun', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_shaohao: ['male', 'shen', 6, ['boss_shenyi', 'boss_shenen', 'boss_baiyi'], ['qun', 'hiddenboss', 'bossallowed']],\r\n\r\n\t\t\t\tboss_xuanlinshilian: ['male', '', 0, ['boss_xuanlin', 'boss_xuanlin_intro1', 'boss_xuanlin_intro2', 'boss_xuanlin_intro3'], ['boss'], 'wei'],\r\n\t\t\t\tboss_xuanwu: ['male', 'shen', 4, ['boss_shenyi', 'boss_lingqu', 'boss_xuanlin2'], ['wei', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_shuishengonggong: ['male', 'shen', 5, ['boss_shenyi', 'boss_juehong', 'boss_xuanlin3'], ['wei', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_shuishenxuanming: ['female', 'shen', 5, ['boss_shenyi', 'boss_zirun', 'boss_xuanlin3'], ['wei', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_zhuanxu: ['male', 'shen', 6, ['boss_shenyi', 'boss_shenen', 'boss_zaoyi'], ['wei', 'hiddenboss', 'bossallowed']],\r\n\r\n\t\t\t\tboss_zhuoguiquxie: ['male', '', 0, ['boss_bianshen', 'boss_bianshen_intro1', 'boss_bianshen_intro2', 'boss_bianshen_intro3', 'boss_bianshen_intro4'], ['boss'], 'shu'],\r\n\t\t\t\tboss_nianshou_heti: ['male', 'shen', 12, ['boss_nianrui', 'boss_mengtai', 'boss_nbianshen', 'boss_nbianshenx'], ['shu', 'boss', 'bossallowed'], 'shu'],\r\n\t\t\t\tboss_nianshou_jingjue: ['male', 'shen', 12, ['boss_nianrui', 'boss_mengtai', 'boss_jingjue', 'boss_nbianshen'], ['shu', 'hiddenboss', 'bossallowed'], 'shu'],\r\n\t\t\t\tboss_nianshou_renxing: ['male', 'shen', 12, ['boss_nianrui', 'boss_mengtai', 'boss_renxing', 'boss_nbianshen'], ['shu', 'hiddenboss', 'bossallowed'], 'shu'],\r\n\t\t\t\tboss_nianshou_ruizhi: ['male', 'shen', 12, ['boss_nianrui', 'boss_mengtai', 'boss_ruizhi', 'boss_nbianshen'], ['shu', 'hiddenboss', 'bossallowed'], 'shu'],\r\n\t\t\t\tboss_nianshou_baonu: ['male', 'shen', 12, ['boss_nianrui', 'boss_mengtai', 'boss_nbaonu', 'boss_shouyi', 'boss_nbianshen'], ['shu', 'hiddenboss', 'bossallowed'], 'shu'],\r\n\r\n\t\t\t\tboss_baiwuchang: ['male', 'shen', 9, ['boss_baolian', 'boss_qiangzheng', 'boss_zuijiu', 'juece', 'boss_bianshen4'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_heiwuchang: ['male', 'shen', 9, ['boss_guiji', 'boss_taiping', 'boss_suoming', 'boss_xixing', 'boss_bianshen4'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_luocha: ['male', 'shen', 12, ['boss_modao', 'boss_yushou', 'yizhong', 'boss_moyany'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_yecha: ['male', 'shen', 11, ['boss_modao', 'boss_mojian', 'bazhen', 'boss_danshu'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_niutou: ['male', 'shen', 7, ['boss_baolian', 'niepan', 'boss_manjia', 'boss_xiaoshou', 'boss_bianshen3'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_mamian: ['male', 'shen', 6, ['boss_guiji', 'fankui', 'boss_lianyu', 'juece', 'boss_bianshen3'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_chi: ['male', 'shen', 5, ['boss_guimei', 'boss_didong', 'boss_shanbeng', 'boss_bianshen2'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_mo: ['female', 'shen', 5, ['boss_guimei', 'enyuan', 'boss_beiming', 'boss_bianshen2'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_wang: ['male', 'shen', 5, ['boss_guimei', 'boss_luolei', 'huilei', 'boss_bianshen2'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_liang: ['female', 'shen', 5, ['boss_guimei', 'boss_guihuo', 'boss_minbao', 'boss_bianshen2'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\r\n\t\t\t\tboss_qinguangwang: ['male', 'qun', 3, ['boss_panguan', 'boss_juhun', 'boss_wangxiang', 'boss_newhuanren'], ['shu', 'boss', 'bossallowed'], 'shu'],\r\n\t\t\t\tboss_chujiangwang: ['male', 'qun', 4, ['weimu', 'refankui', 'boss_bingfeng'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_songdiwang: ['male', 'qun', 4, ['boss_heisheng', 'boss_shengfu', 'enyuan'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_wuguanwang: ['male', 'qun', 4, ['boss_zhiwang', 'boss_gongzheng', 'boss_xuechi'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_yanluowang: ['male', 'qun', 4, ['boss_tiemian', 'boss_zhadao', 'boss_zhuxin'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_bianchengwang: ['male', 'qun', 4, ['boss_leizhou', 'boss_leifu', 'boss_leizhu'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_taishanwang: ['male', 'qun', 4, ['boss_fudu', 'boss_kujiu', 'boss_renao'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_dushiwang: ['male', 'qun', 4, ['boss_remen', 'boss_zhifen', 'boss_huoxing'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_pingdengwang: ['male', 'qun', 4, ['boss_suozu', 'boss_abi', 'boss_pingdeng'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_zhuanlunwang: ['male', 'qun', 6, ['boss_modao', 'boss_lunhui', 'boss_wangsheng', 'boss_zlfanshi'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_mengpo: ['female', 'qun', 3, ['boss_shiyou', 'boss_wanghun', 'boss_wangshi'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\t\t\t\tboss_dizangwang: ['male', 'qun', 8, ['boss_bufo', 'boss_wuliang', 'boss_dayuan', 'boss_diting'], ['shu', 'hiddenboss', 'bossallowed']],\r\n\r\n\t\t\t\tboss_lvbu1: ['male', 'shen', 8, ['mashu', 'wushuang', 'boss_baonu', 'boss_jingjia', 'boss_aozhan'], ['qun', 'boss', 'bossallowed'], 'wei'],\r\n\t\t\t\tboss_lvbu2: ['male', 'shen', 6, ['mashu', 'wushuang', 'xiuluo', 'shenwei', 'shenji'], ['qun', 'hiddenboss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_lvbu3: ['male', 'shen', 6, ['wushuang', 'shenqu', 'jiwu'], ['qun', 'hiddenboss', 'bossallowed'], 'qun'],\r\n\r\n\t\t\t\tboss_caocao: ['male', 'shen', 12, ['boss_guixin', 'xiongcai'], ['wei', 'boss', 'bossallowed'], 'wei'],\r\n\t\t\t\tboss_guojia: ['male', 'shen', 4, ['tiandu', 'boss_guimou', 'boss_yuance', 'boss_qizuo'], ['wei', 'boss', 'bossallowed'], 'zhu'],\r\n\t\t\t\tboss_zhangchunhua: ['female', 'shen', 4, ['jueqing', 'boss_wuxin', 'shangshix'], ['wei', 'boss', 'bossallowed'], 'wei'],\r\n\t\t\t\tboss_zhenji: ['female', 'shen', 4, ['tashui', 'lingbo', 'jiaoxia', 'fanghua'], ['wei', 'boss', 'bossallowed'], 'wei'],\r\n\r\n\t\t\t\tboss_liubei: ['male', 'shen', 8, ['xiaoxiong', 'boss_zhangwu'], ['shu', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_zhugeliang: ['male', 'shen', Infinity, ['xiangxing', 'yueyin', 'fengqi', 'gaiming'], ['shu', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_huangyueying: ['female', 'shen', 4, ['boss_gongshen', 'boss_jizhi', 'qicai', 'boss_guiyin'], ['shu', 'boss', 'bossallowed'], 'wei'],\r\n\t\t\t\tboss_pangtong: ['male', 'shen', 4, ['boss_tianyu', 'qiwu', 'niepan', 'boss_yuhuo'], ['shu', 'boss', 'bossallowed'], 'zhu'],\r\n\t\t\t\tboss_zhaoyun: ['male', 'shen', 1, ['boss_juejing', 'longhun', 'zhanjiang'], ['shu', 'boss', 'bossallowed'], 'qun'],\r\n\r\n\t\t\t\tboss_zhouyu: ['male', 'shen', 6, ['huoshen', 'boss_honglian', 'boss_xianyin'], ['wu', 'boss', 'bossallowed'], 'zhu'],\r\n\r\n\t\t\t\tboss_caiwenji: ['female', 'shen', 4, ['beige', 'boss_hujia', 'boss_guihan'], ['qun', 'boss', 'bossallowed'], 'wei'],\r\n\t\t\t\tboss_zhangjiao: ['male', 'shen', 8, ['boss_leiji', 'tiandao', 'jidian'], ['qun', 'boss', 'bossallowed'], 'shu'],\r\n\t\t\t\tboss_zuoci: ['male', 'shen', 0, ['huanhua'], ['qun', 'boss', 'bossallowed'], 'shu'],\r\n\r\n\t\t\t\tboss_diaochan: ['female', 'shen', 4, ['fengwu', 'yunshen', 'lianji', 'boss_wange', 'yuehun'], ['qun', 'boss', 'bossallowed'], 'qun'],\r\n\t\t\t\tboss_huatuo: ['male', 'shen', 6, ['chulao', 'mazui', 'boss_shengshou', 'guizhen', 'wuqin'], ['qun', 'boss', 'bossallowed'], 'wu'],\r\n\t\t\t\tboss_dongzhuo: ['male', 'shen', 20, ['jiuchi', 'boss_qiangzheng', 'boss_baolin'], ['qun', 'boss', 'bossallowed'], 'shu'],\r\n\r\n\t\t\t\t\"boss_sunce\": [\"male\", \"shen\", \"1/8\", [\"boss_jiang\", \"boss_hunzi\", \"boss_hunyou\", \"boss_taoni\"], ['qun', 'boss', 'bossallowed'], 'wu'],\r\n\r\n\t\t\t\t// boss_nianshou:['male','shen',Infinity,['boss_nianrui','boss_qixiang','boss_damagecount'],['boss'],'shu'],\r\n\t\t\t\t// boss_yuji:['male','qun',8,[],['boss','bossallowed'],'nei'],\r\n\t\t\t\t// boss_shuijing:['male','qun',8,[],['boss','bossallowed'],'wei'],\r\n\t\t\t\t// boss_sunshangxiang:['male','qun',8,[],['boss','bossallowed'],'wei'],\r\n\t\t\t}\r\n\t\t},\r\n\t\tcardPack: {\r\n\t\t\tmode_boss: ['honghuangzhili', 'sadouchengbing', 'yihuajiemu', 'guilongzhanyuedao', 'guofengyupao', 'chiyanzhenhunqin', 'qimenbagua', 'xuwangzhimian', 'juechenjinge', 'xiuluolianyuji', 'chixueqingfeng', 'longfenghemingjian', 'qicaishenlu', 'wushuangfangtianji', 'shufazijinguan', 'hongmianbaihuapao', 'linglongshimandai', 'boss_mengpohuihun', 'lingsheji', 'shanrangzhaoshu', 'jinwuluorigong', 'xingtianpojunfu', 'gubuzifeng']\r\n\t\t},\r\n\t\tinit: function () {\r\n\t\t\tfor (var i in lib.characterPack.mode_boss) {\r\n\t\t\t\tif (lib.characterPack.mode_boss[i][4].contains('hiddenboss')) continue;\r\n\t\t\t\tlib.mode.boss.config[i + '_boss_config'] = {\r\n\t\t\t\t\tname: get.translation(i),\r\n\t\t\t\t\tinit: true,\r\n\t\t\t\t\tunfrequent: true,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tgame: {\r\n\t\t\treserveDead: true,\r\n\t\t\taddBossFellow: function (position, name) {\r\n\t\t\t\tvar fellow = game.addFellow(position, name, 'zoominanim');\r\n\t\t\t\tfellow.directgain(get.cards(4));\r\n\t\t\t\tfellow.side = true;\r\n\t\t\t\tfellow.identity = 'zhong';\r\n\t\t\t\tfellow.setIdentity('zhong');\r\n\t\t\t\tgame.addVideo('setIdentity', fellow, 'zhong');\r\n\t\t\t},\r\n\t\t\tchangeBoss: function (name, player) {\r\n\t\t\t\tif (!player) {\r\n\t\t\t\t\tif (game.additionaldead) {\r\n\t\t\t\t\t\tgame.additionaldead.push(game.boss);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.additionaldead = [game.boss];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer = game.boss;\r\n\t\t\t\t\tdelete game.boss;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tplayer.delete();\r\n\t\t\t\tgame.players.remove(player);\r\n\t\t\t\tgame.dead.remove(player);\r\n\t\t\t\tvar boss = ui.create.player();\r\n\t\t\t\tboss.getId();\r\n\t\t\t\tboss.init(name);\r\n\t\t\t\tboss.side = true;\r\n\t\t\t\tgame.addVideo('bossSwap', player, (game.boss ? '_' : '') + boss.name);\r\n\t\t\t\tboss.dataset.position = player.dataset.position;\r\n\t\t\t\tif (game.me == player) {\r\n\t\t\t\t\tgame.swapControl(boss);\r\n\t\t\t\t}\r\n\t\t\t\tgame.players.push(boss.animate('zoominanim'));\r\n\t\t\t\tgame.arrangePlayers();\r\n\t\t\t\tif (!game.boss) {\r\n\t\t\t\t\tgame.boss = boss;\r\n\t\t\t\t\tboss.setIdentity('zhu');\r\n\t\t\t\t\tboss.identity = 'zhu';\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tboss.setIdentity('zhong');\r\n\t\t\t\t\tboss.identity = 'zhong';\r\n\t\t\t\t}\r\n\t\t\t\tui.arena.appendChild(boss);//[todo player]\r\n\t\t\t\tboss.directgain(get.cards(4));\r\n\t\t\t},\r\n\t\t\tcheckResult: function () {\r\n\t\t\t\tif (game.boss == game.me) {\r\n\t\t\t\t\tgame.over(game.boss.isAlive());\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tgame.over(!game.boss.isAlive());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetVideoName: function () {\r\n\t\t\t\tvar str = get.translation(game.me.name);\r\n\t\t\t\tif (game.me.name2) {\r\n\t\t\t\t\tstr += '/' + get.translation(game.me.name2);\r\n\t\t\t\t}\r\n\t\t\t\tvar str2 = '挑战';\r\n\t\t\t\tif (game.me != game.boss) {\r\n\t\t\t\t\tstr2 += ' - ' + get.translation(game.boss);\r\n\t\t\t\t}\r\n\t\t\t\tvar name = [str, str2];\r\n\t\t\t\treturn name;\r\n\t\t\t},\r\n\t\t\tbossPhaseLoop: function () {\r\n\t\t\t\tvar next = game.createEvent('phaseLoop');\r\n\t\t\t\tif (game.bossinfo.loopFirst) {\r\n\t\t\t\t\tnext.player = game.bossinfo.loopFirst();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tnext.player = game.boss;\r\n\t\t\t\t}\r\n\t\t\t\t_status.looped = true;\r\n\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tif (player.chongzheng) {\r\n\t\t\t\t\t\tplayer.chongzheng = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (player.isDead()) {\r\n\t\t\t\t\t\tif (player.hp < 0) player.hp = 0;\r\n\t\t\t\t\t\tplayer.$.boss_chongzheng++;\r\n\t\t\t\t\t\tif (player.maxHp > 0 && game.bossinfo.chongzheng) {\r\n\t\t\t\t\t\t\tif (player.hp < player.maxHp) {\r\n\t\t\t\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (player.countCards('h') < 4) {\r\n\t\t\t\t\t\t\t\tvar card = get.cards()[0];\r\n\t\t\t\t\t\t\t\tvar sort = lib.config.sort_card(card);\r\n\t\t\t\t\t\t\t\tvar position = sort > 0 ? player.node.handcards1 : player.node.handcards2;\r\n\t\t\t\t\t\t\t\tcard.fix();\r\n\t\t\t\t\t\t\t\tcard.animate('start');\r\n\t\t\t\t\t\t\t\tposition.insertBefore(card, position.firstChild);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t\t\tif (player.$.boss_chongzheng >= game.bossinfo.chongzheng) {\r\n\t\t\t\t\t\t\t\tplayer.revive(player.hp);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (game.bossinfo.loopType == 2) {\r\n\t\t\t\t\t\t\tgame.boss.chongzheng = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (player.identity == 'zhu' && game.boss != player) {\r\n\t\t\t\t\t\t\tplayer = game.boss;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.phase();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (game.bossinfo.loopType == 2) {\r\n\t\t\t\t\t\t_status.roundStart = true;\r\n\t\t\t\t\t\tif (event.player == game.boss) {\r\n\t\t\t\t\t\t\tif (!_status.last || _status.last.nextSeat == game.boss) {\r\n\t\t\t\t\t\t\t\tevent.player = game.boss.nextSeat;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tevent.player = _status.last.nextSeat;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t_status.last = player;\r\n\t\t\t\t\t\t\tevent.player = game.boss;\r\n\t\t\t\t\t\t\tif (player.nextSeat == game.boss) {\r\n\t\t\t\t\t\t\t\tdelete _status.roundStart;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.player = event.player.nextSeat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.goto(0);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonSwapControl: function () {\r\n\t\t\t\tif (game.me == game.boss) return;\r\n\t\t\t\tgame.addVideo('onSwapControl');\r\n\t\t\t\tvar name = game.me.name;\r\n\t\t\t\tif (ui.fakeme && ui.fakeme.current != name) {\r\n\t\t\t\t\tui.fakeme.current = name;\r\n\t\t\t\t\tif (ui.versushighlight && ui.versushighlight != game.me) {\r\n\t\t\t\t\t\tui.versushighlight.classList.remove('current_action');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.versushighlight = game.me;\r\n\t\t\t\t\tgame.me.classList.add('current_action');\r\n\t\t\t\t\t// game.me.line(ui.fakeme,{opacity:0.5,dashed:true});\r\n\r\n\t\t\t\t\tui.fakeme.style.backgroundImage = game.me.node.avatar.style.backgroundImage;\r\n\t\t\t\t\t// ui.fakeme.style.backgroundSize='cover';\r\n\t\t\t\t}\r\n\t\t\t\tui.updatehl();\r\n\t\t\t},\r\n\t\t\tmodeSwapPlayer: function (player) {\r\n\t\t\t\tvar bool = (game.me == game.boss || player == game.boss);\r\n\t\t\t\tgame.swapControl(player);\r\n\t\t\t\tgame.onSwapControl();\r\n\t\t\t\tif (!bool) return;\r\n\t\t\t\tif (game.me == game.boss) {\r\n\t\t\t\t\tgame.singleHandcard = false;\r\n\t\t\t\t\tui.arena.classList.remove('single-handcard');\r\n\t\t\t\t\tui.window.classList.remove('single-handcard');\r\n\t\t\t\t\tui.fakeme.style.display = 'none';\r\n\t\t\t\t\tgame.me.dataset.position = 0;\r\n\t\t\t\t\tgame.me.nextSeat.dataset.position = 2;\r\n\t\t\t\t\tgame.me.nextSeat.nextSeat.dataset.position = 4;\r\n\t\t\t\t\tgame.me.nextSeat.nextSeat.nextSeat.dataset.position = 6;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tgame.singleHandcard = true;\r\n\t\t\t\t\tui.arena.classList.add('single-handcard');\r\n\t\t\t\t\tui.window.classList.add('single-handcard');\r\n\t\t\t\t\tui.fakeme.style.display = '';\r\n\t\t\t\t\tgame.boss.dataset.position = 7;\r\n\t\t\t\t\tgame.boss.nextSeat.dataset.position = 1;\r\n\t\t\t\t\tgame.boss.nextSeat.nextSeat.dataset.position = 2;\r\n\t\t\t\t\tgame.boss.nextSeat.nextSeat.nextSeat.dataset.position = 3;\r\n\t\t\t\t\tif (game.me && game.me.node.handcards2.childNodes.length) {\r\n\t\t\t\t\t\twhile (game.me.node.handcards2.childNodes.length) {\r\n\t\t\t\t\t\t\tgame.me.node.handcards1.appendChild(game.me.node.handcards2.firstChild);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchooseCharacter: function (func) {\r\n\t\t\t\tvar next = game.createEvent('chooseCharacter', false);\r\n\t\t\t\tnext.showConfig = true;\r\n\t\t\t\tnext.customreplacetarget = func;\r\n\t\t\t\tnext.ai = function (player, list) {\r\n\t\t\t\t\tif (get.config('double_character')) {\r\n\t\t\t\t\t\tplayer.init(list[0], list[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.init(list[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tevent.list = list;\r\n\t\t\t\t\tfor (i in lib.character) {\r\n\t\t\t\t\t\tif (lib.character[i][4].contains('minskin')) continue;\r\n\t\t\t\t\t\tif (lib.character[i][4].contains('boss')) continue;\r\n\t\t\t\t\t\tif (lib.character[i][4].contains('hiddenboss')) continue;\r\n\t\t\t\t\t\tif (lib.character[i][4] && lib.character[i][4].contains('forbidai')) continue;\r\n\t\t\t\t\t\tif (lib.config.forbidboss.contains(i)) continue;\r\n\t\t\t\t\t\tif (lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\tvar dialog = ui.create.dialog('选择参战角色', 'hidden');\r\n\t\t\t\t\tdialog.classList.add('fixed');\r\n\t\t\t\t\tui.window.appendChild(dialog);\r\n\t\t\t\t\tdialog.classList.add('bosscharacter');\r\n\t\t\t\t\tdialog.classList.add('modeshortcutpause');\r\n\t\t\t\t\tdialog.classList.add('withbg');\r\n\t\t\t\t\t// dialog.add('0/3');\r\n\t\t\t\t\tdialog.add([list.slice(0, 20), 'character']);\r\n\t\t\t\t\tdialog.noopen = true;\r\n\t\t\t\t\tvar next = game.me.chooseButton(dialog, true).set('onfree', true);\r\n\t\t\t\t\tnext._triggered = null;\r\n\t\t\t\t\tnext.custom.replace.target = event.customreplacetarget;\r\n\t\t\t\t\tnext.selectButton = [3, 3];\r\n\t\t\t\t\t// next.custom.add.button=function(){\r\n\t\t\t\t\t//\t\tif(ui.cheat2&&ui.cheat2.backup) return;\r\n\t\t\t\t\t//\t\t_status.event.dialog.content.childNodes[1].innerHTML=\r\n\t\t\t\t\t//\t\tui.selected.buttons.length+'/3';\r\n\t\t\t\t\t// };\r\n\t\t\t\t\tevent.changeDialog = function () {\r\n\t\t\t\t\t\tif (ui.cheat2 && ui.cheat2.dialog == _status.event.dialog) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (game.changeCoin) {\r\n\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlist.randomSort();\r\n\r\n\t\t\t\t\t\tvar buttons = ui.create.div('.buttons');\r\n\t\t\t\t\t\tvar node = _status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t_status.event.dialog.buttons = ui.create.buttons(list.slice(0, 20), 'character', buttons);\r\n\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons, node);\r\n\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\tnode.remove();\r\n\r\n\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tui.create.cheat = function () {\r\n\t\t\t\t\t\t_status.createControl = ui.cheat2 || event.asboss;\r\n\t\t\t\t\t\tui.cheat = ui.create.control('更换', event.changeDialog);\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar createCharacterDialog = function () {\r\n\t\t\t\t\t\tevent.dialogxx = ui.create.characterDialog();\r\n\t\t\t\t\t\tevent.dialogxx.classList.add('bosscharacter');\r\n\t\t\t\t\t\tevent.dialogxx.classList.add('withbg');\r\n\t\t\t\t\t\tevent.dialogxx.classList.add('fixed');\r\n\t\t\t\t\t\tif (ui.cheat2) {\r\n\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx', 500);\r\n\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (lib.onfree) {\r\n\t\t\t\t\t\tlib.onfree.push(createCharacterDialog);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tcreateCharacterDialog();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.create.cheat2 = function () {\r\n\t\t\t\t\t\t_status.createControl = event.asboss;\r\n\t\t\t\t\t\tui.cheat2 = ui.create.control('自由选将', function () {\r\n\t\t\t\t\t\t\tif (this.dialog == _status.event.dialog) {\r\n\t\t\t\t\t\t\t\tif (game.changeCoin) {\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog = this.backup;\r\n\t\t\t\t\t\t\t\tui.window.appendChild(this.backup);\r\n\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif (ui.cheat) {\r\n\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx', 500);\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (_status.bosschoice) {\r\n\t\t\t\t\t\t\t\t\t_status.bosschoice.animate('controlpressdownx', 500);\r\n\t\t\t\t\t\t\t\t\t_status.bosschoice.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (game.changeCoin) {\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.backup = _status.event.dialog;\r\n\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog = _status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\tthis.dialog = _status.event.dialog;\r\n\t\t\t\t\t\t\t\tui.window.appendChild(this.dialog);\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif (ui.cheat) {\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (_status.bosschoice) {\r\n\t\t\t\t\t\t\t\t\t_status.bosschoice.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (lib.onfree) {\r\n\t\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!ui.cheat && get.config('change_choice'))\r\n\t\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\tif (!ui.cheat2 && get.config('free_choose'))\r\n\t\t\t\t\t\tui.create.cheat2();\r\n\r\n\t\t\t\t\tevent.asboss = ui.create.control('应战', function () {\r\n\t\t\t\t\t\tevent.boss = true;\r\n\t\t\t\t\t\tevent.enemy = [];\r\n\t\t\t\t\t\tfor (var i = 0; i < ui.selected.buttons.length; i++) {\r\n\t\t\t\t\t\t\tevent.enemy.push(ui.selected.buttons[i].link);\r\n\t\t\t\t\t\t\tevent.list.remove(ui.selected.buttons[i].link);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twhile (event.enemy.length < 3) {\r\n\t\t\t\t\t\t\tvar name = event.list.randomRemove();\r\n\t\t\t\t\t\t\tif (lib.boss[lib.storage.current] && lib.boss[lib.storage.current].randchoice) {\r\n\t\t\t\t\t\t\t\tname = lib.boss[lib.storage.current].randchoice(name, event.enemy);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.enemy.push(name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\tif (ui.confirm) {\r\n\t\t\t\t\t\t\tui.confirm.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (ui.cheat) {\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (ui.cheat2) {\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.asboss.close();\r\n\t\t\t\t\tif (_status.bosschoice) {\r\n\t\t\t\t\t\t_status.bosschoice.close();\r\n\t\t\t\t\t\tdelete _status.bosschoice;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (event.boss) {\r\n\t\t\t\t\t\tevent.result = {\r\n\t\t\t\t\t\t\tboss: true,\r\n\t\t\t\t\t\t\tlinks: event.enemy\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.result = {\r\n\t\t\t\t\t\t\tboss: false,\r\n\t\t\t\t\t\t\tlinks: result.links\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\t_status.coinCoeff = get.coinCoeff(result.links);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn next;\r\n\t\t\t},\r\n\t\t},\r\n\t\tboss: {\r\n\t\t\tboss_qiongqi: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.nextSeat.nextSeat;\r\n\t\t\t\t},\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\treturn player == game.boss ? 8 : 4;\r\n\t\t\t\t},\r\n\t\t\t\tminion: {\r\n\t\t\t\t\t'2': 'boss_zhuyin',\r\n\t\t\t\t\t'8': 'boss_zhuyin',\r\n\t\t\t\t},\r\n\t\t\t\trandchoice: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.randchoice.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tcontrolid: 'shenwuzaishi',\r\n\t\t\t\tcontrol: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.control.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.init.apply(this, arguments);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xiangliu: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.nextSeat.nextSeat;\r\n\t\t\t\t},\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\treturn player == game.boss ? 8 : 4;\r\n\t\t\t\t},\r\n\t\t\t\tminion: {\r\n\t\t\t\t\t'2': 'boss_zhuyin',\r\n\t\t\t\t\t'8': 'boss_zhuyin',\r\n\t\t\t\t},\r\n\t\t\t\trandchoice: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.randchoice.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tcontrolid: 'shenwuzaishi',\r\n\t\t\t\tcontrol: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.control.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.init.apply(this, arguments);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zhuyan: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.nextSeat.nextSeat;\r\n\t\t\t\t},\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\treturn player == game.boss ? 8 : 4;\r\n\t\t\t\t},\r\n\t\t\t\tminion: {\r\n\t\t\t\t\t'2': 'boss_zhuyin',\r\n\t\t\t\t\t'8': 'boss_zhuyin',\r\n\t\t\t\t},\r\n\t\t\t\trandchoice: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.randchoice.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tcontrolid: 'shenwuzaishi',\r\n\t\t\t\tcontrol: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.control.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.init.apply(this, arguments);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bifang: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.nextSeat.nextSeat;\r\n\t\t\t\t},\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\treturn player == game.boss ? 8 : 4;\r\n\t\t\t\t},\r\n\t\t\t\tminion: {\r\n\t\t\t\t\t'2': 'boss_zhuyin',\r\n\t\t\t\t\t'8': 'boss_zhuyin',\r\n\t\t\t\t},\r\n\t\t\t\trandchoice: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.randchoice.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tcontrolid: 'shenwuzaishi',\r\n\t\t\t\tcontrol: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.control.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.init.apply(this, arguments);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_yingzhao: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.nextSeat.nextSeat;\r\n\t\t\t\t},\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\treturn player == game.boss ? 8 : 4;\r\n\t\t\t\t},\r\n\t\t\t\tminion: {\r\n\t\t\t\t\t'2': 'boss_zhuyin',\r\n\t\t\t\t\t'8': 'boss_zhuyin',\r\n\t\t\t\t},\r\n\t\t\t\trandchoice: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.randchoice.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tcontrolid: 'shenwuzaishi',\r\n\t\t\t\tcontrol: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.control.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.init.apply(this, arguments);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_hundun: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.nextSeat.nextSeat;\r\n\t\t\t\t},\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\treturn player == game.boss ? 8 : 4;\r\n\t\t\t\t},\r\n\t\t\t\tminion: {\r\n\t\t\t\t\t'2': 'boss_zhuyin',\r\n\t\t\t\t\t'8': 'boss_zhuyin',\r\n\t\t\t\t},\r\n\t\t\t\trandchoice: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.randchoice.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tcontrolid: 'shenwuzaishi',\r\n\t\t\t\tcontrol: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.control.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.init.apply(this, arguments);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_taotie: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.nextSeat.nextSeat;\r\n\t\t\t\t},\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\treturn player == game.boss ? 8 : 4;\r\n\t\t\t\t},\r\n\t\t\t\tminion: {\r\n\t\t\t\t\t'2': 'boss_zhuyin',\r\n\t\t\t\t\t'8': 'boss_zhuyin',\r\n\t\t\t\t},\r\n\t\t\t\trandchoice: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.randchoice.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tcontrolid: 'shenwuzaishi',\r\n\t\t\t\tcontrol: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.control.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\treturn lib.boss.boss_taowu.init.apply(this, arguments);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_taowu: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.nextSeat.nextSeat;\r\n\t\t\t\t},\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\treturn player == game.boss ? 8 : 4;\r\n\t\t\t\t},\r\n\t\t\t\tminion: {\r\n\t\t\t\t\t'2': 'boss_zhuyin',\r\n\t\t\t\t\t'8': 'boss_zhuyin',\r\n\t\t\t\t},\r\n\t\t\t\trandchoice: function (name, list) {\r\n\t\t\t\t\tif (Math.random() > 1 / 3) {\r\n\t\t\t\t\t\treturn name;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar arr = ['sp_KaguraMea', 'sp_MinatoAqua', 'sp_MononobeAlice', 'sp_Ava', 'sp_Diana', 'sp_HisekiErio', 'sp_GawrGura'];\r\n\t\t\t\t\t\tarr.removeArray(list);\r\n\t\t\t\t\t\treturn arr.randomGet();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcontrolid: 'shenwuzaishi',\r\n\t\t\t\tcontrol: function (type, control) {\r\n\t\t\t\t\tif (type == 'cancel') {\r\n\t\t\t\t\t\tif (!control.classList.contains('glow')) return;\r\n\t\t\t\t\t\tvar dialog = control.dialog;\r\n\t\t\t\t\t\tdialog.content.removeChild(control.backup1);\r\n\t\t\t\t\t\tdialog.buttons.removeArray(control.backup2);\r\n\r\n\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar control = ui.create.control('神将', function () {\r\n\t\t\t\t\t\t\tif (ui.cheat2 && ui.cheat2.dialog == _status.event.dialog) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar dialog = _status.event.dialog;\r\n\t\t\t\t\t\t\tthis.dialog = dialog;\r\n\t\t\t\t\t\t\tif (this.classList.contains('glow')) {\r\n\t\t\t\t\t\t\t\tthis.backup1.remove();\r\n\t\t\t\t\t\t\t\tdialog.buttons.removeArray(this.backup2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tvar links = [];\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < dialog.buttons.length; i++) {\r\n\t\t\t\t\t\t\t\t\tlinks.push(dialog.buttons[i].link);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < this.backup2.length; i++) {\r\n\t\t\t\t\t\t\t\t\tif (links.contains(this.backup2[i].link)) {\r\n\t\t\t\t\t\t\t\t\t\tthis.backup2[i].style.display = 'none';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tthis.backup2[i].style.display = '';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tdialog.content.insertBefore(this.backup1, dialog.buttons[0].parentNode);\r\n\t\t\t\t\t\t\t\tdialog.buttons.addArray(this.backup2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.classList.toggle('glow');\r\n\r\n\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tcontrol.backup1 = ui.create.div('.buttons');\r\n\t\t\t\t\t\tcontrol.backup2 = ui.create.buttons(['sp_KaguraMea', 'sp_MinatoAqua', 'sp_MononobeAlice', 'sp_Ava', 'sp_Diana', 'sp_HisekiErio', 'sp_GawrGura'], 'character', control.backup1);\r\n\t\t\t\t\t\treturn control;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\tgame.addGlobalSkill('boss_shenwuzaishi');\r\n\t\t\t\t\tgame.addGlobalSkill('TheDayIBecomeAGod');\r\n\t\t\t\t\tgame.addGlobalSkill('thedayibecomeagod');\r\n\t\t\t\t\tvar list = ['lebu', 'bingliang'];\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tswitch (game.players[i].name1) {\r\n\t\t\t\t\t\t\tcase 'shen_guanyu': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('guilongzhanyuedao', 'spade', 5));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('guilongzhanyuedao');\r\n\t\t\t\t\t\t\t\tlist.push('qinglong');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_zhugeliang': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('qimenbagua', 'spade', 2));\r\n\t\t\t\t\t\t\t\tlist.push('bagua');\r\n\t\t\t\t\t\t\t\tlib.inpile.add('qimenbagua');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_zhouyu': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('chiyanzhenhunqin', 'diamond', 1));\r\n\t\t\t\t\t\t\t\tlist.push('zhuque');\r\n\t\t\t\t\t\t\t\tlib.inpile.add('chiyanzhenhunqin');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_caocao': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('juechenjinge', 'spade', 5));\r\n\t\t\t\t\t\t\t\tlist.push('jueying');\r\n\t\t\t\t\t\t\t\tlib.inpile.add('juechenjinge');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_zhaoyun': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('chixueqingfeng', 'spade', 6));\r\n\t\t\t\t\t\t\t\tlist.push('qinggang');\r\n\t\t\t\t\t\t\t\tlib.inpile.add('chixueqingfeng');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_lvbu': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('xiuluolianyuji', 'diamond', 12));\r\n\t\t\t\t\t\t\t\tlist.push('fangtian');\r\n\t\t\t\t\t\t\t\tlib.inpile.add('xiuluolianyuji');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_simayi': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('xuwangzhimian', 'diamond', 4));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('xuwangzhimian');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_liubei': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('longfenghemingjian', 'spade', 2));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('longfenghemingjian');\r\n\t\t\t\t\t\t\t\tlist.push('cixiong');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_lvmeng': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('guofengyupao', 'diamond', 3));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('guofengyupao');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_luxun': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('qicaishenlu', 'diamond', 3));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('qicaishenlu');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_ganning': case 'key_iwasawa': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('jinwuluorigong', 'heart', 5));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('jinwuluorigong');\r\n\t\t\t\t\t\t\t\tlist.push('qilin');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'ol_zhangliao': case 'key_noda': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('xingtianpojunfu', 'diamond', 5));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('xingtianpojunfu');\r\n\t\t\t\t\t\t\t\tlist.push('guanshi');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_zhenji': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('lingsheji', 'club', 12));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('lingsheji');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'shen_caopi': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('shanrangzhaoshu', 'spade', 13));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('shanrangzhaoshu');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'key_kagari': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('goujiangdesidai', 'heart', 1));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('goujiangdesidai');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'key_shiki': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('niaobaidaowenha', 'diamond', 13));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('niaobaidaowenha');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'key_hina': {\r\n\t\t\t\t\t\t\t\tgame.players[i].equip(game.createCard2('shenzhixiunvfu', 'spade', 13));\r\n\t\t\t\t\t\t\t\tlib.inpile.add('shenzhixiunvfu');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.inpile.remove('wuzhong');\r\n\t\t\t\t\tlib.inpile.remove('jiedao');\r\n\t\t\t\t\tlib.inpile.add('sadouchengbing');\r\n\t\t\t\t\tlib.inpile.add('yihuajiemu');\r\n\t\t\t\t\tlib.inpile.add('gubuzifeng');\r\n\t\t\t\t\tfor (var i = 0; i < ui.cardPile.childElementCount; i++) {\r\n\t\t\t\t\t\tvar node = ui.cardPile.childNodes[i];\r\n\t\t\t\t\t\tif (node.name == 'wuzhong') {\r\n\t\t\t\t\t\t\tnode.init([node.suit, node.number, 'sadouchengbing']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (node.name == 'jiedao') {\r\n\t\t\t\t\t\t\tnode.init([node.suit, node.number, 'yihuajiemu']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (list.contains(node.name)) {\r\n\t\t\t\t\t\t\tlib.inpile.remove(node.name);\r\n\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar cards = [\r\n\t\t\t\t\t\tgame.createCard2('gubuzifeng', 'club', 5),\r\n\t\t\t\t\t\tgame.createCard2('gubuzifeng', 'diamond', 7)\r\n\t\t\t\t\t];\r\n\t\t\t\t\twhile (cards.length > 0) {\r\n\t\t\t\t\t\tui.cardPile.insertBefore(cards.shift(), ui.cardPile.childNodes[get.rand(0, ui.cardPile.childElementCount - 1)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.inpile.sort(lib.sort.card);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_chiyanshilian: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopType: 2,\r\n\t\t\t\tcheckResult: function (player) {\r\n\t\t\t\t\tif (player == game.boss && game.boss.name != 'boss_yandi') {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\t_status.additionalReward = function () {\r\n\t\t\t\t\t\treturn 500;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.inpile.remove('shandian');\r\n\t\t\t\t\tlib.inpile.remove('huoshan');\r\n\t\t\t\t\tlib.inpile.remove('hongshui');\r\n\t\t\t\t\tlib.inpile.remove('fulei');\r\n\t\t\t\t\tlib.inpile.add('honghuangzhili');\r\n\t\t\t\t\tlib.inpile.sort(lib.sort.card);\r\n\t\t\t\t\tfor (var i = 0; i < ui.cardPile.childElementCount; i++) {\r\n\t\t\t\t\t\tvar node = ui.cardPile.childNodes[i];\r\n\t\t\t\t\t\tif (node.name == 'shandian') {\r\n\t\t\t\t\t\t\tnode.classList.remove('fullskin');\r\n\t\t\t\t\t\t\tnode.classList.remove('thunder');\r\n\t\t\t\t\t\t\tnode.init([node.suit, node.number, 'honghuangzhili']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (['huoshan', 'hongshui', 'fulei'].contains(node.name)) {\r\n\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qingmushilian: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopType: 2,\r\n\t\t\t\tcheckResult: function (player) {\r\n\t\t\t\t\tif (player == game.boss && game.boss.name != 'boss_taihao') {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\tlib.boss.boss_chiyanshilian.init();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baimangshilian: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopType: 2,\r\n\t\t\t\tcheckResult: function (player) {\r\n\t\t\t\t\tif (player == game.boss && game.boss.name != 'boss_shaohao') {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\tlib.boss.boss_chiyanshilian.init();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xuanlinshilian: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tloopType: 2,\r\n\t\t\t\tcheckResult: function (player) {\r\n\t\t\t\t\tif (player == game.boss && game.boss.name != 'boss_zhuanxu') {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\tlib.boss.boss_chiyanshilian.init();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zhuoguiquxie: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tcheckResult: function (player) {\r\n\t\t\t\t\tif (player == game.boss && game.boss.name != 'boss_yecha' && game.boss.name != 'boss_luocha') {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\t_status.additionalReward = function () {\r\n\t\t\t\t\t\treturn 500;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qinguangwang: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tcheckResult: function (player) {\r\n\t\t\t\t\tif (player == game.boss && (!_status.shidianyanluo_level || _status.shidianyanluo_level < 3)) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\t_status.shidianyanluo_level = 0;\r\n\t\t\t\t\tlib.inpile.remove('muniu');\r\n\t\t\t\t\tfor (var i = 0; i < ui.cardPile.childElementCount; i++) {\r\n\t\t\t\t\t\tif (ui.cardPile.childNodes[i].name == 'muniu') {\r\n\t\t\t\t\t\t\tui.cardPile.childNodes[i].remove();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.additionalReward = function () {\r\n\t\t\t\t\t\treturn 500;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_nianshou: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\tgame.boss.node.action.classList.add('freecolor');\r\n\t\t\t\t\tgame.boss.node.action.style.opacity = 1;\r\n\t\t\t\t\tgame.boss.node.action.style.letterSpacing = '4px';\r\n\t\t\t\t\tgame.boss.node.action.style.marginRight = 0;\r\n\t\t\t\t\tgame.boss.node.action.style.fontFamily = 'huangcao';\r\n\t\t\t\t\tgame.boss.node.action.innerHTML = '';\r\n\t\t\t\t\t_status.additionalReward = function () {\r\n\t\t\t\t\t\treturn Math.round(Math.pow(_status.damageCount, 2.4)) * 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar time = 360;\r\n\t\t\t\t\tvar interval = setInterval(function () {\r\n\t\t\t\t\t\tif (_status.over) {\r\n\t\t\t\t\t\t\tclearInterval(interval);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar sec = time % 60;\r\n\t\t\t\t\t\tif (sec < 10) {\r\n\t\t\t\t\t\t\tsec = '0' + sec;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.boss.node.action.innerHTML = Math.floor(time / 60) + ':' + sec;\r\n\t\t\t\t\t\tif (time <= 0) {\r\n\t\t\t\t\t\t\tdelete _status.additionalReward;\r\n\t\t\t\t\t\t\tif (typeof _status.coin == 'number') {\r\n\t\t\t\t\t\t\t\tif (game.me == game.boss) {\r\n\t\t\t\t\t\t\t\t\t_status.coin += Math.round(Math.pow(_status.damageCount, 2.4));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t_status.coin += Math.round(Math.pow(_status.damageCount, 1.8));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.forceOver(true);\r\n\t\t\t\t\t\t\tclearInterval(interval);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttime--;\r\n\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t_status.damageCount = 0;\r\n\t\t\t\t\tui.damageCount = ui.create.system('伤害: 0', null, true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_nianshou_heti: {\r\n\t\t\t\tchongzheng: 0,\r\n\t\t\t},\r\n\t\t\tboss_zhangjiao: {\r\n\t\t\t\t// loopType:2,\r\n\t\t\t},\r\n\t\t\tboss_caiwenji: {\r\n\t\t\t\tloopType: 2,\r\n\t\t\t},\r\n\t\t\tboss_pangtong: {\r\n\t\t\t\tloopType: 2,\r\n\t\t\t\tchongzheng: 12\r\n\t\t\t},\r\n\t\t\tboss_zhaoyun: {\r\n\t\t\t\tchongzheng: 12\r\n\t\t\t},\r\n\t\t\tboss_zhenji: {\r\n\t\t\t\tchongzheng: 4,\r\n\t\t\t},\r\n\t\t\tboss_lvbu1: {\r\n\t\t\t\tloopType: 2,\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\tif (player == game.boss) return 8;\r\n\t\t\t\t\tif (player == game.boss.previous) return 5;\r\n\t\t\t\t\treturn 4;\r\n\t\t\t\t},\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.nextSeat;\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\tlib.inpile.remove('wugu');\r\n\t\t\t\t\tlib.inpile.remove('taoyuan');\r\n\t\t\t\t\tlib.inpile.remove('bagua');\r\n\t\t\t\t\tlib.inpile.remove('tengjia');\r\n\t\t\t\t\tlib.inpile.remove('fangtian');\r\n\t\t\t\t\tlib.inpile.remove('muniu');\r\n\t\t\t\t\tlib.inpile.addArray(['wushuangfangtianji', 'shufazijinguan', 'hongmianbaihuapao', 'linglongshimandai', 'lianjunshengyan']);\r\n\t\t\t\t\tlib.inpile.sort(lib.sort.card);\r\n\t\t\t\t\tvar equiplist = [];\r\n\t\t\t\t\tfor (var i = 0; i < ui.cardPile.childElementCount; i++) {\r\n\t\t\t\t\t\tvar node = ui.cardPile.childNodes[i];\r\n\t\t\t\t\t\tif (node.name == 'bagua') {\r\n\t\t\t\t\t\t\tnode.init([node.suit, node.number, 'linglongshimandai']);\r\n\t\t\t\t\t\t\tequiplist.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (node.name == 'tengjia') {\r\n\t\t\t\t\t\t\tnode.init([node.suit, node.number, 'hongmianbaihuapao']);\r\n\t\t\t\t\t\t\tequiplist.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (node.name == 'fangtian') {\r\n\t\t\t\t\t\t\tnode.init([node.suit, node.number, 'wushuangfangtianji']);\r\n\t\t\t\t\t\t\tequiplist.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (node.name == 'muniu') {\r\n\t\t\t\t\t\t\tnode.init([node.suit, node.number, 'shufazijinguan']);\r\n\t\t\t\t\t\t\tequiplist.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (node.name == 'wugu' || node.name == 'taoyuan') {\r\n\t\t\t\t\t\t\tnode.init([node.suit, node.number, 'lianjunshengyan']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tequiplist.randomSort();\r\n\t\t\t\t\tvar next = game.createEvent('boss_jingjia');\r\n\t\t\t\t\tnext.player = game.boss;\r\n\t\t\t\t\tnext.cards = equiplist;\r\n\t\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\tif (!cards.length) {\r\n\t\t\t\t\t\t\tevent.finish(); return;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.logSkill('boss_jingjia');\r\n\t\t\t\t\t\tevent.num = 1.5;\r\n\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\tvar card = cards.shift();\r\n\t\t\t\t\t\tif (player.isEmpty(get.subtype(card)) && Math.random() < event.num) {\r\n\t\t\t\t\t\t\tplayer.equip(card);\r\n\t\t\t\t\t\t\tevent.num = 0.5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cards.length) event.redo();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zuoci: {\r\n\t\t\t\tchongzheng: 4,\r\n\t\t\t},\r\n\t\t\tboss_diaochan: {\r\n\t\t\t\tchongzheng: 4,\r\n\t\t\t},\r\n\t\t\tboss_huangyueying: {\r\n\t\t\t\tchongzheng: 12,\r\n\t\t\t},\r\n\t\t\tboss_sunce: {\r\n\t\t\t\tloopType: 2,\r\n\t\t\t\tloopFirst: function () {\r\n\t\t\t\t\treturn game.boss.previousSeat;\r\n\t\t\t\t},\r\n\t\t\t\tgameDraw: function (player) {\r\n\t\t\t\t\treturn player == game.boss ? 8 : 4;\r\n\t\t\t\t},\r\n\t\t\t\tinit: function () {\r\n\t\t\t\t\t_status.taoni_over = get.copy(game.over);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tglobal: {\r\n\t\t\t\tloopType: 1,\r\n\t\t\t\tchongzheng: 6\r\n\t\t\t},\r\n\t\t},\r\n\t\tskill: {\r\n\t\t\tniaobaidaowenha_skill: {\r\n\t\t\t\ttrigger: { player: 'loseMaxHpAfter' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.count = trigger.num;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.count--;\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt2('niaobaidaowenha_skill'), lib.filter.notMe).set('ai', function (target) {\r\n\t\t\t\t\t\treturn get.attitude(_status.event.player, target) / (target.maxHp || 1)\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tvar target = result.targets[0];\r\n\t\t\t\t\t\tplayer.logSkill('niaobaidaowenha_skill', target);\r\n\t\t\t\t\t\ttarget.gainMaxHp();\r\n\t\t\t\t\t\ttarget.recover();\r\n\t\t\t\t\t\tif (event.count) event.goto(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgoujiangdesidai_skill: {\r\n\t\t\t\tinherit: 'kagari_zongsi',\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn !player.hasSkill('kagari_zongsi') || player.getStat('skill').kagari_zongsi;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgubuzifeng_disable: {\r\n\t\t\t\tinit: function (player, skill) {\r\n\t\t\t\t\tif (!player.storage[skill]) player.storage[skill] = [];\r\n\t\t\t\t},\r\n\t\t\t\tonremove: function (player, skill) {\r\n\t\t\t\t\tplayer.enableSkill(skill);\r\n\t\t\t\t\tdelete player.storage[skill];\r\n\t\t\t\t},\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tlocked: true,\r\n\t\t\t\tmark: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: function (storage, player, skill) {\r\n\t\t\t\t\t\tvar list = [];\r\n\t\t\t\t\t\tfor (var i in player.disabledSkills) {\r\n\t\t\t\t\t\t\tif (player.disabledSkills[i].contains(skill)) {\r\n\t\t\t\t\t\t\t\tlist.push(i)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\t\tvar str = '失效技能：';\r\n\t\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\t\tif (lib.translate[list[i] + '_info']) {\r\n\t\t\t\t\t\t\t\t\tstr += get.translation(list[i]) + '、';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn str.slice(0, str.length - 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tthedayibecomeagod: {\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function (event, player) { return player.group == 'shen' },\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tskillAnimation: true,\r\n\t\t\t\tanimationColor: 'kami',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt2('thedayibecomeagod'), function (card, player, target) {\r\n\t\t\t\t\t\treturn target.isFriendOf(player);\r\n\t\t\t\t\t}).set('forceDie', true).ai = function (target) {\r\n\t\t\t\t\t\treturn get.attitude(_status.event.player, target);\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tvar target = result.targets[0];\r\n\t\t\t\t\t\tevent.target = target;\r\n\t\t\t\t\t\tplayer.logSkill('thedayibecomeagod', target);\r\n\t\t\t\t\t\tif (target.group != 'shen') {\r\n\t\t\t\t\t\t\ttarget.changeGroup('shen');\r\n\t\t\t\t\t\t\tgame.log('此刻，便是', target, '成为神明之日！');\r\n\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse target.turnOver(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (target.isDamaged()) target.recover(target.maxHp - target.hp);\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\ttarget.drawTo(5);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tTheDayIBecomeAGod: {\r\n\t\t\t\ttrigger: { player: 'useCard1' },\r\n\t\t\t\truleSkill: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tprompt: '是否将此【杀】改为神属性？',\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.group == 'shen' && event.card.name == 'sha';\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tgame.log(trigger.card, '被改为神属性');\r\n\t\t\t\t\ttrigger.card.nature = 'kami';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshanrangzhaoshu: {\r\n\t\t\t\ttrigger: { global: 'gainEnd' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player != player && event.player != _status.currentPhase && event.player.getHistory('gain')[0] == event && player.countCards('he') + event.player.countCards('he') > 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.target = trigger.player;\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tif (player.countCards('he') > 1) list.push('交给其一张牌');\r\n\t\t\t\t\tif (trigger.player.countCards('he') > 0) list.push('令其交给你一张牌');\r\n\t\t\t\t\tevent.list = list;\r\n\t\t\t\t\tplayer.chooseControl('cancel2').set('choiceList', list).set('prompt', get.prompt('shanrangzhaoshu', trigger.player)).set('ai', function () {\r\n\t\t\t\t\t\tif (get.attitude(_status.event.player, _status.event.getTrigger().player) < 0) return _status.event.getParent().list.length - 1;\r\n\t\t\t\t\t\treturn 'cancel2';\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.control == 'cancel2') {\r\n\t\t\t\t\t\tevent.finish(); return;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.logSkill('shanrangzhaoshu', target);\r\n\t\t\t\t\tif (event.list[result.index][0] == '令') {\r\n\t\t\t\t\t\tevent.player = target;\r\n\t\t\t\t\t\tevent.target = player;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tplayer.chooseCard('he', true).set('filterCard', function (card, player) {\r\n\t\t\t\t\t\tif (player != _status.event.getTrigger().player) return card != player.getEquip('shanrangzhaoshu');\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif (result.cards && result.cards.length) target.gain(result.cards, player, 'giveAuto');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tlingsheji: {\r\n\t\t\t\ttrigger: { player: 'phaseUseEnd' },\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list = ['摸一张牌'];\r\n\t\t\t\t\tif (player.countCards('he') > 1) list.push('将一张牌置于武将牌上，于回合结束后获得之');\r\n\t\t\t\t\tplayer.chooseControl('cancel2').set('prompt', get.prompt('lingsheji')).set('choiceList', list).set('ai', function () {\r\n\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\tif (player.countCards('e', function (card) {\r\n\t\t\t\t\t\t\treturn card.name != 'tengjia' && get.value(card) <= 0;\r\n\t\t\t\t\t\t})) return 1;\r\n\t\t\t\t\t\tif (!player.needsToDiscard()) return 0;\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.control == 'cancel2') {\r\n\t\t\t\t\t\tevent.finish(); return;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.logSkill('lingsheji');\r\n\t\t\t\t\tif (result.index == 0) {\r\n\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.chooseCard('he', true, function (card, player) {\r\n\t\t\t\t\t\t\treturn card != player.getEquip(5);\r\n\t\t\t\t\t\t}).set('ai', function (card) {\r\n\t\t\t\t\t\t\tif (get.position(card) == 'e' && get.value(card) <= 0) return 10;\r\n\t\t\t\t\t\t\treturn (get.position(card) == 'h' ? 2 : 1) * -get.value(card);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tplayer.addSkill('lingsheji2');\r\n\t\t\t\t\tplayer.lose(result.cards, ui.special, 'toStorage');\r\n\t\t\t\t\tplayer.markAuto('lingsheji2', result.cards);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tlingsheji2: {\r\n\t\t\t\ttrigger: { player: 'phaseEnd' },\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.gain(player.getStorage('lingsheji2'), 'gain2', 'log');\r\n\t\t\t\t\tplayer.$.lingsheji2.length = 0;\r\n\t\t\t\t\tplayer.removeSkill('lingsheji2');\r\n\t\t\t\t},\r\n\t\t\t\tintro: { content: 'cards' },\r\n\t\t\t},\r\n\t\t\tnoda_axe: {\r\n\t\t\t\ttrigger: { player: 'useCardToPlayered' },\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.isPhaseUsing() && player != event.target && event.targets.length == 1 && player.countCards('he') > 2;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseToDiscard('he', get.prompt('noda_axe', trigger.target), 2, '弃置两张牌，令' + get.translation(trigger.target) + '本回合内不能使用或打出牌且防具技能无效。', function (card, player) {\r\n\t\t\t\t\t\treturn card != player.getEquip(1);\r\n\t\t\t\t\t}).set('logSkill', ['noda_axe', trigger.target]).set('goon', function (event, player) {\r\n\t\t\t\t\t\tif (player.hasSkill('noda_axe2')) return false;\r\n\t\t\t\t\t\tif (event.getParent().excluded.contains(player)) return false;\r\n\t\t\t\t\t\tif (get.attitude(event.player, player) > 0) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (get.type(event.card) == 'trick' && event.player.hasWuxie()) return true;\r\n\t\t\t\t\t\tif (get.tag(event.card, 'respondSha')) {\r\n\t\t\t\t\t\t\tif (!player.hasSha()) return false;\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (get.tag(event.card, 'respondShan')) {\r\n\t\t\t\t\t\t\tif (!player.hasShan()) return false;\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}(trigger, trigger.target)).set('ai', function (card) {\r\n\t\t\t\t\t\tif (_status.event.goon) return 7.5 - get.value(card);\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) trigger.target.addTempSkill('noda_axe2');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tnoda_axe2: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tcardEnabled: function () { return false },\r\n\t\t\t\t\tcardSavable: function () { return false },\r\n\t\t\t\t\tcardRespondable: function () { return false },\r\n\t\t\t\t},\r\n\t\t\t\tmark: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: '不能使用或打出牌且防具技能无效直到回合结束',\r\n\t\t\t\t},\r\n\t\t\t\tai: { unequip2: true },\r\n\t\t\t},\r\n\t\t\tiwasawa_crowbow: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: { player: 'loseAfter' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.hs && event.hs.length > 1 && player.isPhaseUsing();\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.num = trigger.hs.length;\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('iwasawa_crowbow'), '弃置一名其他角色的' + get.cnNumber(event.num) + '张牌', function (card, player, target) {\r\n\t\t\t\t\t\treturn player != target && target.countDiscardableCards(player, 'he') > 0;\r\n\t\t\t\t\t}).set('ai', function (target) {\r\n\t\t\t\t\t\tvar att = get.attitude(_status.event.player, target);\r\n\t\t\t\t\t\tif (target.countDiscardableCards(_status.event.player, 'he') >= _status.event.getParent().num) att = att * 2;\r\n\t\t\t\t\t\treturn -att;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tvar target = result.targets[0];\r\n\t\t\t\t\t\tplayer.logSkill('iwasawa_crowbow', target);\r\n\t\t\t\t\t\tplayer.discardPlayerCard(target, 'he', true, num);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_panguan: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\ttargetEnabled: function (card) {\r\n\t\t\t\t\t\tif (get.type(card) == 'delay') return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_juhun: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\ttarget[['turnOver', 'link'].randomGet()]();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_wangxiang: {\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tgame.countPlayer(function (current) {\r\n\t\t\t\t\t\tif (current != player && current.countCards('e')) {\r\n\t\t\t\t\t\t\tplayer.line(current);\r\n\t\t\t\t\t\t\tcurrent.discard(current.getCards('e'));\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_xhuanren: {\r\n\t\t\t\tnobracket: true,\r\n\t\t\t\tglobal: 'boss_xhuanren2'\r\n\t\t\t},\r\n\t\t\tboss_xhuanren2: {\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\tif (_status.shidianyanluo_level == undefined) return false;\r\n\t\t\t\t\treturn player == game.boss;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar next = game.createEvent('shidianyanluo_huanren', false, trigger.getParent());\r\n\t\t\t\t\tnext.player = player;\r\n\t\t\t\t\tnext.forceDie = true;\r\n\t\t\t\t\tnext.setContent(lib.skill.boss_xhuanren2.contentx);\r\n\t\t\t\t},\r\n\t\t\t\tcontentx: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list = [\r\n\t\t\t\t\t\t['boss_chujiangwang', 'boss_songdiwang', 'boss_wuguanwang', 'boss_yanluowang'],\r\n\t\t\t\t\t\t['boss_bianchengwang', 'boss_taishanwang', 'boss_dushiwang', 'boss_pingdengwang'],\r\n\t\t\t\t\t\t['boss_zhuanlunwang'],\r\n\t\t\t\t\t][_status.shidianyanluo_level];\r\n\t\t\t\t\tif (list.length == 1) event._result = { control: list[0] };\r\n\t\t\t\t\telse player.chooseControl(list).set('prompt', '请选择下一个出战的角色').set('forceDie', true).ai = function () {\r\n\t\t\t\t\t\treturn list.randomGet();\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\t_status.shidianyanluo_level++;\r\n\t\t\t\t\tgame.changeBoss(result.control);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_newhuanren: {\r\n\t\t\t\tnobracket: true,\r\n\t\t\t\tglobal: 'boss_newhuanren2',\r\n\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tsuperCharlotte: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (get.mode() != 'boss') return;\r\n\t\t\t\t\t//孟婆\r\n\t\t\t\t\tif (!_status.shidianyanluo_mengpo && Math.random() <= 0.4) {\r\n\t\t\t\t\t\tif (game.me != game.boss) {\r\n\t\t\t\t\t\t\tgame.boss.changeSeat(6);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tgame.boss.nextSeat.changeSeat(3);\r\n\t\t\t\t\t\t\tgame.boss.previousSeat.changeSeat(5);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//\tgame.addBossFellow(game.me==game.boss?1:7,'boss_mengpo');\r\n\t\t\t\t\t\tvar fellow = game.addFellow(game.me == game.boss ? 1 : 7, 'boss_mengpo', 'zoominanim');\r\n\t\t\t\t\t\tif (_status.shidianyanluo_level != 0) {\r\n\t\t\t\t\t\t\tfellow.directgain(get.cards(4));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfellow.side = true;\r\n\t\t\t\t\t\tfellow.identity = 'zhong';\r\n\t\t\t\t\t\tfellow.setIdentity('zhong');\r\n\t\t\t\t\t\tgame.addVideo('setIdentity', fellow, 'zhong');\r\n\t\t\t\t\t\t_status.shidianyanluo_mengpo = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list = ['luxun', 're_luxun', 'zhangchunhua', 'zuoci', 're_zuoci', 're_yuji', 'xin_yuji', 'jiangfei', 'kongrong'];//禁将\r\n\t\t\t\t\tgame.countPlayer(function (current) {\r\n\t\t\t\t\t\tif (current != game.boss) {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\t\tif (current.name == list[i] || current.name2 == list[i]) { current.init('sunce'); }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_newhuanren2: {\r\n\t\t\t\ttrigger: { global: ['die'] },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\tif (_status.shidianyanluo_level == undefined) return false;\r\n\t\t\t\t\treturn player == game.boss && event.player == player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar next = game.createEvent('shidianyanluo_huanren', false, trigger.getParent());\r\n\t\t\t\t\tnext.player = player;\r\n\t\t\t\t\tnext.forceDie = true;\r\n\t\t\t\t\tnext.setContent(lib.skill.boss_newhuanren2.contentx);\r\n\t\t\t\t},\r\n\t\t\t\tcontentx: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\tvar list = game.filterPlayer();\r\n\t\t\t\t\tfor (var x = 0; x < list.length; x++) {\r\n\t\t\t\t\t\tlist[x].removeSkill('diaohulishan');\r\n\t\t\t\t\t\tlist[x].removeSkill('guogong2');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list = game.boss.getEnemies();\r\n\t\t\t\t\tfor (var x = 0; x < list.length; x++) {\r\n\t\t\t\t\t\tlist[x].removeSkill('boss_wangshi2');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list = [\r\n\t\t\t\t\t\t['boss_chujiangwang', 'boss_songdiwang', 'boss_wuguanwang', 'boss_yanluowang'],\r\n\t\t\t\t\t\t['boss_bianchengwang', 'boss_taishanwang', 'boss_dushiwang', 'boss_pingdengwang'],\r\n\t\t\t\t\t\t['boss_zhuanlunwang'],\r\n\t\t\t\t\t][_status.shidianyanluo_level];\r\n\t\t\t\t\t//如果mengpo死亡且50回合内通过第三关，list[2]变成地藏王\r\n\t\t\t\t\tif (game.phaseNumber <= 50 && _status.shidianyanluo_level == 2 && _status.shidianyanluo_mengpodie == true) {\r\n\t\t\t\t\t\tlist = ['boss_dizangwang'];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (list.length == 1) event._result = { control: list[0] };\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.chooseControl(list).set('forceDie', true).set('choice', list.randomGet()).set('ai', function () { return _status.event.choice }).prompt = '选择下一个登场的武将';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\t_status.shidianyanluo_level++;\r\n\t\t\t\t\tgame.changeBoss(result.control);\r\n\t\t\t\t\t//地藏王登场摸3\r\n\t\t\t\t\tif (result.control == 'boss_dizangwang') { game.boss.draw(3); }\r\n\t\t\t\t\t//计回合数\r\n\t\t\t\t\tvar level = _status.shidianyanluo_level;\r\n\t\t\t\t\t//孟婆\r\n\t\t\t\t\tif (!_status.shidianyanluo_mengpo) {\r\n\t\t\t\t\t\tif (Math.random() <= 0.5 || level == 2) {\r\n\t\t\t\t\t\t\tif (game.me != game.boss) {\r\n\t\t\t\t\t\t\t\tgame.boss.changeSeat(6);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tgame.boss.nextSeat.changeSeat(3);\r\n\t\t\t\t\t\t\t\tgame.boss.previousSeat.changeSeat(5);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t//game.addBossFellow();\r\n\t\t\t\t\t\t\tvar fellow = game.addFellow(game.me == game.boss ? 1 : 7, 'boss_mengpo', 'zoominanim');\r\n\t\t\t\t\t\t\tif (_status.shidianyanluo_level != 0) {\r\n\t\t\t\t\t\t\t\tfellow.directgain(get.cards(4));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfellow.side = true;\r\n\t\t\t\t\t\t\tfellow.identity = 'zhong';\r\n\t\t\t\t\t\t\tfellow.setIdentity('zhong');\r\n\t\t\t\t\t\t\tgame.addVideo('setIdentity', fellow, 'zhong');\r\n\t\t\t\t\t\t\t_status.shidianyanluo_mengpo = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t//移除孟婆\r\n\t\t\t\t\t\tgame.countPlayer2(function (current) {\r\n\t\t\t\t\t\t\tif (current.name == 'boss_mengpo') {\r\n\t\t\t\t\t\t\t\tcurrent.removed = true;\r\n\t\t\t\t\t\t\t\tcurrent.classList.add('dead');\r\n\t\t\t\t\t\t\t\tcurrent.remove();\r\n\t\t\t\t\t\t\t\tgame.players.remove(current);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//然后是boss进行回合\r\n\t\t\t\t\tgame.phaseLoop(game.boss);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bingfeng: {\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.source && !event.source.isTurnedOver();\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'source',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.source.turnOver();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_heisheng: {\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.line(game.players.slice(0));\r\n\t\t\t\t\tgame.countPlayer(function (current) {\r\n\t\t\t\t\t\tif (current != player) current.link();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_shengfu: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tgame.countPlayer(function (current) {\r\n\t\t\t\t\t\tif (current == player) return;\r\n\t\t\t\t\t\tvar es = current.getCards('e', { subtype: ['equip3', 'equip4', 'equip6'] })\r\n\t\t\t\t\t\tif (es.length) list.push([current, es]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_heisheng');\r\n\t\t\t\t\t\tvar current = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(current[0]);\r\n\t\t\t\t\t\tcurrent[0].discard(current[1].randomGet());\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_zhiwang: {\r\n\t\t\t\tderivation: 'boss_zhiwang_planetarian',\r\n\t\t\t\ttrigger: { global: 'gainEnd' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player != player && !(event.getParent().name == 'draw' && event.getParent(2).name == 'phaseDraw') && event.player.countCards('h');\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tlogTarget: 'player',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar evt = trigger.getParent('boss_zhiwang');\r\n\t\t\t\t\tif (evt && evt.name == 'boss_zhiwang') {\r\n\t\t\t\t\t\ttrigger.player.uninit();\r\n\t\t\t\t\t\ttrigger.player.init('sunce');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar hs = trigger.player.getCards('h');\r\n\t\t\t\t\tif (hs.length) {\r\n\t\t\t\t\t\ttrigger.player.discard(hs.randomGet());\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill: { planetarian: {} },\r\n\t\t\t},\r\n\t\t\tboss_gongzheng: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('j') > 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.discard(player.getCards('j').randomGet())\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_xuechi: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\ttarget.loseHp(2);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_tiemian: {\r\n\t\t\t\tinherit: 'renwang_skill',\r\n\t\t\t\tpriority: -0.3,\r\n\t\t\t\tequipSkill: false,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (!player.isEmpty(2)) return false;\r\n\t\t\t\t\treturn lib.skill.renwang_skill.filter.apply(this, arguments);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_zhadao: {\r\n\t\t\t\tinherit: 'qinggang_skill',\r\n\t\t\t\tequipSkill: false,\r\n\t\t\t},\r\n\t\t\tboss_zhuxin: {\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseTarget('【诛心】：请选择一名角色，令其受到2点伤害。', function (card, player, target) {\r\n\t\t\t\t\t\treturn target != player && !game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current != player && current != target && current.hp < target.hp;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}).set('forceDie', true).ai = function (target) {\r\n\t\t\t\t\t\treturn -get.attitude(_status.event.player, target);\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tvar target = result.targets[0];\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\ttarget.damage(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_leizhou: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\ttarget.damage('thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_leifu: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\ttarget.link();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_leizhu: {\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tlist.sort(lib.sort.seat);\r\n\t\t\t\t\t\tplayer.line(list);\r\n\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\tlist[i].damage('thunder');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_fudu: {\r\n\t\t\t\ttrigger: { global: 'useCard' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.card.name == 'tao' && event.player != player && game.players.length > 2;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tlist.remove(trigger.player);\r\n\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\ttarget.loseHp();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_kujiu: {\r\n\t\t\t\ttrigger: { global: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player != player;\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'player',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\ttrigger.player.loseHp();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\ttrigger.player.useCard({ name: 'jiu' }, trigger.player);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_renao: {\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\ttarget.damage(3, 'fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_remen: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: { target: ['useCardToBefore'] },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: 6,\r\n\t\t\t\taudio: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (!player.isEmpty('equip2')) return false;\r\n\t\t\t\t\tif (event.card.name == 'nanman') return true;\r\n\t\t\t\t\tif (event.card.name == 'wanjian') return true;\r\n\t\t\t\t\treturn event.card.name == 'sha' && !get.nature(event.card);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target, current) {\r\n\t\t\t\t\t\t\tif (!target.isEmpty('equip2')) return;\r\n\t\t\t\t\t\t\tif (card.name == 'nanman' || card.name == 'wanjian') return 'zerotarget';\r\n\t\t\t\t\t\t\tif (card.name == 'sha') {\r\n\t\t\t\t\t\t\t\tvar equip1 = player.getEquip(1);\r\n\t\t\t\t\t\t\t\tif (equip1 && equip1.name == 'zhuque') return 1.9;\r\n\t\t\t\t\t\t\t\tif (!card.nature) return 'zerotarget';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zhifen: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\tevent.target = target;\r\n\t\t\t\t\t\tif (target.countGainableCards(player, 'h')) player.gainPlayerCard(target, 'h', true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\ttarget.damage('fire');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tboss_huoxing: {\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tlist.sort(lib.sort.seat);\r\n\t\t\t\t\t\tplayer.line(list);\r\n\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\tlist[i].damage('fire');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_suozu: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tlist.sort(lib.sort.seat);\r\n\t\t\t\t\t\tplayer.line(list);\r\n\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\tlist[i].link();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_abi: {\r\n\t\t\t\ttrigger: { player: 'damageEnd' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.source != undefined;\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'source',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.source.damage().nature = ['fire', 'thunder'].randomGet();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_pingdeng: {\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player && !game.hasPlayer(function (current2) {\r\n\t\t\t\t\t\t\treturn current2.hp > current.hp;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet()\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\ttarget.damage(2).nature = lib.linked.randomGet();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player && !game.hasPlayer(function (current2) {\r\n\t\t\t\t\t\t\treturn current2.hp > current.hp;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\ttarget.damage().nature = lib.linked.randomGet();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_lunhui: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.hp <= 2 && game.hasPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player && current.hp > 2;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player && current.hp > 2;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\tvar hp1 = player.hp;\r\n\t\t\t\t\t\tvar hp2 = target.hp;\r\n\t\t\t\t\t\tplayer.hp = Math.min(player.maxHp, hp2);\r\n\t\t\t\t\t\ttarget.hp = Math.min(target.maxHp, hp1);\r\n\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t\ttarget.update();\r\n\t\t\t\t\t\tgame.log(player, '和', target, '交换了体力值')\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_wangsheng: {\r\n\t\t\t\ttrigger: { player: 'phaseUseBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar name = ['nanman', 'wanjian'].randomGet();\r\n\t\t\t\t\tplayer.useCard({ name: name }, game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn player.canUse({ name: name }, current)\r\n\t\t\t\t\t}), 'noai');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_zlfanshi: {\r\n\t\t\t\ttrigger: { player: 'damageEnd' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (player.hasSkill('boss_zlfanshi_terra')) {\r\n\t\t\t\t\t\tvar list = game.players.slice(0);\r\n\t\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\t\ttarget.damage();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse player.addTempSkill('boss_zlfanshi_terra');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_zlfanshi_terra: { charlotte: true },\r\n\t\t\t//孟婆:\r\n\t\t\t\"boss_shiyou\": {\r\n\t\t\t\taudio: true,\r\n\t\t\t\ttrigger: { global: 'loseEnd' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tvar evt = event.getParent(3);\r\n\t\t\t\t\treturn event.type == 'discard' && evt.name == 'phaseDiscard' && evt.player == event.player && evt.player != player && event.cards2 && event.cards2.filterInD('d').length > 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.cards = trigger.cards2.filterInD('d');\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tvar next = player.chooseCardButton(get.prompt('boss_shiyou'), event.cards, [1, event.cards.length]).set('ai', function (button) {\r\n\t\t\t\t\t\treturn get.value(button.link, player);\r\n\t\t\t\t\t}).set('filterButton', function (button) {\r\n\t\t\t\t\t\tfor (var i = 0; i < ui.selected.buttons.length; i++) {\r\n\t\t\t\t\t\t\tif (get.suit(ui.selected.buttons[i].link) == get.suit(button.link)) return false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.gain(result.links, 'gain2', 'log');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_wangshi\": {\r\n\t\t\t\ttrigger: { global: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\taudio: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (player.getEnemies().contains(event.player)) { return true; }\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'player',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = ['basic', 'trick', 'equip'].randomGet();\r\n\t\t\t\t\ttrigger.player.addTempSkill('boss_wangshi2');\r\n\t\t\t\t\ttrigger.player.$.boss_wangshi2 = [list];\r\n\t\t\t\t\tgame.log(trigger.player, '本回合不能使用或打出', list, '牌');\r\n\t\t\t\t\ttrigger.player.markSkill('boss_wangshi2');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_wangshi2\": {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: function (storage) {\r\n\t\t\t\t\t\treturn '不能使用或打出' + get.translation(storage) + '牌';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinit: function (player, skill) {\r\n\t\t\t\t\tif (!player.storage[skill]) player.storage[skill] = [];\r\n\t\t\t\t},\r\n\t\t\t\t//mark:true,\r\n\t\t\t\tonremove: true,\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tcardEnabled2: function (card, player) {\r\n\t\t\t\t\t\tif (player.$.boss_wangshi2.contains(get.type(card, 'trick'))) return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_mengpohuihun1\": {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer: 'loseEnd',\r\n\t\t\t\t\tglobal: 'cardsDiscardEnd',\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tfor (var i = 0; i < event.cards.length; i++) {\r\n\t\t\t\t\t\tif (event.cards[i].name == 'boss_mengpohuihun' && get.position(event.cards[i], true) == 'd') {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar cards = [];\r\n\t\t\t\t\tfor (var i = 0; i < trigger.cards.length; i++) {\r\n\t\t\t\t\t\tif (trigger.cards[i].name == 'boss_mengpohuihun' && get.position(trigger.cards[i]) == 'd') {\r\n\t\t\t\t\t\t\tcards.push(trigger.cards[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (cards.length) {\r\n\t\t\t\t\t\tgame.cardsGotoSpecial(cards);\r\n\t\t\t\t\t\tgame.log(cards, '已被移出游戏');\r\n\t\t\t\t\t\tplayer.popup('回魂');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_wanghun\": {\r\n\t\t\t\taudio: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\ttrigger: { player: 'die' },\r\n\t\t\t\tforceDie: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t_status.shidianyanluo_mengpodie = true;\r\n\t\t\t\t\tvar list = player.getEnemies();\r\n\t\t\t\t\tif (list.length > 0) {\r\n\t\t\t\t\t\tfor (var x = 0; x < list.length; x++) {\r\n\t\t\t\t\t\t\tlist[x].removeSkill('boss_wangshi2');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar ran1 = list.randomGet();//第一个角色\r\n\t\t\t\t\t\tlist.remove(ran1);//移除\r\n\t\t\t\t\t\tvar skills1 = ran1.getSkills(true, false);\r\n\t\t\t\t\t\tif (skills1.length) {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < skills1.length; i++) {\r\n\t\t\t\t\t\t\t\tif (get.skills[i] || lib.skill[skills1[i]].charlotte || !lib.translate[skills1[i] + '_info'] || lib.skill[skills1[i]].zhuSkill == true) {\r\n\t\t\t\t\t\t\t\t\tskills1.splice(i--, 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}//排除技能，然后随机失去一个可以失去的技能\r\n\t\t\t\t\t\t\tif (skills1.length > 0) {\r\n\t\t\t\t\t\t\t\tskills1 = skills1.randomGet();\r\n\t\t\t\t\t\t\t\tran1.disableSkill('boss_wanghun', skills1);\r\n\t\t\t\t\t\t\t\tgame.log(ran1, '失去了', skills1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tgame.log(ran1, '没有技能可失去');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (list.length > 0) {\r\n\t\t\t\t\t\t\tvar ran2 = list.randomGet();//第二个角色\r\n\t\t\t\t\t\t\tlist.remove(ran2);//移除\r\n\t\t\t\t\t\t\tvar skills2 = ran2.getSkills(true, false);\r\n\t\t\t\t\t\t\tif (skills2.length) {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < skills2.length; i++) {\r\n\t\t\t\t\t\t\t\t\tif (get.skills[i] || lib.skill[skills2[i]].charlotte || !lib.translate[skills2[i] + '_info'] || lib.skill[skills2[i]].zhuSkill == true) {\r\n\t\t\t\t\t\t\t\t\t\tskills2.splice(i--, 1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}//排除技能，然后随机失去一个可以失去的技能\r\n\t\t\t\t\t\t\t\tif (skills2.length > 0) {\r\n\t\t\t\t\t\t\t\t\tskills2 = skills2.randomGet();\r\n\t\t\t\t\t\t\t\t\tran2.disableSkill('boss_wanghun', skills2);\r\n\t\t\t\t\t\t\t\t\tgame.log(ran2, '失去了', skills2);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tgame.log(ran2, '没有技能可失去');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//添加两张回魂\t\t\t\r\n\t\t\t\t\t\tif (get.mode() == 'boss') {\r\n\t\t\t\t\t\t\tvar card1 = game.createCard('boss_mengpohuihun', 'heart', 3, null);\r\n\t\t\t\t\t\t\tvar card2 = game.createCard('boss_mengpohuihun', 'club', 4, null);\r\n\t\t\t\t\t\t\tvar a = [];\r\n\t\t\t\t\t\t\tif (ui.cardPile.childElementCount < 3) {\r\n\t\t\t\t\t\t\t\tgame.boss.getCards(4);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor (var i = 0; i < ui.cardPile.childElementCount; i++) {\r\n\t\t\t\t\t\t\t\ta.push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.cardPile.insertBefore(card1, ui.cardPile.childNodes[a.randomGet()]);\r\n\t\t\t\t\t\t\ta.push(a.length);\r\n\t\t\t\t\t\t\tui.cardPile.insertBefore(card2, ui.cardPile.childNodes[a.randomGet()]);\r\n\t\t\t\t\t\t\tgame.log('牌堆中添加了', card1, card2);\r\n\t\t\t\t\t\t\tgame.updateRoundNumber();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//地藏王:\r\n\t\t\t\"boss_bufo\": {\r\n\t\t\t\taudio: true,\r\n\t\t\t\tforced: true,\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer: ['damageBegin4', 'phaseZhunbeiBegin'],\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player, name) {\r\n\t\t\t\t\tif (name == 'damageBegin4') { return event.num && event.num > 1; }\r\n\t\t\t\t\treturn game.hasPlayer(function (target) {\r\n\t\t\t\t\t\treturn player != target && get.distance(player, target) <= 1;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar name = event.triggername;\r\n\t\t\t\t\tif (name == 'damageBegin4') {\r\n\t\t\t\t\t\ttrigger.num--; return;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.countPlayer(function (target) {\r\n\t\t\t\t\t\t\tif (player != target && get.distance(player, target) <= 1) {\r\n\t\t\t\t\t\t\t\ttarget.damage(1, player, 'fire');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_wuliang\": {\r\n\t\t\t\tforced: true,\r\n\t\t\t\taudio: true,\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tglobal: \"gameDrawAfter\",\r\n\t\t\t\t\tplayer: ['phaseZhunbeiBegin', 'phaseJieshuBegin', 'enterGame'],\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player, name) {\r\n\t\t\t\t\tif (name == 'gameDrawAfter' || name == 'enterGame') {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (name == 'phaseZhunbeiBegin') {\r\n\t\t\t\t\t\treturn player.hp < 3;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar name = event.triggername;\r\n\t\t\t\t\tif (name == 'phaseZhunbeiBegin') {\r\n\t\t\t\t\t\tplayer.recover(3 - player.hp); return;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.draw((name == 'gameDrawAfter' || name == 'enterGame') ? 3 : 2);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_dayuan\": {\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tglobal: \"judge\",\r\n\t\t\t\t},\r\n\t\t\t\taudio: true,\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tlastDo: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar card = trigger.player.judging[0];\r\n\t\t\t\t\tvar judge0 = trigger.judge(card);\r\n\t\t\t\t\tvar judge1 = 0;\r\n\t\t\t\t\tvar choice = 'cancel2';\r\n\t\t\t\t\tevent.suitchoice = 'cancel2';\r\n\t\t\t\t\tvar attitude = get.attitude(player, trigger.player);\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tevent.suitx = ['heart', 'diamond', 'club', 'spade'];\r\n\t\t\t\t\tfor (var x = 0; x < 4; x++) {\r\n\t\t\t\t\t\tfor (var i = 1; i < 14; i++) {\r\n\t\t\t\t\t\t\tlist.add(i);\r\n\t\t\t\t\t\t\tvar judge2 = (trigger.judge({\r\n\t\t\t\t\t\t\t\tname: get.name(card),\r\n\t\t\t\t\t\t\t\tsuit: event.suitx[x],\r\n\t\t\t\t\t\t\t\tnumber: i,\r\n\t\t\t\t\t\t\t\tnature: get.nature(card),\r\n\t\t\t\t\t\t\t}) - judge0) * attitude;\r\n\t\t\t\t\t\t\tif (judge2 > judge1) {\r\n\t\t\t\t\t\t\t\tchoice = i;\r\n\t\t\t\t\t\t\t\tevent.suitchoice = event.suitx[x];\r\n\t\t\t\t\t\t\t\tjudge1 = judge2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.push('cancel2');\r\n\t\t\t\t\tevent.suitx.push('cancel2');\r\n\t\t\t\t\tplayer.chooseControl(list).set('ai', function () {\r\n\t\t\t\t\t\treturn _status.event.choice;\r\n\t\t\t\t\t}).set('choice', choice).prompt = get.prompt2(event.name);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.control != 'cancel2') {\r\n\t\t\t\t\t\tif (!event.logged) {\r\n\t\t\t\t\t\t\tevent.logged = true;\r\n\t\t\t\t\t\t\tplayer.logSkill(event.name, trigger.player);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.log(trigger.player, '判定结果点数为', '#g' + result.control);\r\n\t\t\t\t\t\tplayer.popup(result.control, 'fire');\r\n\t\t\t\t\t\tif (!trigger.fixedResult) trigger.fixedResult = {};\r\n\t\t\t\t\t\ttrigger.fixedResult.number = result.control;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.chooseControl(event.suitx).set('ai', function () {\r\n\t\t\t\t\t\treturn _status.event.choice;\r\n\t\t\t\t\t}).set('choice', event.suitchoice).prompt = get.prompt2(event.name);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (result.control != 'cancel2') {\r\n\t\t\t\t\t\tif (!event.logged) {\r\n\t\t\t\t\t\t\tevent.logged = true;\r\n\t\t\t\t\t\t\tplayer.logSkill(event.name, trigger.player);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.log(trigger.player, '判定结果花色为', '#g' + result.control);\r\n\t\t\t\t\t\tplayer.popup(result.control, 'fire');\r\n\t\t\t\t\t\tif (!trigger.fixedResult) trigger.fixedResult = {};\r\n\t\t\t\t\t\ttrigger.fixedResult.suit = result.control;\r\n\t\t\t\t\t\tif (result.control == 'club' || result.control == 'spade') {\r\n\t\t\t\t\t\t\ttrigger.fixedResult.color = 'black';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (result.control == 'heart' || result.control == 'diamond') {\r\n\t\t\t\t\t\t\ttrigger.fixedResult.color = 'red';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_diting\": {\r\n\t\t\t\taudio: true,\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tglobalFrom: function (from, to, distance) {\r\n\t\t\t\t\t\treturn distance - 1;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tglobalTo: function (from, to, distance) {\r\n\t\t\t\t\t\treturn distance + 1;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.$disableEquip('equip3');\r\n\t\t\t\t\tplayer.$disableEquip('equip4');\r\n\t\t\t\t},\r\n\t\t\t\tenable: \"phaseUse\",\r\n\t\t\t\tposition: 'h',\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('he', { subtype: ['equip3', 'equip4', 'equip6'] }) > 0;\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard: function (card) {\r\n\t\t\t\t\treturn get.subtype(card) == 'equip3' || get.subtype(card) == 'equip4' || get.subtype(card) == 'equip6';\r\n\t\t\t\t},\r\n\t\t\t\tcheck: function (card) {\r\n\t\t\t\t\tif (_status.event.player.isDisabled(get.subtype(card))) return 5;\r\n\t\t\t\t\treturn 3 - get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t},\r\n\t\t\t\tdiscard: false,\r\n\t\t\t\tvisible: true,\r\n\t\t\t\tloseTo: 'discardPile',\r\n\t\t\t\tprompt: \"将一张坐骑牌置入弃牌堆并摸一张牌\",\r\n\t\t\t\tdelay: 0.5,\r\n\t\t\t\tprepare: function (cards, player) {\r\n\t\t\t\t\tplayer.$throw(cards, 1000);\r\n\t\t\t\t\tgame.log(player, '将', cards, '置入了弃牌堆');\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\torder: 10,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\tplayer: 1,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t/*\r\n\t\t\t\"boss_sdyl_level\":{\r\n\t\t\ttrigger:{global:'gameStart'},\r\n\t\t\tforced:true,\r\n\t\t\tsuperCharlotte:true,\r\n   charlotte:true,\r\n   fixed:true,\r\n\t\t\tcontent:function(){},\r\n\t\t\tcontentplayer:function(player){\t\t\t\r\n\t\t\tvar list=[1,2,3,4,5];\r\n\t\t\tvar list2=[\"boss_sdyl_playerlevel1\",\"boss_sdyl_playerlevel2\",\"boss_sdyl_playerlevel3\",\"boss_sdyl_playerlevel4\",\"boss_sdyl_playerlevel5\"];\r\n\t\t\tplayer.removeAdditionalSkill('boss_sdyl_level');\r\n\t\t\tvar num=list.randomGet();\r\n\t\t\tplayer.$.boss_sdyl_level=num;\r\n\t\t\t\tvar list3=list2.concat();\r\n\t\t\tlist3.length=num;\r\n\t\t\tplayer.addAdditionalSkill('boss_sdyl_level',list3);\r\n\t\t\tgame.log(player,'的等阶为',num);\r\n\t\t\tif(num>1){\r\n\t\t\tvar a=function(card){\r\n\t\t\t\treturn get.type(card)=='equip';\r\n\t\t\t\t};\r\n\t\t\t\t\t\tfor(var i=0;i<ui.cardPile.childNodes.length;i++){\r\n\t\t\t\t\tif(a(ui.cardPile.childNodes[i])){\r\n\t\t\t\t\t\t\tplayer.chooseUseTarget(ui.cardPile.childNodes[i],'noanimate','nopopup',true);\r\n\t\t\t\t\t\t\tui.cardPile.removeChild(ui.cardPile.childNodes[i]);\r\n\t\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcontentboss:function(boss){\t\t\t\r\n\t\t\tvar list=[1,2,3,4,5];\r\n\t\t\tvar list2=[\"boss_sdyl_bosslevel1\",\"boss_sdyl_bosslevel2\",\"boss_sdyl_bosslevel3\",\"boss_sdyl_bosslevel4\",\"boss_sdyl_bosslevel5\"];\r\n\t\t\tboss.removeAdditionalSkill('boss_sdyl_level');\r\n\t\t\tvar num=list.randomGet();\r\n\t\t\tboss.$.boss_sdyl_level=num;\r\n\t\t\t\tvar list3=list2.concat();\r\n\t\t\tlist3.length=num;\r\n\t\t\tboss.addAdditionalSkill('boss_sdyl_level',list3);\r\n\t\t\tgame.log(boss,'的等阶为',num);\r\n\t\t\tif(num>1){\r\n\t\t\t\t\t\t\t\t\t\tvar a=function(card){\r\n\t\t\t\treturn get.type(card)=='equip';\r\n\t\t\t\t};\r\n\t\t\t\t\t\tfor(var i=0;i<ui.cardPile.childNodes.length;i++){\r\n\t\t\t\t\tif(a(ui.cardPile.childNodes[i])){\r\n\t\t\t\t\t\t\tboss.chooseUseTarget(ui.cardPile.childNodes[i],'noanimate','nopopup',true);\r\n\t\t\t\t\t\t\tui.cardPile.removeChild(ui.cardPile.childNodes[i]);\r\n\t\t\t\t\t\t\tboss.update();\r\n\t\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t},\r\n\t\t\t\t\"boss_sdyl_playerlevel1\":{\r\n\t\t\t\tfixed:true,\r\n\t\t\t\tglobalFixed:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\t},\r\n\t\t\t\t\"boss_sdyl_playerlevel3\":{\r\n\t\t\t\tfixed:true,\r\n\t\t\t\tglobalFixed:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tinit:function(player){\t\t\t\t\t\r\n\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmod:{\r\n\t\tcardUsable:function (card,player,num){\r\n\t\t\tif(card.name=='sha') return num+=1;\r\n\t\t},\r\n\t},\r\n\t\t\t\t},\r\n\t\t\t\t\"boss_sdyl_playerlevel2\":{\r\n\t\t\t\tfixed:true,\r\n\t\t\t\tglobalFixed:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\t},\r\n\t\t\t\t\"boss_sdyl_playerlevel4\":{\r\n\t\t\t\tfixed:true,\r\n\t\t\t\tglobalFixed:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\ttrigger:{player:'phaseDrawBegin2'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function (event,player){\r\n\t\treturn !event.numFixed;\r\n\t},\r\n\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\t\"boss_sdyl_playerlevel5\":{\r\n\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.$.boss_sdyl_playerlevel5=false;\t\r\n\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t},\r\n\t\t\t\t\taudio:'niepan',\r\n\t\t\t\tunique:true,\r\n\t\t\t\tenable:'chooseToUse',\r\n\t\t\t\tmark:true,\r\n\t\t\t\tskillAnimation:true,\r\n\t\t\t\tanimationStr:'重生',\r\n\t\t\t\tlimited:true,\r\n\t\t\t\tanimationColor:'orange',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(player.$.boss_sdyl_playerlevel5) return false;\r\n\t\t\t\t\tif(event.type=='dying'){\r\n\t\t\t\t\t\tif(player!=event.dying) return false;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.awakenSkill('boss_sdyl_playerlevel5');\r\n\t\t\t\t\tplayer.$.boss_sdyl_playerlevel5=true;\r\n\t\t\t\t\tplayer.discard(player.getCards('j'));\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.link(false);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tplayer.turnOver(false);\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tplayer.drawTo(Math.min(5,player.maxHp));\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tplayer.recover(player.maxHp-player.hp);\t\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:1,\r\n\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\tif(player.$.boss_sdyl_playerlevel5) return false;\r\n\t\t\t\t\t\tif(player.hp>0) return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsave:true,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player){\r\n\t\t\t\t\t\t\tif(player.hp<=0) return 10;\r\n\t\t\t\t\t\t\tif(player.hp<=2&&player.countCards('he')<=1) return 10;\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten:function(player,target){\r\n\t\t\t\t\t\tif(!target.$.boss_sdyl_playerlevel5) return 0.6;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'limited'\r\n\t\t\t\t}\t\t\r\n\t\t\t\t},\r\n\t\t\t\t\"boss_sdyl_bosslevel1\":{\r\n\t\t\t\tfixed:true,\r\n\t\t\t\tglobalFixed:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\t},\r\n\t\t\t\t\"boss_sdyl_bosslevel3\":{\r\n\t\t\t\tfixed:true,\r\n\t\t\t\tglobalFixed:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttrigger:{player:'phaseZhunbeiBegin'},\r\n\t\t\t\t\tforced:true,\r\n\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tvar card=get.cardPile('sha');\r\n\t\t\t\t\t\t\tif(card){\r\n\t\t\t\t\t\t\tplayer.gain(card);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmod:{\r\n\t\tcardUsable:function (card,player,num){\r\n\t\t\tif(card.name=='sha') return num+=1;\r\n\t\t},\r\n\t},\r\n\t\t\t\t},\r\n\t\t\t\t\"boss_sdyl_bosslevel2\":{\r\n\t\t\t\tfixed:true,\r\n\t\t\t\tglobalFixed:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\t},\r\n\t\t\t\t\"boss_sdyl_bosslevel4\":{\r\n\t\t\t\tfixed:true,\r\n\t\t\t\tglobalFixed:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\ttrigger:{player:'phaseDrawBegin2'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function (event,player){\r\n\t\treturn !event.numFixed;\r\n\t},\r\n\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\tmod:{\r\n\t\tmaxHandcard:function (player,num){\r\n\t\t  return num+=1;\r\n\t\t},\r\n\t},\r\n\t\t\t\t},\r\n\t\t\t\t\"boss_sdyl_bosslevel5\":{\r\n\t\t\t\tfixed:true,\r\n\t\t\t\tglobalFixed:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\tplayer.update();\r\n\t\t\t\t\tif(_status.shidianyanluo_level&&_status.shidianyanluo_level>0){\r\n\t\t\t\t\tvar players=game.filterPlayer(function(current){return current!=player;});\r\n\t\t\t\t\tplayer.useCard({name:'nanman'},false,players);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttrigger:{\r\n\t\tsource:\"damageBegin4\",\r\n\t\tplayer:\"useCardAfter\",\r\n\t\tglobal:'gameDrawAfter',\r\n\t},\r\n\tfilter:function (event,player,name){\r\n\t\tif(name=='gameDrawAfter'){\r\n\t\tif(!_status.shidianyanluo_level||_status.shidianyanluo_level==0){\r\n\t\t\t\t\t\t\t\tvar players=game.filterPlayer(function(current){return current!=player;});\r\n\t\t\t\t\t\t\t\tplayer.useCard({name:'nanman'},false,players);\r\n\t\t\t\t\t\t\t\t}\r\n\t\treturn false;\r\n\t\t}\r\n\t\tif(player.$.boss_sdyl_bosslevel5) return false;\r\n\t\tif(name=='damageBegin4'){\r\n\t\tif(!event.card||event.card.name!='nanman') return false;      \r\n\t\treturn true;\r\n\t\t}else if(name=='useCardAfter'){\r\n\t\tif(!event.card||event.card.name!='nanman') return false;      \r\n\t\tplayer.$.boss_sdyl_bosslevel5=true;\r\n\t\treturn false;\r\n\t\t}                \r\n\t},\r\n\tcontent:function (){  \r\n\ttrigger.num++;\r\n\t},\r\n\t\t\t\t},\r\n\t*/\r\n\t\t\t\"boss_jingjia\": {},\r\n\t\t\t\"boss_aozhan\": {\r\n\t\t\t\tforced: true,\r\n\t\t\t\tlocked: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tgroup: [\"boss_aozhan_wuqi\", \"boss_aozhan_fangju\", \"boss_aozhan_zuoji\", \"boss_aozhan_baowu\"],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\twuqi: {\r\n\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\tcardUsable: function (card, player, num) {\r\n\t\t\t\t\t\t\t\tif (player.getEquip(1) && card.name == 'sha') return num + 1;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfangju: {\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tplayer: \"damageBegin4\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.getEquip(2) && event.num > 1;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.num = 1;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tzuoji: {\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tplayer: \"phaseDrawBegin\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn (player.getEquip(3) || player.getEquip(4));\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbaowu: {\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tplayer: \"phaseJudgeBefore\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.getEquip(5);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\t\tgame.log(player, '跳过了判定阶段');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"shufazijinguan_skill\": {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer: \"phaseZhunbeiBegin\",\r\n\t\t\t\t},\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('shufazijinguan'), function (card, player, target) {\r\n\t\t\t\t\t\treturn player != target;\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\treturn get.damageEffect(target, player, player);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.line(result.targets, 'white');\r\n\t\t\t\t\t\tresult.targets[0].damage();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"linglongshimandai_skill\": {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\ttarget: \"useCardToTargeted\",\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (event.targets && event.targets.length > 1 || event.player == player) return false;\r\n\t\t\t\t\tif (player.hasSkillTag('unequip2')) return false;\r\n\t\t\t\t\tvar evt = event.getParent();\r\n\t\t\t\t\tif (evt.player && evt.player.hasSkillTag('unequip', false, {\r\n\t\t\t\t\t\tname: evt.card ? evt.card.name : null,\r\n\t\t\t\t\t\ttarget: player,\r\n\t\t\t\t\t\tcard: evt.card\r\n\t\t\t\t\t})) return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\taudio: true,\r\n\t\t\t\tcheck: function (event, player) {\r\n\t\t\t\t\treturn get.effect(player, event.card, event.player, player) <= 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.judge('linglongshimandai', function (card) { return (get.suit(card) == 'heart') ? 1.5 : -0.5 });\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.judge > 0) {\r\n\t\t\t\t\t\ttrigger.getParent().excluded.add(player);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target, effect) {\r\n\t\t\t\t\t\t\tif (player.hasSkillTag('unequip', false, {\r\n\t\t\t\t\t\t\t\tname: card ? card.name : null,\r\n\t\t\t\t\t\t\t\ttarget: player,\r\n\t\t\t\t\t\t\t\tcard: card\r\n\t\t\t\t\t\t\t})) return;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"hongmianbaihuapao_skill\": {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer: \"damageBegin4\",\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (event.source && event.source.hasSkillTag('unequip', false, {\r\n\t\t\t\t\t\tname: event.card ? event.card.name : null,\r\n\t\t\t\t\t\ttarget: player,\r\n\t\t\t\t\t\tcard: event.card\r\n\t\t\t\t\t})) return;\r\n\t\t\t\t\tif (event.nature) return true;\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tnofire: true,\r\n\t\t\t\t\tnothunder: true,\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target, current) {\r\n\t\t\t\t\t\t\tif (player.hasSkillTag('unequip', false, {\r\n\t\t\t\t\t\t\t\tname: card ? card.name : null,\r\n\t\t\t\t\t\t\t\ttarget: player,\r\n\t\t\t\t\t\t\t\tcard: card\r\n\t\t\t\t\t\t\t})) return;\r\n\t\t\t\t\t\t\tif (get.tag(card, 'natureDamage')) return 'zerotarget';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"wushuangfangtianji_skill\": {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tsource: \"damageSource\",\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.card && event.card.name == 'sha';\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.line(trigger.player, 'white');\r\n\t\t\t\t\tif (!trigger.player.countCards('he')) {\r\n\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tevent.goto(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tplayer.chooseControl('摸一张牌', '弃置其一张牌', function (event, player) {\r\n\t\t\t\t\t\tif (get.attitude(player, trigger.player) > 2) return '摸一张牌';\r\n\t\t\t\t\t\treturn '弃置其一张牌';\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif (result.control == '摸一张牌') {\r\n\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.discardPlayerCard(trigger.player, 'he', true);\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\r\n\t\t\tboss_yaoshou: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tglobalFrom: function (from, to, distance) {\r\n\t\t\t\t\t\treturn distance - 2;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_duqu: {\r\n\t\t\t\ttrigger: { player: 'damageEnd' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.source && !event.source.hasSkill('boss_duqu');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar target = trigger.source;\r\n\t\t\t\t\tif (!target.$.boss_shedu) target.$.boss_shedu = 0;\r\n\t\t\t\t\ttarget.$.boss_shedu++;\r\n\t\t\t\t\ttarget.markSkill('boss_shedu');\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tglobal: 'boss_shedu',\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tcardname: function (card, player) {\r\n\t\t\t\t\t\tif (card.name == 'tao') return 'sha';\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_shedu: {\r\n\t\t\t\ttrigger: { player: \"phaseBegin\" },\r\n\t\t\t\tmark: true,\r\n\t\t\t\tintro: { content: 'mark' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.$.boss_shedu && player.$.boss_shedu > 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar num = player.$.boss_shedu;\r\n\t\t\t\t\tevent.num = num;\r\n\t\t\t\t\tvar chs = get.cnNumber(num);\r\n\t\t\t\t\tplayer.chooseToDiscard('he', num, '弃置' + chs + '张牌，或失去' + chs + '点体力').ai = function (card) {\r\n\t\t\t\t\t\treturn 12 - get.value(card);\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (!result.bool) player.loseHp(num);\r\n\t\t\t\t\tplayer.$.boss_shedu--;\r\n\t\t\t\t\tif (num > 1) player.markSkill('boss_shedu');\r\n\t\t\t\t\telse player.unmarkSkill('boss_shedu');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_jiushou: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tmaxHandcard: function (player, num) {\r\n\t\t\t\t\t\treturn num - player.hp + 9;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { player: ['phaseUseBegin', 'phaseJieshuBegin', 'phaseDrawBegin'] },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.name == 'phaseDraw' || player.countCards('h') < 9;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (trigger.name == 'phaseDraw') trigger.cancel();\r\n\t\t\t\t\telse player.draw(9 - player.countCards('h'));\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_echou_switch: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tgroup: ['boss_echou_switch_on', 'boss_echou_switch_off'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\toff: {\r\n\t\t\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.disableSkill('boss_echou_awake', 'boss_echou');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ton: {\r\n\t\t\t\t\t\ttrigger: { player: 'changeHp' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.hp <= player.maxHp / 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\t\tanimationColor: 'thunder',\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.enableSkill('boss_echou_awake');\r\n\t\t\t\t\t\t\tplayer.removeSkill('boss_echou_switch');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_echou: {\r\n\t\t\t\ttrigger: { global: 'useCard' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn !event.player.hasSkill('boss_duqu') && ['tao', 'jiu'].contains(event.card.name);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar target = trigger.player;\r\n\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\tif (!target.$.boss_shedu) target.$.boss_shedu = 0;\r\n\t\t\t\t\ttarget.$.boss_shedu++;\r\n\t\t\t\t\ttarget.markSkill('boss_shedu');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_bingxian: {\r\n\t\t\t\ttrigger: { global: 'phaseJieshuBegin' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player != player && event.player.countUsed('sha', true) == 0;\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.useCard({ name: 'sha' }, trigger.player);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_juyuan: {\r\n\t\t\t\tinit: function (player, skill) {\r\n\t\t\t\t\tplayer.storage[skill] = 0;\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { player: 'phaseAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.$.boss_juyuan = player.hp;\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tselectTarget: function (card, player, range) {\r\n\t\t\t\t\t\tif (card.name != 'sha') return;\r\n\t\t\t\t\t\tif (range[1] == -1) return;\r\n\t\t\t\t\t\tif (player.hp >= player.$.boss_juyuan) return;\r\n\t\t\t\t\t\trange[1] += 2;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_xushi_switch: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tgroup: ['boss_xushi_switch_on', 'boss_xushi_switch_off'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\toff: {\r\n\t\t\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.disableSkill('boss_xushi_awake', 'boss_xushi');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ton: {\r\n\t\t\t\t\t\ttrigger: { player: 'changeHp' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.hp <= player.maxHp / 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\t\tanimationColor: 'thunder',\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.enableSkill('boss_xushi_awake');\r\n\t\t\t\t\t\t\tplayer.removeSkill('boss_xushi_switch');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xushi: {\r\n\t\t\t\ttrigger: { player: ['phaseUseEnd', 'turnOverEnd'] },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.name == 'phaseUse' || !player.isTurnedOver();\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif (trigger.name == 'phaseUse') {\r\n\t\t\t\t\t\tplayer.turnOver();\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current != player;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tevent.list.sort(lib.sort.seat);\r\n\t\t\t\t\t\tplayer.line(event.list, 'green');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar target = event.list.shift();\r\n\t\t\t\t\ttarget.damage([1, 2].randomGet());\r\n\t\t\t\t\tif (event.list.length) event.redo();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_zhaohuo: {\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer: 'damageBegin4',\r\n\t\t\t\t\tsource: 'damageBegin1',\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (player == event.player) return event.nature == 'fire' || player == event.source;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (player == trigger.player) trigger.cancel();\r\n\t\t\t\t\telse trigger.nature = 'fire';\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tunequip: true,\r\n\t\t\t\t\tskillTagFilter: function (player) {\r\n\t\t\t\t\t\tif (player != _status.currentPhase) return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_honglianx: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tignoredHandcard: function (card, player) {\r\n\t\t\t\t\t\tif (get.color(card) == 'red') {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcardDiscardable: function (card, player, name) {\r\n\t\t\t\t\t\tif (name == 'phaseDiscard' && get.color(card) == 'red') return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.num1 = 3;\r\n\t\t\t\t\tevent.num2 = [0, 1, 2, 3].randomGet();\r\n\t\t\t\t\tevent.togain = [];\r\n\t\t\t\t\twhile (event.togain.length < event.num2) {\r\n\t\t\t\t\t\tvar card = get.cardPile(function (card) {\r\n\t\t\t\t\t\t\treturn !event.togain.contains(card) && get.color(card) == 'red';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (card) event.togain.push(card);\r\n\t\t\t\t\t\telse break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.num1 -= event.togain.length;\r\n\t\t\t\t\tif (event.togain.length) player.gain(event.togain, 'draw');\r\n\t\t\t\t\tif (event.num1 == 0) event.finish();\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current != player;\r\n\t\t\t\t\t\t}).randomGets(event.num1).sortBySeat();\r\n\t\t\t\t\t\tplayer.line(event.list, 'fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar target = event.list.shift();\r\n\t\t\t\t\ttarget.damage('fire');\r\n\t\t\t\t\tif (event.list.length) event.redo();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_yanyu_switch: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tgroup: ['boss_yanyu_switch_on', 'boss_yanyu_switch_off'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\toff: {\r\n\t\t\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.disableSkill('boss_yanyu_awake', 'boss_yanyu');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ton: {\r\n\t\t\t\t\t\ttrigger: { player: 'changeHp' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.hp <= player.maxHp / 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\t\tanimationColor: 'thunder',\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.enableSkill('boss_yanyu_awake');\r\n\t\t\t\t\t\t\tplayer.removeSkill('boss_yanyu_switch');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_yanyu: {\r\n\t\t\t\tforced: true,\r\n\t\t\t\ttrigger: { global: 'phaseBegin' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player != event.player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.count = 3;\r\n\t\t\t\t\tplayer.line(trigger.player, 'fire');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.count--;\r\n\t\t\t\t\ttrigger.player.judge(function (card) {\r\n\t\t\t\t\t\tif (get.color(card) == 'red') return -5;\r\n\t\t\t\t\t\treturn 5;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (!result.bool) {\r\n\t\t\t\t\t\ttrigger.player.damage('fire');\r\n\t\t\t\t\t\tif (event.count) event.goto(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_fengdong: {\r\n\t\t\t\ttrigger: { player: \"phaseBegin\" },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tgame.countPlayer(function (current) {\r\n\t\t\t\t\t\tif (current != player) current.addTempSkill('fengyin');\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_xunyou: {\r\n\t\t\t\ttrigger: { global: 'phaseBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player != event.player\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player && current.countCards('hej');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(target, 'green');\r\n\t\t\t\t\t\tvar card = target.getCards('hej').randomGet();\r\n\t\t\t\t\t\tevent.card = card;\r\n\t\t\t\t\t\tplayer.gain(card, target);\r\n\t\t\t\t\t\ttarget.$giveAuto(card, player);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (player.getCards('h').contains(card) && get.type(card) == 'equip') player.chooseUseTarget(card, true, 'nopopup', 'noanimate');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_sipu_switch: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tgroup: ['boss_sipu_switch_on', 'boss_sipu_switch_off'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\toff: {\r\n\t\t\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.disableSkill('boss_sipu_awake', 'boss_sipu');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ton: {\r\n\t\t\t\t\t\ttrigger: { player: 'changeHp' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.hp <= player.maxHp / 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\t\tanimationColor: 'thunder',\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.enableSkill('boss_sipu_awake');\r\n\t\t\t\t\t\t\tplayer.removeSkill('boss_sipu_switch');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_sipu: {\r\n\t\t\t\tglobal: 'boss_sipu2',\r\n\t\t\t},\r\n\t\t\tboss_sipu2: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tcardEnabled: function (card, player) {\r\n\t\t\t\t\t\tvar sc = _status.currentPhase;\r\n\t\t\t\t\t\tif (sc && sc != player && sc.isPhaseUsing() && sc.hasSkill('boss_sipu') && !sc.hasSkill('boss_sipu_switch') && sc.countUsed() < 3) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcardUsable: function (card, player) {\r\n\t\t\t\t\t\tvar sc = _status.currentPhase;\r\n\t\t\t\t\t\tif (sc && sc != player && sc.isPhaseUsing() && sc.hasSkill('boss_sipu') && !sc.hasSkill('boss_sipu_switch') && sc.countUsed() < 3) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcardRespondable: function (card, player) {\r\n\t\t\t\t\t\tvar sc = _status.currentPhase;\r\n\t\t\t\t\t\tif (sc && sc != player && sc.isPhaseUsing() && sc.hasSkill('boss_sipu') && !sc.hasSkill('boss_sipu_switch') && sc.countUsed() < 3) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcardSavable: function (card, player) {\r\n\t\t\t\t\t\tvar sc = _status.currentPhase;\r\n\t\t\t\t\t\tif (sc && sc != player && sc.isPhaseUsing() && sc.hasSkill('boss_sipu') && !sc.hasSkill('boss_sipu_switch') && sc.countUsed() < 3) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t/*----分界线----*/\r\n\t\t\tboss_zirun: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tlogTarget: function () {\r\n\t\t\t\t\treturn game.filterPlayer();\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.filterPlayer().sortBySeat();\r\n\t\t\t\t\tgame.asyncDraw(list, function (current) {\r\n\t\t\t\t\t\tif (current.countCards('e')) return 2;\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_juehong: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tlogTarget: function (event, player) {\r\n\t\t\t\t\treturn player.getEnemies();\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.list = player.getEnemies().sortBySeat();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (event.list.length) {\r\n\t\t\t\t\t\tvar target = event.list.shift();\r\n\t\t\t\t\t\tif (target.countCards('he')) {\r\n\t\t\t\t\t\t\tvar es = target.getCards('e');\r\n\t\t\t\t\t\t\tif (es.length) {\r\n\t\t\t\t\t\t\t\ttarget.discard(es);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tplayer.discardPlayerCard(target, 'h', true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zaoyi: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\tvar list = ['boss_shuishenxuanming', 'boss_shuishengonggong'];\r\n\t\t\t\t\tif (list.contains(event.player.name)) {\r\n\t\t\t\t\t\treturn !game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn list.contains(current.name);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(4);\r\n\t\t\t\t\tplayer.addSkill('boss_zaoyi_hp');\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\thp: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tmark: true,\r\n\t\t\t\t\t\tintro: {\r\n\t\t\t\t\t\t\tcontent: '每个回合开始时使体力值最少的敌方角色失去所有体力'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tvar list = player.getEnemies();\r\n\t\t\t\t\t\t\tvar min = list[0].hp;\r\n\t\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\t\tif (list[i].hp < min) {\r\n\t\t\t\t\t\t\t\t\tmin = list[i].hp;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\t\tif (list[i].hp > min) {\r\n\t\t\t\t\t\t\t\t\tlist.splice(i--, 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.line(list, 'green');\r\n\t\t\t\t\t\t\tlist.sortBySeat();\r\n\t\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\t\tlist[i].loseHp(min);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\ttargetEnabled: function (card, player, target, now) {\r\n\t\t\t\t\t\tif (target.isEnemyOf(player)) {\r\n\t\t\t\t\t\t\tvar type = get.type(card, 'trick');\r\n\t\t\t\t\t\t\tif (type == 'trick') {\r\n\t\t\t\t\t\t\t\tif (game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\t\t\treturn current.name == 'boss_shuishenxuanming';\r\n\t\t\t\t\t\t\t\t})) {\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (type == 'basic') {\r\n\t\t\t\t\t\t\t\tif (game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\t\t\treturn current.name == 'boss_shuishengonggong';\r\n\t\t\t\t\t\t\t\t})) {\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_lingqu: {\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.$.boss_lingqu = 0;\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { player: 'damageEnd' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\tplayer.$.boss_lingqu++;\r\n\t\t\t\t\tplayer.markSkill('boss_lingqu');\r\n\t\t\t\t},\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: '手牌上限+#'\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tmaxHandcard: function (player, num) {\r\n\t\t\t\t\t\treturn num + player.$.boss_lingqu;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup: 'boss_lingqu_cancel',\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tcancel: {\r\n\t\t\t\t\t\ttrigger: { player: 'damageBegin4' },\r\n\t\t\t\t\t\tpriority: -11,\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\t\t\treturn event.num > 1;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.num = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baiyi: {\r\n\t\t\t\tgroup: ['boss_baiyi_draw', 'boss_baiyi_thunder', 'boss_baiyi_discard'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tdiscard: {\r\n\t\t\t\t\t\ttrigger: { global: 'roundStart' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function () {\r\n\t\t\t\t\t\t\treturn game.roundNumber == 5;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tlogTarget: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.getEnemies();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tevent.list = player.getEnemies();\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif (event.list.length) {\r\n\t\t\t\t\t\t\t\tevent.list.shift().chooseToDiscard('he', true, 2);\r\n\t\t\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdraw: {\r\n\t\t\t\t\t\ttrigger: { global: 'phaseDrawBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn game.roundNumber < 3 && event.player.isEnemyOf(player);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.num--\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthunder: {\r\n\t\t\t\t\t\ttrigger: { player: 'damageBegin4' },\r\n\t\t\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\t\t\treturn event.nature == 'thunder' && game.roundNumber < 7;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai: {\r\n\t\t\t\t\t\t\tnothunder: true,\r\n\t\t\t\t\t\t\tskillTagFilter: function () {\r\n\t\t\t\t\t\t\t\treturn game.roundNumber < 7;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\teffect: {\r\n\t\t\t\t\t\t\t\ttarget: function (card, player, target, current) {\r\n\t\t\t\t\t\t\t\t\tif (get.tag(card, 'thunderDamage') && game.roundNumber < 7) return 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qingzhu: {\r\n\t\t\t\ttrigger: { player: 'phaseDiscardBefore' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tcardEnabled: function (card, player) {\r\n\t\t\t\t\t\tif (card.name == 'sha' && _status.currentPhase == player &&\r\n\t\t\t\t\t\t\t_status.event.getParent('phaseUse') && !player.hasSkill('boss_jiding')) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jiazu: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tgetTargets: function (player) {\r\n\t\t\t\t\tvar targets = [];\r\n\t\t\t\t\ttargets.add(player.getNext());\r\n\t\t\t\t\ttargets.add(player.getPrevious());\r\n\t\t\t\t\tvar enemies = player.getEnemies();\r\n\t\t\t\t\tfor (var i = 0; i < targets.length; i++) {\r\n\t\t\t\t\t\tif (!enemies.contains(targets[i]) ||\r\n\t\t\t\t\t\t\t(!targets[i].getEquip(3) && !targets[i].getEquip(4))) {\r\n\t\t\t\t\t\t\ttargets.splice(i--, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn targets;\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn lib.skill.boss_jiazu.getTargets(player).length > 0;\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: function (event, player) {\r\n\t\t\t\t\treturn lib.skill.boss_jiazu.getTargets(player);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.list = lib.skill.boss_jiazu.getTargets(player).sortBySeat();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (event.list.length) {\r\n\t\t\t\t\t\tvar target = event.list.shift();\r\n\t\t\t\t\t\tvar cards = target.getCards('e', function (card) {\r\n\t\t\t\t\t\t\tvar subtype = get.subtype(card);\r\n\t\t\t\t\t\t\treturn subtype == 'equip3' || subtype == 'equip4';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (cards.length) {\r\n\t\t\t\t\t\t\ttarget.discard(cards);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jiding: {\r\n\t\t\t\ttrigger: { global: 'damageEnd' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tmark: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: 'info'\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player != player && event.player.isFriendOf(player) &&\r\n\t\t\t\t\t\tevent.source && event.source.isIn() && event.source.isEnemyOf(player);\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'source',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.useCard({ name: 'sha', nature: 'thunder' }, trigger.source);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.removeSkill('boss_jiding');\r\n\t\t\t\t},\r\n\t\t\t\tgroup: 'boss_jiding_recover',\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\trecover: {\r\n\t\t\t\t\t\ttrigger: { source: 'damageEnd' },\r\n\t\t\t\t\t\tsilent: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn event.getParent(3).name == 'boss_jiding';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\t\tif (game.players[i].name == 'boss_jinshenrushou') {\r\n\t\t\t\t\t\t\t\t\tgame.players[i].recover();\r\n\t\t\t\t\t\t\t\t\tplayer.line(game.players[i], 'green');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xingqiu: {\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.$.boss_xingqiu = false;\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tlocked: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif (player.$.boss_xingqiu) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_xingqiu');\r\n\t\t\t\t\t\tevent.list = player.getEnemies().sortBySeat();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.$.boss_xingqiu = !player.$.boss_xingqiu;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (event.list.length) {\r\n\t\t\t\t\t\tvar target = event.list.shift();\r\n\t\t\t\t\t\tif (!target.isLinked()) {\r\n\t\t\t\t\t\t\ttarget.link();\r\n\t\t\t\t\t\t\tplayer.line(target, 'green');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].name == 'boss_mingxingzhu') {\r\n\t\t\t\t\t\t\tgame.players[i].addSkill('boss_jiding');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_kuangxiao: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\ttargetInRange: function (card, player, target) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tselectTarget: function (card, player, range) {\r\n\t\t\t\t\t\tif (card.name == 'sha') {\r\n\t\t\t\t\t\t\trange[1] = -1;\r\n\t\t\t\t\t\t\trange[0] = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tplayerEnabled: function (card, player, target) {\r\n\t\t\t\t\t\tif (card.name == 'sha' && target.isFriendOf(player)) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_yinzei_switch: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tgroup: ['boss_yinzei_switch_on', 'boss_yinzei_switch_off'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\toff: {\r\n\t\t\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.disableSkill('boss_yinzei_awake', 'boss_yinzei');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ton: {\r\n\t\t\t\t\t\ttrigger: { player: 'changeHp' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.hp <= player.maxHp / 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\t\tanimationColor: 'thunder',\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.enableSkill('boss_yinzei_awake');\r\n\t\t\t\t\t\t\tplayer.removeSkill('boss_yinzei_switch');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jicai_switch: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tgroup: ['boss_jicai_switch_on', 'boss_jicai_switch_off'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\toff: {\r\n\t\t\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.disableSkill('boss_jicai_awake', 'boss_jicai');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ton: {\r\n\t\t\t\t\t\ttrigger: { player: 'changeHp' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.hp <= player.maxHp / 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\t\tanimationColor: 'thunder',\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.enableSkill('boss_jicai_awake');\r\n\t\t\t\t\t\t\tplayer.removeSkill('boss_jicai_switch');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_luanchang_switch: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tgroup: ['boss_luanchang_switch_on', 'boss_luanchang_switch_off'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\toff: {\r\n\t\t\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.disableSkill('boss_luanchang_awake', 'boss_luanchang');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ton: {\r\n\t\t\t\t\t\ttrigger: { player: 'changeHp' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.hp <= player.maxHp / 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\t\tanimationColor: 'thunder',\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.enableSkill('boss_luanchang_awake');\r\n\t\t\t\t\t\t\tplayer.removeSkill('boss_luanchang_switch');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_yandu_switch: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tgroup: ['boss_yandu_switch_on', 'boss_yandu_switch_off'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\toff: {\r\n\t\t\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.disableSkill('boss_yandu_awake', 'boss_yandu');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ton: {\r\n\t\t\t\t\t\ttrigger: { player: 'changeHp' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.hp <= player.maxHp / 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\t\tanimationColor: 'thunder',\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.enableSkill('boss_yandu_awake');\r\n\t\t\t\t\t\t\tplayer.removeSkill('boss_yandu_switch');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_shenwuzaishi: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.side != game.boss.side;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (player == trigger.source && trigger.player.name == 'boss_zhuyin') {\r\n\t\t\t\t\t\tplayer.draw(3);\r\n\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (trigger.player.side == player.side) {\r\n\t\t\t\t\t\tplayer.draw(player.group == 'shen' ? 3 : 1);\r\n\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_wuzang: {\r\n\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num += Math.max(5, Math.floor(player.hp / 2)) - 2;\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tmaxHandcard: function (player, num) {\r\n\t\t\t\t\t\treturn num - player.hp;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xiangde: {\r\n\t\t\t\ttrigger: { player: 'damageBegin3' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.source && event.source.isIn() && event.source != player && event.source.getEquip(1);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_yinzei: {\r\n\t\t\t\ttrigger: { player: 'damageEnd' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tlogTarget: 'source',\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.source && event.source.isIn() && event.source != player && event.source.countCards('he') && !player.countCards('h');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.source.randomDiscard();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zhue: {\r\n\t\t\t\ttrigger: { global: 'damageEnd' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.source && event.source.isIn() && event.source != player;\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'source',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tgame.asyncDraw([player, trigger.source]);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_yandu: {\r\n\t\t\t\ttrigger: { global: 'phaseJieshuBegin' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player != player && !event.player.getStat('damage') && event.player.countCards('he');\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'player',\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.gainPlayerCard(trigger.player, true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_futai: {\r\n\t\t\t\tglobal: 'boss_futai2',\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tlogTarget: function (event, player) {\r\n\t\t\t\t\treturn game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn current.isDamaged();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn current.isDamaged();\r\n\t\t\t\t\t}).sortBySeat();\r\n\t\t\t\t\tevent.list = list;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (event.list.length) {\r\n\t\t\t\t\t\tevent.list.shift().recover();\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_futai2: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tcardSavable: function (card, player) {\r\n\t\t\t\t\t\tif (card.name == 'tao' && !_status.event.skill && game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current != player && current.hasSkill('boss_futai') && _status.currentPhase != current;\r\n\t\t\t\t\t\t})) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcardEnabled: function (card, player) {\r\n\t\t\t\t\t\tif (card.name == 'tao' && !_status.event.skill && game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current != player && current.hasSkill('boss_futai') && _status.currentPhase != current;\r\n\t\t\t\t\t\t})) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_luanchang: {\r\n\t\t\t\tgroup: ['boss_luanchang_begin', 'boss_luanchang_end'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tbegin: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\t\treturn player.canUse('nanman', current);\r\n\t\t\t\t\t\t\t}).sortBySeat();\r\n\t\t\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\t\t\tplayer.useCard({ name: 'nanman' }, list);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tend: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\t\treturn player.canUse('wanjian', current);\r\n\t\t\t\t\t\t\t}).sortBySeat();\r\n\t\t\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\t\t\tplayer.useCard({ name: 'wanjian' }, list);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_nitai: {\r\n\t\t\t\tgroup: ['boss_nitai_in', 'boss_nitai_out'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tin: {\r\n\t\t\t\t\t\ttrigger: { player: 'damageBegin4' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn _status.currentPhase == player;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tout: {\r\n\t\t\t\t\t\ttrigger: { player: 'damageBegin1' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn _status.currentPhase != player && event.nature == 'fire';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_minwan: {\r\n\t\t\t\tgroup: ['boss_minwan_clear', 'boss_minwan_draw', 'boss_minwan_add'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tclear: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseAfter' },\r\n\t\t\t\t\t\tsilent: true,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tdelete player.$.boss_minwan;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdraw: {\r\n\t\t\t\t\t\ttrigger: { player: 'useCard' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn _status.currentPhase == player && Array.isArray(player.$.boss_minwan);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tadd: {\r\n\t\t\t\t\t\ttrigger: { source: 'damageAfter' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn _status.currentPhase == player;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tif (!player.$.boss_minwan) {\r\n\t\t\t\t\t\t\t\tplayer.$.boss_minwan = [player];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.$.boss_minwan.add(trigger.player);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tplayerEnabled: function (card, player, target) {\r\n\t\t\t\t\t\tif (_status.currentPhase == player && Array.isArray(player.$.boss_minwan) && !player.$.boss_minwan.contains(target)) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_tanyu: {\r\n\t\t\t\ttrigger: { player: 'phaseDiscardBefore' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tgroup: 'boss_tanyu_hp',\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\thp: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tpopup: false,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn player.isMaxHandcard();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_cangmu: {\r\n\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num += game.countPlayer() - 2;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jicai: {\r\n\t\t\t\ttrigger: { global: 'recoverAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tlogTarget: 'player',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (trigger.player == player) {\r\n\t\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.asyncDraw([player, trigger.player]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xiongshou: {\r\n\t\t\t\tgroup: ['boss_xiongshou_turn', 'boss_xiongshou_damage'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tdamage: {\r\n\t\t\t\t\t\ttrigger: { source: 'damageBegin1' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn event.notLink() && event.card && event.card.name == 'sha' && event.player.hp < player.hp;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tturn: {\r\n\t\t\t\t\t\ttrigger: { player: 'turnOverBefore' },\r\n\t\t\t\t\t\tpriority: 20,\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn !player.isTurnedOver();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\t\tgame.log(player, '取消了翻面');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tglobalFrom: function (from, to, distance) {\r\n\t\t\t\t\t\treturn distance - 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tnoturn: true,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txuwangzhimian: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num += 2;\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tmaxHandcard: function (player, num) {\r\n\t\t\t\t\t\treturn num - 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txiuluolianyuji2: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tvanish: true,\r\n\t\t\t\ttrigger: { player: 'damageEnd' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (trigger.xiuluolianyuji) player.recover();\r\n\t\t\t\t\tplayer.removeSkill('xiuluolianyuji2');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txiuluolianyuji: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tselectTarget: function (card, player, range) {\r\n\t\t\t\t\t\tif (card.name != 'sha') return;\r\n\t\t\t\t\t\tif (range[1] == -1) return;\r\n\t\t\t\t\t\trange[1] = Infinity;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { source: 'damageBegin1' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.card && event.card.name == 'sha';\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\ttrigger.xiuluolianyuji = true;\r\n\t\t\t\t\ttrigger.player.addSkill('xiuluolianyuji2');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjuechenjinge: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tglobal: 'juechenjinge2'\r\n\t\t\t},\r\n\t\t\tjuechenjinge2: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tglobalTo: function (from, to, distance) {\r\n\t\t\t\t\t\treturn distance + game.countPlayer(function (current) {\r\n\t\t\t\t\t\t\tif (current == to) return;\r\n\t\t\t\t\t\t\tif (current.side != to.side) return;\r\n\t\t\t\t\t\t\tif (current.hasSkill('juechenjinge')) return 1;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchiyanzhenhunqin: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: { source: 'damageBegin1' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.nature = 'fire';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchixueqingfeng: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: { player: 'useCardToPlayered' },\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.card.name == 'sha';\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'target',\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.target.addTempSkill('chixueqingfeng2', 'shaAfter');\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tunequip: true,\r\n\t\t\t\t\tskillTagFilter: function (player, tag, arg) {\r\n\t\t\t\t\t\tif (arg && arg.name == 'sha') return true;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchixueqingfeng2: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tcardEnabled: function () {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcardUsable: function () {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcardRespondable: function () {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcardSavable: function () {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tqimenbagua: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: { target: 'shaBefore' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (player.hasSkillTag('unequip2')) return false;\r\n\t\t\t\t\tif (event.player.hasSkillTag('unequip', false, {\r\n\t\t\t\t\t\tname: event.card ? event.card.name : null,\r\n\t\t\t\t\t\ttarget: player,\r\n\t\t\t\t\t\tcard: event.card\r\n\t\t\t\t\t})) return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (player.hasSkillTag('unequip', false, {\r\n\t\t\t\t\t\t\t\tname: card ? card.name : null,\r\n\t\t\t\t\t\t\t\ttarget: player,\r\n\t\t\t\t\t\t\t\tcard: card\r\n\t\t\t\t\t\t\t})) return;\r\n\t\t\t\t\t\t\tif (card.name == 'sha') return 'zerotarget';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tguilongzhanyuedao: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\ttrigger: { player: 'useCard' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.card && event.card.name == 'sha' && get.color(event.card) == 'red';\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.directHit.addArray(game.players);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tguofengyupao: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tmod: {\r\n\t\t\t\t\ttargetEnabled: function (card, player, target, now) {\r\n\t\t\t\t\t\tif (target.hasSkillTag('unequip2')) return false;\r\n\t\t\t\t\t\tif (player != target) {\r\n\t\t\t\t\t\t\tif (player.hasSkillTag('unequip', false, {\r\n\t\t\t\t\t\t\t\tname: card ? card.name : null,\r\n\t\t\t\t\t\t\t\ttarget: player,\r\n\t\t\t\t\t\t\t\tcard: card\r\n\t\t\t\t\t\t\t})) { }\r\n\t\t\t\t\t\t\telse if (get.type(card) == 'trick') return false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlongfenghemingjian: {\r\n\t\t\t\tequipSkill: true,\r\n\t\t\t\tinherit: 'cixiong_skill',\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn lib.linked.contains(event.card.nature);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tqicaishenlu: {\r\n\t\t\t\ttrigger: { source: 'damageBegin1' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn lib.linked.contains(event.nature);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_chiyan: {\r\n\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.smoothAvatar();\r\n\t\t\t\t\tplayer.init('boss_zhuque');\r\n\t\t\t\t\t_status.noswap = true;\r\n\t\t\t\t\tgame.addVideo('reinit2', player, player.name);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_chiyan2: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_chiyan2x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player == game.boss;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_chiyan2x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_chiyan2');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (game.me != game.boss) {\r\n\t\t\t\t\t\tgame.boss.changeSeat(6);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.boss.nextSeat.changeSeat(3);\r\n\t\t\t\t\t\tgame.boss.previousSeat.changeSeat(5);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.changeBoss('boss_huoshenzhurong');\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.addBossFellow(game.me == game.boss ? 1 : 5, 'boss_yanling');\r\n\t\t\t\t\tgame.addBossFellow(7, 'boss_yanling');\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar dnum = 0;\r\n\t\t\t\t\tvar dead = game.dead.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < dead.length; i++) {\r\n\t\t\t\t\t\tif (!dead[i].side && dead[i].maxHp > 0 && dead[i].parentNode == player.parentNode) {\r\n\t\t\t\t\t\t\tdead[i].revive(dead[i].maxHp);\r\n\t\t\t\t\t\t\tdnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].side) continue;\r\n\t\t\t\t\t\tgame.players[i].removeEquipTrigger();\r\n\t\t\t\t\t\tvar hej = game.players[i].getCards('hej');\r\n\t\t\t\t\t\tfor (var j = 0; j < hej.length; j++) {\r\n\t\t\t\t\t\t\thej[j].discard(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].hujia = 0;\r\n\t\t\t\t\t\tgame.players[i].classList.remove('turnedover');\r\n\t\t\t\t\t\tgame.players[i].removeLink();\r\n\t\t\t\t\t\tgame.players[i].directgain(get.cards(4 - dnum));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\twhile (_status.event.name != 'phaseLoop') {\r\n\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t_status.paused = false;\r\n\t\t\t\t\t_status.event.player = game.boss;\r\n\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\tgame.phaseNumber = 0;\r\n\t\t\t\t\tgame.roundNumber = 0;\r\n\t\t\t\t\tif (game.bossinfo) {\r\n\t\t\t\t\t\tgame.bossinfo.loopType = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_chiyan3: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_chiyan3x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player == game.boss;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tplayer.nextSeat.hide();\r\n\t\t\t\t\tplayer.previousSeat.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player.nextSeat);\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player.previousSeat);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_chiyan3x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_chiyan3');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.changeBoss('boss_yandi');\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.changeBoss('boss_huoshenzhurong', game.boss.previousSeat);\r\n\t\t\t\t\tgame.changeBoss('boss_yanling', game.boss.nextSeat);\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar dnum = 0;\r\n\t\t\t\t\tvar dead = game.dead.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < dead.length; i++) {\r\n\t\t\t\t\t\tif (!dead[i].side && dead[i].maxHp > 0 && dead[i].parentNode == player.parentNode) {\r\n\t\t\t\t\t\t\tdead[i].revive(dead[i].maxHp);\r\n\t\t\t\t\t\t\tdnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].side) continue;\r\n\t\t\t\t\t\tgame.players[i].removeEquipTrigger();\r\n\t\t\t\t\t\tvar hej = game.players[i].getCards('hej');\r\n\t\t\t\t\t\tfor (var j = 0; j < hej.length; j++) {\r\n\t\t\t\t\t\t\thej[j].discard(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].hujia = 0;\r\n\t\t\t\t\t\tgame.players[i].classList.remove('turnedover');\r\n\t\t\t\t\t\tgame.players[i].removeLink();\r\n\t\t\t\t\t\tgame.players[i].directgain(get.cards(4 - dnum));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\twhile (_status.event.name != 'phaseLoop') {\r\n\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t_status.paused = false;\r\n\t\t\t\t\t_status.event.player = game.boss;\r\n\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\tgame.phaseNumber = 0;\r\n\t\t\t\t\tgame.roundNumber = 0;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qingmu: {\r\n\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.smoothAvatar();\r\n\t\t\t\t\tplayer.init('boss_qinglong');\r\n\t\t\t\t\t_status.noswap = true;\r\n\t\t\t\t\tgame.addVideo('reinit2', player, player.name);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qingmu2: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_qingmu2x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player == game.boss;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qingmu2x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_qingmu2');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (game.me != game.boss) {\r\n\t\t\t\t\t\tgame.boss.changeSeat(6);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.boss.nextSeat.changeSeat(3);\r\n\t\t\t\t\t\tgame.boss.previousSeat.changeSeat(5);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.changeBoss('boss_mushengoumang');\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.addBossFellow(game.me == game.boss ? 1 : 5, 'boss_shujing');\r\n\t\t\t\t\tgame.addBossFellow(7, 'boss_shujing');\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar dnum = 0;\r\n\t\t\t\t\tvar dead = game.dead.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < dead.length; i++) {\r\n\t\t\t\t\t\tif (!dead[i].side && dead[i].maxHp > 0 && dead[i].parentNode == player.parentNode) {\r\n\t\t\t\t\t\t\tdead[i].revive(dead[i].maxHp);\r\n\t\t\t\t\t\t\tdnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].side) continue;\r\n\t\t\t\t\t\tgame.players[i].removeEquipTrigger();\r\n\t\t\t\t\t\tvar hej = game.players[i].getCards('hej');\r\n\t\t\t\t\t\tfor (var j = 0; j < hej.length; j++) {\r\n\t\t\t\t\t\t\thej[j].discard(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].hujia = 0;\r\n\t\t\t\t\t\tgame.players[i].classList.remove('turnedover');\r\n\t\t\t\t\t\tgame.players[i].removeLink();\r\n\t\t\t\t\t\tgame.players[i].directgain(get.cards(4 - dnum));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\twhile (_status.event.name != 'phaseLoop') {\r\n\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t_status.paused = false;\r\n\t\t\t\t\t_status.event.player = game.boss;\r\n\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\tgame.phaseNumber = 0;\r\n\t\t\t\t\tgame.roundNumber = 0;\r\n\t\t\t\t\tif (game.bossinfo) {\r\n\t\t\t\t\t\tgame.bossinfo.loopType = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qingmu3: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_qingmu3x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player == game.boss;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tplayer.nextSeat.hide();\r\n\t\t\t\t\tplayer.previousSeat.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player.nextSeat);\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player.previousSeat);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qingmu3x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_qingmu3');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.changeBoss('boss_taihao');\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.changeBoss('boss_mushengoumang', game.boss.previousSeat);\r\n\t\t\t\t\tgame.changeBoss('boss_shujing', game.boss.nextSeat);\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar dnum = 0;\r\n\t\t\t\t\tvar dead = game.dead.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < dead.length; i++) {\r\n\t\t\t\t\t\tif (!dead[i].side && dead[i].maxHp > 0 && dead[i].parentNode == player.parentNode) {\r\n\t\t\t\t\t\t\tdead[i].revive(dead[i].maxHp);\r\n\t\t\t\t\t\t\tdnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].side) continue;\r\n\t\t\t\t\t\tgame.players[i].removeEquipTrigger();\r\n\t\t\t\t\t\tvar hej = game.players[i].getCards('hej');\r\n\t\t\t\t\t\tfor (var j = 0; j < hej.length; j++) {\r\n\t\t\t\t\t\t\thej[j].discard(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].hujia = 0;\r\n\t\t\t\t\t\tgame.players[i].classList.remove('turnedover');\r\n\t\t\t\t\t\tgame.players[i].removeLink();\r\n\t\t\t\t\t\tgame.players[i].directgain(get.cards(4 - dnum));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\twhile (_status.event.name != 'phaseLoop') {\r\n\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t_status.paused = false;\r\n\t\t\t\t\t_status.event.player = game.boss;\r\n\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\tgame.phaseNumber = 0;\r\n\t\t\t\t\tgame.roundNumber = 0;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xuanlin: {\r\n\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.smoothAvatar();\r\n\t\t\t\t\tplayer.init('boss_xuanwu');\r\n\t\t\t\t\t_status.noswap = true;\r\n\t\t\t\t\tgame.addVideo('reinit2', player, player.name);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xuanlin2: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_xuanlin2x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player == game.boss;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xuanlin2x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_xuanlin2');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (game.me != game.boss) {\r\n\t\t\t\t\t\tgame.boss.changeSeat(6);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.boss.nextSeat.changeSeat(3);\r\n\t\t\t\t\t\tgame.boss.previousSeat.changeSeat(5);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.changeBoss('boss_shuishengonggong');\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.addBossFellow(game.me == game.boss ? 1 : 7, 'boss_shuishenxuanming');\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar dnum = 0;\r\n\t\t\t\t\tvar dead = game.dead.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < dead.length; i++) {\r\n\t\t\t\t\t\tif (!dead[i].side && dead[i].maxHp > 0 && dead[i].parentNode == player.parentNode) {\r\n\t\t\t\t\t\t\tdead[i].revive(dead[i].maxHp);\r\n\t\t\t\t\t\t\tdnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].side) continue;\r\n\t\t\t\t\t\tgame.players[i].removeEquipTrigger();\r\n\t\t\t\t\t\tvar hej = game.players[i].getCards('hej');\r\n\t\t\t\t\t\tfor (var j = 0; j < hej.length; j++) {\r\n\t\t\t\t\t\t\thej[j].discard(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].hujia = 0;\r\n\t\t\t\t\t\tgame.players[i].classList.remove('turnedover');\r\n\t\t\t\t\t\tgame.players[i].removeLink();\r\n\t\t\t\t\t\tgame.players[i].directgain(get.cards(4 - dnum));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\twhile (_status.event.name != 'phaseLoop') {\r\n\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t_status.paused = false;\r\n\t\t\t\t\t_status.event.player = game.boss;\r\n\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\tgame.phaseNumber = 0;\r\n\t\t\t\t\tgame.roundNumber = 0;\r\n\t\t\t\t\tif (game.bossinfo) {\r\n\t\t\t\t\t\tgame.bossinfo.loopType = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xuanlin3: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_xuanlin3x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (game.boss && game.boss.name == 'boss_zhuanxu') return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t\tif (player.nextSeat.side == player.side) {\r\n\t\t\t\t\t\tplayer.nextSeat.hide();\r\n\t\t\t\t\t\tgame.addVideo('hidePlayer', player.nextSeat);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (player.previousSeat.side == player.side) {\r\n\t\t\t\t\t\tplayer.previousSeat.hide();\r\n\t\t\t\t\t\tplayer.previousSeat.node.handcards1.hide();\r\n\t\t\t\t\t\tplayer.previousSeat.node.handcards2.hide();\r\n\t\t\t\t\t\tgame.addVideo('hidePlayer', player.previousSeat);\r\n\t\t\t\t\t\tgame.addVideo('deleteHandcards', player.previousSeat);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xuanlin3x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\tif (game.boss && game.boss.name == 'boss_zhuanxu') return false;\r\n\t\t\t\t\treturn event.player.hasSkill('boss_xuanlin3');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.changeBoss('boss_zhuanxu');\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.addBossFellow(game.me == game.boss ? 7 : 5, 'boss_shuishengonggong');\r\n\t\t\t\t\tgame.changeBoss('boss_shuishenxuanming', game.boss.nextSeat);\r\n\t\t\t\t\tgame.boss.previousSeat.maxHp--;\r\n\t\t\t\t\tgame.boss.previousSeat.update();\r\n\t\t\t\t\tgame.boss.nextSeat.maxHp--;\r\n\t\t\t\t\tgame.boss.nextSeat.update();\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar dnum = 0;\r\n\t\t\t\t\tvar dead = game.dead.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < dead.length; i++) {\r\n\t\t\t\t\t\tif (!dead[i].side && dead[i].maxHp > 0 && dead[i].parentNode == player.parentNode) {\r\n\t\t\t\t\t\t\tdead[i].revive(dead[i].maxHp);\r\n\t\t\t\t\t\t\tdnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].side) continue;\r\n\t\t\t\t\t\tgame.players[i].removeEquipTrigger();\r\n\t\t\t\t\t\tvar hej = game.players[i].getCards('hej');\r\n\t\t\t\t\t\tfor (var j = 0; j < hej.length; j++) {\r\n\t\t\t\t\t\t\thej[j].discard(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].hujia = 0;\r\n\t\t\t\t\t\tgame.players[i].classList.remove('turnedover');\r\n\t\t\t\t\t\tgame.players[i].removeLink();\r\n\t\t\t\t\t\tgame.players[i].directgain(get.cards(4 - dnum));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\twhile (_status.event.name != 'phaseLoop') {\r\n\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t_status.paused = false;\r\n\t\t\t\t\t_status.event.player = game.boss;\r\n\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\tgame.phaseNumber = 0;\r\n\t\t\t\t\tgame.roundNumber = 0;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baimang: {\r\n\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.smoothAvatar();\r\n\t\t\t\t\tplayer.init('boss_baihu');\r\n\t\t\t\t\t_status.noswap = true;\r\n\t\t\t\t\tgame.addVideo('reinit2', player, player.name);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baimang2: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_baimang2x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player == game.boss;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baimang2x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_baimang2');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (game.me != game.boss) {\r\n\t\t\t\t\t\tgame.boss.changeSeat(6);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.boss.nextSeat.changeSeat(3);\r\n\t\t\t\t\t\tgame.boss.previousSeat.changeSeat(5);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.changeBoss('boss_jinshenrushou');\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.addBossFellow(game.me == game.boss ? 1 : 5, 'boss_mingxingzhu');\r\n\t\t\t\t\tgame.addBossFellow(7, 'boss_mingxingzhu');\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar dnum = 0;\r\n\t\t\t\t\tvar dead = game.dead.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < dead.length; i++) {\r\n\t\t\t\t\t\tif (!dead[i].side && dead[i].maxHp > 0 && dead[i].parentNode == player.parentNode) {\r\n\t\t\t\t\t\t\tdead[i].revive(dead[i].maxHp);\r\n\t\t\t\t\t\t\tdnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].side) continue;\r\n\t\t\t\t\t\tgame.players[i].removeEquipTrigger();\r\n\t\t\t\t\t\tvar hej = game.players[i].getCards('hej');\r\n\t\t\t\t\t\tfor (var j = 0; j < hej.length; j++) {\r\n\t\t\t\t\t\t\thej[j].discard(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].hujia = 0;\r\n\t\t\t\t\t\tgame.players[i].classList.remove('turnedover');\r\n\t\t\t\t\t\tgame.players[i].removeLink();\r\n\t\t\t\t\t\tgame.players[i].directgain(get.cards(4 - dnum));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\twhile (_status.event.name != 'phaseLoop') {\r\n\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t_status.paused = false;\r\n\t\t\t\t\t_status.event.player = game.boss;\r\n\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\tgame.phaseNumber = 0;\r\n\t\t\t\t\tgame.roundNumber = 0;\r\n\t\t\t\t\tif (game.bossinfo) {\r\n\t\t\t\t\t\tgame.bossinfo.loopType = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baimang3: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_baimang3x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player == game.boss;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tplayer.nextSeat.hide();\r\n\t\t\t\t\tplayer.previousSeat.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player.nextSeat);\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player.previousSeat);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baimang3x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_baimang3');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.changeBoss('boss_shaohao');\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.changeBoss('boss_jinshenrushou', game.boss.previousSeat);\r\n\t\t\t\t\tgame.changeBoss('boss_mingxingzhu', game.boss.nextSeat);\r\n\t\t\t\t\tgame.boss.previousSeat.maxHp--;\r\n\t\t\t\t\tgame.boss.previousSeat.update();\r\n\t\t\t\t\tif (game.me != game.boss) {\r\n\t\t\t\t\t\tgame.addBossFellow(4, 'boss_mingxingzhu');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// ui.arena.dataset.number='7';\r\n\t\t\t\t\t\t// game.addVideo('arenaNumber',null,7);\r\n\t\t\t\t\t\t// game.boss.previousSeat.changeSeat(6);\r\n\t\t\t\t\t\t// game.boss.nextSeat.nextSeat.changeSeat(2);\r\n\t\t\t\t\t\t// game.boss.nextSeat.nextSeat.nextSeat.changeSeat(3);\r\n\t\t\t\t\t\t// game.boss.nextSeat.nextSeat.nextSeat.nextSeat.changeSeat(4);\r\n\t\t\t\t\t\tgame.addBossFellow(6, 'boss_mingxingzhu');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar dnum = 0;\r\n\t\t\t\t\tvar dead = game.dead.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < dead.length; i++) {\r\n\t\t\t\t\t\tif (!dead[i].side && dead[i].maxHp > 0 && dead[i].parentNode == player.parentNode) {\r\n\t\t\t\t\t\t\tdead[i].revive(dead[i].maxHp);\r\n\t\t\t\t\t\t\tdnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].side) continue;\r\n\t\t\t\t\t\tgame.players[i].removeEquipTrigger();\r\n\t\t\t\t\t\tvar hej = game.players[i].getCards('hej');\r\n\t\t\t\t\t\tfor (var j = 0; j < hej.length; j++) {\r\n\t\t\t\t\t\t\thej[j].discard(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hp = game.players[i].maxHp;\r\n\t\t\t\t\t\tgame.players[i].hujia = 0;\r\n\t\t\t\t\t\tgame.players[i].classList.remove('turnedover');\r\n\t\t\t\t\t\tgame.players[i].removeLink();\r\n\t\t\t\t\t\tgame.players[i].directgain(get.cards(4 - dnum));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\twhile (_status.event.name != 'phaseLoop') {\r\n\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t_status.paused = false;\r\n\t\t\t\t\t_status.event.player = game.boss;\r\n\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\tgame.phaseNumber = 0;\r\n\t\t\t\t\tgame.roundNumber = 0;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_shenyi: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tjudge: function (player, result) {\r\n\t\t\t\t\t\tif (_status.event.type == 'phase') {\r\n\t\t\t\t\t\t\tif (result.bool == false) {\r\n\t\t\t\t\t\t\t\tresult.bool = null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tresult.bool = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { player: 'turnOverBefore' },\r\n\t\t\t\tpriority: 20,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn !player.isTurnedOver();\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\tgame.log(player, '取消了翻面');\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tnoturn: true,\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (get.type(card) == 'delay') return 0.5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thonghuangzhili: {\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.disableSkill('honghuangzhili', 'boss_shenyi');\r\n\t\t\t\t},\r\n\t\t\t\tmark: true,\r\n\t\t\t\tnopop: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: '【神裔】无效直到下家的回合开始'\r\n\t\t\t\t},\r\n\t\t\t\tmarktext: '荒',\r\n\t\t\t\tonremove: function (player) {\r\n\t\t\t\t\tplayer.enableSkill('honghuangzhili', 'boss_shenyi');\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { global: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player == player.next;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.removeSkill('honghuangzhili');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_shenen: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tunique: true,\r\n\t\t\t\tglobal: 'boss_shenen2'\r\n\t\t\t},\r\n\t\t\tboss_shenen2: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\ttargetInRange: function (card, player) {\r\n\t\t\t\t\t\tif (player.side) return true;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmaxHandcard: function (player, num) {\r\n\t\t\t\t\t\tif (!player.side) return num + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn !player.side;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_fentian: {\r\n\t\t\t\ttrigger: { source: 'damageBegin1' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.nature != 'fire';\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.nature = 'fire';\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tcardUsable: function (card) {\r\n\t\t\t\t\t\tif (get.color(card) == 'red') return Infinity;\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttargetInRange: function (card) {\r\n\t\t\t\t\t\tif (get.color(card) == 'red') return true;\r\n\t\t\t\t\t},\r\n\t\t\t\t\twuxieRespondable: function (card, player, target) {\r\n\t\t\t\t\t\tif (get.color(card) == 'red' && player != target) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup: 'boss_fentian2',\r\n\t\t\t},\r\n\t\t\tboss_fentian2: {\r\n\t\t\t\ttrigger: { player: 'useCard' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn get.color(event.card) == 'red';\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.directHit.addArray(game.players);\r\n\t\t\t\t\ttrigger.directHit.remove(player);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_xingxia: {\r\n\t\t\t\tenable: 'phaseUse',\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (!game.hasPlayer(function (current) {\r\n\t\t\t\t\t\treturn current.name == 'boss_yanling';\r\n\t\t\t\t\t})) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn !player.$.boss_xingxia || game.roundNumber - player.$.boss_xingxia >= 2;\r\n\t\t\t\t},\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilterTarget: function (card, player, target) {\r\n\t\t\t\t\treturn target.name == 'boss_yanling';\r\n\t\t\t\t},\r\n\t\t\t\tselectTarget: -1,\r\n\t\t\t\tline: 'fire',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttarget.damage(2, 'fire');\r\n\t\t\t\t},\r\n\t\t\t\tcontentAfter: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.$.boss_xingxia = game.roundNumber;\r\n\t\t\t\t\tplayer.chooseTarget(function (card, player, target) {\r\n\t\t\t\t\t\treturn target.side != player.side;\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\treturn get.damageEffect(target, player, player, 'fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tevent.target = result.targets[0];\r\n\t\t\t\t\t\tplayer.line(event.target, 'fire');\r\n\t\t\t\t\t\tevent.target.chooseToDiscard('he', { color: 'red' }, '弃置一张红色牌或受到一点火焰伤害').ai = function (card) {\r\n\t\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\t\tvar source = _status.event.parent.player;\r\n\t\t\t\t\t\t\tif (get.damageEffect(player, source, player, 'fire') >= 0) return 0;\r\n\t\t\t\t\t\t\treturn 8 - get.value(card);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (!result.bool) {\r\n\t\t\t\t\t\tevent.target.damage('fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\torder: 6,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttarget: function (player, target) {\r\n\t\t\t\t\t\t\tif (target.isLinked() && player.isLinked() && get.damageEffect(player, player, player, 'fire') < 0) return -1;\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_huihuo: {\r\n\t\t\t\tglobal: 'boss_huihuo2',\r\n\t\t\t\tunique: true,\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tcardUsable: function (card, player, num) {\r\n\t\t\t\t\t\tif (card.name == 'sha') return num + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\trevertsave: true,\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (!game.boss) return;\r\n\t\t\t\t\t\t\tif (card.name == 'tiesuo') {\r\n\t\t\t\t\t\t\t\tif (_status.event.player == game.boss) return 'zeroplayertarget';\r\n\t\t\t\t\t\t\t\treturn 0.5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (get.tag(card, 'damage') || get.tag(card, 'recover')) {\r\n\t\t\t\t\t\t\t\tif (game.boss.isLinked() && get.damageEffect(game.boss, player, game.boss, 'fire') < 0) {\r\n\t\t\t\t\t\t\t\t\tif (game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\t\t\t\treturn current.isEnemyOf(game.boss) && current.isLinked();\r\n\t\t\t\t\t\t\t\t\t})) {\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (get.tag(card, 'natureDamage') && target.isLinked()) {\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (target.isDying()) {\r\n\t\t\t\t\t\t\t\t\tif (player.isEnemyOf(target) && player.hp >= -1) return [0, 0, 0, 1];\r\n\t\t\t\t\t\t\t\t\treturn 'zeroplayertarget';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn -0.5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_huihuo2: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player.hasSkill('boss_huihuo') && event.player.isDead() && player.isEnemyOf(event.player);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.player.line(player, 'fire');\r\n\t\t\t\t\tplayer.damage('nosource', 'fire', 3).animate = false;\r\n\t\t\t\t\tplayer.$damage(trigger.player);\r\n\t\t\t\t\tplayer.$damagepop(-3, 'fire');\r\n\t\t\t\t\tif (lib.config.animation && !lib.config.low_performance) {\r\n\t\t\t\t\t\tplayer.$fire();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!event.parent.parent.boss_huihuo_logv) {\r\n\t\t\t\t\t\tevent.parent.parent.boss_huihuo_logv = true;\r\n\t\t\t\t\t\tgame.logv(trigger.player, 'boss_huihuo', game.filterPlayer(), event.parent.parent);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_furan: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tglobal: 'boss_furan2'\r\n\t\t\t},\r\n\t\t\tboss_furan2: {\r\n\t\t\t\tenable: 'chooseToUse',\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.type == 'dying' && event.dying.hasSkill('boss_furan') && player.isEnemyOf(event.dying);\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard: function (card) {\r\n\t\t\t\t\treturn get.color(card) == 'red';\r\n\t\t\t\t},\r\n\t\t\t\tposition: 'he',\r\n\t\t\t\tviewAs: { name: 'tao' },\r\n\t\t\t\tprompt: '将一张红色牌当桃使用',\r\n\t\t\t\tcheck: function (card) { return 8 - get.value(card) },\r\n\t\t\t\tai: {\r\n\t\t\t\t\torder: 5,\r\n\t\t\t\t\tskillTagFilter: function (player) {\r\n\t\t\t\t\t\tvar event = _status.event;\r\n\t\t\t\t\t\tif (event.dying && event.dying.hasSkill('boss_furan') && player.isEnemyOf(event.dying)) {\r\n\t\t\t\t\t\t\treturn player.countCards('he', { color: 'red' }) > 0 && _status.currentPhase != player;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsave: true,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_chiyi: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn [3, 5, 7].contains(game.roundNumber);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif (game.roundNumber == 3) {\r\n\t\t\t\t\t\tvar enemies = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.isEnemyOf(player);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tplayer.line(enemies, 'green');\r\n\t\t\t\t\t\tfor (var i = 0; i < enemies.length; i++) {\r\n\t\t\t\t\t\t\tenemies[i].addSkill('boss_chiyi2');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (game.roundNumber == 5) {\r\n\t\t\t\t\t\tevent.targets = game.filterPlayer().sortBySeat();\r\n\t\t\t\t\t\tevent.num = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.targets = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.name == 'boss_yanling';\r\n\t\t\t\t\t\t}).sortBySeat();\r\n\t\t\t\t\t\tevent.num = 5;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (event.targets.length) {\r\n\t\t\t\t\t\tvar target = event.targets.shift();\r\n\t\t\t\t\t\tplayer.line(target, 'fire');\r\n\t\t\t\t\t\ttarget.damage(event.num, 'fire');\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_chiyi2: {\r\n\t\t\t\tmark: true,\r\n\t\t\t\tmarktext: '赤',\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: '受到的伤害+1'\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { player: 'damageBegin3' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_buchun: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tunique: true,\r\n\t\t\t\tgroup: ['boss_buchun_recover', 'boss_buchun_revive'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\trevive: {\r\n\t\t\t\t\t\tenable: 'phaseUse',\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\tif (!player.$.boss_buchun || game.roundNumber - player.$.boss_buchun >= 2) {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < game.dead.length; i++) {\r\n\t\t\t\t\t\t\t\t\tif (game.dead[i].parentNode == player.parentNode && game.dead[i].name == 'boss_shujing') {\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t\t\t\tplayer.$.boss_buchun = game.roundNumber;\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tevent.targets = [];\r\n\t\t\t\t\t\t\tvar dead = game.dead.slice(0);\r\n\t\t\t\t\t\t\tfor (var i = 0; i < dead.length; i++) {\r\n\t\t\t\t\t\t\t\tif (dead[i].parentNode == player.parentNode && dead[i].name == 'boss_shujing') {\r\n\t\t\t\t\t\t\t\t\tevent.targets.push(dead[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (event.targets[0] == player.previousSeat) {\r\n\t\t\t\t\t\t\t\tevent.targets.push(event.targets.shift());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tif (event.targets.length) {\r\n\t\t\t\t\t\t\t\tvar target = event.targets.shift();\r\n\t\t\t\t\t\t\t\tplayer.line(target, 'green');\r\n\t\t\t\t\t\t\t\ttarget.revive(1);\r\n\t\t\t\t\t\t\t\ttarget.draw(2, false);\r\n\t\t\t\t\t\t\t\ttarget.$draw(2);\r\n\t\t\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 3'\r\n\t\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai: {\r\n\t\t\t\t\t\t\torder: 6,\r\n\t\t\t\t\t\t\tresult: {\r\n\t\t\t\t\t\t\t\tplayer: function (player, target) {\r\n\t\t\t\t\t\t\t\t\tif (player.hp <= 1) return 0;\r\n\t\t\t\t\t\t\t\t\tif (player.hp <= 3 && game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\t\t\t\treturn current.name == 'boss_shujing' && current.hp == 1;\r\n\t\t\t\t\t\t\t\t\t})) {\r\n\t\t\t\t\t\t\t\t\t\tif (_status.event.getRand() < 0.4) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (player.hp >= 3) return 1;\r\n\t\t\t\t\t\t\t\t\tif (player.hp >= 2 && player != game.boss) return 1;\r\n\t\t\t\t\t\t\t\t\tif (game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\t\t\t\treturn current.name == 'boss_shujing';\r\n\t\t\t\t\t\t\t\t\t})) {\r\n\t\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\trecover: {\r\n\t\t\t\t\t\tenable: 'phaseUse',\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\tif (!player.$.boss_buchun || game.roundNumber - player.$.boss_buchun >= 2) {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < game.dead.length; i++) {\r\n\t\t\t\t\t\t\t\t\tif (game.dead[i].parentNode == player.parentNode && game.dead[i].name == 'boss_shujing') {\r\n\t\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprompt: '令一名己方角色回复2点体力',\r\n\t\t\t\t\t\tfilterTarget: function (card, player, target) {\r\n\t\t\t\t\t\t\treturn target.isFriendOf(player) && target.isDamaged();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttarget.recover(2);\r\n\t\t\t\t\t\t\tplayer.$.boss_buchun = game.roundNumber;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai: {\r\n\t\t\t\t\t\t\torder: 6,\r\n\t\t\t\t\t\t\tresult: {\r\n\t\t\t\t\t\t\t\ttarget: function (player, target) {\r\n\t\t\t\t\t\t\t\t\tvar num = 1;\r\n\t\t\t\t\t\t\t\t\tif (target.maxHp - target.hp >= 2) {\r\n\t\t\t\t\t\t\t\t\t\tnum = 1.5;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn 1.5 * get.recoverEffect(target, player, target);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_cuidu: {\r\n\t\t\t\ttrigger: { source: 'damageEnd' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (event._notrigger.contains(event.player)) return false;\r\n\t\t\t\t\treturn event.player.isIn() && event.player.isEnemyOf(player) && !event.player.hasSkill('boss_zhongdu');\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'player',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.player.addSkill('boss_zhongdu');\r\n\t\t\t\t\tvar boss = game.findPlayer(function (current) {\r\n\t\t\t\t\t\treturn current.name == 'boss_mushengoumang';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (boss) {\r\n\t\t\t\t\t\tboss.draw();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zhongdu: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tmark: true,\r\n\t\t\t\tnopop: true,\r\n\t\t\t\ttemp: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: '锁定技，回合开始时，你进行判定，若结果不为红桃，你受到1点无来源的伤害，若结果不为黑桃，你失去此技能'\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.judge(function (card) {\r\n\t\t\t\t\t\tvar suit = get.suit(card);\r\n\t\t\t\t\t\tif (suit == 'spade') return -1;\r\n\t\t\t\t\t\tif (suit == 'heart') return 1;\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.suit != 'heart') {\r\n\t\t\t\t\t\tplayer.damage('nosource');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (result.suit != 'spade') {\r\n\t\t\t\t\t\tplayer.removeSkill('boss_zhongdu');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qingyi: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn [3, 5, 7].contains(game.roundNumber);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif (game.roundNumber == 7) {\r\n\t\t\t\t\t\tvar goumang, shujing;\r\n\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\tif (game.players[i].name == 'boss_mushengoumang') {\r\n\t\t\t\t\t\t\t\tgoumang = game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (game.players[i].name == 'boss_shujing') {\r\n\t\t\t\t\t\t\t\tshujing = game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!goumang || !shujing) {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < game.dead.length; i++) {\r\n\t\t\t\t\t\t\t\tif (game.dead[i].parentNode != player.parentNode) continue;\r\n\t\t\t\t\t\t\t\tif (game.dead[i].name == 'boss_mushengoumang') {\r\n\t\t\t\t\t\t\t\t\tgoumang = game.dead[i];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (game.dead[i].name == 'boss_shujing') {\r\n\t\t\t\t\t\t\t\t\tshujing = game.dead[i];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.targets = [];\r\n\t\t\t\t\t\tif (goumang) {\r\n\t\t\t\t\t\t\tevent.targets.push(goumang);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (shujing) {\r\n\t\t\t\t\t\t\tevent.targets.push(shujing);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.command = 'revive';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (game.roundNumber == 5) {\r\n\t\t\t\t\t\tevent.targets = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.isEnemyOf(player);\r\n\t\t\t\t\t\t}).sortBySeat();\r\n\t\t\t\t\t\tevent.command = 'loseHp';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.targets = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.isFriendOf(player);\r\n\t\t\t\t\t\t}).sortBySeat();\r\n\t\t\t\t\t\tevent.command = 'recover';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (event.targets.length) {\r\n\t\t\t\t\t\tvar target = event.targets.shift();\r\n\t\t\t\t\t\tplayer.line(target, 'green');\r\n\t\t\t\t\t\tif (event.command == 'revive') {\r\n\t\t\t\t\t\t\tplayer.line(target, 'green');\r\n\t\t\t\t\t\t\tif (target.isDead()) {\r\n\t\t\t\t\t\t\t\ttarget.maxHp++;\r\n\t\t\t\t\t\t\t\ttarget.revive(3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\ttarget.gainMaxHp();\r\n\t\t\t\t\t\t\t\ttarget.recover(3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttarget.draw(3, false);\r\n\t\t\t\t\t\t\ttarget.$draw(3);\r\n\t\t\t\t\t\t\tevent.delay = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttarget[event.command]();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (event.delay) {\r\n\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qizuo: {\r\n\t\t\t\ttrigger: { player: 'useCardAfter' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (event.parent.name == 'boss_qizuo') return false;\r\n\t\t\t\t\tif (!event.targets || !event.card) return false;\r\n\t\t\t\t\tif (event.card && event.card.name == 'wuxie') return false;\r\n\t\t\t\t\tvar type = get.type(event.card);\r\n\t\t\t\t\tif (type != 'trick') return false;\r\n\t\t\t\t\tvar card = game.createCard(event.card.name, event.card.suit, event.card.number, event.card.nature);\r\n\t\t\t\t\tvar targets = event._targets || event.targets;\r\n\t\t\t\t\tfor (var i = 0; i < targets.length; i++) {\r\n\t\t\t\t\t\tif (!targets[i].isIn()) return false;\r\n\t\t\t\t\t\tif (!player.canUse({ name: event.card.name }, targets[i], false, false)) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcheck: function (event, player) {\r\n\t\t\t\t\tif (event.card.name == 'tiesuo') return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar card = game.createCard(trigger.card.name, trigger.card.suit, trigger.card.number, trigger.card.nature);\r\n\t\t\t\t\tplayer.useCard(card, (trigger._targets || trigger.targets).slice(0));\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: 1.3\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_guimou: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.filterPlayer(function (target) {\r\n\t\t\t\t\t\treturn target != player && !target.isMad();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (list.length) {\r\n\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\tplayer.line(target, 'green');\r\n\t\t\t\t\t\ttarget.goMad({ player: 'phaseAfter' });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_yuance: {\r\n\t\t\t\ttrigger: { global: 'damageEnd' },\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.source && event.source != event.player && event.source.isAlive() && event.player.isAlive();\r\n\t\t\t\t},\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar att1 = get.attitude(player, trigger.player);\r\n\t\t\t\t\tvar att2 = get.attitude(player, trigger.source);\r\n\t\t\t\t\tvar targets = player.getEnemies();\r\n\t\t\t\t\tvar stop = false;\r\n\t\t\t\t\tfor (var i = 0; i < targets.length; i++) {\r\n\t\t\t\t\t\tvar skills = targets[i].getSkills();\r\n\t\t\t\t\t\tfor (var j = 0; j < skills.length; j++) {\r\n\t\t\t\t\t\t\tif (get.tag(skills[j], 'rejudge', targets[i])) {\r\n\t\t\t\t\t\t\t\tstop = true; break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar rand = Math.random() < 0.5 ? '选项一' : '选项二';\r\n\t\t\t\t\tvar sourcename = get.translation(trigger.source);\r\n\t\t\t\t\tvar playername = get.translation(trigger.player);\r\n\t\t\t\t\tplayer.chooseControl('选项一', '选项二', 'cancel2', function () {\r\n\t\t\t\t\t\tif (att1 == 0 && att2 == 0) return rand;\r\n\t\t\t\t\t\tif (att1 * att2 >= 0) {\r\n\t\t\t\t\t\t\tif (att1 + att2 > 0) {\r\n\t\t\t\t\t\t\t\treturn '选项二';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\treturn '选项一';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (trigger.player.isHealthy() && trigger.source.isHealthy()) return rand;\r\n\t\t\t\t\t\t\tif (trigger.player.isHealthy()) {\r\n\t\t\t\t\t\t\t\tif (att1 < 0) return '选项二';\r\n\t\t\t\t\t\t\t\tif (att1 > 0 && !stop) return '选项一';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (trigger.source.isHealthy()) {\r\n\t\t\t\t\t\t\t\tif (att2 < 0) return '选项二';\r\n\t\t\t\t\t\t\t\tif (att2 > 0 && !stop) return '选项一';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (stop) return 'cancel2';\r\n\t\t\t\t\t\t\treturn rand;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).set('prompt', get.prompt('boss_yuance')).set('choiceList', [\r\n\t\t\t\t\t\t'若判定结果为黑色，' + playername + '失去一点体力，否则' + sourcename + '失去一点体力',\r\n\t\t\t\t\t\t'若判定结果为红色，' + playername + '回复一点体力，否则' + sourcename + '回复一点体力'\r\n\t\t\t\t\t]);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar att1 = get.attitude(player, trigger.player);\r\n\t\t\t\t\tvar att2 = get.attitude(player, trigger.source);\r\n\t\t\t\t\tif (result.control == '选项一') {\r\n\t\t\t\t\t\tevent.type = 1;\r\n\t\t\t\t\t\tplayer.judge(function (card) {\r\n\t\t\t\t\t\t\tif (get.color(card) == 'black') {\r\n\t\t\t\t\t\t\t\tif (att1 > 0) return -1;\r\n\t\t\t\t\t\t\t\tif (att1 < 0) return 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (att2 > 0) return -1;\r\n\t\t\t\t\t\t\t\tif (att2 < 0) return 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (result.control == '选项二') {\r\n\t\t\t\t\t\tevent.type = 2;\r\n\t\t\t\t\t\tplayer.judge(function (card) {\r\n\t\t\t\t\t\t\tif (get.color(card) == 'red') {\r\n\t\t\t\t\t\t\t\tif (trigger.player.isDamaged()) {\r\n\t\t\t\t\t\t\t\t\tif (att1 > 0) return 1;\r\n\t\t\t\t\t\t\t\t\tif (att1 < 0) return -1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (trigger.source.isDamaged()) {\r\n\t\t\t\t\t\t\t\t\tif (att2 > 0) return 1;\r\n\t\t\t\t\t\t\t\t\tif (att2 < 0) return -1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (event.type == 1) {\r\n\t\t\t\t\t\tif (result.color == 'black') {\r\n\t\t\t\t\t\t\ttrigger.player.loseHp();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttrigger.source.loseHp();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (result.color == 'red') {\r\n\t\t\t\t\t\t\ttrigger.player.recover();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttrigger.source.recover();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_guixin: {\r\n\t\t\t\ttrigger: { global: 'drawAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tlogTarget: 'player',\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.result && event.result.length >= 2 && event.player != player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\ttrigger.player.chooseCard(function (card) {\r\n\t\t\t\t\t\treturn trigger.result.contains(card);\r\n\t\t\t\t\t}, '归心：交给' + get.translation(player) + '一张牌', true);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.gain(result.cards, trigger.player);\r\n\t\t\t\t\t\ttrigger.player.$give(1, player);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txiongcai: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\ttrigger: { player: 'phaseAfter' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.$.xiongcai = [];\r\n\t\t\t\t\t// player.$.xiongcai2=0;\r\n\t\t\t\t},\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: 'characters'\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\t// if(player.$.xiongcai2<1){\r\n\t\t\t\t\t//\t\tplayer.$.xiongcai2++;\r\n\t\t\t\t\t//\t\tevent.finish();\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t// else{\r\n\t\t\t\t\t//\t\tplayer.$.xiongcai2=0;\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.logSkill('xiongcai');\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tvar list2 = [];\r\n\t\t\t\t\tvar players = game.players.concat(game.dead);\r\n\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\tlist2.add(players[i].name);\r\n\t\t\t\t\t\tlist2.add(players[i].name1);\r\n\t\t\t\t\t\tlist2.add(players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i in lib.character) {\r\n\t\t\t\t\t\tif (lib.character[i][1] != 'wei') continue;\r\n\t\t\t\t\t\tif (lib.character[i][4].contains('boss')) continue;\r\n\t\t\t\t\t\tif (lib.character[i][4].contains('minskin')) continue;\r\n\t\t\t\t\t\tif (player.$.xiongcai.contains(i)) continue;\r\n\t\t\t\t\t\tif (list2.contains(i)) continue;\r\n\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar name = list.randomGet();\r\n\t\t\t\t\tplayer.$.xiongcai.push(name);\r\n\t\t\t\t\tplayer.markSkill('xiongcai');\r\n\t\t\t\t\tvar skills = lib.character[name][3];\r\n\t\t\t\t\tfor (var i = 0; i < skills.length; i++) {\r\n\t\t\t\t\t\tplayer.addSkill(skills[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.dialog = ui.create.dialog('<div class=\"text center\">' + get.translation(player) + '发动了【雄才】', [[name], 'character']);\r\n\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txiaoxiong: {\r\n\t\t\t\ttrigger: { global: 'useCardAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tforceunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tvar type = get.type(event.card, 'trick');\r\n\t\t\t\t\treturn event.player != player && (type == 'basic' || type == 'trick');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.gain(game.createCard(trigger.card), 'gain2');\r\n\t\t\t\t},\r\n\t\t\t\tgroup: 'xiaoxiong_damage',\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tdamage: {\r\n\t\t\t\t\t\ttrigger: { global: 'phaseJieshuBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn event.player != player && event.player.countUsed() == 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tlogTarget: 'player',\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.player.damage();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zhangwu: {\r\n\t\t\t\tglobal: 'boss_zhangwu_ai',\r\n\t\t\t\ttrigger: { player: 'damageEnd' },\r\n\t\t\t\tcheck: function (event, player) {\r\n\t\t\t\t\treturn event.source && event.source.isIn() && get.damageEffect(event.source, player, player) > 0;\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.source && event.source.isAlive();\r\n\t\t\t\t},\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tlogTarget: 'source',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseToDiscard(get.prompt('boss_zhangwu', trigger.source), 'he', [1, Infinity]).set('ai', function (card) {\r\n\t\t\t\t\t\tif (get.attitude(player, target) < 0) return 8 - get.value(card);\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}).set('logSkill', ['boss_zhangwu', trigger.source]);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tvar num = result.cards.length;\r\n\t\t\t\t\t\tvar cnum = get.cnNumber(num);\r\n\t\t\t\t\t\tevent.num = num;\r\n\t\t\t\t\t\ttrigger.source.chooseToDiscard('he', '章武：弃置' + cnum + '张牌，或取消并受到' + cnum + '点伤害', num).set('ai', function (card) {\r\n\t\t\t\t\t\t\tif (!trigger.source.hasSkillTag('nodamage')) return 10 - get.value(card);\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (!result.bool) {\r\n\t\t\t\t\t\ttrigger.source.damage(event.num);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tmaixie: true,\r\n\t\t\t\t\tmaixie_hp: true,\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'damage') && get.attitude(target, player) < 0 && player.countCards('he') < target.countCards('he')) {\r\n\t\t\t\t\t\t\t\treturn [0, 2];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zhangwu_ai: {\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'recover') && card.name != 'recover') {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\t\t\tif (game.players[i].hasSkill('xiaoxiong') && get.attitude(target, game.players[i]) < 0) {\r\n\t\t\t\t\t\t\t\t\t\treturn 'zeroplayertarget';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyueyin: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tmark: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: function (storage, player) {\r\n\t\t\t\t\t\tvar str = '扣减' + (7 - player.$.xiangxing_count) + '点体力后失去下一枚星；';\r\n\t\t\t\t\t\tstr += '防上禳星伤害条件：' + lib.translate['xiangxing' + player.$.xiangxing + '_info'];\r\n\t\t\t\t\t\treturn str;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmarkcount: function (storage, player) {\r\n\t\t\t\t\t\treturn Math.max(0, 7 - player.$.xiangxing_count);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tskipDamage: {\r\n\t\t\t\t\tx7: function (player) {\r\n\t\t\t\t\t\treturn player.countCards('h') == 0;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tx6: function (player, event) {\r\n\t\t\t\t\t\treturn event.nature == 'fire';\r\n\t\t\t\t\t},\r\n\t\t\t\t\tx5: function (player, event) {\r\n\t\t\t\t\t\treturn event.nature == 'thunder';\r\n\t\t\t\t\t},\r\n\t\t\t\t\tx4: function (player, event) {\r\n\t\t\t\t\t\treturn event.name == 'loseHp';\r\n\t\t\t\t\t},\r\n\t\t\t\t\tx3: function (player, event) {\r\n\t\t\t\t\t\treturn game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current != player && current.countCards('e') >= 4;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tx2: function (player) {\r\n\t\t\t\t\t\treturn player.countCards('j') >= 2;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tx1: function () {\r\n\t\t\t\t\t\treturn game.players.length == 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\txiangxing: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.$.xiangxing = 7;\r\n\t\t\t\t\tplayer.$.xiangxing_count = 0;\r\n\t\t\t\t\tplayer.addSkill('xiangxing7');\r\n\t\t\t\t},\r\n\t\t\t\tmark: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: '当前有#枚星'\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { player: ['damageEnd', 'loseHpEnd'] },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar num = trigger.num;\r\n\t\t\t\t\tif (num) {\r\n\t\t\t\t\t\tplayer.$.xiangxing_count += num;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (player.$.xiangxing_count >= 7) {\r\n\t\t\t\t\t\tif (player.hasSkill('yueyin') && lib.skill.yueyin.skipDamage['x' + player.$.xiangxing](player, trigger)) {\r\n\t\t\t\t\t\t\tevent.goto(3);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.removeSkill('xiangxing' + player.$.xiangxing);\r\n\t\t\t\t\t\tplayer.$.xiangxing--;\r\n\t\t\t\t\t\tplayer.$.xiangxing_count = 0;\r\n\t\t\t\t\t\tplayer.updateMarks();\r\n\t\t\t\t\t\tif (player.$.xiangxing) {\r\n\t\t\t\t\t\t\tplayer.addSkill('xiangxing' + player.$.xiangxing);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tplayer.awakenSkill('xiangxing');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.popup('xiangxing');\r\n\t\t\t\t\t\tgame.log(player, '失去了一枚星');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.updateMarks();\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list = game.filterPlayer();\r\n\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\tlist.sort(lib.sort.seat);\r\n\t\t\t\t\tvar list2 = [];\r\n\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\tlist2.push(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < 7; i++) {\r\n\t\t\t\t\t\tlist2[Math.floor(Math.random() * list2.length)]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list = list;\r\n\t\t\t\t\tevent.list2 = list2;\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (event.list.length) {\r\n\t\t\t\t\t\tvar target = event.list.shift();\r\n\t\t\t\t\t\ttarget.damage(event.list2.shift(), 'thunder');\r\n\t\t\t\t\t\tplayer.line(target, 'thunder');\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif (player.$.xiangxing == 0) {\r\n\t\t\t\t\t\tplayer.maxHp = 3;\r\n\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tfengqi: {\r\n\t\t\t\ttrigger: { player: ['phaseZhunbeiBegin', 'phaseJieshuBegin'] },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list = { basic: [], equip: [], trick: [], delay: [] };\r\n\t\t\t\t\tfor (var i = 0; i < lib.inpile.length; i++) {\r\n\t\t\t\t\t\tvar name = lib.inpile[i];\r\n\t\t\t\t\t\tvar info = lib.card[name];\r\n\t\t\t\t\t\tif (info.autoViewAs || name == 'yuansuhuimie') continue;\r\n\t\t\t\t\t\tif (lib.filter.cardEnabled({ name: name }, player)) {\r\n\t\t\t\t\t\t\tif (!list[info.type]) {\r\n\t\t\t\t\t\t\t\tlist[info.type] = [];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlist[info.type].push([get.translation(lib.card[name].type), '', name]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.trick.sort(lib.sort.name);\r\n\t\t\t\t\tvar dialog = ui.create.dialog('风起', [list.trick, 'vcard']);\r\n\t\t\t\t\t// for(var i in list){\r\n\t\t\t\t\t//\t\tdialog.addText(get.translation(i)+'牌');\r\n\t\t\t\t\t//\t\tdialog.add([list[i],'vcard']);\r\n\t\t\t\t\t// }\r\n\t\t\t\t\tvar rand1 = Math.random() < 1 / 3;\r\n\t\t\t\t\tvar rand2 = Math.random() < 0.5;\r\n\t\t\t\t\tvar rand3 = Math.random() < 1 / 3;\r\n\t\t\t\t\tvar rand4 = Math.random() < 1 / 3;\r\n\t\t\t\t\tplayer.chooseButton(dialog).ai = function (button) {\r\n\t\t\t\t\t\tvar name = button.link[2];\r\n\t\t\t\t\t\tif (player.hp <= 1) {\r\n\t\t\t\t\t\t\tswitch (name) {\r\n\t\t\t\t\t\t\t\tcase 'dunpaigedang': return 0.8;\r\n\t\t\t\t\t\t\t\tcase 'nanman': return 0.5;\r\n\t\t\t\t\t\t\t\tdefault: return 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (rand4 && player.countCards('h') <= 1) {\r\n\t\t\t\t\t\t\tswitch (name) {\r\n\t\t\t\t\t\t\t\tcase 'zengbin': return 1;\r\n\t\t\t\t\t\t\t\tcase 'wuzhong': return 0.8;\r\n\t\t\t\t\t\t\t\tdefault: return 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (player.hasSkill('qinglonglingzhu')) {\r\n\t\t\t\t\t\t\tif (rand2) return name == 'chiyuxi' ? 0.8 : 0;\r\n\t\t\t\t\t\t\treturn name == 'jingleishan' ? 0.8 : 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (rand2) return name == 'wanjian' ? 0.8 : 0;\r\n\t\t\t\t\t\treturn name == 'nanman' ? 0.8 : 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.chooseUseTarget(result.links[0][2], true, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: 1.5,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfengqi2: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\twuxieRespondable: function () {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgaiming: {\r\n\t\t\t\ttrigger: { player: 'judgeBefore' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tpriority: 1,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.cards = get.cards(7);\r\n\t\t\t\t\tplayer.chooseCardButton(true, event.cards, '改命：选择一张牌作为你的' + trigger.judgestr + '判定结果').ai = function (button) {\r\n\t\t\t\t\t\tif (get.attitude(player, trigger.player) > 0) {\r\n\t\t\t\t\t\t\treturn 1 + trigger.judge(button.link);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (get.attitude(player, trigger.player) < 0) {\r\n\t\t\t\t\t\t\treturn 1 - trigger.judge(button.link);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (!result.bool) {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.logSkill('gaiming', trigger.player);\r\n\t\t\t\t\tvar card = result.links[0];\r\n\t\t\t\t\tevent.cards.remove(card);\r\n\t\t\t\t\tvar judgestr = get.translation(trigger.player) + '的' + trigger.judgestr + '判定';\r\n\t\t\t\t\tevent.videoId = lib.status.videoId++;\r\n\t\t\t\t\tevent.dialog = ui.create.dialog(judgestr);\r\n\t\t\t\t\tevent.dialog.classList.add('center');\r\n\t\t\t\t\tevent.dialog.videoId = event.videoId;\r\n\r\n\t\t\t\t\tgame.addVideo('judge1', player, [get.cardInfo(card), judgestr, event.videoId]);\r\n\t\t\t\t\tfor (var i = 0; i < event.cards.length; i++) event.cards[i].discard();\r\n\t\t\t\t\t// var node=card.copy('thrown','center',ui.arena).animate('start');\r\n\t\t\t\t\tvar node;\r\n\t\t\t\t\tif (game.chess) {\r\n\t\t\t\t\t\tnode = card.copy('thrown', 'center', ui.arena).animate('start');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tnode = player.$throwordered(card.copy(), true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnode.classList.add('thrownhighlight');\r\n\t\t\t\t\tui.arena.classList.add('thrownhighlight');\r\n\t\t\t\t\tif (card) {\r\n\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\ttrigger.result = {\r\n\t\t\t\t\t\t\tcard: card,\r\n\t\t\t\t\t\t\tjudge: trigger.judge(card),\r\n\t\t\t\t\t\t\tnode: node,\r\n\t\t\t\t\t\t\tnumber: get.number(card),\r\n\t\t\t\t\t\t\tsuit: get.suit(card),\r\n\t\t\t\t\t\t\tcolor: get.color(card),\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (trigger.result.judge > 0) {\r\n\t\t\t\t\t\t\ttrigger.result.bool = true;\r\n\t\t\t\t\t\t\ttrigger.player.popup('洗具');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (trigger.result.judge < 0) {\r\n\t\t\t\t\t\t\ttrigger.result.bool = false;\r\n\t\t\t\t\t\t\ttrigger.player.popup('杯具');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.log(trigger.player, '的判定结果为', card);\r\n\t\t\t\t\t\ttrigger.direct = true;\r\n\t\t\t\t\t\ttrigger.position.appendChild(card);\r\n\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tui.arena.classList.remove('thrownhighlight');\r\n\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\tgame.addVideo('judge2', null, event.videoId);\r\n\t\t\t\t\tui.clear();\r\n\t\t\t\t\tvar card = trigger.result.card;\r\n\t\t\t\t\ttrigger.position.appendChild(card);\r\n\t\t\t\t\ttrigger.result.node.delete();\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\ttiandao: {\r\n\t\t\t\taudio: true,\r\n\t\t\t\ttrigger: { global: 'judge' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('he') > 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseCard(get.translation(trigger.player) + '的' + (trigger.judgestr || '') + '判定为' +\r\n\t\t\t\t\t\tget.translation(trigger.player.judging[0]) + '，' + get.prompt('tiandao'), 'he').ai = function (card) {\r\n\t\t\t\t\t\t\tvar trigger = _status.event.parent._trigger;\r\n\t\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\t\tvar result = trigger.judge(card) - trigger.judge(trigger.player.judging[0]);\r\n\t\t\t\t\t\t\tvar attitude = get.attitude(player, trigger.player);\r\n\t\t\t\t\t\t\tif (attitude == 0 || result == 0) return 0;\r\n\t\t\t\t\t\t\tif (attitude > 0) {\r\n\t\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\treturn -result;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.respond(result.cards, 'highlight');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('tiandao');\r\n\t\t\t\t\t\tplayer.$gain2(trigger.player.judging[0]);\r\n\t\t\t\t\t\tplayer.gain(trigger.player.judging[0]);\r\n\t\t\t\t\t\ttrigger.player.judging[0] = result.cards[0];\r\n\t\t\t\t\t\ttrigger.position.appendChild(result.cards[0]);\r\n\t\t\t\t\t\tgame.log(trigger.player, '的判定牌改为', result.cards[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\ttag: {\r\n\t\t\t\t\t\trejudge: 1\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten: 1.5\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlianji: {\r\n\t\t\t\taudio: true,\r\n\t\t\t\tenable: 'phaseUse',\r\n\t\t\t\tusable: 1,\r\n\t\t\t\tfilterTarget: function (card, player, target) {\r\n\t\t\t\t\tif (player == target) return false;\r\n\t\t\t\t\treturn target.countCards('h') > 0;\r\n\t\t\t\t},\r\n\t\t\t\tselectTarget: 2,\r\n\t\t\t\tmultitarget: true,\r\n\t\t\t\tmultiline: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('h') > 0;\r\n\t\t\t\t},\r\n\t\t\t\tprepare: 'throw',\r\n\t\t\t\tdiscard: false,\r\n\t\t\t\tfilterCard: true,\r\n\t\t\t\tcheck: function (card) {\r\n\t\t\t\t\treturn 6 - get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tif (targets[0].countCards('h') && targets[1].countCards('h')) {\r\n\t\t\t\t\t\ttargets[0].chooseToCompare(targets[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\ttargets[0].gain(cards);\r\n\t\t\t\t\t\ttargets[0].$gain2(cards);\r\n\t\t\t\t\t\ttargets[1].damage(targets[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttargets[1].gain(cards);\r\n\t\t\t\t\t\ttargets[1].$gain2(cards);\r\n\t\t\t\t\t\ttargets[0].damage(targets[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\texpose: 0.3,\r\n\t\t\t\t\tthreaten: 2,\r\n\t\t\t\t\torder: 9,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttarget: -1\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tmazui: {\r\n\t\t\t\taudio: true,\r\n\t\t\t\tenable: 'phaseUse',\r\n\t\t\t\tusable: 1,\r\n\t\t\t\tfilterCard: { color: 'black' },\r\n\t\t\t\tfilterTarget: function (card, player, target) {\r\n\t\t\t\t\treturn !target.hasSkill('mazui2');\r\n\t\t\t\t},\r\n\t\t\t\tcheck: function (card) {\r\n\t\t\t\t\treturn 6 - get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tdiscard: false,\r\n\t\t\t\tprepare: 'give',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttarget.$.mazui2 = cards[0];\r\n\t\t\t\t\ttarget.addSkill('mazui2');\r\n\t\t\t\t\tgame.addVideo('storage', target, ['mazui2', get.cardInfo(target.$.mazui2), 'card']);\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\texpose: 0.2,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttarget: function (player, target) {\r\n\t\t\t\t\t\t\treturn -target.hp;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\torder: 4,\r\n\t\t\t\t\tthreaten: 1.2\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmazui2: {\r\n\t\t\t\ttrigger: { source: 'damageBegin1' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tmark: 'card',\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.num > 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num--;\r\n\t\t\t\t\tplayer.addSkill('mazui3');\r\n\t\t\t\t\tplayer.removeSkill('mazui2');\r\n\t\t\t\t},\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: 'card'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmazui3: {\r\n\t\t\t\ttrigger: { source: ['damageEnd', 'damageZero'] },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.gain(player.$.mazui2, 'gain2');\r\n\t\t\t\t\tgame.log(player, '获得了', player.$.mazui2);\r\n\t\t\t\t\tplayer.removeSkill('mazui3');\r\n\t\t\t\t\tdelete player.$.mazui2;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyunshen: {\r\n\t\t\t\ttrigger: { player: ['respond', 'useCard'] },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.card.name == 'shan';\r\n\t\t\t\t},\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.$.yunshen = 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.$.yunshen++;\r\n\t\t\t\t\tplayer.markSkill('yunshen');\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'respondShan')) {\r\n\t\t\t\t\t\t\t\tvar shans = target.countCards('h', 'shan');\r\n\t\t\t\t\t\t\t\tvar hs = target.countCards('h');\r\n\t\t\t\t\t\t\t\tif (shans > 1) return [1, 1];\r\n\t\t\t\t\t\t\t\tif (shans && hs > 2) return [1, 1];\r\n\t\t\t\t\t\t\t\tif (shans) return [1, 0.5];\r\n\t\t\t\t\t\t\t\tif (hs > 2) return [1, 0.3];\r\n\t\t\t\t\t\t\t\tif (hs > 1) return [1, 0.2];\r\n\t\t\t\t\t\t\t\treturn [1.2, 0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten: 0.8\r\n\t\t\t\t},\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: 'mark'\r\n\t\t\t\t},\r\n\t\t\t\tgroup: 'yunshen2'\r\n\t\t\t},\r\n\t\t\tyunshen2: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.$.yunshen > 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(player.$.yunshen);\r\n\t\t\t\t\tplayer.$.yunshen = 0;\r\n\t\t\t\t\tplayer.unmarkSkill('yunshen');\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tglobalTo: function (from, to, distance) {\r\n\t\t\t\t\t\tif (typeof to.$.yunshen == 'number') return distance + to.$.yunshen;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlingbo: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: ['respond', 'useCard'] },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.card.name == 'shan';\r\n\t\t\t\t},\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tmingzhi: false,\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'respondShan')) {\r\n\t\t\t\t\t\t\t\tvar shans = target.countCards('h', 'shan');\r\n\t\t\t\t\t\t\t\tvar hs = target.countCards('h');\r\n\t\t\t\t\t\t\t\tif (shans > 1) return [0, 1];\r\n\t\t\t\t\t\t\t\tif (shans && hs > 2) return [0, 1];\r\n\t\t\t\t\t\t\t\tif (shans) return [0, 0];\r\n\t\t\t\t\t\t\t\tif (hs > 2) return [0, 0];\r\n\t\t\t\t\t\t\t\tif (hs > 1) return [1, 0.5];\r\n\t\t\t\t\t\t\t\treturn [1.5, 0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten: 0.8\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjiaoxia: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { target: 'useCardToTargeted' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.card && get.color(event.card) == 'red';\r\n\t\t\t\t},\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: function (card, player, target) {\r\n\t\t\t\t\t\tif (get.color(card) == 'red') return [1, 1];\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_nbianshenx: {},\r\n\t\t\tboss_jingjue: {\r\n\t\t\t\tinherit: 'boss_danshu'\r\n\t\t\t},\r\n\t\t\tboss_renxing: {\r\n\t\t\t\ttrigger: { global: ['damageEnd', 'recoverEnd'] },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn _status.currentPhase != player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_ruizhi: {\r\n\t\t\t\ttrigger: { global: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player != player && event.player.countCards('he') > 1;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.line(trigger.player, 'green');\r\n\t\t\t\t\tvar next = trigger.player.chooseCard(true, '选择保留一张手牌和一张装备区内的牌，然后弃置其它牌', 'he', function (card) {\r\n\t\t\t\t\t\tswitch (get.position(card)) {\r\n\t\t\t\t\t\t\tcase 'h': {\r\n\t\t\t\t\t\t\t\tif (ui.selected.cards.length) {\r\n\t\t\t\t\t\t\t\t\treturn get.position(ui.selected.cards[0]) == 'e';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\treturn trigger.player.countCards('h') > 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'e': {\r\n\t\t\t\t\t\t\t\tif (ui.selected.cards.length) {\r\n\t\t\t\t\t\t\t\t\treturn get.position(ui.selected.cards[0]) == 'h';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\treturn trigger.player.countCards('e') > 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar num = 0;\r\n\t\t\t\t\tif (trigger.player.countCards('h') > 1) {\r\n\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (trigger.player.countCards('e') > 1) {\r\n\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnext.selectCard = [num, num];\r\n\t\t\t\t\tnext.ai = function (card) {\r\n\t\t\t\t\t\treturn get.value(card);\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tvar he = [];\r\n\t\t\t\t\t\tvar hs = trigger.player.getCards('h');\r\n\t\t\t\t\t\tvar es = trigger.player.getCards('e');\r\n\t\t\t\t\t\tif (hs.length > 1) {\r\n\t\t\t\t\t\t\the = he.concat(hs);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (es.length > 1) {\r\n\t\t\t\t\t\t\the = he.concat(es);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (var i = 0; i < result.cards.length; i++) {\r\n\t\t\t\t\t\t\the.remove(result.cards[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttrigger.player.discard(he);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_nbaonu: {\r\n\t\t\t\tgroup: ['boss_nbaonu_sha'],\r\n\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -1,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (player.hp > 4) {\r\n\t\t\t\t\t\ttrigger.num = 4 + Math.floor(Math.random() * (player.hp - 3));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttrigger.num = 4;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tsha: {\r\n\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\tcardUsable: function (card, player, num) {\r\n\t\t\t\t\t\t\t\tif (card.name == 'sha' && player.hp < 5) return Infinity;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttrigger: { source: 'damageBegin1' },\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn event.card && event.card.name == 'sha' && event.notLink() && player.hp < 5;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_shouyi: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\ttargetInRange: function () {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_mengtai: {\r\n\t\t\t\tgroup: ['boss_mengtai_begin', 'boss_mengtai_draw', 'boss_mengtai_use',\r\n\t\t\t\t\t'boss_mengtai_discard', 'boss_mengtai_end'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tbegin: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tpopup: false,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.$.boss_mengtai_draw = true;\r\n\t\t\t\t\t\t\tplayer.$.boss_mengtai_use = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdraw: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tpopup: false,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.$.boss_mengtai_draw = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tuse: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseUseBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tpopup: false,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.$.boss_mengtai_use = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdiscard: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseDiscardBefore' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\tif (player.$.boss_mengtai_use) return true;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tend: {\r\n\t\t\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\tif (player.$.boss_mengtai_draw) return true;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.draw(3);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_nbianshen: {\r\n\t\t\t\ttrigger: { player: 'phaseBefore' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tpriority: 25,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (player.name == 'boss_nianshou_heti' || player.$.boss_nbianshen) return true;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tif (player.$.boss_nbianshen) {\r\n\t\t\t\t\t\tvar hp = player.hp,\r\n\t\t\t\t\t\t\tmaxHp = player.maxHp,\r\n\t\t\t\t\t\t\thujia = player.hujia;\r\n\t\t\t\t\t\tplayer.init('boss_nianshou_' + player.$.boss_nbianshen_next);\r\n\t\t\t\t\t\tplayer.$.boss_nbianshen.remove(player.$.boss_nbianshen_next);\r\n\t\t\t\t\t\tif (!player.$.boss_nbianshen.length) {\r\n\t\t\t\t\t\t\tplayer.$.boss_nbianshen = ['jingjue', 'renxing', 'ruizhi', 'baonu'];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.$.boss_nbianshen_next = player.$.boss_nbianshen.randomGet(player.$.boss_nbianshen_next);\r\n\t\t\t\t\t\tplayer.hp = hp;\r\n\t\t\t\t\t\tplayer.maxHp = maxHp;\r\n\t\t\t\t\t\tplayer.hujia = hujia;\r\n\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.$.boss_nbianshen = ['jingjue', 'renxing', 'ruizhi', 'baonu'];\r\n\t\t\t\t\t\tplayer.$.boss_nbianshen_next = player.$.boss_nbianshen.randomGet();\r\n\t\t\t\t\t\tplayer.markSkill('boss_nbianshen');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: function (storage, player) {\r\n\t\t\t\t\t\tvar map = {\r\n\t\t\t\t\t\t\tjingjue: '警觉',\r\n\t\t\t\t\t\t\trenxing: '任性',\r\n\t\t\t\t\t\t\truizhi: '睿智',\r\n\t\t\t\t\t\t\tbaonu: '暴怒'\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treturn '下一个状态：' + map[player.$.boss_nbianshen_next];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_damagecount: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_damagecount2'\r\n\t\t\t},\r\n\t\t\tboss_damagecount2: {\r\n\t\t\t\ttrigger: { source: 'damageEnd' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (!ui.damageCount) return false;\r\n\t\t\t\t\treturn event.num > 0 && player.isFriendOf(game.me) && event.player.isEnemyOf(game.me);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t_status.damageCount += trigger.num;\r\n\t\t\t\t\tui.damageCount.innerHTML = '伤害: ' + _status.damageCount;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_nianrui: {\r\n\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num += 2;\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: 1.6\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qixiang: {\r\n\t\t\t\tgroup: ['boss_qixiang1', 'boss_qixiang2'],\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target, current) {\r\n\t\t\t\t\t\t\tif (card.name == 'lebu' && card.name == 'bingliang') return 0.8;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qixiang1: {\r\n\t\t\t\ttrigger: { player: 'judge' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (event.card) {\r\n\t\t\t\t\t\tif (event.card.viewAs) {\r\n\t\t\t\t\t\t\treturn event.card.viewAs == 'lebu';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\treturn event.card.name == 'lebu';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.addTempSkill('boss_qixiang3', 'judgeAfter');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qixiang2: {\r\n\t\t\t\ttrigger: { player: 'judge' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (event.card) {\r\n\t\t\t\t\t\tif (event.card.viewAs) {\r\n\t\t\t\t\t\t\treturn event.card.viewAs == 'bingliang';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\treturn event.card.name == 'bingliang';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.addTempSkill('boss_qixiang4', 'judgeAfter');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qixiang3: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tsuit: function (card, suit) {\r\n\t\t\t\t\t\tif (suit == 'diamond') return 'heart';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qixiang4: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tsuit: function (card, suit) {\r\n\t\t\t\t\t\tif (suit == 'spade') return 'club';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bianshen2: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobal: 'boss_bianshen2x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bianshen2x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_bianshen2');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.changeBoss(['boss_niutou', 'boss_mamian'].randomGet());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bianshen3: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_bianshen3x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bianshen3x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_bianshen3');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.changeBoss(['boss_baiwuchang', 'boss_heiwuchang'].randomGet());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bianshen4: {\r\n\t\t\t\tmode: ['boss'],\r\n\t\t\t\tglobal: 'boss_bianshen4x',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\tgame.addVideo('hidePlayer', player);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bianshen4x: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: -10,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tif (lib.config.mode != 'boss') return false;\r\n\t\t\t\t\treturn event.player == game.boss && event.player.hasSkill('boss_bianshen4');\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.changeBoss(['boss_yecha', 'boss_luocha'].randomGet());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_moyany: {\r\n\t\t\t\ttrigger: { player: 'loseEnd' },\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn _status.currentPhase != player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.judge(function (card) {\r\n\t\t\t\t\t\treturn get.color(card) == 'red' ? 1 : 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.chooseTarget(true, '选择一个目标对其造成两点火焰伤害', function (card, player, target) {\r\n\t\t\t\t\t\t\treturn player != target;\r\n\t\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\t\treturn get.damageEffect(target, player, player, 'fire');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif (result.targets.length) {\r\n\t\t\t\t\t\tplayer.line(result.targets, 'fire');\r\n\t\t\t\t\t\tresult.targets[0].damage(2, 'fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'loseCard')) {\r\n\t\t\t\t\t\t\t\treturn [0.5, 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_danshu: {\r\n\t\t\t\ttrigger: { player: 'loseEnd' },\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn _status.currentPhase != player && player.hp < player.maxHp;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.judge(function (card) {\r\n\t\t\t\t\t\treturn get.color(card) == 'red' ? 1 : 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.color == 'red') {\r\n\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'loseCard')) {\r\n\t\t\t\t\t\t\t\treturn [0.5, 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_modao: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_mojian: {\r\n\t\t\t\ttrigger: { player: 'phaseUseBegin' },\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn player.canUse('wanjian', current) && current.isEnemyOf(player);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlist.sort(lib.sort.seat);\r\n\t\t\t\t\tplayer.useCard({ name: 'wanjian' }, list);\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: 1.8\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_yushou: {\r\n\t\t\t\ttrigger: { player: 'phaseUseBegin' },\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar list = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn player.canUse('nanman', current) && current.isEnemyOf(player);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlist.sort(lib.sort.seat);\r\n\t\t\t\t\tplayer.useCard({ name: 'nanman' }, list);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zuijiu: {\r\n\t\t\t\ttrigger: { source: 'damageBegin1' },\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.card && (event.card.name == 'sha' || event.card.name == 'juedou') &&\r\n\t\t\t\t\t\tevent.parent.name != '_lianhuan' && event.parent.name != '_lianhuan2';\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xixing: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_xixing'), function (card, player, target) {\r\n\t\t\t\t\t\treturn player != target && target.isLinked();\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\treturn get.damageEffect(target, player, player, 'thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_xixing', result.targets);\r\n\t\t\t\t\t\tresult.targets[0].damage('thunder');\r\n\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_suoming: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn game.hasPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player && !current.isLinked();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar num = game.countPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player && !current.isLinked();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_suoming'), [1, num], function (card, player, target) {\r\n\t\t\t\t\t\treturn !target.isLinked() && player != target;\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\treturn -get.attitude(player, target);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_suoming', result.targets);\r\n\t\t\t\t\t\tevent.targets = result.targets;\r\n\t\t\t\t\t\tevent.num = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif (event.num < event.targets.length) {\r\n\t\t\t\t\t\tevent.targets[event.num].link();\r\n\t\t\t\t\t\tevent.num++;\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_taiping: {\r\n\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num += 2;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baolian: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xiaoshou: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_xiaoshou'), function (card, player, target) {\r\n\t\t\t\t\t\treturn player != target && target.hp >= player.hp;\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\treturn get.damageEffect(target, player, player, 'fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_xiaoshou', result.targets);\r\n\t\t\t\t\t\tresult.targets[0].damage('fire', 3);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_manjia: {\r\n\t\t\t\tgroup: ['boss_manjia1', 'boss_manjia2']\r\n\t\t\t},\r\n\t\t\tboss_manjia1: {\r\n\t\t\t\ttrigger: { target: ['useCardToBefore', 'shaBegin'] },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: 6,\r\n\t\t\t\tfilter: function (event, player, name) {\r\n\t\t\t\t\tif (player.getEquip(2)) return false;\r\n\t\t\t\t\tif (name == 'shaBegin') return lib.skill.tengjia3.filter(event, player);\r\n\t\t\t\t\treturn lib.skill.tengjia1.filter(event, player);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target, current) {\r\n\t\t\t\t\t\t\tif (target.getEquip(2)) return;\r\n\t\t\t\t\t\t\treturn lib.skill.tengjia1.ai.effect.target.apply(this, arguments);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_manjia2: {\r\n\t\t\t\ttrigger: { player: 'damageBegin3' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (player.getEquip(2)) return false;\r\n\t\t\t\t\tif (event.nature == 'fire') return true;\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcheck: function () {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target, current) {\r\n\t\t\t\t\t\t\tif (target.getEquip(2)) return;\r\n\t\t\t\t\t\t\treturn lib.skill.tengjia2.ai.effect.target.apply(this, arguments);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_lianyu: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.players = get.players(player);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (event.players.length) {\r\n\t\t\t\t\t\tvar current = event.players.shift();\r\n\t\t\t\t\t\tif (current.isEnemyOf(player)) {\r\n\t\t\t\t\t\t\tplayer.line(current, 'fire');\r\n\t\t\t\t\t\t\tcurrent.damage('fire');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: 2\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_guiji: {\r\n\t\t\t\ttrigger: { player: 'phaseJudgeBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.discard(player.getCards('j').randomGet());\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('j') > 0;\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target, current) {\r\n\t\t\t\t\t\t\tif (get.type(card) == 'delay' && target.countCards('j') == 0) return 0.1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_minbao: {\r\n\t\t\t\tglobal: 'boss_minbao2'\r\n\t\t\t},\r\n\t\t\tboss_minbao2: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player.hasSkill('boss_minbao') && event.player.isDead();\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.player.line(player, 'fire');\r\n\t\t\t\t\tplayer.damage('nosource', 'fire').animate = false;\r\n\t\t\t\t\tplayer.$damage(trigger.player);\r\n\t\t\t\t\tplayer.$damagepop(-1, 'fire');\r\n\t\t\t\t\tif (lib.config.animation && !lib.config.low_performance) {\r\n\t\t\t\t\t\tplayer.$fire();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!event.parent.parent.boss_minbao_logv) {\r\n\t\t\t\t\t\tevent.parent.parent.boss_minbao_logv = true;\r\n\t\t\t\t\t\tgame.logv(trigger.player, 'boss_minbao', game.filterPlayer(), event.parent.parent);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_guihuo: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_guihuo'), function (card, player, target) {\r\n\t\t\t\t\t\treturn player != target;\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\treturn get.damageEffect(target, player, player, 'fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_guihuo', result.targets);\r\n\t\t\t\t\t\tresult.targets[0].damage('fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_luolei: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_luolei'), function (card, player, target) {\r\n\t\t\t\t\t\treturn player != target;\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\treturn get.damageEffect(target, player, player, 'thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_luolei', result.targets);\r\n\t\t\t\t\t\tresult.targets[0].damage('thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_beiming: {\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.source != undefined;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.source.discard(trigger.source.getCards('h'));\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: 0.7\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_shanbeng: {\r\n\t\t\t\tglobal: 'boss_shanbeng2',\r\n\t\t\t\ttrigger: { player: 'dieBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tlogv: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar targets = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn current.countCards('e');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tplayer.line(targets, 'green');\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\tgame.logv(player, 'boss_shanbeng', targets, null, true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_shanbeng2: {\r\n\t\t\t\ttrigger: { global: 'dieAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tglobalFixed: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('e') > 0 && event.player.hasSkill('boss_shanbeng') && event.player.isDead();\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.discard(player.getCards('e'));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_didong: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_didong'), function (card, player, target) {\r\n\t\t\t\t\t\treturn target.isEnemyOf(player);\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\tvar att = get.attitude(player, target);\r\n\t\t\t\t\t\tif (target.isTurnedOver()) {\r\n\t\t\t\t\t\t\tif (att > 0) {\r\n\t\t\t\t\t\t\t\treturn att + 5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (player.isTurnedOver()) {\r\n\t\t\t\t\t\t\treturn 5 - att;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn -att;\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_didong', result.targets);\r\n\t\t\t\t\t\tresult.targets[0].turnOver();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: 1.7\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_guimei: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\ttargetEnabled: function (card, player, target) {\r\n\t\t\t\t\t\tif (get.type(card) == 'delay') {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bianshen: {\r\n\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.smoothAvatar();\r\n\t\t\t\t\tplayer.init(['boss_chi', 'boss_mo', 'boss_wang', 'boss_liang'].randomGet());\r\n\t\t\t\t\tgame.addVideo('reinit2', player, player.name);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_bianshen_intro1: { nobracket: true },\r\n\t\t\tboss_bianshen_intro2: { nobracket: true },\r\n\t\t\tboss_bianshen_intro3: { nobracket: true },\r\n\t\t\tboss_bianshen_intro4: { nobracket: true },\r\n\t\t\tboss_chiyan_intro1: { nobracket: true },\r\n\t\t\tboss_chiyan_intro2: { nobracket: true },\r\n\t\t\tboss_chiyan_intro3: { nobracket: true },\r\n\t\t\tboss_chiyan_intro4: { nobracket: true },\r\n\t\t\tboss_qingmu_intro1: { nobracket: true },\r\n\t\t\tboss_qingmu_intro2: { nobracket: true },\r\n\t\t\tboss_qingmu_intro3: { nobracket: true },\r\n\t\t\tboss_qingmu_intro4: { nobracket: true },\r\n\t\t\tboss_baimang_intro1: { nobracket: true },\r\n\t\t\tboss_baimang_intro2: { nobracket: true },\r\n\t\t\tboss_baimang_intro3: { nobracket: true },\r\n\t\t\tboss_baimang_intro4: { nobracket: true },\r\n\t\t\tboss_xuanlin_intro1: { nobracket: true },\r\n\t\t\tboss_xuanlin_intro2: { nobracket: true },\r\n\t\t\tboss_xuanlin_intro3: { nobracket: true },\r\n\t\t\tboss_xuanlin_intro4: { nobracket: true },\r\n\t\t\tzhanjiang: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tvar players = game.filterPlayer();\r\n\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\tif (players[i] != player && players[i].getEquip('qinggang')) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar players = game.filterPlayer();\r\n\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\tif (players[i] != player) {\r\n\t\t\t\t\t\t\tvar e = players[i].getEquip('qinggang');\r\n\t\t\t\t\t\t\tif (e) {\r\n\t\t\t\t\t\t\t\tplayer.line(players[i], 'green');\r\n\t\t\t\t\t\t\t\tplayers[i].give(e, player);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_juejing: {\r\n\t\t\t\ttrigger: { player: 'phaseDrawBefore' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tnoh: true,\r\n\t\t\t\t},\r\n\t\t\t\tgroup: 'boss_juejing2'\r\n\t\t\t},\r\n\t\t\tboss_juejing2: {\r\n\t\t\t\ttrigger: { player: 'loseEnd' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('h') < 4;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(4 - player.countCards('h'));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_leiji: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: ['respond', 'useCard'] },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.card.name == 'shan';\r\n\t\t\t\t},\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\";\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_leiji')).ai = function (target) {\r\n\t\t\t\t\t\treturn get.damageEffect(target, player, player, 'thunder');\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_leiji', result.targets, 'thunder');\r\n\t\t\t\t\t\tevent.target = result.targets[0];\r\n\t\t\t\t\t\tevent.target.judge(function (card) {\r\n\t\t\t\t\t\t\t// var suit=get.suit(card);\r\n\t\t\t\t\t\t\t// if(suit=='spade') return -4;\r\n\t\t\t\t\t\t\t// if(suit=='club') return -2;\r\n\t\t\t\t\t\t\tif (get.color(card) == 'black') return -2;\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif (result.bool == false) {\r\n\t\t\t\t\t\tevent.target.damage('thunder');\r\n\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target, current) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'respondShan')) {\r\n\t\t\t\t\t\t\t\tvar hastarget = false, players = game.filterPlayer();\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\t\t\t\tif (get.attitude(target, players[i]) < 0) {\r\n\t\t\t\t\t\t\t\t\t\thastarget = true; break;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar be = target.countCards('e', { color: 'black' });\r\n\t\t\t\t\t\t\t\tif (target.countCards('h', 'shan') && be) {\r\n\t\t\t\t\t\t\t\t\tif (!target.hasSkill('guidao')) return 0;\r\n\t\t\t\t\t\t\t\t\treturn [0, hastarget ? target.countCards('he') / 2 : 0];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (target.countCards('h', 'shan') && target.countCards('h') > 2) {\r\n\t\t\t\t\t\t\t\t\tif (!target.hasSkill('guidao')) return 0;\r\n\t\t\t\t\t\t\t\t\treturn [0, hastarget ? target.countCards('h') / 4 : 0];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (target.countCards('h') > 3 || (be && target.countCards('h') >= 2)) {\r\n\t\t\t\t\t\t\t\t\treturn [0, 0];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (target.countCards('h') == 0) {\r\n\t\t\t\t\t\t\t\t\treturn [1.5, 0];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (target.countCards('h') == 1 && !be) {\r\n\t\t\t\t\t\t\t\t\treturn [1.2, 0];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (!target.hasSkill('guidao')) return [1, 0.05];\r\n\t\t\t\t\t\t\t\treturn [1, Math.min(0.5, (target.countCards('h') + be) / 4)];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\twuqin: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('h') == 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(3)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baolin: {\r\n\t\t\t\taudio: true,\r\n\t\t\t\tinherit: 'juece',\r\n\t\t\t},\r\n\t\t\tboss_qiangzheng: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn game.hasPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player && current.countCards('h');\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar players = get.players(player);\r\n\t\t\t\t\tplayers.remove(player);\r\n\t\t\t\t\tevent.players = players;\r\n\t\t\t\t\tplayer.line(players, 'green');\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (event.players.length) {\r\n\t\t\t\t\t\tvar current = event.players.shift();\r\n\t\t\t\t\t\tvar hs = current.getCards('h')\r\n\t\t\t\t\t\tif (hs.length) {\r\n\t\t\t\t\t\t\tvar card = hs.randomGet();\r\n\t\t\t\t\t\t\tplayer.gain(card, current);\r\n\t\t\t\t\t\t\tcurrent.$giveAuto(card, player);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tguizhen: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: 'loseEnd' },\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (player.countCards('h')) return false;\r\n\t\t\t\t\tfor (var i = 0; i < event.cards.length; i++) {\r\n\t\t\t\t\t\tif (event.cards[i].original == 'h') return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar players = get.players(player);\r\n\t\t\t\t\tplayers.remove(player);\r\n\t\t\t\t\tevent.players = players;\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (event.players.length) {\r\n\t\t\t\t\t\tvar current = event.players.shift();\r\n\t\t\t\t\t\tvar hs = current.getCards('h');\r\n\t\t\t\t\t\tif (hs.length) {\r\n\t\t\t\t\t\t\tcurrent.lose(hs)._triggered = null;\r\n\t\t\t\t\t\t\tcurrent.$throw(hs);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tcurrent.loseHp();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_konghun: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function () {\r\n\t\t\t\t\treturn game.players.length >= 3;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(function (card, player, target) {\r\n\t\t\t\t\t\treturn target != player;\r\n\t\t\t\t\t}).ai = function () {\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('boss_konghun', result.targets);\r\n\t\t\t\t\t\tresult.targets[0].goMad();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup: 'boss_konghun2'\r\n\t\t\t},\r\n\t\t\tboss_konghun2: {\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar players = game.players.concat(game.dead);\r\n\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\tif (players[i].isMad()) {\r\n\t\t\t\t\t\t\tplayers[i].unMad();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyuehun: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_wange: {\r\n\t\t\t\tinherit: 'boss_guiji'\r\n\t\t\t},\r\n\t\t\tfengwu: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tenable: 'phaseUse',\r\n\t\t\t\tusable: 1,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.current = player.next;\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tevent.current.chooseToUse({ name: 'sha' }, function (card, player, target) {\r\n\t\t\t\t\t\tif (player == target) return false;\r\n\t\t\t\t\t\tif (get.distance(player, target) <= 1) return true;\r\n\t\t\t\t\t\tvar players = game.filterPlayer();\r\n\t\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\t\tif (players[i] == player) continue;\r\n\t\t\t\t\t\t\tif (get.distance(player, players[i]) < get.distance(player, target)) return false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif (result.bool == false) event.current.loseHp();\r\n\t\t\t\t\tif (event.current.next != player) {\r\n\t\t\t\t\t\tevent.current = event.current.next;\r\n\t\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\torder: 1,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\tplayer: function (player) {\r\n\t\t\t\t\t\t\tif (player.countCards('h', 'shan')) return 1;\r\n\t\t\t\t\t\t\tvar num = 0, players = game.filterPlayer();\r\n\t\t\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\t\t\tif (players[i].canUse('sha', player) && players[i].countCards('h') > 1) {\r\n\t\t\t\t\t\t\t\t\tnum--;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thuanhua: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { global: 'gameDrawAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i] == player) continue;\r\n\t\t\t\t\t\tplayer.maxHp += game.players[i].maxHp;\r\n\t\t\t\t\t\tif (!game.players[i].name || !lib.character[game.players[i].name]) continue;\r\n\t\t\t\t\t\tvar skills = lib.character[game.players[i].name][3];\r\n\t\t\t\t\t\tfor (var j = 0; j < skills.length; j++) {\r\n\t\t\t\t\t\t\tif (!lib.skill[skills[j]].forceunique) {\r\n\t\t\t\t\t\t\t\tplayer.addSkill(skills[j]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.hp = player.maxHp;\r\n\t\t\t\t\tplayer.update();\r\n\t\t\t\t},\r\n\t\t\t\tgroup: ['huanhua3', 'huanhua4'],\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: 0.8,\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card) {\r\n\t\t\t\t\t\t\tif (card.name == 'bingliang') return 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thuanhua2: {\r\n\t\t\t\ttrigger: { player: 'phaseDrawBefore' },\r\n\t\t\t\tpriority: 10,\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tcheck: function () {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thuanhua3: {\r\n\t\t\t\ttrigger: { global: 'drawAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (event.parent.name != 'phaseDraw') return false;\r\n\t\t\t\t\treturn event.player != player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(trigger.num);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thuanhua4: {\r\n\t\t\t\ttrigger: { global: 'discardAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (event.parent.parent.name != 'phaseDiscard') return false;\r\n\t\t\t\t\treturn event.player != player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.chooseToDiscard(trigger.cards.length, true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjidian: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { source: 'damageAfter' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('jidian'), function (card, player, target) {\r\n\t\t\t\t\t\treturn get.distance(trigger.player, target) <= 1 && trigger.player != target;\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\treturn get.damageEffect(target, player, player, 'thunder') + 0.1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tevent.target = result.targets[0];\r\n\t\t\t\t\t\tevent.target.judge(function (card) {\r\n\t\t\t\t\t\t\treturn get.color(card) == 'red' ? 0 : -1;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tplayer.logSkill('jidian', event.target, false);\r\n\t\t\t\t\t\ttrigger.player.line(event.target, 'thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif (result.color == 'black') {\r\n\t\t\t\t\t\tevent.target.damage('thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttinqin: {\r\n\t\t\t\taudio: false,\r\n\t\t\t\tinherit: 'manjuan'\r\n\t\t\t},\r\n\t\t\tboss_hujia: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (player.hp == player.maxHp) return false;\r\n\t\t\t\t\tif (!player.countCards('he')) return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseCardTarget({\r\n\t\t\t\t\t\tposition: 'he',\r\n\t\t\t\t\t\tfilterTarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (player == target) return false;\r\n\t\t\t\t\t\t\tif (!lib.character[target.name]) return false;\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilterCard: lib.filter.cardDiscardable,\r\n\t\t\t\t\t\tai1: function (card) {\r\n\t\t\t\t\t\t\treturn get.unuseful(card) + 9;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai2: function (target) {\r\n\t\t\t\t\t\t\tif (target.$.boss_hujia) return Math.max(1, 10 - target.maxHp);\r\n\t\t\t\t\t\t\treturn 1 / target.maxHp;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprompt: get.prompt('boss_hujia')\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tvar target = result.targets[0];\r\n\t\t\t\t\t\tplayer.logSkill('boss_hujia', target);\r\n\t\t\t\t\t\tif (target.$.boss_hujia) {\r\n\t\t\t\t\t\t\ttarget.loseMaxHp();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttarget.disableSkill('boss_hujia', lib.character[target.name][3]);\r\n\t\t\t\t\t\t\ttarget.$.boss_hujia = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.discard(result.cards);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\texpose: 0.2,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_guihan: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tenable: 'chooseToUse',\r\n\t\t\t\tmark: true,\r\n\t\t\t\tderivation: ['tinqin', 'boss_huixin'],\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.$.boss_guihan = false;\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (event.type != 'dying') return false;\r\n\t\t\t\t\tif (!player.isDying()) return false;\r\n\t\t\t\t\tif (player.$.boss_guihan) return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.removeSkill('boss_guihan');\r\n\t\t\t\t\tplayer.recover(player.maxHp - player.hp);\r\n\t\t\t\t\tplayer.$.boss_guihan = true;\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tplayer.draw(4);\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tgame.players[i].enableSkill('boss_hujia');\r\n\t\t\t\t\t\tdelete game.players[i].storage.boss_hujia;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (game.bossinfo) {\r\n\t\t\t\t\t\tgame.bossinfo.loopType = 1;\r\n\t\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.removeSkill('beige');\r\n\t\t\t\t\tplayer.removeSkill('boss_hujia');\r\n\t\t\t\t\tplayer.addSkill('tinqin');\r\n\t\t\t\t\tplayer.addSkill('boss_huixin');\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tskillTagFilter: function (player) {\r\n\t\t\t\t\t\tif (player.$.boss_guihan) return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsave: true,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\tplayer: 4,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: 'limited'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thuoshen: {\r\n\t\t\t\ttrigger: { player: 'damageBegin1' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn event.nature == 'fire';\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\tplayer.recover();\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'fireDamage')) {\r\n\t\t\t\t\t\t\t\treturn [0, 2];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_xianyin: {\r\n\t\t\t\ttrigger: { player: 'loseEnd' },\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn _status.currentPhase != player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.judge(function (card) {\r\n\t\t\t\t\t\treturn get.color(card) == 'red' ? 1 : 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.chooseTarget(true, '选择一个目标令其失去一点体力', function (card, player, target) {\r\n\t\t\t\t\t\t\treturn player != target;\r\n\t\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\t\treturn Math.max(1, 9 - target.hp);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif (result.targets.length) {\r\n\t\t\t\t\t\tplayer.line(result.targets);\r\n\t\t\t\t\t\tresult.targets[0].loseHp();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'loseCard')) {\r\n\t\t\t\t\t\t\t\treturn [0.5, 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_huixin: {\r\n\t\t\t\ttrigger: { player: 'loseEnd' },\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn _status.currentPhase != player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.judge();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.color == 'black') {\r\n\t\t\t\t\t\t_status.currentPhase.loseHp();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'loseCard')) {\r\n\t\t\t\t\t\t\t\treturn [0.5, 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_shengshou: {\r\n\t\t\t\taudio: true,\r\n\t\t\t\ttrigger: { player: 'useCard' },\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.hp < player.maxHp;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.judge(function (card) {\r\n\t\t\t\t\t\treturn get.color(card) == 'red' ? 1 : 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_honglian: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.players = get.players(player);\r\n\t\t\t\t\tevent.players.remove(player);\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (event.players.length) {\r\n\t\t\t\t\t\tevent.players.shift().damage('fire');\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_yuhuo: {\r\n\t\t\t\ttrigger: { player: 'niepanAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tderivation: ['shenwei', 'zhuyu'],\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.addSkill('kanpo');\r\n\t\t\t\t\tplayer.addSkill('shenwei');\r\n\t\t\t\t\tplayer.addSkill('zhuyu');\r\n\t\t\t\t\tif (game.bossinfo) {\r\n\t\t\t\t\t\tgame.bossinfo.loopType = 1;\r\n\t\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_tianyu: {\r\n\t\t\t\taudio: true,\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (player.isLinked()) return true;\r\n\t\t\t\t\treturn game.hasPlayer(function (current) {\r\n\t\t\t\t\t\treturn current != player && !current.isLinked();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.targets = game.filterPlayer();\r\n\t\t\t\t\tevent.targets.remove(player);\r\n\t\t\t\t\tevent.targets.sort(lib.sort.seat);\r\n\t\t\t\t\tif (player.isLinked()) player.link();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (event.targets.length) {\r\n\t\t\t\t\t\tvar target = event.targets.shift();\r\n\t\t\t\t\t\tif (!target.isLinked()) {\r\n\t\t\t\t\t\t\ttarget.link();\r\n\t\t\t\t\t\t\tplayer.line(target, 'green');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jizhi: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: 'useCard' },\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\tvar type = get.type(event.card, 'trick');\r\n\t\t\t\t\treturn type != 'basic' && event.card.isCard;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tvar cards = get.cards();\r\n\t\t\t\t\tplayer.gain(cards, 'gain2');\r\n\t\t\t\t\tgame.log(player, '获得了', cards);\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: 1.4,\r\n\t\t\t\t\tnoautowuxie: true,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_guiyin: {\r\n\t\t\t\tmod: {\r\n\t\t\t\t\ttargetEnabled: function (card, player, target) {\r\n\t\t\t\t\t\tif (_status.currentPhase == player && target.hp < player.hp) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_gongshen: {\r\n\t\t\t\ttrigger: { global: 'gameDrawAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i] != player) {\r\n\t\t\t\t\t\t\tgame.players[i].forcemin = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\ttargetEnabled: function (card, player, target) {\r\n\t\t\t\t\t\tif (get.type(card) == 'delay' && player != target) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfanghua: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function () {\r\n\t\t\t\t\treturn game.hasPlayer(function (current) {\r\n\t\t\t\t\t\treturn current.isTurnedOver();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.players = get.players(player);\r\n\t\t\t\t\tevent.num = 0;\r\n\t\t\t\t\tfor (var i = 0; i < event.players.length; i++) {\r\n\t\t\t\t\t\tif (!event.players[i].isTurnedOver()) {\r\n\t\t\t\t\t\t\tevent.players.splice(i--, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (event.players.length) {\r\n\t\t\t\t\t\tevent.players.shift().loseHp();\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttashui: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: ['useCard', 'respondAfter'] },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event) {\r\n\t\t\t\t\treturn get.color(event.card) == 'black';\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('tashui'), function (card, player, target) {\r\n\t\t\t\t\t\treturn player != target;\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\t//\tif(target.isTurnedOver()) return -1;\r\n\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\tif (get.attitude(_status.event.player, target) == 0) return 0;\r\n\t\t\t\t\t\tif (get.attitude(_status.event.player, target) > 0) {\r\n\t\t\t\t\t\t\tif (target.classList.contains('turnedover')) return 3;\r\n\t\t\t\t\t\t\tif (target.hasSkillTag('noturn')) return 1;\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (target.hasSkillTag('noturn')) return 0;\r\n\t\t\t\t\t\t\tif (target.classList.contains('turnedover')) return -1;\r\n\t\t\t\t\t\t\treturn 5 - target.getDamagedHp();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('tashui', result.targets, 'thunder');\r\n\t\t\t\t\t\tresult.targets[0].turnOver();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\tplayer: function (card) {\r\n\t\t\t\t\t\t\tif (get.color(card) == 'black') {\r\n\t\t\t\t\t\t\t\treturn [1, 2];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshangshix: {\r\n\t\t\t\ttrigger: { player: ['loseEnd', 'changeHp'] },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\taudio: 2,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('h') < 4;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(4 - player.countCards('h'));\r\n\t\t\t\t},\r\n\t\t\t\tgroup: 'shangshix2',\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (card.name == 'shunshou') return;\r\n\t\t\t\t\t\t\tif (card.name == 'guohe') {\r\n\t\t\t\t\t\t\t\tif (!target.countCards('e')) return [0, 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (get.tag(card, 'loseCard')) {\r\n\t\t\t\t\t\t\t\treturn [0, 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tnoh: true,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txiuluo: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('j') > 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar next = player.discardPlayerCard(player, 2, 'hj', '是否一张手牌来弃置一张花色相同的判定牌？');\r\n\t\t\t\t\tnext.filterButton = function (button) {\r\n\t\t\t\t\t\tvar card = button.link;\r\n\t\t\t\t\t\tif (!lib.filter.cardDiscardable(card, player)) return false;\r\n\t\t\t\t\t\tif (ui.selected.buttons.length == 0) return true;\r\n\t\t\t\t\t\tif (get.position(ui.selected.buttons[0].link) == 'h') {\r\n\t\t\t\t\t\t\tif (get.position(card) != 'j') return false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (get.position(ui.selected.buttons[0].link) == 'j') {\r\n\t\t\t\t\t\t\tif (get.position(card) != 'h') return false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn get.suit(card) == get.suit(ui.selected.buttons[0].link)\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnext.ai = function (button) {\r\n\t\t\t\t\t\tvar card = button.link;\r\n\t\t\t\t\t\tif (get.position(card) == 'h') {\r\n\t\t\t\t\t\t\treturn 11 - get.value(card);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (card.name == 'lebu') return 5;\r\n\t\t\t\t\t\tif (card.name == 'bingliang') return 4;\r\n\t\t\t\t\t\tif (card.name == 'guiyoujie') return 3;\r\n\t\t\t\t\t\treturn 2;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnext.logSkill = 'xiuluo';\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool && player.countCards('j')) event.goto(0);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshangshix2: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.hp > 1;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.players = get.players(player);\r\n\t\t\t\t\tevent.num = 0;\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (event.players.length) {\r\n\t\t\t\t\t\tevent.players.shift().loseHp();\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_wuxin: {\r\n\t\t\t\ttrigger: { player: 'damageBefore' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: 10,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t},\r\n\t\t\t\taudio: 2,\r\n\t\t\t},\r\n\t\t\tshenwei: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\tunique: true,\r\n\t\t\t\ttrigger: { player: 'phaseDrawBegin' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.num += Math.min(3, game.players.length - 1);\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tmaxHandcard: function (player, current) {\r\n\t\t\t\t\t\treturn current + Math.min(3, game.players.length - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_baonuwash: {\r\n\t\t\t\ttrigger: { player: 'phaseAfter' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tgame.over(game.me == game.boss);\r\n\t\t\t\t},\r\n\t\t\t\ttemp: true,\r\n\t\t\t},\r\n\t\t\tboss_baonu: {\r\n\t\t\t\tunique: true,\r\n\t\t\t\ttrigger: { player: 'changeHp', global: 'boss_baonuwash' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tpriority: 100,\r\n\t\t\t\tfixed: true,\r\n\t\t\t\taudio: 2,\r\n\t\t\t\tmode: ['identity', 'guozhan', 'boss', 'stone'],\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tif (get.mode() == 'boss' && player == game.boss) {\r\n\t\t\t\t\t\tlib.onwash.push(function () {\r\n\t\t\t\t\t\t\tif (!_status.boss_baonuwash) {\r\n\t\t\t\t\t\t\t\t_status.boss_baonuwash = true;\r\n\t\t\t\t\t\t\t\t_status.event.parent.trigger('boss_baonuwash');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t_status.event.player.addSkill('boss_baonuwash');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tfor (var i in lib.card) {\r\n\t\t\t\t\t\t\tif (lib.card[i].subtype == 'equip1') lib.card[i].chongzhu = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.hp <= 4 || _status.boss_baonuwash;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif (player.hp > 6) {\r\n\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.chooseControl('暴怒战神', '神鬼无前', function () {\r\n\t\t\t\t\t\tif (Math.random() < 0.5) return '神鬼无前';\r\n\t\t\t\t\t\treturn '暴怒战神';\r\n\t\t\t\t\t}).set('prompt', '选择一个形态');\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar hp = player.hp;\r\n\t\t\t\t\tplayer.removeSkill('boss_baonu', true);\r\n\t\t\t\t\tif (result.control == '暴怒战神') {\r\n\t\t\t\t\t\tplayer.init('boss_lvbu2');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.init('boss_lvbu3');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (hp > 6) {\r\n\t\t\t\t\t\tplayer.maxHp = hp;\r\n\t\t\t\t\t\tplayer.hp = hp;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.update();\r\n\t\t\t\t\tui.clear();\r\n\t\t\t\t\tif (player.isLinked()) player.link();\r\n\t\t\t\t\tif (player.isTurnedOver()) player.turnOver();\r\n\t\t\t\t\tplayer.discard(player.getCards('j'));\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\twhile (_status.event.name != 'phaseLoop') {\r\n\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t_status.paused = false;\r\n\t\t\t\t\t_status.event.player = player;\r\n\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\tif (game.bossinfo) {\r\n\t\t\t\t\t\tgame.bossinfo.loopType = 1;\r\n\t\t\t\t\t\t_status.roundStart = game.boss;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (get.tag(card, 'damage') || get.tag(card, 'loseHp')) {\r\n\t\t\t\t\t\t\t\tif (player.hp == 5) {\r\n\t\t\t\t\t\t\t\t\tif (game.players.length < 4) return [0, 5];\r\n\t\t\t\t\t\t\t\t\tvar num = 0\r\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\tif (game.players[i] != game.boss && game.players[i].hp == 1) {\r\n\t\t\t\t\t\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (num > 1) return [0, 2];\r\n\t\t\t\t\t\t\t\t\tif (num && Math.random() < 0.7) return [0, 1];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tqiwu: {\r\n\t\t\t\taudio: true,\r\n\t\t\t\ttrigger: { player: 'useCard' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn get.suit(event.card) == 'club' && player.hp < player.maxHp;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.recover();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjizhen: {\r\n\t\t\t\ttrigger: { player: 'phaseJieshuBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn game.hasPlayer(function (current) {\r\n\t\t\t\t\t\treturn current.isDamaged() && current != player;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar num = 0;\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (!game.players[i].isLinked() && player != game.players[i]) {\r\n\t\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('jizhen'), [1, 2], function (card, player, target) {\r\n\t\t\t\t\t\treturn target.hp < target.maxHp && player != target;\r\n\t\t\t\t\t}).ai = function (target) {\r\n\t\t\t\t\t\treturn get.attitude(player, target);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tplayer.logSkill('jizhen', result.targets);\r\n\t\t\t\t\t\tgame.asyncDraw(result.targets);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\texpose: 0.3,\r\n\t\t\t\t\tthreaten: 1.3\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshenqu: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\tgroup: 'shenqu2',\r\n\t\t\t\ttrigger: { global: 'phaseZhunbeiBegin' },\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.countCards('h') <= player.maxHp;\r\n\t\t\t\t},\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshenqu2: {\r\n\t\t\t\ttrigger: { player: 'damageAfter' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.hasSkillTag('respondTao') || player.countCards('h', 'tao') > 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.chooseToUse({ name: 'tao' }, '神躯：是否使用一张桃？').logSkill = 'shenqu';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjiwu: {\r\n\t\t\t\taudio: 2,\r\n\t\t\t\tenable: 'phaseUse',\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (player.countCards('h') == 0) return false;\r\n\t\t\t\t\tif (!player.hasSkill('qiangxix')) return true;\r\n\t\t\t\t\tif (!player.hasSkill('retieji')) return true;\r\n\t\t\t\t\tif (!player.hasSkill('rexuanfeng')) return true;\r\n\t\t\t\t\tif (!player.hasSkill('wansha')) return true;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard: true,\r\n\t\t\t\tposition: 'he',\r\n\t\t\t\tcheck: function (card) {\r\n\t\t\t\t\tif (get.position(card) == 'e' && _status.event.player.hasSkill('rexuanfeng')) return 16 - get.value(card);\r\n\t\t\t\t\treturn 7 - get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tif (!player.hasSkill('qiangxix')) list.push('qiangxix');\r\n\t\t\t\t\tif (!player.hasSkill('retieji')) list.push('retieji');\r\n\t\t\t\t\tif (!player.hasSkill('rexuanfeng')) list.push('rexuanfeng');\r\n\t\t\t\t\tif (!player.hasSkill('wansha')) list.push('wansha');\r\n\t\t\t\t\tif (list.length == 1) {\r\n\t\t\t\t\t\tplayer.addTempSkill(list[0]);\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.chooseControl(list, function () {\r\n\t\t\t\t\t\t\tif (list.contains('rexuanfeng') && player.countCards('he', { type: 'equip' })) return 'rexuanfeng';\r\n\t\t\t\t\t\t\tif (!player.getStat().skill.qiangxix) {\r\n\t\t\t\t\t\t\t\tif (player.hasSkill('qiangxix') && player.getEquip(1) && list.contains('rexuanfeng')) return 'rexuanfeng';\r\n\t\t\t\t\t\t\t\tif (list.contains('wansha') || list.contains('qiangxix')) {\r\n\t\t\t\t\t\t\t\t\tvar players = game.filterPlayer();\r\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\tif (players[i].hp == 1 && get.attitude(player, players[i]) < 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (list.contains('wansha')) return 'wansha';\r\n\t\t\t\t\t\t\t\t\t\t\tif (list.contains('qiangxix')) return 'qiangxix';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (list.contains('qiangxix')) return 'qiangxix';\r\n\t\t\t\t\t\t\tif (list.contains('wansha')) return 'wansha';\r\n\t\t\t\t\t\t\tif (list.contains('rexuanfeng')) return 'rexuanfeng';\r\n\t\t\t\t\t\t\treturn 'retieji';\r\n\t\t\t\t\t\t}).set('prompt', '选择获得一项技能直到回合结束');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.addTempSkill(result.control);\r\n\t\t\t\t\tplayer.popup(get.translation(result.control));\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\torder: function () {\r\n\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\tif (player.countCards('e', { type: 'equip' })) return 10;\r\n\t\t\t\t\t\tif (!player.getStat().skill.qiangxix) {\r\n\t\t\t\t\t\t\tif (player.hasSkill('qiangxix') && player.getEquip(1) && !player.hasSkill('rexuanfeng')) return 10;\r\n\t\t\t\t\t\t\tif (player.hasSkill('wansha')) return 1;\r\n\t\t\t\t\t\t\tvar players = game.filterPlayer();\r\n\t\t\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\t\t\tif (players[i].hp == 1 && get.attitude(player, players[i]) < 0) return 10;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\tplayer: function (player) {\r\n\t\t\t\t\t\t\tif (player.countCards('e', { type: 'equip' })) return 1;\r\n\t\t\t\t\t\t\tif (!player.getStat().skill.qiangxix) {\r\n\t\t\t\t\t\t\t\tif (player.hasSkill('qiangxix') && player.getEquip(1) && !player.hasSkill('rexuanfeng')) return 1;\r\n\t\t\t\t\t\t\t\tif (!player.hasSkill('wansha') || !player.hasSkill('qiangxix')) {\r\n\t\t\t\t\t\t\t\t\tvar players = game.filterPlayer();\r\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\tif (players[i].hp == 1 && get.attitude(player, players[i]) < 0) return 1;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t\"boss_hunzi\": {\r\n\t\t\t\tskillAnimation: true,\r\n\t\t\t\tanimationColor: \"wood\",\r\n\t\t\t\taudio: \"hunzi\",\r\n\t\t\t\tjuexingji: true,\r\n\t\t\t\tderivation: [\"reyingzi\", \"yinghun\"],\r\n\t\t\t\tunique: true,\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer: \"phaseZhunbeiBegin\",\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.hp <= 2 && !player.$.boss_hunzi;\r\n\t\t\t\t},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.removeSkill('boss_hunyou');\r\n\t\t\t\t\tplayer.removeSkill(\"boss_hunyou_dying\");\r\n\t\t\t\t\tplayer.removeSkill(\"boss_hunyou_dieBegin\")\r\n\t\t\t\t\tplayer.loseMaxHp();\r\n\t\t\t\t\tplayer.addSkill('reyingzi');\r\n\t\t\t\t\tplayer.addSkill('yinghun');\r\n\t\t\t\t\tgame.log(player, '获得了技能', '#g【英姿】和【英魂】');\r\n\t\t\t\t\tgame.log(player, '', '#y【魂佑】')\r\n\t\t\t\t\tplayer.awakenSkill('boss_hunzi');\r\n\t\t\t\t\tplayer.$.boss_hunzi = true;\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\tthreaten: function (player, target) {\r\n\t\t\t\t\t\tif (target.hp == 1) return 2;\r\n\t\t\t\t\t\treturn 0.5;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmaixie: true,\r\n\t\t\t\t\teffect: {\r\n\t\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\t\tif (!target.hasFriend()) return;\r\n\t\t\t\t\t\t\tif (get.tag(card, 'damage') == 1 && target.hp == 2 && !target.isTurnedOver() &&\r\n\t\t\t\t\t\t\t\t_status.currentPhase != target && get.distance(_status.currentPhase, target, 'absolute') <= 3) return [0.5, 1];\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_jiang\": {\r\n\t\t\t\taudio: \"jiang\",\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tglobal: [\"respondEnd\"],\r\n\t\t\t\t},\r\n\t\t\t\tcharlotte: true,\r\n\t\t\t\tlocked: true,\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tvar a = window.setInterval(function () {\r\n\t\t\t\t\t\tif (player.hasSkill('boss_jiang')) {\r\n\t\t\t\t\t\t\tplayer.$.boss_jiang = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tgame.addGlobalSkill('boss_jiang');\r\n\t\t\t\t\t\t\tgame.addGlobalSkill('boss_jiang_use');\r\n\t\t\t\t\t\t\twindow.clearInterval(a);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 1000);\r\n\t\t\t\t},\r\n\t\t\t\tfilter2: function (event, player) {\r\n\t\t\t\t\tif (!event.respondTo[1]) return false;\r\n\t\t\t\t\tif (get.itemtype(event.cards) != 'cards') return false;\r\n\t\t\t\t\tif (['h', 'e', 'j'].contains(get.position(event.cards[0]))) return false;\r\n\t\t\t\t\tif (event.respondTo[1] && get.itemtype(event.respondTo[1]) != 'card') return false;\r\n\t\t\t\t\tif (event.respondTo[1] && ['h', 'e', 'j'].contains(get.position(event.respondTo[1]))) return false;\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\tif (!player.$.boss_jiang) return false;\r\n\t\t\t\t\tif (!event.respondTo) return false;\r\n\t\t\t\t\tif (get.color(event.card) != 'red') return false;\r\n\t\t\t\t\tif (event.respondTo[0] != player) {\r\n\t\t\t\t\t\treturn event.player == player;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\treturn event.player != player;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\tif (!lib.skill.boss_jiang.filter2(trigger, player)) return;\r\n\t\t\t\t\tif (trigger.respondTo[0] != player) {\r\n\t\t\t\t\t\tif (trigger.respondTo[1] && get.position(trigger.respondTo[1]) == 'd') player.gain(trigger.respondTo[1], 'gain2');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (get.position(trigger.cards[0]) == 'd') player.gain(trigger.cards, 'gain2');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup: [\"boss_jiang_use\"],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tuse: {\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tglobal: [\"useCard\"],\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\tif (!player.$.boss_jiang) return false;\r\n\t\t\t\t\t\t\tif (get.color(event.card) != 'red') return false;\r\n\t\t\t\t\t\t\treturn player == event.player || event.targets.contains(player);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfrequent: true,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t\tif (trigger.player != player && get.itemtype(trigger.cards) == 'cards' && get.position(trigger.cards[0]) == 'd') player.gain(trigger.cards, 'gain2');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_hunyou\": {\r\n\t\t\t\tforced: true,\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.hp = 1;\r\n\t\t\t\t\tplayer.$.hp = player.hp;\r\n\t\t\t\t\tplayer.$.maxHp = player.maxHp;\r\n\t\t\t\t\tplayer.update();\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer: [\"damageBefore\", \"recoverBefore\", \"loseHpBefore\", \"loseMaxHpBefore\", \"gainMaxHpBefore\"],\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tgroup: [\"boss_hunyou_dying\", \"boss_hunyou_dieBegin\"],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tdying: {\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tplayer: \"dying\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\tif (player.hp != player.$.hp && player.$.hp > 0) return true;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\t\tplayer.maxHp = player.$.maxHp;\r\n\t\t\t\t\t\t\tplayer.hp = player.$.hp;\r\n\t\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub: true,\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tpopup: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdieBegin: {\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tplayer: \"dieBegin\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent: true,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\tif (player.maxHp != player.$.maxHp && player.$.maxHp > 0) return true;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\t\tplayer.maxHp = player.$.maxHp;\r\n\t\t\t\t\t\t\tplayer.hp = player.$.hp;\r\n\t\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub: true,\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tpopup: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"boss_taoni\": {\r\n\t\t\t\tforced: true,\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tglobal: [\"gameStart\", \"phaseBefore\"],\r\n\t\t\t\t\tplayer: \"dieBegin\",\r\n\t\t\t\t},\r\n\t\t\t\tpriority: 50,\r\n\t\t\t\tinit: function (player) {\r\n\t\t\t\t\tplayer.boss_taoni = function () {\r\n\t\t\t\t\t\tvar __Ox598df = [\"length\", \"players\", \"player\", \"element\"];\r\n\t\t\t\t\t\tfor (var i = 0; i < game[__Ox598df[0x1]][__Ox598df[0x0]]; i++) {\r\n\t\t\t\t\t\t\tvar node = game[__Ox598df[0x1]][i];\r\n\t\t\t\t\t\t\tfor (var a in lib[__Ox598df[0x3]][__Ox598df[0x2]]) {\r\n\t\t\t\t\t\t\t\tvar opd = Object.getOwnPropertyDescriptor(node, a);\r\n\t\t\t\t\t\t\t\tif (opd != undefined) {\r\n\t\t\t\t\t\t\t\t\tif (opd.get || opd.set || opd.writable != true || opd.configurable != true || opd.enumerable != true) {\r\n\t\t\t\t\t\t\t\t\t\t_status.taoni_over(lib.translate[node.name] + '触发了〖讨逆〗，游戏已被终止。');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tnode[a] = lib[__Ox598df[0x3]][__Ox598df[0x2]][a];//还原函数\t\t\r\n\t\t\t\t\t\t\t\tvar _xsu8 = ['classList', 'hp', 'maxHp', 'skills'];\r\n\t\t\t\t\t\t\t\tfor (var b = 0; b < _xsu8.length; b++) {\r\n\t\t\t\t\t\t\t\t\tvar opd2 = Object.getOwnPropertyDescriptor(node, _xsu8[b]);\r\n\t\t\t\t\t\t\t\t\tif (opd2 != undefined) {\r\n\t\t\t\t\t\t\t\t\t\tif (opd2.get || opd2.set || opd2.writable != true || opd2.configurable != true || opd2.enumerable != true) {\r\n\t\t\t\t\t\t\t\t\t\t\t_status.taoni_over(lib.translate[node.name] + '触发了〖讨逆〗，游戏已被终止。');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar _cRYC = ['players', 'dead', 'over'];\r\n\t\t\t\t\t\t\t\tfor (var c = 0; c < _cRYC.length; c++) {\r\n\t\t\t\t\t\t\t\t\tvar opd3 = Object.getOwnPropertyDescriptor(game, _cRYC[c]);\r\n\t\t\t\t\t\t\t\t\tif (opd3 != undefined) {\r\n\t\t\t\t\t\t\t\t\t\tif (opd3.get || opd3.set || opd3.writable != true || opd3.configurable != true || opd3.enumerable != true) {\r\n\t\t\t\t\t\t\t\t\t\t\t_status.taoni_over('〖讨逆〗被触发，游戏终止。');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tplayer.boss_taoni();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\ttranslate: {\r\n\t\t\tzhu: '神',\r\n\t\t\tcai: '盟',\r\n\t\t\tzhong: '从',\r\n\r\n\t\t\tboss_chi: '魑',\r\n\t\t\tboss_mo: '魅',\r\n\t\t\tboss_wang: '魍',\r\n\t\t\tboss_liang: '魉',\r\n\t\t\tboss_niutou: '牛头',\r\n\t\t\tboss_mamian: '马面',\r\n\t\t\tboss_baiwuchang: '白无常',\r\n\t\t\tboss_heiwuchang: '黑无常',\r\n\t\t\tboss_luocha: '罗刹',\r\n\t\t\tboss_yecha: '夜叉',\r\n\t\t\tboss_zhuoguiquxie: '捉鬼驱邪',\r\n\r\n\t\t\tboss_nianshou: '年兽',\r\n\t\t\tboss_nianshou_heti: '年兽',\r\n\t\t\tboss_nianshou_jingjue: '警觉年兽',\r\n\t\t\tboss_nianshou_renxing: '任性年兽',\r\n\t\t\tboss_nianshou_baonu: '暴怒年兽',\r\n\t\t\tboss_nianshou_ruizhi: '睿智年兽',\r\n\r\n\t\t\tboss_shuijing: '水镜先生',\r\n\t\t\tboss_huangyueying: '奇智女杰',\r\n\t\t\tboss_zhangchunhua: '冷血皇后',\r\n\t\t\tboss_satan: '堕落天使',\r\n\t\t\tboss_dongzhuo: '乱世魔王',\r\n\t\t\tboss_lvbu1: '最强神话',\r\n\t\t\tboss_lvbu2: '暴怒战神',\r\n\t\t\tboss_lvbu3: '神鬼无前',\r\n\t\t\tboss_zhouyu: '赤壁火神',\r\n\t\t\tboss_pangtong: '涅槃凤雏',\r\n\t\t\tboss_zhugeliang: '祭风卧龙',\r\n\t\t\tboss_zhangjiao: '天公将军',\r\n\t\t\tboss_zuoci: '迷之仙人',\r\n\t\t\tboss_yuji: '琅琊道士',\r\n\t\t\tboss_liubei: '蜀汉烈帝',\r\n\t\t\tboss_caiwenji: '异乡孤女',\r\n\t\t\tboss_huatuo: '药坛圣手',\r\n\t\t\tboss_luxun: '蹁跹君子',\r\n\t\t\tboss_zhenji: '洛水仙子',\r\n\t\t\tboss_diaochan: '绝代妖姬',\r\n\t\t\tboss_zhaoyun: '高达一号',\r\n\t\t\tboss_guojia: '世之奇士',\r\n\t\t\tboss_caocao: '魏武大帝',\r\n\r\n\t\t\tboss_chiyanshilian: '夏之试炼',\r\n\t\t\tboss_zhuque: '朱雀',\r\n\t\t\tboss_huoshenzhurong: '火神祝融',\r\n\t\t\tboss_yanling: '焰灵',\r\n\t\t\tboss_yandi: '炎帝',\r\n\r\n\t\t\tboss_hundun: '混沌',\r\n\t\t\tboss_qiongqi: '穷奇',\r\n\t\t\tboss_taowu: '梼杌',\r\n\t\t\tboss_taotie: '饕餮',\r\n\t\t\tboss_zhuyin: '烛阴',\r\n\t\t\tboss_xiangliu: '相柳',\r\n\t\t\tboss_zhuyan: '朱厌',\r\n\t\t\tboss_bifang: '毕方',\r\n\t\t\tboss_yingzhao: '英招',\r\n\r\n\t\t\tboss_yaoshou: '妖兽',\r\n\t\t\tboss_yaoshou_info: '锁定技，你与其他角色计算-2。',\r\n\t\t\tboss_duqu: '毒躯',\r\n\t\t\tboss_duqu_info: '锁定技，你受到伤害时，伤害来源获得1枚“蛇毒”标记；你自身不会拥有“蛇毒”标记；你的“桃”均视为“杀”。“蛇毒”标记：锁定技，拥有“蛇毒”标记的角色回合开始时，需要选择弃置X张牌或者失去X点体力，然后弃置一枚“蛇毒”标记。X为其拥有的“蛇毒”标记个数。',\r\n\t\t\tboss_shedu: '蛇毒',\r\n\t\t\tboss_jiushou: '九首',\r\n\t\t\tboss_jiushou_info: '锁定技，你的手牌上限始终为9，你的出牌阶段开始时以及你的回合结束时，将手牌补至手牌上限，你始终跳过你的摸牌阶段。',\r\n\t\t\tboss_echou_switch: '恶臭',\r\n\t\t\tboss_echou: '恶臭',\r\n\t\t\tboss_echou_info: '体力值首次减少至一半或更少时激活此技能。锁定技，除你之外的其他角色使用“桃”或“酒”时，获得1枚“蛇毒”标记。',\r\n\t\t\tboss_bingxian: '兵燹',\r\n\t\t\tboss_bingxian_info: '锁定技，其他角色的回合结束时，若其回合内没有使用杀，则视为你对其使用一张“杀”。',\r\n\t\t\tboss_juyuan: '巨猿',\r\n\t\t\tboss_juyuan_info: '锁定技，你的体力上限+5，你的出牌阶段内，若你的体力少于上一次你的回合结束时的体力，则你本回合使用“杀”可额外指定1个目标。',\r\n\t\t\tboss_xushi_switch: '蓄势',\r\n\t\t\tboss_xushi: '蓄势',\r\n\t\t\tboss_xushi_info: '体力值首次减少至一半或更少时激活此技能。锁定技，你的出牌阶段结束时，你令自己翻面；当你的武将牌从背面翻至正面时，对所有其他角色造成随机1至2点伤害。',\r\n\t\t\tboss_zhaohuo: '兆火',\r\n\t\t\tboss_zhaohuo_info: '锁定技，你造成的所有伤害均视为火属性伤害；你的回合中，所有其他角色的防具牌无效；你免疫所有火属性伤害。',\r\n\t\t\tboss_honglianx: '红莲',\r\n\t\t\tboss_honglianx_info: '锁定技，你的红色牌不计入你的手牌上限；你的回合开始时，随机获得牌堆中0到3张红色牌，然后随机对3到0名其他角色各造成1点火属性伤害。',\r\n\t\t\tboss_yanyu: '炎狱',\r\n\t\t\tboss_yanyu_switch: '炎狱',\r\n\t\t\tboss_yanyu_info: '体力值首次减少至一半或更少时激活此技能。锁定技，其他角色回合开始时进行判定，若为红色则受到1点火属性伤害，并重复此过程（每个回合最多判定3次）。',\r\n\t\t\tboss_fengdong: '封冻',\r\n\t\t\tboss_fengdong_info: '锁定技，你的回合内，其他角色的非锁定技无效。',\r\n\t\t\tboss_xunyou: '巡游',\r\n\t\t\tboss_xunyou_info: '锁定技，其他角色回合开始时，你随机获得场上除你以外的一名角色区域内的一张牌，若你获得的是装备牌，则你使用之。',\r\n\t\t\tboss_sipu: '司圃',\r\n\t\t\tboss_sipu_switch: '司圃',\r\n\t\t\tboss_sipu_info: '体力值首次减少至一半或更少时激活此技能。锁定技，你的出牌阶段内，若你使用的牌数小于等于2张，其他角色无法使用或打出牌。',\r\n\r\n\t\t\tboss_wuzang: '无脏',\r\n\t\t\tboss_wuzang_info: '锁定技，摸牌阶段，你的摸牌基数改为X（X为你的体力值一半且至少为5）；你的手牌上限基数为0',\r\n\t\t\tboss_xiangde: '相德',\r\n\t\t\tboss_xiangde_info: '锁定技，其他角色对你造成伤害时，若其装备区内有武器牌，此伤害+1',\r\n\t\t\tboss_yinzei: '隐贼',\r\n\t\t\tboss_yinzei_switch: '隐贼',\r\n\t\t\tboss_yinzei_info: '体力值首次减少至一半或更少时激活此技能。锁定技，若你没有手牌，其他角色对你造成伤害后，随机弃置一张牌',\r\n\t\t\tboss_zhue: '助恶',\r\n\t\t\tboss_zhue_info: '锁定技，每当一名其他角色造成伤害后，你与伤害来源各摸一张牌',\r\n\t\t\tboss_futai: '复态',\r\n\t\t\tboss_futai_info: '锁定技，你的回合外，其他角色不能使用【桃】；你的回合开始时，你令所有角色回复1点体力',\r\n\t\t\tboss_yandu: '厌笃',\r\n\t\t\tboss_yandu_switch: '厌笃',\r\n\t\t\tboss_yandu_info: '体力值首次减少至一半或更少时激活此技能。锁定技，其他角色回合结束后，若其未造成过伤害，你获得其一张牌',\r\n\t\t\tboss_minwan: '冥顽',\r\n\t\t\tboss_minwan_info: '锁定技，当你于回合内使用牌对其他角色造成伤害后，你于此回合内使用牌只能指定你与这些角色为目标，且你每使用一张牌，摸一张牌',\r\n\t\t\tboss_nitai: '拟态',\r\n\t\t\tboss_nitai_info: '锁定技，防止你于回合内受到的伤害；你于回合外受到火属性伤害+1',\r\n\t\t\tboss_luanchang: '乱常',\r\n\t\t\tboss_luanchang_switch: '乱常',\r\n\t\t\tboss_luanchang_info: '体力值首次减少至一半或更少时激活此技能。锁定技，回合开始时，你视为使用【南蛮入侵】；回合结束时，你视为使用【万箭齐发】',\r\n\t\t\tboss_tanyu: '贪欲',\r\n\t\t\tboss_tanyu_info: '锁定技，跳过你的弃牌阶段；结束阶段，若你的手牌数为全场最多，失去1点体力',\r\n\t\t\tboss_cangmu: '藏目',\r\n\t\t\tboss_cangmu_info: '锁定技，你令摸牌阶段摸牌基数改为X（X为存活角色数）',\r\n\t\t\tboss_jicai: '积财',\r\n\t\t\tboss_jicai_switch: '积财',\r\n\t\t\tboss_jicai_info: '体力值首次减少至一半或更少时激活此技能。锁定技，一名角色回复体力后，你与其各摸一张牌',\r\n\t\t\tboss_xiongshou: '凶兽',\r\n\t\t\tboss_xiongshou_info: '锁定技，你使用【杀】对体力值小于你的角色造成的伤害+1；你与其他角色距离-1；你不能被翻面',\r\n\t\t\tsadouchengbing: '撒豆成兵',\r\n\t\t\tsadouchengbing_info: '出牌阶段对自己使用，若你的势力为“神”，摸X张牌；否则将你手牌补至X；（X为你的体力上限且至多为5）',\r\n\t\t\tyihuajiemu: '移花接木',\r\n\t\t\tyihuajiemu_info: '出牌阶段对一名有牌的其他角色使用，令其使用一张【杀】，或交给你两张牌',\r\n\t\t\tguilongzhanyuedao: '鬼龙斩月刀',\r\n\t\t\tguilongzhanyuedao_info: '锁定技，你使用的红色【杀】不能被【闪】响应',\r\n\t\t\tguofengyupao: '国风玉袍',\r\n\t\t\tguofengyupao_info: '锁定技，你不能成为其他角色使用普通锦囊牌的目标',\r\n\t\t\tchiyanzhenhunqin: '赤焰镇魂琴',\r\n\t\t\tchiyanzhenhunqin_info: '锁定技，你造成的伤害均视为具有火属性',\r\n\t\t\tqimenbagua: '奇门八卦',\r\n\t\t\tqimenbagua_info: '锁定技，其他角色使用的【杀】对你无效',\r\n\t\t\tjuechenjinge: '绝尘金戈',\r\n\t\t\tjuechenjinge_info: '锁定技，敌方角色计算与己方其他角色距离+1',\r\n\t\t\txiuluolianyuji: '修罗炼狱戟',\r\n\t\t\txiuluolianyuji_info: '你使用【杀】可以额外指定任意名攻击范围内的其他角色为目标；锁定技，你使用【杀】造成的伤害+1，然后令受到伤害的角色回复1点体力',\r\n\t\t\txuwangzhimian: '虚妄之冕',\r\n\t\t\txuwangzhimian_info: '锁定技，摸牌阶段，你额外摸两张牌；你的手牌上限-1',\r\n\t\t\tchixueqingfeng: '赤血青锋',\r\n\t\t\tchixueqingfeng_info: '锁定技，你使用【杀】结算结束前，目标角色不能使用或打出手牌，且此【杀】无视其防具',\r\n\t\t\tlongfenghemingjian: '鸾凤和鸣剑',\r\n\t\t\tlongfenghemingjian_info: '你使用的【雷杀】或【火杀】指定目标后，可令对方选择弃置一张牌或令你摸一张牌',\r\n\t\t\tqicaishenlu: '七彩神鹿',\r\n\t\t\tqicaishenlu_info: '锁定技，你计算与其他角色的距离时-1，当你造成属性伤害时，你令此伤害+1。',\r\n\t\t\tboss_mengpohuihun: '回魂',\r\n\t\t\tboss_mengpohuihun_info: '若场上有角色在本局游戏中因孟婆的【忘魂】失去过技能，则令其恢复该技能；此牌进入弃牌堆后，会被销毁。',\r\n\t\t\thonghuangzhili: '洪荒之力',\r\n\t\t\thonghuangzhili_cbg: '洪',\r\n\t\t\thonghuangzhili_info: '若该角色的势力是神，你获得其一张牌，其【神裔】无效直到其下家的回合（这个下家是动态变化的，会随着一个人的死或者复活而变化）开始；若该角色的势力不是神，其翻面。',\r\n\r\n\t\t\tboss_qingmushilian: '春之试炼',\r\n\t\t\tboss_qinglong: '青龙',\r\n\t\t\tboss_mushengoumang: '木神勾芒',\r\n\t\t\tboss_shujing: '树精',\r\n\t\t\tboss_taihao: '太昊',\r\n\r\n\t\t\tboss_baimangshilian: '秋之试炼',\r\n\t\t\tboss_baihu: '白虎',\r\n\t\t\tboss_jinshenrushou: '金神蓐收',\r\n\t\t\tboss_mingxingzhu: '明刑柱',\r\n\t\t\tboss_shaohao: '少昊',\r\n\r\n\t\t\tboss_xuanlinshilian: '冬之试炼',\r\n\t\t\tboss_xuanwu: '玄武',\r\n\t\t\tboss_shuishenxuanming: '水神玄冥',\r\n\t\t\tboss_shuishengonggong: '水神共工',\r\n\t\t\tboss_zhuanxu: '颛顼',\r\n\r\n\t\t\tboss_lingqu: '灵躯',\r\n\t\t\tboss_lingqu_info: '锁定技，当你受到伤害后，你摸一张牌，然后手牌上限+1；防止你受到的大于1点的伤害',\r\n\t\t\tboss_zirun: '滋润',\r\n\t\t\tboss_zirun_info: '锁定技，准备阶段开始时，你令所有角色摸一张牌，若其装备区内有牌，则其额外摸一张牌',\r\n\t\t\tboss_juehong: '决洪',\r\n\t\t\tboss_juehong_info: '锁定技，准备阶段开始时，你令所有敌方角色自己弃置自己的装备区内的所有牌，若其装备区内没有牌，则改为你弃置其一张手牌',\r\n\t\t\tboss_zaoyi: '皂仪',\r\n\t\t\tboss_zaoyi_info: '锁定技，只要水神玄冥存活，你不会成为敌方角色使用锦囊牌的目标，只要水神共工存活，你不会成为敌方角色使用基本牌的目标。水神玄冥和水神共工均死亡后，你摸四张牌，然后从下回合开始，每个回合开始时使体力值最少的敌方角色失去所有体力',\r\n\t\t\tboss_baiyi: '白仪',\r\n\t\t\tboss_baiyi_info: '锁定技，每名敌方角色的摸牌阶段，若当前轮数小于3，其少摸一张牌；第五轮开始时，每名敌方角色弃置两张牌；当己方角色受到的雷电伤害时，若当前轮数小于7，其防止此伤害',\r\n\t\t\tboss_qingzhu: '擎柱',\r\n\t\t\tboss_qingzhu_info: '锁定技，你跳过弃牌阶段，若你没有“殛顶”，你于出牌阶段不能使用【杀】',\r\n\t\t\tboss_jiazu: '枷足',\r\n\t\t\tboss_jiazu_info: '锁定技，回合开始时，弃置你上家和下家的敌方角色的装备区内的坐骑牌',\r\n\t\t\tboss_jiding: '殛顶',\r\n\t\t\tboss_jiding_info: '锁定技，其他己方角色受到伤害后，若伤害来源为敌方角色，则你视为对伤害来源使用雷【杀】，若此【杀】造成伤害，蓐收回复1点体力。然后你失去此技能（只有发动了才会失去，没发动不会失去）',\r\n\t\t\tboss_xingqiu: '刑秋',\r\n\t\t\tboss_xingqiu_info: '锁定技，每两轮的出牌阶段开始时，你横置所有敌方角色，然后使明刑柱获得【殛顶】',\r\n\t\t\tboss_kuangxiao: '狂啸',\r\n\t\t\tboss_kuangxiao_info: '锁定技，你的回合内，你使用【杀】没有距离限制，且指定所有敌方角色为目标',\r\n\t\t\tboss_shenyi: '神裔',\r\n\t\t\tboss_shenyi_info: '锁定技，你的武将牌始终正面向上，你的判定区内的牌效果反转',\r\n\t\t\tboss_shenen: '神恩',\r\n\t\t\tboss_shenen_info: '锁定技，所有己方角色使用牌无距离限制；所有敌方角色摸牌阶段多摸一张牌且手牌上限+1',\r\n\t\t\tboss_fentian: '焚天',\r\n\t\t\tboss_fentian_info: '锁定技，你造成的伤害视为火焰伤害；你使用红色牌无距离和次数限制，且不可被其他角色使用【闪】或【无懈可击】响应',\r\n\t\t\tboss_fentian2: '焚天',\r\n\t\t\tboss_xingxia: '行夏',\r\n\t\t\tboss_xingxia_info: '每两轮限一次，出牌阶段，你可以对焰灵造成2点火焰伤害，然后令每名敌方角色选择一项：1.弃置一张红色牌；2.你对其造成1点火焰伤害',\r\n\t\t\tboss_huihuo: '回火',\r\n\t\t\tboss_huihuo_info: '锁定技，当你死亡时，你对所有敌方角色各造成3点火焰伤害；出牌阶段，你可以多使用一张【杀】',\r\n\t\t\tboss_furan: '复燃',\r\n\t\t\tboss_furan2: '复燃',\r\n\t\t\tboss_furan_info: '当你濒死时，所有敌方角色视为可以将红色牌当【桃】对你使用',\r\n\t\t\tboss_chiyi: '赤仪',\r\n\t\t\tboss_chiyi2: '赤仪',\r\n\t\t\tboss_chiyi_info: '锁定技，从第三轮开始，敌方角色受到的伤害+1；第五轮开始时，你对所有角色各造成1点火焰伤害；第七轮开始时，你对焰灵造成5点火焰伤害',\r\n\t\t\tboss_buchun: '布春',\r\n\t\t\tboss_buchun_info: '每两轮限一次，出牌阶段，若场上有死亡的树精，你可以失去1点体力，复活所有树精，使其回复体力至1点，补充手牌至两张；若场上没有死亡的树精，你可以为一名己方角色回复2点体力',\r\n\t\t\tboss_cuidu: '淬毒',\r\n\t\t\tboss_cuidu_info: '锁定技，你对敌方角色造成伤害后，若其没有“中毒”，你令其获得“中毒”，然后令木神勾芒摸一张牌',\r\n\t\t\tboss_zhongdu: '中毒',\r\n\t\t\tboss_zhongdu_bg: '毒',\r\n\t\t\tboss_zhongdu_info: '锁定技，回合开始时，你进行判定，若结果不为红桃，你受到1点无来源的伤害，若结果不为黑桃，你失去此技能',\r\n\t\t\tboss_qingyi: '青仪',\r\n\t\t\tboss_qingyi_info: '锁定技，第三轮开始时，己方角色各回复1点体力；第五轮开始时，敌方角色各失去1点体力；第七轮开始时，复活木神勾芒和树精，使其各摸三张牌，各+1体力上限，然后各回复3点体力',\r\n\r\n\t\t\tboss_guimou: '鬼谋',\r\n\t\t\tboss_guimou_info: '结束阶段，你可以令一名随机的其他角色进入混乱状态直到其下一回合结束',\r\n\t\t\tboss_yuance: '远策',\r\n\t\t\tboss_yuance_info: '每当一名角色受到其他角色的伤害，你可以选择一项并进行一次判定：1. 若结果为黑色，受伤害角色失去一点体力，否则伤害来源失去一点体力；2. 若结果为红色，受伤害角色回复一点体力，否则伤害来源回复一点体力',\r\n\t\t\tboss_qizuo: '奇佐',\r\n\t\t\tboss_qizuo_info: '你可以令你的普通锦囊牌额外结算一次',\r\n\t\t\tboss_guixin: '归心',\r\n\t\t\tboss_guixin_info: '锁定技，其他角色摸牌时，若摸牌数不少于2，须将摸到的牌中的一张交给你',\r\n\t\t\txiongcai: '雄才',\r\n\t\t\txiongcai_info: '锁定技，你在回合结束后随机获得一个魏势力角色的所有技能',\r\n\t\t\txiaoxiong: '枭雄',\r\n\t\t\txiaoxiong_info: '锁定技，每当一名其他角色使用一张基本牌或锦囊牌，你获得一张与之同名的牌；在一名其他角色的结束阶段，若其本回合没有使用牌，你对其造成一点伤害',\r\n\t\t\tboss_zhangwu: '章武',\r\n\t\t\tboss_zhangwu_info: '每当你受到一次伤害，你可以弃置任意张牌并令伤害来源选择一项：弃置等量的牌，或受到等量的伤害',\r\n\t\t\txiangxing: '禳星',\r\n\t\t\txiangxing_info: '锁定技，游戏开始时，你获得7枚星；每当你累计扣减7点体力，你失去一枚星，并造成7点雷属性伤害，随机分配给其他角色；当你失去全部星后，你的体力上限变为3',\r\n\t\t\tyueyin: '月隐',\r\n\t\t\tyueyin_info: '锁定技，你的每一枚星对应的一个特定条件，当你失去星时，若满足此条件，则不造成伤害',\r\n\t\t\txiangxing7_info: '你没有手牌',\r\n\t\t\txiangxing6_info: '此次受到的是火属性伤害',\r\n\t\t\txiangxing5_info: '此次受到的是雷属性伤害',\r\n\t\t\txiangxing4_info: '此次为失去体力',\r\n\t\t\txiangxing3_info: '一名其他角色有至少4件装备',\r\n\t\t\txiangxing2_info: '你的判定区内至少有2张牌',\r\n\t\t\txiangxing1_info: '场上只有2名存活角色',\r\n\t\t\tgaiming: '改命',\r\n\t\t\tgaiming_info: '锁定技，在你的判定牌生效前，你观看牌堆顶的7张牌并选择一张作为判定结果，此结果不可更改',\r\n\t\t\tfengqi: '风起',\r\n\t\t\tfengqi_info: '准备阶段和结束阶段，你可以视为使用任意一张普通锦囊牌',\r\n\r\n\t\t\tjiaoxia: '皎霞',\r\n\t\t\tjiaoxia_info: '每当你成为红色牌的目标，你可以摸一张牌',\r\n\t\t\tlingbo: '凌波',\r\n\t\t\tlingbo_info: '每当你使用或打出一张闪，你可以摸两张牌',\r\n\t\t\ttiandao: '天道',\r\n\t\t\ttiandao_info: '任意一名角色的判定生效前，你可以打出一张牌替换之',\r\n\t\t\tyunshen: '云身',\r\n\t\t\tyunshen2: '云身',\r\n\t\t\tyunshen_info: '每当你使用或打出一张闪时，你可以令你的防御距离+1；准备阶段，你将累计的防御距离清零，然后摸等量的牌',\r\n\t\t\tlianji: '连计',\r\n\t\t\tlianji_info: '出牌阶段限一次，你可以选择一张手牌并指定两名角色进行拼点，拼点赢的角色获得此牌，并对没赢的角色造成一点伤害',\r\n\t\t\tmazui: '麻醉',\r\n\t\t\tmazui2: '麻醉',\r\n\t\t\tmazui_info: '出牌阶段限一次，你可以将一张黑色手牌置于一名角色的武将牌上，该角色造成的下一次伤害-1，然后获得此牌',\r\n\r\n\t\t\tboss_nbianshen: '变形',\r\n\t\t\tboss_nbianshenx: '变形',\r\n\t\t\tboss_nbianshenx_info: '你从第二轮开始，每一轮幻化为警觉、任性、睿智、暴怒四种随机状态中的一种',\r\n\t\t\tboss_mengtai: '萌态',\r\n\t\t\tboss_mengtai_info: '锁定技，若你的出牌阶段被跳过，你跳过本回合的弃牌阶段；若你的摸牌阶段被跳过，结束阶段开始时，你摸三张牌',\r\n\t\t\tboss_ruizhi: '睿智',\r\n\t\t\tboss_ruizhi_info: '锁定技，其他角色的准备阶段开始时，其选择一张手牌和一张装备区里的牌，然后弃置其余的牌',\r\n\t\t\tboss_jingjue: '警觉',\r\n\t\t\tboss_jingjue_info: '每当你于回合外失去牌时，你可以进行一次判定，若结果为红色，你回复1点体力',\r\n\t\t\tboss_renxing: '任性',\r\n\t\t\tboss_renxing_info: '锁定技，你的回合外，一名角色受到1点伤害后或回复1点体力时，你摸一张牌',\r\n\t\t\tboss_nbaonu: '暴怒',\r\n\t\t\tboss_nbaonu_info: '锁定技，摸牌阶段，你改为摸X张牌（X为4到你体力值间的随机数）；若你的体力值小于5，则你使用【杀】造成的伤害+1且无次数限制',\r\n\t\t\tboss_shouyi: '兽裔',\r\n\t\t\tboss_shouyi_info: '锁定技，你使用牌无距离限制',\r\n\r\n\t\t\tboss_nianrui: '年瑞',\r\n\t\t\tboss_nianrui_info: '锁定技，摸牌阶段，你额外摸两张牌',\r\n\t\t\tboss_qixiang: '祺祥',\r\n\t\t\tboss_qixiang1: '祺祥',\r\n\t\t\tboss_qixiang2: '祺祥',\r\n\t\t\tboss_qixiang_info: '乐不思蜀判定时，你的方块判定牌视为红桃；兵粮寸断判定时，你的黑桃判定牌视为草花',\r\n\r\n\t\t\tqiwu: '栖梧',\r\n\t\t\tqiwu_info: '锁定技。每当你使用一张梅花牌，你回复一点体力',\r\n\t\t\tjizhen: '激阵',\r\n\t\t\tjizhen_info: '结束阶段，你可以令所至多两名已受伤角色摸一张牌',\r\n\r\n\t\t\tboss_yushou: '驭兽',\r\n\t\t\tboss_yushou_info: '出牌阶段开始时，你可以对所有敌方角色使用一张南蛮入侵',\r\n\t\t\tboss_moyany: '魔炎',\r\n\t\t\tboss_moyany_info: '每当你于回合外失去牌时，你可以进行一次判定，若结果为红色，你对一名其他角色造成2点火焰伤害',\r\n\t\t\tboss_modao: '魔道',\r\n\t\t\tboss_modao_info: '锁定技，准备阶段，你摸两张牌',\r\n\t\t\tboss_mojian: '魔箭',\r\n\t\t\tboss_mojian_info: '出牌阶段开始时，你可以对所有敌方角色使用一张万箭齐发',\r\n\t\t\tboss_danshu: '丹术',\r\n\t\t\tboss_danshu_info: '每当你于回合外失去牌时，你可以进行一次判定，若结果为红色，你回复1点体力',\r\n\r\n\t\t\tboss_zuijiu: '醉酒',\r\n\t\t\tboss_zuijiu_info: '锁定技，你的【杀】额外造成1点伤害',\r\n\t\t\tboss_taiping: '太平',\r\n\t\t\tboss_taiping_info: '锁定技，摸牌阶段摸牌时，你的摸牌数量+2',\r\n\t\t\tboss_suoming: '索命',\r\n\t\t\tboss_suoming_info: '结束阶段，将任意名未被横置的其他角色的武将牌横置',\r\n\t\t\tboss_xixing: '吸星',\r\n\t\t\tboss_xixing_info: '准备阶段，对任意一名横置的其他角色造成1点雷电伤害，然后回复1点体力',\r\n\r\n\t\t\tboss_baolian: '暴敛',\r\n\t\t\tboss_baolian_info: '锁定技，结束阶段，你摸两张牌',\r\n\t\t\tboss_manjia: '蛮甲',\r\n\t\t\tboss_manjia_info: '锁定技，若你的装备区内没有防具牌，则你视为装备了[初始服]',\r\n\t\t\tboss_xiaoshou: '枭首',\r\n\t\t\tboss_xiaoshou_info: '结束阶段，对体力不小于你的一名其他角色造成3点伤害',\r\n\t\t\tboss_guiji: '诡计',\r\n\t\t\tboss_guiji_info: '锁定技，准备阶段结束时，若你的判定区内有牌，你随机弃置其中一张牌',\r\n\t\t\tboss_lianyu: '炼狱',\r\n\t\t\tboss_lianyu_info: '结束阶段，你可以对所有敌方角色造成1点火焰伤害',\r\n\r\n\t\t\tboss_guihuo: '鬼火',\r\n\t\t\tboss_guihuo_info: '结束阶段，你可以对一名其他角色造成1点火焰伤害',\r\n\t\t\tboss_minbao: '冥爆',\r\n\t\t\tboss_minbao_info: '锁定技，当你死亡时，对场上所有其他角色造成1点火焰伤害',\r\n\t\t\tboss_luolei: '落雷',\r\n\t\t\tboss_luolei_info: '准备阶段，你可以对一名其他角色造成1点雷电伤害',\r\n\t\t\tboss_beiming: '悲鸣',\r\n\t\t\tboss_beiming_info: '锁定技，当你死亡时，你令杀死你的角色弃置所有手牌',\r\n\t\t\tboss_guimei: '鬼魅',\r\n\t\t\tboss_guimei_info: '锁定技，你不能成为延时类锦囊的目标',\r\n\t\t\tboss_didong: '地动',\r\n\t\t\tboss_didong_info: '结束阶段，你可以选择一名敌方角色将其武将牌翻面',\r\n\t\t\tboss_shanbeng: '山崩',\r\n\t\t\tboss_shanbeng_info: '锁定技，当你死亡时，你令所有其他角色弃置其装备区内的所有牌',\r\n\r\n\t\t\tboss_chiyan_intro1: '&nbsp;第一关',\r\n\t\t\tboss_chiyan_intro1_info: '挑战朱雀',\r\n\t\t\tboss_chiyan_intro2: '&nbsp;第二关',\r\n\t\t\tboss_chiyan_intro2_info: '挑战火神祝融、焰灵',\r\n\t\t\tboss_chiyan_intro3: '&nbsp;第三关',\r\n\t\t\tboss_chiyan_intro3_info: '挑战炎帝、火神祝融、焰灵',\r\n\t\t\tboss_chiyan_intro3_append: '每通过一关，游戏轮数清零，阵亡角色复活，所有角色重置武将和区域内的牌，并获得4-X张起始手牌，X为阵亡角色数',\r\n\r\n\t\t\tboss_qingmu_intro1: '&nbsp;第一关',\r\n\t\t\tboss_qingmu_intro1_info: '挑战青龙',\r\n\t\t\tboss_qingmu_intro2: '&nbsp;第二关',\r\n\t\t\tboss_qingmu_intro2_info: '挑战木神勾芒、树精',\r\n\t\t\tboss_qingmu_intro3: '&nbsp;第三关',\r\n\t\t\tboss_qingmu_intro3_info: '挑战太昊、木神勾芒、树精',\r\n\t\t\tboss_qingmu_intro3_append: '每通过一关，游戏轮数清零，阵亡角色复活，所有角色重置武将和区域内的牌，并获得4-X张起始手牌，X为阵亡角色数',\r\n\r\n\t\t\tboss_xuanlin_intro1: '&nbsp;第一关',\r\n\t\t\tboss_xuanlin_intro1_info: '挑战玄武',\r\n\t\t\tboss_xuanlin_intro2: '&nbsp;第二关',\r\n\t\t\tboss_xuanlin_intro2_info: '挑战水神玄冥、水神共工',\r\n\t\t\tboss_xuanlin_intro3: '&nbsp;第三关',\r\n\t\t\tboss_xuanlin_intro3_info: '挑战颛顼、水神玄冥、水神共工',\r\n\t\t\tboss_xuanlin_intro3_append: '每通过一关，游戏轮数清零，阵亡角色复活，所有角色重置武将和区域内的牌，并获得4-X张起始手牌，X为阵亡角色数',\r\n\r\n\t\t\tboss_baimang_intro1: '&nbsp;第一关',\r\n\t\t\tboss_baimang_intro1_info: '挑战白虎',\r\n\t\t\tboss_baimang_intro2: '&nbsp;第二关',\r\n\t\t\tboss_baimang_intro2_info: '挑战金神蓐收、明刑柱',\r\n\t\t\tboss_baimang_intro3: '&nbsp;第三关',\r\n\t\t\tboss_baimang_intro3_info: '挑战少昊、金神蓐收、明刑柱',\r\n\t\t\tboss_baimang_intro3_append: '每通过一关，游戏轮数清零，阵亡角色复活，所有角色重置武将和区域内的牌，并获得4-X张起始手牌，X为阵亡角色数',\r\n\r\n\t\t\tboss_bianshen_intro1: '&nbsp;第一关',\r\n\t\t\tboss_bianshen_intro1_info: '挑战魑、魅、魍、魉中的随机一个',\r\n\t\t\tboss_bianshen_intro2: '&nbsp;第二关',\r\n\t\t\tboss_bianshen_intro2_info: '挑战牛头、马面中的随机一个',\r\n\t\t\tboss_bianshen_intro3: '&nbsp;第三关',\r\n\t\t\tboss_bianshen_intro3_info: '挑战白无常、黑无常中的随机一个',\r\n\t\t\tboss_bianshen_intro4: '&nbsp;第四关',\r\n\t\t\tboss_bianshen_intro4_info: '挑战罗刹、夜叉中的随机一个',\r\n\t\t\t// boss_bianshen2:'后援',\r\n\t\t\t// boss_bianshen2_info:'你死亡后，随机召唤牛头、马面中的一个',\r\n\t\t\t// boss_bianshen3:'后援',\r\n\t\t\t// boss_bianshen3_info:'你死亡后，随机召唤白无常、黑无常中的一个',\r\n\t\t\t// boss_bianshen4:'后援',\r\n\t\t\t// boss_bianshen4_info:'你死亡后，随机召唤罗刹、夜叉中的一个',\r\n\r\n\t\t\tzhanjiang: '斩将',\r\n\t\t\tzhanjiang_info: '准备阶段开始时，如果其他角色的装备区内有【青鼈斩】，你可以获得之',\r\n\r\n\t\t\tboss_qiangzheng: '强征',\r\n\t\t\tboss_qiangzheng_info: '锁定技，结束阶段，你获得每个敌方角色的一张手牌',\r\n\t\t\tboss_baolin: '暴凌',\r\n\t\t\tguizhen: '归真',\r\n\t\t\tguizhen_info: '每当你失去最后一张手牌，你可以所有敌人失去全部手牌，没有手牌的角色失去一点体力（不触发技能）',\r\n\t\t\tboss_shengshou: '圣手',\r\n\t\t\tboss_shengshou_info: '每当你使用一张牌，你可以进行一次判定，若为红色，你回复一点体力',\r\n\t\t\twuqin: '五禽戏',\r\n\t\t\twuqin_info: '结束阶段，若你没有手牌，可以摸三张牌',\r\n\r\n\t\t\tboss_konghun: '控心',\r\n\t\t\tboss_konghun_info: '结束阶段，你可以指定一名敌人令其进入混乱状态（不受对方控制，并将队友视为敌人）直到下一回合开始',\r\n\t\t\tyuehun: '月魂',\r\n\t\t\tyuehun_info: '结束阶段，你可以回复一点体力并摸两张牌',\r\n\t\t\tfengwu: '风舞',\r\n\t\t\tfengwu_info: '出牌阶段限一次，可令除你外的所有角色依次对与其距离最近的另一名角色使用一张【杀】，无法如此做者失去1点体力。',\r\n\t\t\tboss_wange: '笙歌',\r\n\r\n\t\t\thuanhua: '幻化',\r\n\t\t\thuanhua_info: '锁定技，游戏开始时，你获得其他角色的所有技能，体力上限变为其他角色之和；其他角色于摸牌阶段摸牌时，你摸等量的牌；其他角色于弃牌阶段弃牌时，你弃置等量的手牌',\r\n\r\n\t\t\tboss_leiji: '雷击',\r\n\t\t\tboss_leiji_info: '每当你使用或打出一张【闪】，可令任意一名角色进行一次判定，若结果为黑色，其受到一点雷电伤害，然后你摸一张牌',\r\n\t\t\tjidian: '亟电',\r\n\t\t\tjidian_info: '每当你造成一次伤害，可以指定距离受伤害角色1以内的一名其他角色进行判定，若结果为黑色，该角色受到一点雷电伤害',\r\n\r\n\t\t\ttinqin: '听琴',\r\n\t\t\tboss_guihan: '归汉',\r\n\t\t\tboss_guihan_info: '限定技，濒死阶段，你可以将体力回复至体力上限，摸4张牌，令所有敌人的技能恢复，失去技能【悲歌】和【胡笳】，并获得技能【听琴】、【蕙质】',\r\n\t\t\tboss_huixin: '蕙质',\r\n\t\t\tboss_huixin_info: '每当你于回合外失去牌，可以进行一次判定，若为黑色，当前回合角色失去一点体力，否则你回复一点体力并摸一张牌',\r\n\t\t\tboss_hujia: '胡笳',\r\n\t\t\tboss_hujia_info: '结束阶段，若你已受伤，可以弃置一张牌令一名其他角色的所有技能失效，若其所有技能已失效，改为令其失去一点体力上限',\r\n\t\t\tboss_honglian: '红莲',\r\n\t\t\tboss_honglian_info: '锁定技，结束阶段，你摸两张牌，并对所有敌人造成一点火焰伤害',\r\n\t\t\thuoshen: '火神',\r\n\t\t\thuoshen_info: '锁定技，你防止即将受到的火焰伤害，改为回复1点体力',\r\n\t\t\tboss_xianyin: '仙音',\r\n\t\t\tboss_xianyin_info: '每当你于回合外失去牌，你可以进行一次判定，若为红色，你令一名敌人失去一点体力',\r\n\r\n\t\t\tboss_yuhuo: '浴火',\r\n\t\t\tboss_yuhuo_info: '觉醒技，在你涅槃后，你获得技能【神威】、【朱羽】',\r\n\t\t\tboss_tianyu: '天狱',\r\n\t\t\tboss_tianyu_info: '锁定技，结束阶段，你解除横置状态，除你之外的所有角色进入横置状态',\r\n\r\n\t\t\tboss_juejing: '绝境',\r\n\t\t\tboss_juejing2: '绝境',\r\n\t\t\tboss_juejing_info: '锁定技，摸牌阶段开始时，你不摸牌；锁定技，若你的手牌数小于4，你将手牌补至四张',\r\n\r\n\t\t\tboss_jizhi: '集智',\r\n\t\t\tboss_jizhi_info: '每当你使用一张非转化的非基本牌，你可以摸一张牌并展示之',\r\n\t\t\tboss_guiyin: '归隐',\r\n\t\t\tboss_guiyin_info: '锁定技，体力值比你多的角色无法在回合内对你使用卡牌',\r\n\t\t\tboss_gongshen: '工神',\r\n\t\t\tboss_gongshen_info: '锁定技，除你之外的角色没有装备区；你不能成为其他角色的延时锦囊牌的目标',\r\n\r\n\t\t\tfanghua: '芳华',\r\n\t\t\tfanghua_info: '结束阶段，你可以令所有已翻面角色流失一点体力',\r\n\t\t\ttashui: '踏水',\r\n\t\t\ttashui_info: '每当你使用或打出一张黑色牌，你可以令一名其他角色翻面',\r\n\r\n\t\t\tboss_wuxin: '无心',\r\n\t\t\tboss_wuxin_info: '锁定技，你防止即将受到的伤害，改为流失一点体力；你不能成为其他角色的延时锦囊的目标',\r\n\t\t\tshangshix: '伤逝',\r\n\t\t\tshangshix2: '伤逝',\r\n\t\t\tshangshix_info: '锁定技，你的手牌数至少为4，结束阶段，若你的体力值大于1，你令场上所有角色流失一点体力',\r\n\r\n\t\t\tboss_baonu: '暴怒',\r\n\t\t\tboss_baonu_info: '锁定技，当你的体力值降至4或更低时，你变身为暴怒战神或神鬼无前，并立即开始你的回合',\r\n\t\t\tshenwei: '神威',\r\n\t\t\tshenwei_info: '锁定技，摸牌阶段，你额外摸X张牌，你的手牌上限+X（X为场上其他角色的数目且至多为3）',\r\n\t\t\txiuluo: '修罗',\r\n\t\t\txiuluo_info: '准备阶段，你可以弃置一张牌，然后弃置你判定区内一张同花色的牌。你可以重复此流程。',\r\n\t\t\tshenqu: '神躯',\r\n\t\t\tshenqu_info: '每名角色的准备阶段，若你的手牌数少于或等于你的体力上限数，你可以摸两张牌；当你受到伤害后，你可以使用一张【桃】',\r\n\t\t\tjiwu: '极武',\r\n\t\t\tjiwu_info: '出牌阶段，你可以弃置一张牌，然后获得一项：“强袭”、“铁骑”(界)、“旋风”、“完杀”，直到回合结束',\r\n\r\n\t\t\t\"boss_jingjia\": \"精甲\",\r\n\t\t\t\"boss_jingjia_info\": \"锁定技，游戏开始时，将本局游戏中加入的装备随机置入你的装备区。\",\r\n\t\t\t\"boss_aozhan\": \"鏖战\",\r\n\t\t\t\"boss_aozhan_info\": \"锁定技，若你装备区内有：武器牌，你可以多使用一张【杀】；防具牌，防止你受到的超过1点的伤害；坐骑牌，摸牌阶段多摸一张牌；宝物牌，跳过你的判定阶段。\",\r\n\r\n\t\t\t\"shufazijinguan_skill\": \"束发紫金冠\",\r\n\t\t\t\"shufazijinguan_skill_info\": \"准备阶段，你可以对一名其他角色造成1点伤害。\",\r\n\t\t\t\"linglongshimandai_skill\": \"玲珑狮蛮带\",\r\n\t\t\t\"linglongshimandai_skill_info\": \"当其他角色使用牌指定你为唯一目标后，你可以进行一次判定，若判定结果为红桃，则此牌对你无效。\",\r\n\t\t\t\"hongmianbaihuapao_skill\": \"红棉百花袍\",\r\n\t\t\t\"hongmianbaihuapao_skill_info\": \"锁定技，防止你受到的属性伤害。\",\r\n\t\t\t\"wushuangfangtianji_skill\": \"无双方天戟\",\r\n\t\t\t\"wushuangfangtianji_skill_info\": \"你使用【杀】对目标角色造成伤害后，可以摸一张牌或弃置目标角色一张牌。\",\r\n\t\t\t\"wushuangfangtianji\": \"无双方天戟\",\r\n\t\t\t\"wushuangfangtianji_info\": \"你使用【杀】对目标角色造成伤害后，可以摸一张牌或弃置目标角色一张牌。\",\r\n\t\t\t\"shufazijinguan\": \"束发紫金冠\",\r\n\t\t\t\"shufazijinguan_info\": \"准备阶段，你可以对一名其他角色造成1点伤害。\",\r\n\t\t\t\"hongmianbaihuapao\": \"红棉百花袍\",\r\n\t\t\t\"hongmianbaihuapao_info\": \"锁定技，防止你受到的属性伤害。\",\r\n\t\t\t\"linglongshimandai\": \"玲珑狮蛮带\",\r\n\t\t\t\"linglongshimandai_info\": \"当其他角色使用牌指定你为唯一目标后，你可以进行一次判定，若判定结果为红桃，则此牌对你无效。\",\r\n\r\n\t\t\tboss_qinguangwang_ab: '秦广王',\r\n\t\t\tboss_qinguangwang: '秦广王·蒋子文',\r\n\t\t\tboss_panguan: '判官',\r\n\t\t\tboss_panguan_info: '\t锁定技，你不能成为延时类锦囊的目标。',\r\n\t\t\tboss_juhun: '拘魂',\r\n\t\t\tboss_juhun_info: '锁定技，结束阶段，你令随机一名其他角色的武将牌翻面或横置。',\r\n\t\t\tboss_wangxiang: '望乡',\r\n\t\t\tboss_wangxiang_info: '锁定技，当你死亡时，你令所有其他角色弃置其装备区内的所有牌。',\r\n\t\t\tboss_chujiangwang_ab: '楚江王',\r\n\t\t\tboss_chujiangwang: '楚江王·厉温',\r\n\t\t\tboss_bingfeng: '冰封',\r\n\t\t\tboss_bingfeng_info: '锁定技，你死亡时，若杀死你的角色武将牌是正面朝上， 你令其翻面。',\r\n\t\t\tboss_songdiwang: '余懃',\r\n\t\t\tboss_heisheng: '黑绳',\r\n\t\t\tboss_heisheng_info: '锁定技，你死亡时，横置所有场上角色。',\r\n\t\t\tboss_shengfu: '绳缚',\r\n\t\t\tboss_shengfu_info: '锁定技，你的回合结束时，随机弃置一张场上其他角色的坐骑牌。',\r\n\t\t\tboss_wuguanwang_ab: '五官王',\r\n\t\t\tboss_wuguanwang: '五官王·吕岱',\r\n\t\t\tboss_zhiwang: '治妄',\r\n\t\t\tboss_zhiwang_info: '锁定技，当其他角色于摸牌阶段外获得牌时，你随机弃置其一张手牌。',\r\n\t\t\tboss_zhiwang_planetarian: '注意事项',\r\n\t\t\tboss_zhiwang_planetarian_info: '若触发【治妄】的角色因【治妄】触发的其他的技能（如【伤逝】【连营】等）继续获得了牌，则该角色将其武将牌变更为孙策。',\r\n\t\t\tboss_gongzheng: '公正',\r\n\t\t\tboss_gongzheng_info: '锁定技，准备阶段，若你判定区有牌，你随机弃置一张你判定区的牌。',\r\n\t\t\tboss_xuechi: '血池',\r\n\t\t\tboss_xuechi_info: '锁定技，你的回合结束时，令随机一名其他角色失去2点体力。',\r\n\t\t\tboss_yanluowang_ab: '阎罗王',\r\n\t\t\tboss_yanluowang: '阎罗王·包拯',\r\n\t\t\tboss_tiemian: '铁面',\r\n\t\t\tboss_tiemian_info: '锁定技，你的防具区没有牌时，视为你装备【仁王盾】。',\r\n\t\t\tboss_zhadao: '铡刀',\r\n\t\t\tboss_zhadao_info: '锁定技，你使用【杀】指定目标后，你令目标角色防具无效。',\r\n\t\t\tboss_zhuxin: '诛心',\r\n\t\t\tboss_zhuxin_info: '锁定技，你死亡时，你令场上血量最少的一名其他角色受到2点伤害。',\r\n\t\t\tboss_bianchengwang_ab: '卞城王',\r\n\t\t\tboss_bianchengwang: '卞城王·毕元宾',\r\n\t\t\tboss_leizhou: '雷咒',\r\n\t\t\tboss_leizhou_info: '锁定技，准备阶段，你对随机一名其他角色造成1点雷属性伤害',\r\n\t\t\tboss_leifu: '雷缚',\r\n\t\t\tboss_leifu_info: '锁定技，你的回合结束时，随机横置一名其他角色。',\r\n\t\t\tboss_leizhu: '雷诛',\r\n\t\t\tboss_leizhu_info: '锁定技，你死亡时，对所有其他角色造成依次造成1点雷属性伤害。',\r\n\t\t\tboss_taishanwang_ab: '泰山王',\r\n\t\t\tboss_taishanwang: '泰山王·董和',\r\n\t\t\tboss_fudu: '服毒',\r\n\t\t\tboss_fudu_info: '锁定技，其他角色使用【桃】时，你令随机另一名其他角色失去1点体力。',\r\n\t\t\tboss_kujiu: '苦酒',\r\n\t\t\tboss_kujiu_info: '锁定技，其他角色准备阶段，你令其失去1点体力，然后该角色视为使用一张【酒】。',\r\n\t\t\tboss_renao: '热恼',\r\n\t\t\tboss_renao_info: '锁定技，你死亡时，你令随机一名其他角色受到3点火属性伤害。',\r\n\t\t\tboss_dushiwang_ab: '都市王',\r\n\t\t\tboss_dushiwang: '都市王·黄中庸',\r\n\t\t\tboss_remen: '热闷',\r\n\t\t\tboss_remen_info: '锁定技，若你的装备区内没有防具牌，则【南蛮入侵】、【万箭齐发】和普通【杀】对你无效。',\r\n\t\t\tboss_zhifen: '炙焚',\r\n\t\t\tboss_zhifen_info: '锁定技，准备阶段，你随机选择一名其他角色，获得其1张手牌（没有则不获得），并对其造成1点火属性伤害。',\r\n\t\t\tboss_huoxing: '火刑',\r\n\t\t\tboss_huoxing_info: '锁定技，你死亡时，你对所有其他角色造成1点火属性伤害。',\r\n\t\t\tboss_pingdengwang_ab: '平等王',\r\n\t\t\tboss_pingdengwang: '平等王·陆游',\r\n\t\t\tboss_suozu: '锁足',\r\n\t\t\tboss_suozu_info: '锁定技，准备阶段，你令所有其他角色横置。',\r\n\t\t\tboss_abi: '阿鼻',\r\n\t\t\tboss_abi_info: '锁定技，锁定技，你受到伤害时，你对伤害来源造成伤害的角色造成1点随机属性伤害（雷或火随机）。',\r\n\t\t\tboss_pingdeng: '平等',\r\n\t\t\tboss_pingdeng_info: '锁定技，你死亡时，你对体力最多的一名其他角色造成2点随机属性伤害（属性随机），然后再对一名体力最多的其他角色造成1点随机属性伤害（属性随机）。',\r\n\t\t\tboss_zhuanlunwang_ab: '转轮王',\r\n\t\t\tboss_zhuanlunwang: '转轮王·薛礼',\r\n\t\t\tboss_lunhui: '轮回',\r\n\t\t\tboss_lunhui_info: '锁定技，准备阶段，若你的体力小于等于2，则你与场上除你以外体力最高且大于2的角色交换体力值。',\r\n\t\t\tboss_wangsheng: '往生',\r\n\t\t\tboss_wangsheng_info: '锁定技，你的出牌阶段开始时，视为你随机使用一张【南蛮入侵】或【万箭齐发】。',\r\n\t\t\tboss_zlfanshi: '反噬',\r\n\t\t\tboss_zlfanshi_info: '锁定技，每个回合你受到第一次伤害后，若再次受到伤害，则对随机一名其他角色造成1点伤害。',\r\n\t\t\tboss_shikieiki_ab: '四季映姫',\r\n\t\t\tboss_shikieiki: '四季映姬·夜魔仙那度',\r\n\t\t\tboss_yingzhong: '映冢',\r\n\t\t\tboss_yingzhong_info: '锁定技。你登场后的第一个回合开始时，你随机获得两个“阴间武将”的全部技能。',\r\n\t\t\tboss_yingzhong_append: '<span style=\"font-family:yuanli\">四季映姬到阴曹地府<br>——阴(映)到家了！</span>',\r\n\t\t\t//孟婆:\r\n\t\t\t\"boss_mengpo\": \"孟婆\",\r\n\t\t\t\"boss_shiyou\": \"拾忧\",\r\n\t\t\t\"boss_shiyou_info\": \"其他角色于弃牌阶段弃置的牌进入弃牌堆前，你可以选择其中任意张花色各不相同的牌获得之。\",\r\n\t\t\t\"boss_wanghun\": \"忘魂\",\r\n\t\t\t\"boss_wanghun_info\": \"锁定技，你死亡时，令随机两名敌方角色各随机失去一个技能（主公技除外），并在牌堆中加入2张回魂。(回魂只能在挑战模式出现)\",\r\n\t\t\t\"boss_wangshi\": \"往事\",\r\n\t\t\t\"boss_wangshi_info\": \"锁定技，你存活时，敌方角色的回合开始时，令其于本回合不能使用或打出随机一种类型的牌（基本、锦囊、装备）。\",\r\n\t\t\t\"boss_wangshi2\": \"往事\",\r\n\t\t\t\"boss_wangshi2_info\": \"\",\r\n\t\t\t//地藏王:\r\n\t\t\t\"boss_dizangwang\": \"地藏王\",\r\n\t\t\t\"boss_bufo\": \"不佛\",\r\n\t\t\t\"boss_bufo_info\": \"锁定技，你的回合开始时，你对所有距离为1的其他角色造成1点火焰伤害；你受到大于等于2的伤害时，令此伤害-1。\",\r\n\t\t\t\"boss_wuliang\": \"无量\",\r\n\t\t\t\"boss_wuliang_info\": \"锁定技，你登场时额外摸3张牌；结束阶段开始时，你摸两张牌；你的回合开始时，若你当前体力小于3，则回复至3。\",\r\n\t\t\t\"boss_dayuan\": \"大愿\",\r\n\t\t\t\"boss_dayuan_info\": \" 当一名角色判定牌最终生效前，你可以指定该判定牌的点数和花色\",\r\n\t\t\t\"boss_diting\": \"谛听\",\r\n\t\t\t\"boss_diting_info\": \"锁定技，你的坐骑区被废除，你与别人计算距离时-1，别人与你计算距离时+1；你的坐骑牌均用于重铸。\",\r\n\t\t\t/*\t\t\t//等阶\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel1\":\"一阶\",\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel1_info\":\"\",\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel2\":\"二阶\",\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel2_info\":\"开局随机使用一张装备牌，起始手牌+1\",\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel3\":\"三阶\",\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel3_info\":\"出杀次数+1，体力上限+1\",\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel4\":\"四阶\",\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel4_info\":\"摸牌阶段多摸一张牌，起始手牌+1\",\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel5\":\"重生\",\r\n\t\t\t\t\t\t\"boss_sdyl_playerlevel5_info\":\"限定技，当你处于濒死状态时，你可以弃置所有判定区牌，然后复原你的武将牌，将手牌补充至手牌体力上限（至多为5），将体力回复至体力上限。\",\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel1\":\"一阶\",\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel1_info\":\"\",\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel2\":\"二阶\",\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel2_info\":\"登场时随机使用一张装备牌\",\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel3\":\"三阶\",\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel3_info\":\"出杀次数+1，回合开始获得一张【杀】，体力上限+1，起始手牌+1\",\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel4\":\"四阶\",\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel4_info\":\"摸牌阶段多摸一张牌，手牌上限+1\",\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel5\":\"五阶\",\r\n\t\t\t\t\t\t\"boss_sdyl_bosslevel5_info\":\"登场时视为使用一张【南蛮入侵】且此【南蛮入侵】伤害+1。体力上限+1，起始手牌+1\",\r\n\t\t\t\t\t\t*/\r\n\t\t\t\"boss_sunce\": \"那个男人\",\r\n\t\t\t\"boss_hunzi\": \"魂姿\",\r\n\t\t\t\"boss_hunzi_info\": \"觉醒技，准备阶段，若你的体力值为1，你减1点体力上限，失去技能【魂佑】并获得技能【英姿】和【英魂】。\",\r\n\t\t\t\"boss_jiang\": \"激昂\",\r\n\t\t\t\"boss_jiang_info\": \"①锁定技，【激昂】不会无效<br>②每当你使用或打出红色牌时，你可以摸一张牌。若你是因响应其他角色使用或打出的牌，则你获得对方使用或打出的牌<br>③当有其他角色使用或打出红色牌指定你为目标或响应你后，你可以摸一张牌并获得这些牌\",\r\n\t\t\t\"boss_hunyou\": \"魂佑\",\r\n\t\t\t\"boss_hunyou_info\": \"锁定技，你的体力值变化和体力上限变化无效。\",\r\n\t\t\t\"boss_taoni\": \"讨逆\",\r\n\t\t\t\"boss_taoni_info\": \"锁定技，游戏开始时，每名角色回合开始时或你死亡时，你检查存活角色的合法性。若有角色存在非法行为，则你终止本局游戏。\",\r\n\r\n\t\t\tboss_xhuanren: '关卡说明',\r\n\t\t\tboss_xhuanren_info: '',\r\n\t\t\tboss_xhuanren_info_boss: '第一关：挑战秦广王。<br>第二关：挑战楚江王，宋帝王，五官王，阎罗王中的一个。<br>第三关：挑战卞城王，泰山王，都市王，平等王中的一个。<br>第四关：挑战转轮王。',\r\n\r\n\t\t\tboss_newhuanren: '关卡说明',\r\n\t\t\tboss_newhuanren_info: '',\r\n\t\t\tboss_newhuanren_info_boss: '第一关：挑战秦广王。<br>第二关：挑战楚江王，宋帝王，五官王，阎罗王中的一个。<br>第三关：挑战卞城王，泰山王，都市王，平等王中的一个。<br>第四关：挑战转轮王。<br>注：孟婆将在每局前三个阶段随机一个阶段登场<br>地藏王登场规则为，50回合内通过第三关，并且在前三关中成功击杀孟婆。<li>选陆逊左慈张春华于吉蒋费孔融自动变孙笨',\r\n\t\t\tlingsheji: '灵蛇髻',\r\n\t\t\tlingsheji2: '灵蛇髻',\r\n\t\t\tshanrangzhaoshu: '禅让诏书',\r\n\t\t\txingtianpojunfu: '刑天破军斧',\r\n\t\t\tnoda_axe: '刑天破军斧',\r\n\t\t\tnoda_axe2: '刑天破军斧',\r\n\t\t\tjinwuluorigong: '金乌落日弓',\r\n\t\t\tiwasawa_crowbow: '金乌落日弓',\r\n\t\t\tlingsheji_info: '出牌阶段结束时，你可选择：1.摸一张牌。2.将一张武将牌置于武将牌上，并于回合结束后获得此牌。',\r\n\t\t\tshanrangzhaoshu_info: '其他角色于回合外获得牌后，若是其本回合内第一次获得牌，则你可以选择一项：交给其一张牌，或令其交给你一张牌。',\r\n\t\t\txingtianpojunfu_info: '当你于出牌阶段内使用牌指定唯一目标后，你可弃置两张牌。若如此做，其本回合内不能使用或打出牌且其防具技能无效。',\r\n\t\t\tjinwuluorigong_info: '当你于出牌阶段内一次性失去了两张以上的手牌后，你可以弃置一名其他角色等量的牌。',\r\n\t\t\tTheDayIBecomeAGod: '神杀',\r\n\t\t\tthedayibecomeagod: '传承',\r\n\t\t\tthedayibecomeagod_info: '选择一名其他己方角色。若其势力非神，则改为神势力；若其势力为神，则将武将牌翻至正面，回复体力至体力上限，并将手牌摸至5 ',\r\n\t\t\tgubuzifeng: '故步自封',\r\n\t\t\tgubuzifeng_disable: '故步自封',\r\n\t\t\tgubuzifeng_info: '出牌阶段，对一名其他角色使用。其的一个随机技能失效直到其下个回合结束。',\r\n\t\t\tgoujiangdesidai: '篝酱的丝带',\r\n\t\t\tgoujiangdesidai_info: '锁定技，若你未拥有技能【纵丝】，则你视为拥有技能【纵丝】；若你拥有技能【纵丝】，则你将此技能改为「出牌阶段限两次」',\r\n\t\t\tgoujiangdesidai_skill: '纵丝',\r\n\t\t\tniaobaidaowenha: '鸟白岛文蛤',\r\n\t\t\tniaobaidaowenha_skill: '鸟白岛文蛤',\r\n\t\t\tniaobaidaowenha_info: '当你减少1点体力上限后，你可令一名其他角色增加1点体力上限并回复1点体力。',\r\n\t\t\tniaobaidaowenha_skill_info: '当你减少1点体力上限后，你可令一名其他角色增加1点体力上限并回复1点体力。',\r\n\t\t\tshenzhixiunvfu: '神之修女服',\r\n\t\t\tshenzhixiunvfu_info: '没什么实际作用的衣服，仅仅是显得像个神而已。',\r\n\r\n\t\t\tmode_boss_card_config: '挑战卡牌',\r\n\t\t\tmode_boss_character_config: '挑战武将',\r\n\t\t},\r\n\t\tget: {\r\n\t\t\trawAttitude: function (from, to) {\r\n\t\t\t\tvar num = (to.identity == 'zhong') ? 5 : 6;\r\n\t\t\t\treturn (from.side === to.side ? num : -num);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/boss.js?")},"./src/mode/brawl.js":function(){eval("\r\ngame.import('mode',function(lib,game,ui,get,ai,_status){\r\n\treturn {\r\n\t\tname:'brawl',\r\n\t\tgame:{\r\n\t\t\tsyncMenu:true,\r\n\t\t},\r\n\t\tstart:function(){\r\n\t\t\tui.auto.hide();\r\n\t\t\tif(!lib.storage.scene){\r\n\t\t\t\tlib.storage.scene={};\r\n\t\t\t}\r\n\t\t\tif(!lib.storage.stage){\r\n\t\t\t\tlib.storage.stage={};\r\n\t\t\t}\r\n\t\t\tif(!_status.extensionmade){\r\n\t\t\t\t_status.extensionmade=[];\r\n\t\t\t}\r\n\t\t\tif(_status.extensionscene){\r\n\t\t\t\tgame.save('scene',lib.storage.scene);\r\n\t\t\t}\r\n\t\t\tif(_status.extensionstage){\r\n\t\t\t\tgame.save('stage',lib.storage.stage);\r\n\t\t\t}\r\n\t\t\tvar dialog=ui.create.dialog('hidden');\r\n\t\t\tdialog.classList.add('fixed');\r\n\t\t\tdialog.classList.add('scroll1');\r\n\t\t\tdialog.classList.add('scroll2');\r\n\t\t\tdialog.classList.add('fullwidth');\r\n\t\t\tdialog.classList.add('fullheight');\r\n\t\t\tdialog.classList.add('noupdate');\r\n\t\t\tdialog.classList.add('character');\r\n\t\t\tdialog.contentContainer.style.overflow='visible';\r\n\t\t\tdialog.style.overflow='hidden';\r\n\t\t\tdialog.content.style.height='100%';\r\n\t\t\tdialog.contentContainer.style.transition='all 0s';\r\n\t\t\tif(!lib.storage.directStage) dialog.open();\r\n\t\t\tvar packnode=ui.create.div('.packnode',dialog);\r\n\t\t\tlib.setScroll(packnode);\r\n\t\t\tvar clickCapt=function(){\r\n\t\t\t\tvar active=this.parentNode.querySelector('.active');\r\n\t\t\t\tif(this.link=='stage'){\r\n\t\t\t\t\tif(get.is.empty(lib.storage.scene)){\r\n\t\t\t\t\t\talert('请创建至少1个场景');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(active){\r\n\t\t\t\t\tif(active==this) return;\r\n\t\t\t\t\tfor(var i=0;i<active.nodes.length;i++){\r\n\t\t\t\t\t\tactive.nodes[i].remove();\r\n\t\t\t\t\t\tif(active.nodes[i].showcaseinterval){\r\n\t\t\t\t\t\t\tclearInterval(active.nodes[i].showcaseinterval);\r\n\t\t\t\t\t\t\tdelete active.nodes[i].showcaseinterval;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tactive.classList.remove('active');\r\n\t\t\t\t}\r\n\t\t\t\tthis.classList.add('active');\r\n\t\t\t\tfor(var i=0;i<this.nodes.length;i++){\r\n\t\t\t\t\tdialog.content.appendChild(this.nodes[i]);\r\n\t\t\t\t}\r\n\t\t\t\tvar showcase=this.nodes[this.nodes.length-1];\r\n\t\t\t\tshowcase.style.height=(dialog.content.offsetHeight-showcase.offsetTop)+'px';\r\n\t\t\t\tif(typeof showcase.action=='function'){\r\n\t\t\t\t\tif(showcase.action(showcase._showcased?false:true)!==false){\r\n\t\t\t\t\t\tshowcase._showcased=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(this._nostart) start.style.display='none';\r\n\t\t\t\telse start.style.display='';\r\n\t\t\t\tgame.save('currentBrawl',this.link);\r\n\t\t\t}\r\n\t\t\tvar createNode=function(name){\r\n\t\t\t\tvar info=lib.brawl[name];\r\n\t\t\t\tvar node=ui.create.div('.dialogbutton.menubutton.large',info.name,packnode,clickCapt);\r\n\t\t\t\tnode.style.transition='all 0s';\r\n\t\t\t\tvar caption=info.name;\r\n\t\t\t\tvar modeinfo='';\r\n\t\t\t\tif(info.mode){\r\n\t\t\t\t\tmodeinfo=get.translation(info.mode)+'模式';\r\n\t\t\t\t}\r\n\t\t\t\tif(info.submode){\r\n\t\t\t\t\tif(modeinfo){\r\n\t\t\t\t\t\tmodeinfo+=' - ';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmodeinfo+=info.submode;\r\n\t\t\t\t}\r\n\t\t\t\tvar intro;\r\n\t\t\t\tif(Array.isArray(info.intro)){\r\n\t\t\t\t\tintro='<ul style=\"text-align:left;margin-top:0;width:450px\">';\r\n\t\t\t\t\tif(modeinfo){\r\n\t\t\t\t\t\tintro+='<li>'+modeinfo;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<info.intro.length;i++){\r\n\t\t\t\t\t\tintro+='<li>'+info.intro[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tintro='';\r\n\t\t\t\t\tif(modeinfo){\r\n\t\t\t\t\t\tintro+='（'+modeinfo+'）';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tintro+=info.intro;\r\n\t\t\t\t}\r\n\t\t\t\tvar showcase=ui.create.div();\r\n\t\t\t\tshowcase.style.margin='0px';\r\n\t\t\t\tshowcase.style.padding='0px';\r\n\t\t\t\tshowcase.style.width='100%';\r\n\t\t\t\tshowcase.style.display='block'\r\n\t\t\t\tshowcase.action=info.showcase;\r\n\t\t\t\tshowcase.link=name;\r\n\t\t\t\tif(info.fullshow){\r\n\t\t\t\t\tnode.nodes=[showcase];\r\n\t\t\t\t\tshowcase.style.height='100%';\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnode.nodes=[\r\n\t\t\t\t\t\tui.create.div('.caption',caption),\r\n\t\t\t\t\t\tui.create.div('.text center',intro),\r\n\t\t\t\t\t\tshowcase\r\n\t\t\t\t\t];\r\n\t\t\t\t}\r\n\t\t\t\tnode.link=name;\r\n\t\t\t\tnode._nostart=info.nostart;\r\n\t\t\t\tif(lib.storage.currentBrawl==name){\r\n\t\t\t\t\tclickCapt.call(node);\r\n\t\t\t\t}\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\t\t\tvar clickStart=function(){\r\n\t\t\t\tvar active=packnode.querySelector('.active');\r\n\t\t\t\tif(active){\r\n\t\t\t\t\tfor(var i=0;i<active.nodes.length;i++){\r\n\t\t\t\t\t\tif(active.nodes[i].showcaseinterval){\r\n\t\t\t\t\t\t\tclearInterval(active.nodes[i].showcaseinterval);\r\n\t\t\t\t\t\t\tdelete active.nodes[i].showcaseinterval;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar info;\r\n\t\t\t\t\tif(active.link.indexOf('stage_')==0){\r\n\t\t\t\t\t\tvar level;\r\n\t\t\t\t\t\tif(Array.isArray(arguments[0])){\r\n\t\t\t\t\t\t\tlevel={index:arguments[0][1]};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tlevel=dialog.content.querySelector('.menubutton.large.active');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(level){\r\n\t\t\t\t\t\t\tvar stagesave=lib.storage.stage;\r\n\t\t\t\t\t\t\tvar stage=stagesave[active.link.slice(6)];\r\n\t\t\t\t\t\t\tgame.save('lastStage',level.index);\r\n\t\t\t\t\t\t\tlib.onover.push(function(bool){\r\n\t\t\t\t\t\t\t\t_status.createControl=ui.controls[0];\r\n\t\t\t\t\t\t\t\tif(bool&&level.index+1<stage.scenes.length){\r\n\t\t\t\t\t\t\t\t\tui.create.control('下一关',function(){\r\n\t\t\t\t\t\t\t\t\t\tgame.save('directStage',[stage.name,level.index+1],'brawl');\r\n\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem(lib.configprefix+'directstart',true);\r\n\t\t\t\t\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tif(level.index+1>stage.level){\r\n\t\t\t\t\t\t\t\t\t\tstage.level=level.index+1;\r\n\t\t\t\t\t\t\t\t\t\tgame.save('stage',stagesave,'brawl');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif(stage.mode!='sequal'){\r\n\t\t\t\t\t\t\t\t\t\tgame.save('lastStage',level.index+1,'brawl');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tui.create.control('重新开始',function(){\r\n\t\t\t\t\t\t\t\t\t\tif(stage.mode=='sequal'&&bool&&level.index==stage.scenes.length-1){\r\n\t\t\t\t\t\t\t\t\t\t\tgame.save('directStage',[stage.name,0],'brawl');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\tgame.save('directStage',[stage.name,level.index],'brawl');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem(lib.configprefix+'directstart',true);\r\n\t\t\t\t\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tif(stage.mode=='sequal'&&level.index==stage.scenes.length-1){\r\n\t\t\t\t\t\t\t\t\t\tstage.level=0;\r\n\t\t\t\t\t\t\t\t\t\tgame.save('stage',stagesave,'brawl');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif(stage.mode!='sequal'){\r\n\t\t\t\t\t\t\t\t\t\tgame.save('lastStage',level.index,'brawl');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tvar scene=stage.scenes[level.index];\r\n\t\t\t\t\t\t\tinfo={\r\n\t\t\t\t\t\t\t\tname:scene.name,\r\n\t\t\t\t\t\t\t\tintro:scene.intro,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tfor(var i in lib.brawl.scene.template){\r\n\t\t\t\t\t\t\t\tinfo[i]=get.copy(lib.brawl.scene.template[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!scene.gameDraw){\r\n\t\t\t\t\t\t\t\tinfo.content.noGameDraw=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tinfo.content.scene=scene;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tinfo=lib.brawl[active.link];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.translate.restart='返回';\r\n\t\t\t\t\tdialog.delete();\r\n\t\t\t\t\tui.brawlinfo=ui.create.system('乱斗',null,true);\r\n\t\t\t\t\tlib.setPopped(ui.brawlinfo,function(){\r\n\t\t\t\t\t\tvar uiintro=ui.create.dialog('hidden');\r\n\t\t\t\t\t\tuiintro.add(info.name);\r\n\t\t\t\t\t\tvar intro;\r\n\t\t\t\t\t\tif(Array.isArray(info.intro)){\r\n\t\t\t\t\t\t\tintro='<ul style=\"text-align:left;margin-top:0;width:450px\">';\r\n\t\t\t\t\t\t\tfor(var i=0;i<info.intro.length;i++){\r\n\t\t\t\t\t\t\t\tintro+='<li>'+info.intro[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tintro+='</ul>'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tintro=info.intro;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tuiintro.add('<div class=\"text center\">'+intro+'</div>');\r\n\t\t\t\t\t\tvar ul=uiintro.querySelector('ul');\r\n\t\t\t\t\t\tif(ul){\r\n\t\t\t\t\t\t\tul.style.width='180px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tuiintro.add(ui.create.div('.placeholder'));\r\n\t\t\t\t\t\treturn uiintro;\r\n\t\t\t\t\t},250);\r\n\t\t\t\t\tui.auto.show();\r\n\t\t\t\t\t_status.brawl=info.content;\r\n\t\t\t\t\tgame.switchMode(info.mode);\r\n\t\t\t\t\tif(info.init){\r\n\t\t\t\t\t\tinfo.init();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar start=ui.create.div('.menubutton.round.highlight','斗',dialog.content,clickStart);\r\n\t\t\tstart.style.position='absolute';\r\n\t\t\tstart.style.left='auto';\r\n\t\t\tstart.style.right='10px';\r\n\t\t\tstart.style.top='auto';\r\n\t\t\tstart.style.bottom='10px';\r\n\t\t\tstart.style.width='80px';\r\n\t\t\tstart.style.height='80px';\r\n\t\t\tstart.style.lineHeight='80px';\r\n\t\t\tstart.style.margin='0';\r\n\t\t\tstart.style.padding='5px';\r\n\t\t\tstart.style.fontSize='72px';\r\n\t\t\tstart.style.zIndex=3;\r\n\t\t\tstart.style.transition='all 0s';\r\n\t\t\tgame.addScene=function(name,clear){\r\n\t\t\t\tvar scene=lib.storage.scene[name];\r\n\t\t\t\tvar brawl={\r\n\t\t\t\t\tname:name,\r\n\t\t\t\t\tintro:scene.intro,\r\n\t\t\t\t};\r\n\t\t\t\tfor(var i in lib.brawl.scene.template){\r\n\t\t\t\t\tbrawl[i]=get.copy(lib.brawl.scene.template[i]);\r\n\t\t\t\t}\r\n\t\t\t\tif(!scene.gameDraw){\r\n\t\t\t\t\tbrawl.content.noGameDraw=true;\r\n\t\t\t\t}\r\n\t\t\t\tbrawl.content.scene=scene;\r\n\t\t\t\tlib.brawl['scene_'+name]=brawl;\r\n\t\t\t\tvar node=createNode('scene_'+name);\r\n\t\t\t\tif(clear){\r\n\t\t\t\t\tgame.addSceneClear();\r\n\t\t\t\t\tclickCapt.call(node);\r\n\t\t\t\t\t_status.sceneChanged=true;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tgame.addStage=function(name,clear){\r\n\t\t\t\tvar stage=lib.storage.stage[name];\r\n\t\t\t\tvar brawl={\r\n\t\t\t\t\tname:name,\r\n\t\t\t\t\tintro:stage.intro,\r\n\t\t\t\t\tcontent:{}\r\n\t\t\t\t};\r\n\t\t\t\tfor(var i in lib.brawl.stage.template){\r\n\t\t\t\t\tbrawl[i]=get.copy(lib.brawl.stage.template[i]);\r\n\t\t\t\t}\r\n\t\t\t\tbrawl.content.stage=stage;\r\n\t\t\t\tlib.brawl['stage_'+name]=brawl;\r\n\t\t\t\tvar node=createNode('stage_'+name);\r\n\t\t\t\tif(clear){\r\n\t\t\t\t\tgame.addStageClear();\r\n\t\t\t\t\tclickCapt.call(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tgame.removeScene=function(name){\r\n\t\t\t\tdelete lib.storage.scene[name];\r\n\t\t\t\tgame.save('scene',lib.storage.scene);\r\n\t\t\t\t_status.sceneChanged=true;\r\n\t\t\t\tfor(var i=0;i<packnode.childElementCount;i++){\r\n\t\t\t\t\tif(packnode.childNodes[i].link=='scene_'+name){\r\n\t\t\t\t\t\tif(packnode.childNodes[i].classList.contains('active')){\r\n\t\t\t\t\t\t\tfor(var j=0;j<packnode.childElementCount;j++){\r\n\t\t\t\t\t\t\t\tif(packnode.childNodes[j].link=='scene'){\r\n\t\t\t\t\t\t\t\t\tclickCapt.call(packnode.childNodes[j]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpacknode.childNodes[i].remove();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tgame.removeStage=function(name){\r\n\t\t\t\tdelete lib.storage.stage[name];\r\n\t\t\t\tgame.save('stage',lib.storage.stage);\r\n\t\t\t\tfor(var i=0;i<packnode.childElementCount;i++){\r\n\t\t\t\t\tif(packnode.childNodes[i].link=='stage_'+name){\r\n\t\t\t\t\t\tif(packnode.childNodes[i].classList.contains('active')){\r\n\t\t\t\t\t\t\tfor(var j=0;j<packnode.childElementCount;j++){\r\n\t\t\t\t\t\t\t\tif(get.is.empty(lib.storage.scene)){\r\n\t\t\t\t\t\t\t\t\tif(packnode.childNodes[j].link=='scene'){\r\n\t\t\t\t\t\t\t\t\t\tclickCapt.call(packnode.childNodes[j]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tif(packnode.childNodes[j].link=='stage'){\r\n\t\t\t\t\t\t\t\t\t\tclickCapt.call(packnode.childNodes[j]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpacknode.childNodes[i].remove();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sceneNode;\r\n\t\t\tfor(var i in lib.brawl){\r\n\t\t\t\tif(get.config(i)===false) continue;\r\n\t\t\t\tif(i=='scene'){\r\n\t\t\t\t\tsceneNode=createNode(i);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tcreateNode(i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(sceneNode){\r\n\t\t\t\tgame.switchScene=function(){\r\n\t\t\t\t\tclickCapt.call(sceneNode);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(var i in lib.storage.scene){\r\n\t\t\t\tgame.addScene(i);\r\n\t\t\t}\r\n\t\t\tfor(var i in lib.storage.stage){\r\n\t\t\t\tgame.addStage(i);\r\n\t\t\t}\r\n\t\t\tif(!lib.storage.currentBrawl){\r\n\t\t\t\tclickCapt.call(packnode.firstChild);\r\n\t\t\t}\r\n\t\t\tgame.save('lastStage');\r\n\t\t\tif(lib.storage.directStage){\r\n\t\t\t\tvar directStage=lib.storage.directStage;\r\n\t\t\t\tgame.save('directStage');\r\n\t\t\t\tclickStart(directStage);\r\n\t\t\t}\r\n\t\t\tlib.init.onfree();\r\n\t\t},\r\n\t\tbrawl:{\r\n\t\t\thuanhuazhizhan:{\r\n\t\t\t\tname:'幻化之战',\r\n\t\t\t\tmode:'identity',\r\n\t\t\t\tintro:[\r\n\t\t\t\t\t'杀死所有其他角色，成为最后的存活者',\r\n\t\t\t\t\t'所有角色改为四血白板，依靠灵力值获得技能。灵力值可以通过各种方式获得',\r\n\t\t\t\t],\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tthis.nodes=[];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\twhile(this.nodes.length){\r\n\t\t\t\t\t\t\tthis.nodes.shift().remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar lx=this.offsetWidth/2-120;\r\n\t\t\t\t\tvar ly=Math.min(lx,this.offsetHeight/2-60);\r\n\t\t\t\t\tvar setPos=function(node){\r\n\t\t\t\t\t\tvar i=node.index;\r\n\t\t\t\t\t\tvar deg=Math.PI/4*i;\r\n\t\t\t\t\t\tvar dx=Math.round(lx*Math.cos(deg));\r\n\t\t\t\t\t\tvar dy=Math.round(ly*Math.sin(deg));\r\n\t\t\t\t\t\tnode.style.transform='translate('+dx+'px,'+dy+'px)';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar characterz=['xinkeniang','Bafuko','ShikaiYue','InabaHaneru','Yousa','re_UruhaRushia','re_YuNi','re_Siro'];\r\n\t\t\t\t\tfor(var i=0;i<8;i++){\r\n\t\t\t\t\t\tvar node=ui.create.player(null,true);\r\n\t\t\t\t\t\tthis.nodes.push(node);\r\n\t\t\t\t\t\tnode.init(characterz[i]);\r\n\t\t\t\t\t\tnode.classList.add('minskin');\r\n\t\t\t\t\t\tnode.node.marks.remove();\r\n\t\t\t\t\t\tnode.node.hp.remove();\r\n\t\t\t\t\t\tnode.node.count.remove();\r\n\t\t\t\t\t\tnode.style.left='calc(50% - 60px)';\r\n\t\t\t\t\t\tnode.style.top='calc(50% - 60px)';\r\n\t\t\t\t\t\tnode.index=i;\r\n\t\t\t\t\t\tnode.style.borderRadius='100%';\r\n\t\t\t\t\t\tnode.node.avatar.style.borderRadius='100%';\r\n\t\t\t\t\t\tnode.node.name.remove();\r\n\t\t\t\t\t\tsetPos(node);\r\n\t\t\t\t\t\tthis.appendChild(node);//[todo player]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar nodes=this.nodes;\r\n\t\t\t\t\tthis.showcaseinterval=setInterval(function(){\r\n\t\t\t\t\t\tfor(var i=0;i<nodes.length;i++){\r\n\t\t\t\t\t\t\tnodes[i].index++;\r\n\t\t\t\t\t\t\tif(nodes[i].index>7){\r\n\t\t\t\t\t\t\t\tnodes[i].index=0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetPos(nodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},1000);\r\n\t\t\t\t},\r\n\t\t\t\tinit:function(){},\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tsubmode:'normal',\r\n\t\t\t\t\tchooseCharacterBefore:function(){\r\n\t\t\t\t\tgame.identityVideoName='幻化之战';\r\n\t\t\t\t\tvar skills=[];\r\n\t\t\t\t\tvar banned=[\r\n\t\t\t\t\t\t'maoge',\r\n\r\n\t\t\t\t\t\t'xinfu_guhuo','reguhuo','jixi','duanchang','huashen','xinsheng','rehuashen','rexinsheng',\r\n\t\t\t\t\t\t'jinqu','nzry_binglve','nzry_huaiju','nzry_yili','nzry_zhenglun','nzry_mingren','nzry_zhenliang','drlt_qingce',\r\n\t\t\t\t\t\t'new_wuhun','qixing','kuangfeng','dawu','baonu','wumou','ol_wuqian','ol_shenfen','renjie','jilue','nzry_junlve','nzry_dinghuo','drlt_duorui',\r\n\t\t\t\t\t\t'chuanxin','cunsi',\r\n\t\t\t\t\t\t'jueqing','huilei','paiyi','fuhun','zhuiyi','olddanshou','yanzhu','juexiang','jiexun','bizhuan','tongbo',\r\n\t\t\t\t\t\t'xinfu_zhanji','xinfu_jijun','xinfu_fangtong',\r\n\t\t\t\t\t\t'xinfu_qianchong','pdgyinshi','shuliang',\r\n\t\t\t\t\t\t'zongkui','guju','bmcanshi','dingpan','xinfu_lingren','new_luoyan','junwei','gxlianhua',\r\n\t\t\t\t\t\t'qizhou','fenyue','dianhu','linglong','fenxin','mouduan',\r\n\t\t\t\t\t\t'cuorui','xinmanjuan','xinfu_jianjie','jianjie_faq','new_meibu','xinfu_xingzhao','jici',\r\n\t\t\t\t\t\t'xianfu','fenyong','xuehen','yingbin','midao','yishe','yinbing','juedi',\r\n\t\t\t\t\t\t'bushi','xinfu_dianhua','xinfu_falu','xinfu_zhenyi','lskuizhu','pingjian','xjshijian','fentian','zhiri','xindan',\r\n\t\t\t\t\t\t'xinzhengnan','xinfu_xiaode',\r\n\t\t\t\t\t\t'komari_xueshang','qiaosi_map',\r\n\t\t\t\t\t];\r\n\t\t\t\t\tvar characters=[];\r\n\t\t\t\t\tfor(var name in lib.character){\r\n\t\t\t\t\t\tif(!lib.character[name]) continue;\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(name)) continue;\r\n\t\t\t\t\t\tif(name.indexOf('old_')==0) continue;\r\n\t\t\t\t\t\tvar skillsx=lib.character[name][3].slice(0);\r\n\t\t\t\t\t\tlib.character[name][2]=4;\r\n\t\t\t\t\t\tlib.character[name][3]=[];\r\n\t\t\t\t\t\tif(lib.character[name][4]) lib.character[name][4].remove('hiddenSkill');\r\n\t\t\t\t\t\tcharacters.push(name);\r\n\t\t\t\t\t\tvar list=skillsx.slice(0);\r\n\t\t\t\t\t\tfor(var j=0;j<skillsx.length;j++){\r\n\t\t\t\t\t\t\tvar info=get.info(skillsx[j]);\r\n\t\t\t\t\t\t\tif(!info){\r\n\t\t\t\t\t\t\t\tskillsx.splice(j,1);\r\n\t\t\t\t\t\t\t\tlist.splice(j--,1);\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(typeof info.derivation=='string') list.push(info.derivation);\r\n\t\t\t\t\t\t\telse if(Array.isArray(info.derivation)) list.addArray(info.derivation);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var j=0;j<list.length;j++){\r\n\t\t\t\t\t\t\tif(skills.contains(list[j])||banned.contains(list[j])) continue;\r\n\t\t\t\t\t\t\tvar info=get.info(list[j]);\r\n\t\t\t\t\t\t\tif(!info||info.zhuSkill||info.juexingji||info.charlotte||info.limited) continue;\r\n\t\t\t\t\t\t\tskills.push(list[j]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.characterlist=characters;\r\n\t\t\t\t\tvar pack={\r\n\t\t\t\t\t\tskills:skills,\r\n\t\t\t\t\t\tpack:{\r\n\t\t\t\t\t\t\tcard:{\r\n\t\t\t\t\t\t\t\thhzz_toulianghuanzhu:{\r\n\t\t\t\t\t\t\t\t\tenable:true,\r\n\t\t\t\t\t\t\t\t\tcardimage:\"toulianghuanzhu\",\r\n\t\t\t\t\t\t\t\t\tchongzhu:true,\r\n\t\t\t\t\t\t\t\t\ttype:'trick',\r\n\t\t\t\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\t\t\t\t\t\treturn target.skillH.length>0;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\ttarget.removeSkillH(target.skillH.randomGet());\r\n\t\t\t\t\t\t\t\t\t\tvar skills=lib.huanhuazhizhan.skills;\r\n\t\t\t\t\t\t\t\t\t\tskills.randomSort();\r\n\t\t\t\t\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\t\t\t\t\tif(!target.skillH.contains(skills[i])){\r\n\t\t\t\t\t\t\t\t\t\t\t\ttarget.addSkillH(skills[i]);\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\t\t\t\torder:10,\r\n\t\t\t\t\t\t\t\t\t\tresult:{\r\n\t\t\t\t\t\t\t\t\t\t\ttarget:function(){\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn 0.5-Math.random();\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\thhzz_fudichouxin:{\r\n\t\t\t\t\t\t\t\t\tenable:true,\r\n\t\t\t\t\t\t\t\t\tcardimage:\"fudichouxin\",\r\n\t\t\t\t\t\t\t\t\ttype:'trick',\r\n\t\t\t\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\t\t\t\t\t\treturn target.skillH.length>0;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\ttarget.removeSkillH(target.skillH.randomGet());\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\t\t\t\torder:10,\r\n\t\t\t\t\t\t\t\t\t\tresult:{target:-1},\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcharacter:{\r\n\t\t\t\t\t\t\t\thhzz_shiona:['female','key',1,['hhzz_huilei']],\r\n\t\t\t\t\t\t\t\thhzz_kanade:['female','key',2,['hhzz_youlian']],\r\n\t\t\t\t\t\t\t\thhzz_takaramono1:['male','qun',5,['hhzz_jubao','hhzz_huizhen']],\r\n\t\t\t\t\t\t\t\thhzz_takaramono2:['male','qun',3,['hhzz_jubao','hhzz_zhencang']],\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tskill:{\r\n\t\t\t\t\t\t\t\t_lingli_damage:{\r\n\t\t\t\t\t\t\t\t\ttrigger:{source:'damage'},\r\n\t\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn event.player==player._toKill;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\tgame.log(player,'对击杀目标造成了伤害');\r\n\t\t\t\t\t\t\t\t\t\tplayer.changeLingli(trigger.num);\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t_lingli:{\r\n\t\t\t\t\t\t\t\t mark:true,\r\n\t\t\t\t\t\t\t\t marktext:'灵',\r\n\t\t\t\t\t\t\t\t popup:'聚灵',\r\n\t\t\t\t\t\t\t\t intro:{\r\n\t\t\t\t\t\t\t\t \tname:'灵力',\r\n\t\t\t\t\t\t\t\t \tcontent:'当前灵力点数：# / 5',\r\n\t\t\t\t\t\t\t\t },\r\n\t\t\t\t\t\t\t\t trigger:{\r\n\t\t\t\t\t\t\t\t \tplayer:'phaseBeginStart',\r\n\t\t\t\t\t\t\t\t },\r\n\t\t\t\t\t\t\t\t prompt:'是否消耗2点灵力获得一个技能？',\r\n\t\t\t\t\t\t\t\t filter:function(event,player){\r\n\t\t\t\t\t\t\t\t \treturn player.$._lingli>1;\r\n\t\t\t\t\t\t\t\t },\r\n\t\t\t\t\t\t\t\t check:function(event,player){\r\n\t\t\t\t\t\t\t\t \treturn player.skillH.length<3;\r\n\t\t\t\t\t\t\t\t },\r\n\t\t\t\t\t\t\t\t content:function(){\r\n\t\t\t\t\t\t\t\t \t'step 0'\r\n\t\t\t\t\t\t\t\t \tplayer.changeLingli(-2);\r\n\t\t\t\t\t\t\t\t \t'step 1'\r\n\t\t\t\t\t\t\t\t \tevent.skills=lib.huanhuazhizhan.skills;\r\n\t\t\t\t\t\t\t\t \tvar skills=event.skills;\r\n\t\t\t\t\t\t\t\t \tskills.randomSort();\r\n\t\t\t\t\t\t\t\t \tvar list=[];\r\n\t\t\t\t\t\t\t\t \tfor(var i=0;i<skills[i].length;i++){\r\n\t\t\t\t\t\t\t\t \t\tif(!player.skillH.contains(skills[i])) list.push(skills[i]);\r\n\t\t\t\t\t\t\t\t \t\tif(list.length==3) break;\r\n\t\t\t\t\t\t\t\t \t}\r\n\t\t\t\t\t\t\t\t \tif(!list.length){event.finish();return;}\r\n\t\t\t\t\t\t\t\t \tif(player.$._lingli>0)\tlist.push('刷新');\r\n\t\t\t\t\t\t\t\t \tevent.list=list;\r\n\t\t\t\t\t\t\t\t \tvar dialog=game.getSkillDialog(event.list,'选择获得一个技能');\r\n\t\t\t\t\t\t\t\t \tplayer.chooseControl(event.list).set('ai',function(){\r\n\t\t\t\t\t\t\t\t \t\treturn 0;\r\n\t\t\t\t\t\t\t\t \t}).dialog=dialog;\r\n\t\t\t\t\t\t\t\t \t'step 2'\r\n\t\t\t\t\t\t\t \t\tif(result.control=='刷新'){\r\n\t\t\t\t\t\t\t \t\t\tplayer.changeLingli(-1);\r\n\t\t\t\t\t\t\t \t\t\tevent.goto(1);\r\n\t\t\t\t\t\t\t \t\t\treturn;\r\n\t\t\t\t\t\t\t \t\t}\r\n\t\t\t\t\t\t\t \t\tevent.skill=result.control;\r\n\t\t\t\t\t\t\t \t\tif(player.skillH.length==3){\r\n\t\t\t\t\t\t\t\t\t \tevent.lose=true;\r\n\t\t\t\t\t\t\t\t\t\t\tplayer.chooseControl(player.skillH).prompt='选择失去1个已有技能';\r\n\t\t\t\t\t\t\t \t\t}\r\n\t\t\t\t\t\t\t\t \t'step 3'\r\n\t\t\t\t\t\t\t\t \tif(event.lose) player.removeSkillH(result.control);\r\n\t\t\t\t\t\t\t\t \tplayer.addSkillH(event.skill);\r\n\t\t\t\t\t\t\t\t },\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t_lingli_round:{\r\n\t\t\t\t\t\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn _status._aozhan!=true&&game.roundNumber>1;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\tplayer.changeLingli(1);\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t_lingli_draw:{\r\n\t\t\t\t\t\t\t\t\tenable:'phaseUse',\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn player.$._lingli>0;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\tplayer.changeLingli(-1);\r\n\t\t\t\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tdelay:0,\r\n\t\t\t\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\t\t\t\torder:10,\r\n\t\t\t\t\t\t\t\t\t\tresult:{\r\n\t\t\t\t\t\t\t\t\t\t\tplayer:function(player){\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (player.$._lingli-2*(3-player.skillH.length))>0?1:0;\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t_lingli_save:{\r\n\t\t\t\t\t\t\t\t\ttrigger:{target:'useCardToTargeted'},\r\n\t\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn event.card.name=='tao'&&player==event.player._toSave;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\tgame.log(trigger.player,'帮助了保护目标');\r\n\t\t\t\t\t\t\t\t\t\ttrigger.player.changeLingli(1);\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t_hhzz_qiankunbagua:{\r\n\t\t\t\t\t\t\t\t\ttrigger:{player:'phaseAfter'},\r\n\t\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\t\tforceDie:true,\r\n\t\t\t\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn _status._aozhan&&!player.getStat('damage')&&player.isAlive()||event._lastDead!=undefined;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\t\t\t\tif(_status._aozhan&&!player.getStat('damage')){\r\n\t\t\t\t\t\t\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t\t\t\t\t\t\t\tplayer.changeLingli(1);\r\n\t\t\t\t\t\t\t\t\t\t\tgame.log(player,'本回合内未造成伤害，触发死战模式惩罚');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif(trigger._lastDead==undefined) event.goto(2);\r\n\t\t\t\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\t\t\t\tvar type=get.rand(1,8);\r\n\t\t\t\t\t\t\t\t\t\tevent.type=type;\r\n\t\t\t\t\t\t\t\t\t\ttrigger._lastDead.playerfocus(1200);\r\n\t\t\t\t\t\t\t\t\t\tplayer.$fullscreenpop('乾坤八卦·'+['离','坎','乾','震','兑','艮','巽','坤'][type-1],get.groupnature(trigger._lastDead.group,'raw'));\r\n\t\t\t\t\t\t\t\t\t\tgame.delay(1.5);\r\n\t\t\t\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\t\t\t\tvar type=event.type;\r\n\t\t\t\t\t\t\t\t\t\tswitch(type){\r\n\t\t\t\t\t\t\t\t\t\t\tcase 1:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcurrent.loseHp();\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tcase 2:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcurrent.draw(2,'nodelay');\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tcase 3:{\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrigger._lastDead.revive(3);\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrigger._lastDead.draw(3);\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tcase 4:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar he=current.getCards('he');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(he.length) current.discard(he.randomGet()).delay=false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tcase 5:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcurrent.changeLingli(1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tcase 6:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar cards=[];\r\n\t\t\t\t\t\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn !cards.contains(card)&&get.type(card)=='equip';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(card){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcards.push(card);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurrent.$gain(card,'gain2')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurrent.gain(card);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tcase 7:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(current.skillH.length<3){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar skills=lib.huanhuazhizhan.skills;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tskills.randomSort();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!current.skillH.contains(skills[i])){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurrent.addSkillH(skills[i]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tcase 8:{\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrigger._lastDead.revive(null,false);\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrigger._lastDead.uninit();\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrigger._lastDead.init(['hhzz_shiona','hhzz_kanade','hhzz_takaramono1','hhzz_takaramono2'].randomGet());\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrigger._lastDead.skillH=lib.character[trigger._lastDead.name][3].slice(0);\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrigger._lastDead.addSkill('hhzz_noCard');\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t'step 3'\r\n\t\t\t\t\t\t\t\t\t\tif(game.playerx().length<=4&&!_status._aozhan){\r\n\t\t\t\t\t\t\t\t\t\t\tgame.countPlayer2(function(current){\r\n\t\t\t\t\t\t\t\t\t\t\t\tdelete current._toKill;\r\n\t\t\t\t\t\t\t\t\t\t\t\tdelete current._toSave;\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tui.huanhuazhizhan.innerHTML='死战模式';\r\n\t\t\t\t\t\t\t\t\t\t\t_status._aozhan=true;\r\n\t\t\t\t\t\t\t\t\t\t\tgame.playBackgroundMusic();\r\n\t\t\t\t\t\t\t\t\t\t\ttrigger._lastDead.$fullscreenpop('死战模式',get.groupnature(trigger._lastDead.group,'raw')||'fire');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse game.randomMission();\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\thhzz_noCard:{\r\n\t\t\t\t\t\t\t\t\tmod:{\r\n\t\t\t\t\t\t\t\t\t\tcardEnabled:function(){return false},\r\n\t\t\t\t\t\t\t\t\t\tcardSavable:function(){return false},\r\n\t\t\t\t\t\t\t\t\t\tcardRespondable:function(){return false},\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\thhzz_huilei:{\r\n\t\t\t\t\t\t\t\t\ttrigger:{player:'die'},\r\n\t\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\t\tforceDie:true,\r\n\t\t\t\t\t\t\t\t\tskillAnimation:true,\r\n\t\t\t\t\t\t\t\t\tlogTarget:'source',\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn event.source!=undefined;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\tvar source=trigger.source;\r\n\t\t\t\t\t\t\t\t\t\tvar cards=source.getCards('he');\r\n\t\t\t\t\t\t\t\t\t\tif(cards.length) source.discard(cards);\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\t\t\t\teffect:{\r\n\t\t\t\t\t\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(get.tag(card,'damage')) return [-5,0];\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\thhzz_youlian:{\r\n\t\t\t\t\t\t\t\t\ttrigger:{player:'die'},\r\n\t\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\t\tforceDie:true,\r\n\t\t\t\t\t\t\t\t\tskillAnimation:true,\r\n\t\t\t\t\t\t\t\t\tlogTarget:'source',\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn event.source!=undefined;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\tvar source=trigger.source;\r\n\t\t\t\t\t\t\t\t\t\tvar cards=source.getCards('he');\r\n\t\t\t\t\t\t\t\t\t\tif(cards.length) source.discard(cards);\r\n\t\t\t\t\t\t\t\t\t\tvar skills=source.skillH;\r\n\t\t\t\t\t\t\t\t\t\tif(skills.length) source.removeSkillH(skills.randomGet());\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\t\t\t\teffect:{\r\n\t\t\t\t\t\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(get.tag(card,'damage')) return [-5,0];\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\thhzz_zhencang:{\r\n\t\t\t\t\t\t\t\t\ttrigger:{player:'die'},\r\n\t\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn event.source!=undefined;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tforceDie:true,\r\n\t\t\t\t\t\t\t\t\tlogTarget:'source',\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\tvar source=trigger.source;\r\n\t\t\t\t\t\t\t\t\t\tsource.draw();\r\n\t\t\t\t\t\t\t\t\t\tif(source.skillH.length==3) source.removeSkillH(source.skillH.randomGet());\r\n\t\t\t\t\t\t\t\t\t\tvar skills=lib.huanhuazhizhan.skills;\r\n\t\t\t\t\t\t\t\t\t\tskills.randomSort();\r\n\t\t\t\t\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\t\t\t\t\tif(!source.skillH.contains(skills[i])){\r\n\t\t\t\t\t\t\t\t\t\t\t\tsource.addSkillH(skills[i]);\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\thhzz_huizhen:{\r\n\t\t\t\t\t\t\t\t\ttrigger:{player:'die'},\r\n\t\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\t\tforceDie:true,\r\n\t\t\t\t\t\t\t\t\tlogTarget:'source',\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn event.source!=undefined;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\tvar source=trigger.source;\r\n\t\t\t\t\t\t\t\t\t\tsource.draw(3);\r\n\t\t\t\t\t\t\t\t\t\tif(source.skillH.length==3) source.removeSkillH(source.skillH.randomGet());\r\n\t\t\t\t\t\t\t\t\t\tvar skills=lib.huanhuazhizhan.skills;\r\n\t\t\t\t\t\t\t\t\t\tskills.randomSort();\r\n\t\t\t\t\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\t\t\t\t\tif(!source.skillH.contains(skills[i])){\r\n\t\t\t\t\t\t\t\t\t\t\t\tsource.addSkillH(skills[i]);\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\thhzz_jubao:{\r\n\t\t\t\t\t\t\t\t\ttrigger:{player:'damage'},\r\n\t\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\t\tlogTarget:'source',\r\n\t\t\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\t\t\treturn event.source!=undefined&&player.countCards('he')>0;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\t\tvar cards=player.getCards('he');\r\n\t\t\t\t\t\t\t\t\t\tcards.randomSort();\r\n\t\t\t\t\t\t\t\t\t\tcards=cards.slice(0,trigger.num);\r\n\t\t\t\t\t\t\t\t\t\ttrigger.source.gain('give',cards,player);\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\t\t\t\teffect:{\r\n\t\t\t\t\t\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(get.tag(card,'damage')) return [15,0];\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ttranslate:{\r\n\t\t\t\t\t\t\t\t_lingli:'聚灵',\r\n\t\t\t\t\t\t\t\t_lingli_bg:'灵',\r\n\t\t\t\t\t\t\t\t_lingli_draw:'聚灵',\r\n\t\t\t\t\t\t\t\thhzz_huilei:'挥泪',\r\n\t\t\t\t\t\t\t\thhzz_youlian:'犹怜',\r\n\t\t\t\t\t\t\t\thhzz_zhencang:'珍藏',\r\n\t\t\t\t\t\t\t\thhzz_huizhen:'汇珍',\r\n\t\t\t\t\t\t\t\thhzz_jubao:'聚宝',\r\n\t\t\t\t\t\t\t\thhzz_huilei_info:'锁定技，杀死你的角色弃置所有的牌。',\r\n\t\t\t\t\t\t\t\thhzz_youlian_info:'锁定技，杀死你的角色弃置所有牌并随机失去一个技能。',\r\n\t\t\t\t\t\t\t\thhzz_zhencang_info:'锁定技，杀死你的角色摸一张牌并随机获得一个技能(已满则先随机移除一个)。',\r\n\t\t\t\t\t\t\t\thhzz_huizhen_info:'锁定技，杀死你的角色摸三张牌并随机获得一个技能(已满则先随机移除一个)。',\r\n\t\t\t\t\t\t\t\thhzz_jubao_info:'锁定技，当你受到伤害的点数确定时，伤害来源随机获得你区域内的X张牌（X为伤害点数）。',\r\n\t\t\t\t\t\t\t\thhzz_shiona:'汐奈',\r\n\t\t\t\t\t\t\t\thhzz_kanade:'立华奏',\r\n\t\t\t\t\t\t\t\thhzz_takaramono1:'坚实宝箱',\r\n\t\t\t\t\t\t\t\thhzz_takaramono2:'普通宝箱',\r\n\t\t\t\t\t\t\t\thhzz_toulianghuanzhu:'偷梁换柱',\r\n\t\t\t\t\t\t\t\thhzz_fudichouxin:'釜底抽薪',\r\n\t\t\t\t\t\t\t\thhzz_toulianghuanzhu_info:'出牌阶段，对一名角色使用，随机更换其一个技能。可重铸。',\r\n\t\t\t\t\t\t\t\thhzz_fudichouxin_info:'出牌阶段，对一名角色使用，随机弃置其一个技能。',\r\n\t\t\t\t\t\t\t\tnei:' ',\r\n\t\t\t\t\t\t\t\tnei2:' ',\r\n\t\t\t\t\t\t\t\t刷新_info:'消耗1点灵力值，刷新上述技能',\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tget:{\r\n\t\t\t\t\t\t\trawAttitude:function(from,to){\r\n\t\t\t\t\t\t\t\tif(from==to||to==from._toSave) return 10;\r\n\t\t\t\t\t\t\t\tif(to==from._toKill) return -30;\r\n\t\t\t\t\t\t\t\treturn -10;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\teltc:{\r\n\t\t\t\t\t\t\tgameDraw:function(){\r\n\t\t\t\t\t\t\t\tvar end=player;\r\n\t\t\t\t\t\t\t\tvar numx;\r\n\t\t\t\t\t\t\t\tvar num=function(player){\r\n\t\t\t\t\t\t\t\t\treturn player._hSeat>5?5:4;\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tdo{\r\n\t\t\t\t\t\t\t\t\tif(typeof num=='function'){\r\n\t\t\t\t\t\t\t\t\t\tnumx=num(player);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif(player._hSeat>6) player.changeLingli(1);\r\n\t\t\t\t\t\t\t\t\tplayer.directgain(get.cards(numx));\r\n\t\t\t\t\t\t\t\t\tplayer=player.next;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\twhile(player!=end);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\teltp:{\r\n\t\t\t\t\t\t\taddSkillH:function(skill){\r\n\t\t\t\t\t\t\t\tthis.skillH.add(skill);\r\n\t\t\t\t\t\t\t\tthis.addSkillLog.apply(this,arguments);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tremoveSkillH:function(skill){\r\n\t\t\t\t\t\t\t\tthis.skillH.remove(skill);\r\n\t\t\t\t\t\t\t\tgame.log(this,'失去了技能','#g【'+get.translation(skill)+'】');\r\n\t\t\t\t\t\t\t\tthis.removeSkill(skill);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tdieAfter:function(){\r\n\t\t\t\t\t\t\t\tvar evt=_status.event.getParent('phase');\r\n\t\t\t\t\t\t\t\tif(evt) evt._lastDead=this;\r\n\t\t\t\t\t\t\t\tif(game.playerx().length==1) game.over(game.me.isAlive());\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t$dieAfter:function(){},\r\n\t\t\t\t\t\t\thasUnknown:function(){return false},\r\n\t\t\t\t\t\t\tisUnknown:function(){return false},\r\n\t\t\t\t\t\t\tgetEnemies:function(){\r\n\t\t\t\t\t\t\t\tvar list=game.playerx();\r\n\t\t\t\t\t\t\t\tlist.remove(this);\r\n\t\t\t\t\t\t\t\treturn list;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tdieAfter2:function(source){\r\n\t\t\t\t\t\t\t\tif(source&&this.name.indexOf('hhzz_')!=0){\r\n\t\t\t\t\t\t\t\t\tif(source._toKill==this) game.log(source,'击杀目标成功');\r\n\t\t\t\t\t\t\t\t\tsource.draw(this==source._toKill?2:1);\r\n\t\t\t\t\t\t\t\t\tsource.changeLingli(this==source._toKill?3:2);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(!_status._aozhan){\r\n\t\t\t\t\t\t\t\t\tvar that=this;\r\n\t\t\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\t\tif(current._toSave==that){\r\n\t\t\t\t\t\t\t\t\t\t\tgame.log(current,'保护失败');\r\n\t\t\t\t\t\t\t\t\t\t\tvar cards=current.getCards('he');\r\n\t\t\t\t\t\t\t\t\t\t\tif(cards.length) current.discard(cards.randomGets(4));\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tlogAi:function(){},\r\n\t\t\t\t\t\t\thasZhuSkill:function(){return false},\r\n\t\t\t\t\t\t\tchangeLingli:function(num){\r\n\t\t\t\t\t\t\t\tif(typeof num!='number') num=1;\r\n\t\t\t\t\t\t\t\tif(typeof this.$._lingli!='number') this.$._lingli=0;\r\n\t\t\t\t\t\t\t\tif(num>0){\r\n\t\t\t\t\t\t\t\t\tnum=Math.min(num,5-this.$._lingli);\r\n\t\t\t\t\t\t\t\t\tif(num<1) return;\r\n\t\t\t\t\t\t\t\t\tgame.log(this,'获得了','#y'+get.cnNumber(num)+'点','灵力');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tif(-num>this.$._lingli) num=-this.$._lingli;\r\n\t\t\t\t\t\t\t\t\tif(num==0) return;\r\n\t\t\t\t\t\t\t\t\tgame.log(this,'失去了','#y'+get.cnNumber(-num)+'点','灵力');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.$._lingli+=num;\r\n\t\t\t\t\t\t\t\tthis.markSkill('_lingli');\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tgame:{\r\n\t\t\t\t\t\t\tplayerx:function(){\r\n\t\t\t\t\t\t\t\treturn game.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\tif(current.name.indexOf('hhzz_')==0) return;\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\trandomMission:function(){\r\n\t\t\t\t\t\t\t\tif(_status._aozhan) return;\r\n\t\t\t\t\t\t\t\tif(!ui.huanhuazhizhan){\r\n\t\t\t\t\t\t\t\t\tui.huanhuazhizhan=ui.create.div('.touchinfo.left',ui.window);\r\n\t\t\t\t\t\t\t\t\tif(ui.time3) ui.time3.style.display='none';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar players=game.playerx();\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\t\t\tvar player=players[i];\r\n\t\t\t\t\t\t\t\t\tvar list=players.slice(0).randomSort();\r\n\t\t\t\t\t\t\t\t\tlist.remove(player);\r\n\t\t\t\t\t\t\t\t\tplayer._toKill=list[0];\r\n\t\t\t\t\t\t\t\t\tplayer._toSave=list[1];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tui.huanhuazhizhan.innerHTML='击杀'+get.translation(game.me._toKill)+'，保护'+get.translation(game.me._toSave);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tgetSkillDialog:function(skills,prompt){\r\n\t\t\t\t\t\t\t\tvar dialog=ui.create.dialog('hidden','forcebutton');\r\n\t\t\t\t\t\t\t\tif(prompt) dialog.addText(prompt);\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\t\t\tdialog.add('<div class=\"popup pointerdiv\" style=\"width:80%;display:inline-block\"><div class=\"skill\">'+get.translation(skills[i])+'</div><div>'+lib.translate[skills[i]+'_info']+'</div></div>');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tdialog.addText(' <br> ');\r\n\t\t\t\t\t\t\t\treturn dialog;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tchooseCharacter:function(){\r\n\t\t\t\t\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\t\t\t\t\tnext.showConfig=true;\r\n\t\t\t\t\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\t\t\tgame.zhu=game.players.randomGet();\r\n\t\t\t\t\t\t\t\t\tvar i=1;\r\n\t\t\t\t\t\t\t\t\tvar current=game.zhu;\r\n\t\t\t\t\t\t\t\t\twhile(true){\r\n\t\t\t\t\t\t\t\t\t\tcurrent.skillH=[];\r\n\t\t\t\t\t\t\t\t\t\tcurrent._hSeat=i;\r\n\t\t\t\t\t\t\t\t\t\tcurrent.identity='nei';\r\n\t\t\t\t\t\t\t\t\t\tcurrent.setNickname(get.cnNumber(i,true)+'号位');\r\n\t\t\t\t\t\t\t\t\t\tfor(var ii in lib.huanhuazhizhan.eltp) current[ii]=lib.huanhuazhizhan.eltp[ii];\r\n\t\t\t\t\t\t\t\t\t\tcurrent=current.next;\r\n\t\t\t\t\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t\t\t\t\tif(current==game.zhu) break;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t\t\t\t\tgame.me.chooseButton(['请选择角色形象',[_status.characterlist.randomRemove(5),'character']],true).onfree=true;\r\n\t\t\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\t\t\t\t\tvar list=['xiandeng','shulv','xisheng'];\r\n\t\t\t\t\t\t\t\t\tgame.me.chooseControl(list).dialog=game.getSkillDialog(list,'选择要获得的初始技能');\r\n\t\t\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\t\t\tvar list=['_lingli','_lingli_round','_lingli_draw','_lingli_save','_hhzz_qiankunbagua','_lingli_damage'];\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\t\tgame.addGlobalSkill(list[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tgame.me.addSkillH(result.control);\r\n\t\t\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\t\tif(!current.name){\r\n\t\t\t\t\t\t\t\t\t\t\tcurrent.init(_status.characterlist.randomRemove(1)[0]);\r\n\t\t\t\t\t\t\t\t\t\t\tcurrent.addSkillH(['xiandeng','shulv','xisheng'].randomGet());\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tcurrent.$._lingli=0;\r\n\t\t\t\t\t\t\t\t\t\tcurrent.markSkill('_lingli');\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tgame.showIdentity(true);\r\n\t\t\t\t\t\t\t\t\t'step 3'\r\n\t\t\t\t\t\t\t\t\tgame.randomMission();\r\n\t\t\t\t\t\t\t\t\tvar list=[\r\n\t\t\t\t\t\t\t\t\t\tgame.createCard('hhzz_fudichouxin'),\r\n\t\t\t\t\t\t\t\t\t\tgame.createCard('hhzz_toulianghuanzhu'),\r\n\t\t\t\t\t\t\t\t\t\tgame.createCard('hhzz_toulianghuanzhu'),\r\n\t\t\t\t\t\t\t\t\t\tgame.createCard('hhzz_toulianghuanzhu'),\r\n\t\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\t\tui.cardPile.insertBefore(list[i],ui.cardPile.childNodes[get.rand(ui.cardPile.childElementCount)]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tgame.updateRoundNumber();\r\n\t\t\t\t\t\t\t\t\t'step 4'\r\n\t\t\t\t\t\t\t\t\tsetTimeout(function(){\t\r\n\t\t\t\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t\t\t\t_status.videoInited=true;\r\n\t\t\t\t\t\t\t\t\tgame.addVideo('arrangeLib',null,{\r\n\t\t\t\t\t\t\t\t\t\tskill:{\r\n\t\t\t\t\t\t\t\t\t\t\t_lingli_damage:{},\r\n\t\t\t\t\t\t\t\t\t\t\t_lingli:{\r\n\t\t\t\t\t\t\t\t\t\t\t mark:true,\r\n\t\t\t\t\t\t\t\t\t\t\t marktext:'灵',\r\n\t\t\t\t\t\t\t\t\t\t\t popup:'聚灵',\r\n\t\t\t\t\t\t\t\t\t\t\t intro:{\r\n\t\t\t\t\t\t\t\t\t\t\t\t name:'灵力',\r\n\t\t\t\t\t\t\t\t\t\t\t\t content:'当前灵力点数：# / 5',\r\n\t\t\t\t\t\t\t\t\t\t\t },\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t_lingli_round:{},\r\n\t\t\t\t\t\t\t\t\t\t\t_lingli_draw:{},\r\n\t\t\t\t\t\t\t\t\t\t\t_lingli_save:{},\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_noCard:{},\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_huilei:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tskillAnimation:true,\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_youlian:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tskillAnimation:true,\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_zhencang:{},\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_huizhen:{},\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_jubao:{},\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tcard:{\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_toulianghuanzhu:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tcardimage:\"toulianghuanzhu\",\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_fudichouxin:{\r\n\t\t\t\t\t\t\t\t\t\t\t\tcardimage:\"fudichouxin\",\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tcharacter:{\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_shiona:['female','key',1,['hhzz_huilei']],\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_kanade:['female','key',2,['hhzz_youlian']],\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_takaramono1:['male','qun',5,['hhzz_jubao','hhzz_huizhen']],\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_takaramono2:['male','qun',3,['hhzz_jubao','hhzz_zhencang']],\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\ttranslate:{\r\n\t\t\t\t\t\t\t\t\t\t\t_lingli:'聚灵',\r\n\t\t\t\t\t\t\t\t\t\t\t_lingli_bg:'灵',\r\n\t\t\t\t\t\t\t\t\t\t\t_lingli_draw:'聚灵',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_huilei:'挥泪',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_youlian:'犹怜',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_zhencang:'珍藏',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_huizhen:'汇珍',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_jubao:'聚宝',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_huilei_info:'锁定技，杀死你的角色弃置所有的牌。',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_youlian_info:'锁定技，杀死你的角色弃置所有牌并随机失去一个技能。',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_zhencang_info:'锁定技，杀死你的角色摸一张牌并随机获得一个技能(已满则先随机移除一个)。',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_huizhen_info:'锁定技，杀死你的角色摸三张牌并随机获得一个技能(已满则先随机移除一个)。',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_jubao_info:'锁定技，当你受到伤害的点数确定时，伤害来源随机获得你区域内的X张牌（X为伤害点数）。',\r\n\t\t\t\t\t\t\t\t\t\t\tnei:' ',\r\n\t\t\t\t\t\t\t\t\t\t\tnei2:' ',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_shiona:'汐奈',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_kanade:'立华奏',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_takaramono1:'坚实宝箱',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_takaramono2:'普通宝箱',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_toulianghuanzhu:'偷梁换柱',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_fudichouxin:'釜底抽薪',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_toulianghuanzhu_info:'出牌阶段，对一名角色使用，随机更换其一个技能。可重铸。',\r\n\t\t\t\t\t\t\t\t\t\t\thhzz_fudichouxin_info:'出牌阶段，对一名角色使用，随机弃置其一个技能。',\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar func=function(pack){\r\n \t\t\t\t\tfor(var i in pack.pack){\r\n \t\t\t\t\t\tfor(var j in pack.pack[i]) lib[i][j]=pack.pack[i][j];\r\n \t\t\t\t\t}\r\n \t\t\t\t\tfor(var i in pack.eltc) lib.element.content[i]=pack.eltc[i];\r\n \t\t\t\t\tfor(var i in pack.eltp) lib.element.player[i]=pack.eltp[i];\r\n \t\t\t\t\tfor(var i in pack.game) game[i]=pack.game[i];\r\n \t\t\t\t\tfor(var i in pack.get) get[i]=pack.get[i];\r\n \t\t\t\t\tlib.huanhuazhizhan=pack;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfunc(pack);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tqunxionggeju:{\r\n\t\t\t\tname:'群雄割据',\r\n\t\t\t\tmode:'guozhan',\r\n\t\t\t\tintro:[\r\n\t\t\t\t\t'开放不同势力组合，以优先亮出的武将牌作为自己的势力，双势力武将则使用列表的第一个势力',\r\n\t\t\t\t],\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tvar node=this;\r\n\t\t\t\t\tvar list=[\r\n\t\t\t\t\t\t['re_Nekomasu','re_UruhaRushia'],\r\n\t\t\t\t\t\t['re_Kano','re_HonmaHimawari'],\r\n\t\t\t\t\t\t['re_HanamaruHareru','re_HisekiErio'],\r\n\t\t\t\t\t\t['re_DoumyoujiHaruto','SasakiSaku'],\r\n\t\t\t\t\t\t['LizeHelesta','InabaHaneru'],\r\n\t\t\t\t\t\t['Diana','re_KizunaAI'],\r\n\t\t\t\t\t\t['re_HoshimatiSuisei','re_SuzuharaLulu'],\r\n\t\t\t\t\t\t['re_YuNi','UshimiIchigo'],\r\n\t\t\t\t\t\t['KaguraMea','MinatoAqua'],\r\n\t\t\t\t\t];\r\n\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\tvar func=function(){\r\n\t\t\t\t\t\tvar card=ui.create.player(null,true);\r\n\t\t\t\t\t\tvar name=list.shift();\r\n\t\t\t\t\t\tcard.init(name[0],name[1]);\r\n\t\t\t\t\t\tcard.node.marks.remove();\r\n\t\t\t\t\t\tcard.node.count.remove();\r\n\t\t\t\t\t\tcard.node.hp.remove();\r\n\t\t\t\t\t\tcard.classList.remove('unseen');\r\n\t\t\t\t\t\tnode.nodes.push(card);\r\n\t\t\t\t\t\tcard.style.position='absolute';\r\n\t\t\t\t\t\tcard.style.zIndex=2;\r\n\t\t\t\t\t\tcard.style.transition='all 2s';\r\n\t\t\t\t\t\tvar rand1=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand2=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand3=Math.round(Math.random()*40)-20;\r\n\t\t\t\t\t\tcard.style.left='calc('+rand1+'% - '+(rand1*1.5)+'px)';\r\n\t\t\t\t\t\tcard.style.top='calc('+rand2+'% - '+(rand2*1.8)+'px)';\r\n\t\t\t\t\t\tcard.style.transform='scale(0.8) rotate('+rand3+'deg)';\r\n\t\t\t\t\t\tnode.appendChild(card);//[todo player]\r\n\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar list2=['feilongduofeng','taipingyaoshu','dinglanyemingzhu'];\r\n\t\t\t\t\tvar func2=function(){\r\n\t\t\t\t\t\tvar card=game.createCard(list2.shift(),'noclick');\r\n\t\t\t\t\t\tnode.nodes.push(card);\r\n\t\t\t\t\t\tcard.style.position='absolute';\r\n\t\t\t\t\t\tcard.style.zIndex=2;\r\n\t\t\t\t\t\tcard.style.transition='all 2s';\r\n\t\t\t\t\t\tvar rand1=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand2=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand3=Math.round(Math.random()*40)-20;\r\n\t\t\t\t\t\tcard.style.left='calc('+rand1+'% - '+rand1+'px)';\r\n\t\t\t\t\t\tcard.style.top='calc('+rand2+'% - '+rand2+'px)';\r\n\t\t\t\t\t\tcard.style.transform='rotate('+rand3+'deg)';\r\n\t\t\t\t\t\tnode.appendChild(card);\r\n\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tnode.nodes=[];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\twhile(node.nodes.length){\r\n\t\t\t\t\t\t\tnode.nodes.shift().remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<5;i++){\r\n\t\t\t\t\t\tfunc();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<3;i++){\r\n\t\t\t\t\t\tfunc2();\r\n\t\t\t\t\t\tfunc();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinit:function(){},\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tchooseCharacterBefore:function(){\r\n\t\t\t\t\t\tgame.chooseCharacter=function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.addPlayer=true;\r\n\t\t\t\tnext.ai=function(player,list,back){\r\n\t\t\t\t\tvar mainx=list[0];\r\n\t\t\t\t\tvar vicex=list[1];\r\n\t\t\t\t\tif(get.guozhanReverse(mainx,vicex)){\r\n\t\t\t\t\t\tmainx=list[1];\r\n\t\t\t\t\t\tvicex=list[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.init(mainx,vicex,false);\r\n\t\t\t\t\tif(back){\r\n\t\t\t\t\t\tlist.remove(player.name1);\r\n\t\t\t\t\t\tlist.remove(player.name2);\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tback.push(list[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar eltp={\r\n\t\t\t\t\t\tgetGuozhanGroup:function(num){\r\n\t\t\t\t\t\t\tif(num==1) return lib.character[this.name2][1];\r\n\t\t\t\t\t\t\treturn lib.character[this.name1][1];\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\twontYe:function(group){\r\n\t\t\t\t\t\t\tif(!group) group=lib.character[this.name1][1];\r\n\t\t\t\t\t\t\tif(_status.yeidentity&&_status.yeidentity.contains(group)) return false;\r\n\t\t\t\t\t\t\tif(get.zhu(this,null,true)) return true;\r\n\t\t\t\t\t\t\tvar num=3,total=get.population();\r\n\t\t\t\t\t\t\tif(total<6) num=1;\r\n\t\t\t\t\t\t\telse if(total<8) num=2;\r\n\t\t\t\t\t\t\treturn get.totalPopulation(group)+1<=num;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i of game.players){\r\n\t\t\t\t\t\tfor(var j in eltp) i[j]=eltp[j];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var j in eltp) lib.element.player[j]=eltp[j];\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar addSetting=function(dialog){\r\n\t\t\t\t\t\tdialog.add('选择座位').classList.add('add-setting');\r\n\t\t\t\t\t\tvar seats=document.createElement('table');\r\n\t\t\t\t\t\tseats.classList.add('add-setting');\r\n\t\t\t\t\t\tseats.style.margin='0';\r\n\t\t\t\t\t\tseats.style.width='100%';\r\n\t\t\t\t\t\tseats.style.position='relative';\r\n\t\t\t\t\t\tfor(var i=1;i<=game.players.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.innerHTML='<span>'+get.cnNumber(i,true)+'</span>';\r\n\t\t\t\t\t\t\ttd.link=i-1;\r\n\t\t\t\t\t\t\tseats.appendChild(td);\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.cheat_seat){\r\n\t\t\t\t\t\t\t\t\t_status.cheat_seat.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t\tif(_status.cheat_seat==this){\r\n\t\t\t\t\t\t\t\t\t\tdelete _status.cheat_seat;\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t_status.cheat_seat=this;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(seats);\r\n\t\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\t\tseats.previousSibling.style.display='none';\r\n\t\t\t\t\t\t\tseats.style.display='none';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tif(get.is.phoneLayout()) dialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar removeSetting=function(){\r\n\t\t\t\t\t\tvar dialog=_status.event.dialog;\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tdialog.style.height='';\r\n\t\t\t\t\t\t\tdelete dialog._scrollset;\r\n\t\t\t\t\t\t\tvar list=Array.from(dialog.querySelectorAll('.add-setting'));\r\n\t\t\t\t\t\t\twhile(list.length){\r\n\t\t\t\t\t\t\t\tlist.shift().remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.addSetting=addSetting;\r\n\t\t\t\t\tevent.removeSetting=removeSetting;\r\n\r\n\t\t\t\t\tvar chosen=lib.config.continue_name||[];\r\n\t\t\t\t\tgame.saveConfig('continue_name');\r\n\t\t\t\t\tevent.chosen=chosen;\r\n\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(i.indexOf('gz_shibing')==0) continue;\r\n\t\t\t\t\t\tif(chosen.contains(i)) continue;\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tif(get.config('onlyguozhan')){\r\n\t\t\t\t\t\t\tif(!lib.characterPack.mode_guozhan[i]) continue;\r\n\t\t\t\t\t\t\tif(get.is.jun(i)) continue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(lib.character[i][4].contains('hiddenSkill')) continue;\r\n\t\t\t\t\t\tif(lib.character[i][2]==3||lib.character[i][2]==4||lib.character[i][2]==5)\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\t_status.yeidentity=[];\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t// var list=event.list.splice(0,parseInt(get.config('choice_num')));\r\n\t\t\t\t\tvar list=event.list.randomRemove(parseInt(get.config('choice_num')));\r\n\t\t\t\t\tif(_status.auto){\r\n\t\t\t\t\t\tevent.ai(game.me,list);\r\n\t\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(chosen.length){\r\n\t\t\t\t\t\tgame.me.init(chosen[0],chosen[1],false);\r\n\t\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('选择角色','hidden',[list,'character']);\r\n\t\t\t\t\t\tif(get.config('change_identity')){\r\n\t\t\t\t\t\t\taddSetting(dialog);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar next=game.me.chooseButton(dialog,true,2).set('onfree',true);\r\n\t\t\t\t\t\tnext.filterButton=function(button){\r\n\t\t\t\t\t\t\tif(ui.dialog.buttons.length<=10){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<ui.dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(ui.dialog.buttons[i]!=button){\r\n\t\t\t\t\t\t\t\t\t\tif(lib.element.player.perfectPair.call({\r\n\t\t\t\t\t\t\t\t\t\t\tname1:button.link,name2:ui.dialog.buttons[i].link\r\n\t\t\t\t\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\t\t\t\t\tbutton.classList.add('glow2');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tnext.switchToAuto=function(){\r\n\t\t\t\t\t\t\tevent.ai(game.me,list);\r\n\t\t\t\t\t\t\tui.arena.classList.remove('selecting');\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar createCharacterDialog=function(){\r\n\t\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset',function(i){\r\n\t\t\t\t\t\t\t\tif(i.indexOf('gz_shibing')==0) return true;\r\n\t\t\t\t\t\t\t\tif(get.config('onlyguozhan')){\r\n\t\t\t\t\t\t\t\t\tif(!lib.characterPack.mode_guozhan[i]) return true;\r\n\t\t\t\t\t\t\t\t\tif(get.is.jun(i)) return true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},get.config('onlyguozhanexpand')?'expandall':undefined,get.config('onlyguozhan')?'onlypack:mode_guozhan':undefined);\r\n\t\t\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\t\tlib.onfree.push(createCharacterDialog);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tcreateCharacterDialog();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tui.create.cheat2=function(){\r\n\t\t\t\t\t\t\tui.cheat2=ui.create.control('自由选将',function(){\r\n\t\t\t\t\t\t\t\tif(this.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t\t_status.event.dialog=this.backup;\r\n\t\t\t\t\t\t\t\t\tthis.backup.open();\r\n\t\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis.backup=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t\t_status.event.dialog=_status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\t\tthis.dialog=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t\tthis.dialog.open();\r\n\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tui.create.cheat=function(){\r\n\t\t\t\t\t\t\t_status.createControl=ui.cheat2;\r\n\t\t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n\t\t\t\t\t\t\t\tif(ui.cheat2&&ui.cheat2.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tevent.list=event.list.concat(list);\r\n\t\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\t\t// list=event.list.splice(0,parseInt(get.config('choice_num')));\r\n\t\t\t\t\t\t\t\tlist=event.list.randomRemove(parseInt(get.config('choice_num')));\r\n\t\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list,'character',buttons);\r\n\t\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!ui.cheat&&get.config('change_choice'))\r\n\t\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\t\tif(!ui.cheat2&&get.config('free_choose'))\r\n\t\t\t\t\t\tui.create.cheat2();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(result.buttons){\r\n\t\t\t\t\t\tgame.me.init(result.buttons[0].link,result.buttons[1].link,false);\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link,result.buttons[1].link);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// game.me.setIdentity(game.me.group);\r\n\t\t\t\t\tevent.list.remove(game.me.name1);\r\n\t\t\t\t\tevent.list.remove(game.me.name2);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tevent.ai(game.players[i],event.list.randomRemove(parseInt(get.config('choice_num'))),event.list);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].classList.add('unseen');\r\n\t\t\t\t\t\tgame.players[i].classList.add('unseen2');\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='猜';\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.dataset.color='unknown';\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.classList.add('guessing');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hiddenSkills=lib.character[game.players[i].name1][3].slice(0);\r\n\t\t\t\t\t\tvar hiddenSkills2=lib.character[game.players[i].name2][3];\r\n\t\t\t\t\t\tfor(var j=0;j<hiddenSkills2.length;j++){\r\n\t\t\t\t\t\t\tgame.players[i].hiddenSkills.add(hiddenSkills2[j]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var j=0;j<game.players[i].hiddenSkills.length;j++){\r\n\t\t\t\t\t\t\tif(!lib.skill[game.players[i].hiddenSkills[j]]){\r\n\t\t\t\t\t\t\t\tgame.players[i].hiddenSkills.splice(j--,1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].group='unknown';\r\n\t\t\t\t\t\tgame.players[i].sex='unknown';\r\n\t\t\t\t\t\tgame.players[i].name1=game.players[i].name;\r\n\t\t\t\t\t\tgame.players[i].name='unknown';\r\n\t\t\t\t\t\tgame.players[i].identity='unknown';\r\n\t\t\t\t\t\tgame.players[i].node.name.show();\r\n\t\t\t\t\t\tgame.players[i].node.name2.show();\r\n\t\t\t\t\t\tgame.players[i]._group=lib.character[game.players[i].name1][1];\r\n\t\t\t\t\t\tfor(var j=0;j<game.players[i].hiddenSkills.length;j++){\r\n\t\t\t\t\t\t\tgame.players[i].addSkillTrigger(game.players[i].hiddenSkills[j],true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tduzhansanguo:{\r\n\t\t\t\tname:'毒战三国',\r\n\t\t\t\tmode:'identity',\r\n\t\t\t\tintro:'牌堆中额外添加10%的毒',\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tvar node=this;\r\n\t\t\t\t\tvar func=function(){\r\n\t\t\t\t\t\tvar card=game.createCard('du','noclick');\r\n\t\t\t\t\t\tnode.nodes.push(card);\r\n\t\t\t\t\t\tcard.style.position='absolute';\r\n\t\t\t\t\t\tvar rand1=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand2=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand3=Math.round(Math.random()*40)-20;\r\n\t\t\t\t\t\tcard.style.left='calc('+rand1+'% - '+rand1+'px)';\r\n\t\t\t\t\t\tcard.style.top='calc('+rand2+'% - '+rand2+'px)';\r\n\t\t\t\t\t\tcard.style.transform='scale(0.8) rotate('+rand3+'deg)';\r\n\t\t\t\t\t\tcard.style.opacity=0;\r\n\t\t\t\t\t\tnode.appendChild(card);\r\n\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\tcard.style.opacity=1;\r\n\t\t\t\t\t\tcard.style.transform='scale(1) rotate('+rand3+'deg)';\r\n\t\t\t\t\t\tif(node.nodes.length>7){\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\twhile(node.nodes.length>5){\r\n\t\t\t\t\t\t\t\t\tnode.nodes.shift().delete();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tnode.nodes=[];\r\n\t\t\t\t\t\tfor(var i=0;i<5;i++){\r\n\t\t\t\t\t\t\tfunc();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnode.showcaseinterval=setInterval(func,1000);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tcardPile:function(list){\r\n\t\t\t\t\t\tgame.identityVideoName='毒战三国杀';\r\n\t\t\t\t\t\tlib.config.bannedcards.remove('du');\r\n\t\t\t\t\t\tif(game.bannedcards) game.bannedcards.remove('du');\r\n\t\t\t\t\t\tvar num=Math.ceil(list.length/10);\r\n\t\t\t\t\t\twhile(num--){\r\n\t\t\t\t\t\t\tlist.push([['heart','diamond','club','spade'].randomGet(),Math.ceil(Math.random()*13),'du']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn list;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tdaoshiyueying:{\r\n\t\t\t\tname:'导师爱璃',\r\n\t\t\t\tmode:'identity',\r\n\t\t\t\tintro:'牌堆中所有普通锦囊牌数量翻倍；移除拥有集智技能的角色',\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tvar node=this;\r\n\t\t\t\t\tvar player1,player2;\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tplayer1=ui.create.player(null,true).init('AkiRinco');\r\n\t\t\t\t\t\tplayer2=ui.create.player(null,true);\r\n\t\t\t\t\t\tplayer2.init('NoiR');\r\n\t\t\t\t\t\t// if(lib.character.jsp_huangyueying){\r\n\t\t\t\t\t\t// \tplayer2.init('jsp_huangyueying');\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t// else if(lib.character.re_huangyueying){\r\n\t\t\t\t\t\t// \tplayer2.init('re_huangyueying');\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t// else{\r\n\t\t\t\t\t\t// \tplayer2.init('huangyueying');\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\tplayer1.style.left='20px';\r\n\t\t\t\t\t\tplayer1.style.top='20px';\r\n\t\t\t\t\t\tplayer1.style.transform='scale(0.9)';\r\n\t\t\t\t\t\tplayer1.node.count.innerHTML='2';\r\n\t\t\t\t\t\tplayer1.node.count.dataset.condition='mid';\r\n\t\t\t\t\t\tplayer2.style.left='auto';\r\n\t\t\t\t\t\tplayer2.style.right='20px';\r\n\t\t\t\t\t\tplayer2.style.top='20px';\r\n\t\t\t\t\t\tplayer2.style.transform='scale(0.9)';\r\n\t\t\t\t\t\tplayer2.node.count.innerHTML='2';\r\n\t\t\t\t\t\tplayer2.node.count.dataset.condition='mid';\r\n\t\t\t\t\t\tthis.appendChild(player1);//[todo player]\r\n\t\t\t\t\t\tthis.appendChild(player2);//[todo player]\r\n\t\t\t\t\t\tthis.player1=player1;\r\n\t\t\t\t\t\tthis.player2=player2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer1=this.player1;\r\n\t\t\t\t\t\tplayer2=this.player2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar rect1=player1.getBoundingClientRect();\r\n\t\t\t\t\tvar rect2=player2.getBoundingClientRect();\r\n\t\t\t\t\tvar left1=rect1.left+rect1.width/2-ui.arena.offsetLeft;\r\n\t\t\t\t\tvar left2=rect2.left+rect2.width/2-ui.arena.offsetLeft;\r\n\t\t\t\t\tvar top1=rect1.top+rect1.height/2-ui.arena.offsetTop;\r\n\t\t\t\t\tvar top2=rect2.top+rect2.height/2-ui.arena.offsetTop;\r\n\r\n\t\t\t\t\tvar createCard=function(wuxie){\r\n\t\t\t\t\t\tvar card;\r\n\t\t\t\t\t\tif(wuxie){\r\n\t\t\t\t\t\t\tcard=game.createCard('wuxie','noclick');\r\n\t\t\t\t\t\t\tcard.style.transform='scale(0.9)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tcard=ui.create.card(null,'noclick',true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcard.style.opacity=0;\r\n\t\t\t\t\t\tcard.style.position='absolute';\r\n\t\t\t\t\t\tcard.style.zIndex=2;\r\n\t\t\t\t\t\tcard.style.margin=0;\r\n\t\t\t\t\t\treturn card;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar func=function(){\r\n\t\t\t\t\t\tgame.linexy([left1,top1,left2,top2]);\r\n\t\t\t\t\t\tvar card=createCard(true);\r\n\t\t\t\t\t\tcard.style.left='43px';\r\n\t\t\t\t\t\tcard.style.top='58px';\r\n\t\t\t\t\t\tnode.appendChild(card);\r\n\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\tcard.style.opacity=1;\r\n\t\t\t\t\t\tcard.style.transform='scale(0.9) translate(137px,152px)';\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tcard.delete();\r\n\t\t\t\t\t\t},1000);\r\n\t\t\t\t\t\tplayer1.node.count.innerHTML='1';\r\n\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tif(!node.showcaseinterval) return;\r\n\t\t\t\t\t\t\tplayer1.node.count.innerHTML='2';\r\n\t\t\t\t\t\t\tvar card=createCard();\r\n\t\t\t\t\t\t\tcard.style.left='43px';\r\n\t\t\t\t\t\t\tcard.style.top='58px';\r\n\t\t\t\t\t\t\tcard.style.transform='scale(0.9) translate(137px,152px)';\r\n\t\t\t\t\t\t\tnode.appendChild(card);\r\n\t\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\t\tcard.style.opacity=1;\r\n\t\t\t\t\t\t\tcard.style.transform='scale(0.9)';\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\tcard.delete();\r\n\t\t\t\t\t\t\t},1000);\r\n\t\t\t\t\t\t},300);\r\n\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tif(!node.showcaseinterval) return;\r\n\t\t\t\t\t\t\tplayer2.node.count.innerHTML='1';\r\n\t\t\t\t\t\t\tgame.linexy([left2,top2,left1,top1]);\r\n\t\t\t\t\t\t\tvar card=createCard(true);\r\n\t\t\t\t\t\t\tcard.style.left='auto';\r\n\t\t\t\t\t\t\tcard.style.right='43px';\r\n\t\t\t\t\t\t\tcard.style.top='58px';\r\n\t\t\t\t\t\t\tnode.appendChild(card);\r\n\t\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\t\tcard.style.opacity=1;\r\n\t\t\t\t\t\t\tcard.style.transform='scale(0.9) translate(-137px,152px)';\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\tcard.delete();\r\n\t\t\t\t\t\t\t},700);\r\n\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\tif(!node.showcaseinterval) return;\r\n\t\t\t\t\t\t\t\tplayer2.node.count.innerHTML='2';\r\n\t\t\t\t\t\t\t\tvar card=createCard();\r\n\t\t\t\t\t\t\t\tcard.style.left='auto';\r\n\t\t\t\t\t\t\t\tcard.style.right='43px';\r\n\t\t\t\t\t\t\t\tcard.style.top='58px';\r\n\t\t\t\t\t\t\t\tcard.style.transform='scale(0.9) translate(-137px,152px)';\r\n\t\t\t\t\t\t\t\tnode.appendChild(card);\r\n\t\t\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\t\t\tcard.style.opacity=1;\r\n\t\t\t\t\t\t\t\tcard.style.transform='scale(0.9)';\r\n\t\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\tcard.delete();\r\n\t\t\t\t\t\t\t\t},700);\r\n\t\t\t\t\t\t\t},300);\r\n\t\t\t\t\t\t},1000);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnode.showcaseinterval=setInterval(func,2200);\r\n\t\t\t\t\tfunc();\r\n\t\t\t\t},\r\n\t\t\t\tinit:function(){\r\n\t\t\t\t\tfor(var i in lib.character){\r\n\t\t\t\t\t\tvar skills=lib.character[i][3]\r\n\t\t\t\t\t\tif(skills.contains('jizhi')||skills.contains('rejizhi')||skills.contains('lingzhou')||skills.contains('sbaiyin')){\r\n\t\t\t\t\t\t\tdelete lib.character[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tcardPile:function(list){\r\n\t\t\t\t\t\tgame.identityVideoName='导师爱璃';\r\n\t\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tlist2.push(list[i]);\r\n\t\t\t\t\t\t\tif(get.type(list[i][2])=='trick'){\r\n\t\t\t\t\t\t\t\tlist2.push(list[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn list2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tweiwoduzun:{\r\n\t\t\t\tname:'唯我独尊',\r\n\t\t\t\tmode:'identity',\r\n\t\t\t\tintro:[\r\n\t\t\t\t\t'牌堆中杀的数量增加30%',\r\n\t\t\t\t\t'游戏开始时，主公获得一枚战神标记',\r\n\t\t\t\t\t'拥有战神标记的角色杀造成的伤害+1',\r\n\t\t\t\t\t'受到杀造成的伤害后战神印记将移到伤害来源的武将牌上'\r\n\t\t\t\t],\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tvar node=this;\r\n\t\t\t\t\tvar player;\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tplayer=ui.create.player(null,true);\r\n\t\t\t\t\t\tplayer.node.avatar.style.backgroundSize='cover';\r\n\t\t\t\t\t\tplayer.node.avatar.setBackgroundImage('image/mode/boss/character/boss_lvbu2.jpg');\r\n\t\t\t\t\t\tplayer.node.avatar.show();\r\n\t\t\t\t\t\tplayer.style.left='calc(50% - 75px)';\r\n\t\t\t\t\t\tplayer.style.top='20px';\r\n\t\t\t\t\t\tplayer.node.count.remove();\r\n\t\t\t\t\t\tplayer.node.hp.remove();\r\n\t\t\t\t\t\tplayer.style.transition='all 0.5s';\r\n\t\t\t\t\t\tnode.appendChild(player);//[todo player]\r\n\t\t\t\t\t\tnode.playernode=player;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer=node.playernode;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar num=0;\r\n\t\t\t\t\tvar num2=0;\r\n\t\t\t\t\tthis.showcaseinterval=setInterval(function(){\r\n\t\t\t\t\t\tvar dx,dy\r\n\t\t\t\t\t\tif(num2%5==0){\r\n\t\t\t\t\t\t\t// player.animate('target');\r\n\t\t\t\t\t\t\t// player.animate('zoomin');\r\n\t\t\t\t\t\t\tplayer.classList.add('zoomin3');\r\n\t\t\t\t\t\t\tplayer.hide();\r\n\t\t\t\t\t\t\tplayer.style.transitionDuration='0.7s'\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\tplayer.style.transitionProperty='none';\r\n\t\t\t\t\t\t\t\tplayer.classList.remove('zoomin3');\r\n\t\t\t\t\t\t\t\tplayer.classList.add('zoomout2');\r\n\t\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\tplayer.style.transitionProperty='';\r\n\t\t\t\t\t\t\t\t\tplayer.classList.remove('zoomout2');\r\n\t\t\t\t\t\t\t\t\tplayer.show();\r\n\t\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t\t},700);\r\n\t\t\t\t\t\t\tfor(var i=0;i<5;i++){\r\n\t\t\t\t\t\t\t\tswitch(i){\r\n\t\t\t\t\t\t\t\t\tcase 0:dx=-180;dy=0;break;\r\n\t\t\t\t\t\t\t\t\tcase 1:dx=-140;dy=100;break;\r\n\t\t\t\t\t\t\t\t\tcase 2:dx=0;dy=155;break;\r\n\t\t\t\t\t\t\t\t\tcase 3:dx=140;dy=100;break;\r\n\t\t\t\t\t\t\t\t\tcase 4:dx=180;dy=0;break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar card=game.createCard('sha','noclick');\r\n\t\t\t\t\t\t\t\tcard.style.left='calc(50% - 52px)';\r\n\t\t\t\t\t\t\t\tcard.style.top='68px';\r\n\t\t\t\t\t\t\t\tcard.style.position='absolute';\r\n\t\t\t\t\t\t\t\tcard.style.margin=0;\r\n\t\t\t\t\t\t\t\tcard.style.zIndex=2;\r\n\t\t\t\t\t\t\t\tcard.style.opacity=0;\r\n\t\t\t\t\t\t\t\tnode.appendChild(card);\r\n\t\t\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\t\t\tcard.style.opacity=1;\r\n\t\t\t\t\t\t\t\tcard.style.transform='translate('+dx+'px,'+dy+'px)';\r\n\t\t\t\t\t\t\t\tsetTimeout((function(card){\r\n\t\t\t\t\t\t\t\t\treturn function(){\r\n\t\t\t\t\t\t\t\t\t\tcard.delete();\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t})(card),700);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnum2++;\r\n\t\t\t\t\t\tif(num>=5){\r\n\t\t\t\t\t\t\tnum=0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},700);\r\n\t\t\t\t},\r\n\t\t\t\tinit:function(){\r\n\t\t\t\t\tgame.identityVideoName='唯我独尊';\r\n\t\t\t\t\tlib.skill.weiwoduzun={\r\n\t\t\t\t\t\tmark:true,\r\n\t\t\t\t\t\tintro:{\r\n\t\t\t\t\t\t\tcontent:'杀造成的伤害+1'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tgroup:['weiwoduzun_damage','weiwoduzun_lose'],\r\n\t\t\t\t\t\tsubSkill:{\r\n\t\t\t\t\t\t\tdamage:{\r\n\t\t\t\t\t\t\t\ttrigger:{source:'damageBegin'},\r\n\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\tfilter:function(event){\r\n\t\t\t\t\t\t\t\t\treturn event.card&&event.card.name=='sha'&&event.notLink();\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tlose:{\r\n\t\t\t\t\t\t\t\ttrigger:{player:'damageEnd'},\r\n\t\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\t\tfilter:function(event){\r\n\t\t\t\t\t\t\t\t\treturn event.source&&event.source.isAlive();\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\tplayer.removeSkill('weiwoduzun');\r\n\t\t\t\t\t\t\t\t\ttrigger.source.addSkill('weiwoduzun');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlib.translate.weiwoduzun='战神';\r\n\t\t\t\t\tlib.translate.weiwoduzun_bg='尊';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tcardPile:function(list){\r\n\t\t\t\t\t\tvar num=0;\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tif(list[i][2]=='sha') num++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnum=Math.round(num*0.3);\r\n\t\t\t\t\t\tif(num<=0) return list;\r\n\t\t\t\t\t\twhile(num--){\r\n\t\t\t\t\t\t\tvar nature='';\r\n\t\t\t\t\t\t\tvar rand=Math.random();\r\n\t\t\t\t\t\t\tif(rand<0.15){\r\n\t\t\t\t\t\t\t\tnature='fire';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(rand<0.3){\r\n\t\t\t\t\t\t\t\tnature='thunder';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar suit=['heart','spade','club','diamond'].randomGet();\r\n\t\t\t\t\t\t\tvar number=Math.ceil(Math.random()*13);\r\n\t\t\t\t\t\t\tif(nature){\r\n\t\t\t\t\t\t\t\tlist.push([suit,number,'sha',nature]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tlist.push([suit,number,'sha']);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn list;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tgameStart:function(){\r\n\t\t\t\t\t\tif(_status.mode=='zhong'){\r\n\t\t\t\t\t\t\tgame.zhong.addSkill('weiwoduzun');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.zhu.addSkill('weiwoduzun');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttongxingzhizheng:{\r\n\t\t\t\tname:'同姓之争',\r\n\t\t\t\tmode:'versus',\r\n\t\t\t\tsubmode:'2v2',\r\n\t\t\t\tintro:'姓氏相同的武将组合一队',\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tvar node=this;\r\n\t\t\t\t\tvar getList=function(){\r\n\t\t\t\t\t\tvar list=[['re_MurasakiShion','ShikaiYue'],\r\n\t\t\t\t\t\t['Siro','XiaoxiXiaotao','XiaDi'],['ShizukuLulu','SuzuharaLulu'],\r\n\t\t\t\t\t\t['Ciyana','Civia'],['ShirayukiTomoe','ShirayukiMishiro'],\r\n\t\t\t\t\t\t['KaguraMea','KaguraNana']];\r\n\t\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tlist2=list2.concat(list[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnode.list=list2;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar func=function(){\r\n\t\t\t\t\t\tif(!node.list.length){\r\n\t\t\t\t\t\t\tgetList();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar card=ui.create.player(null,true);\r\n\t\t\t\t\t\tcard.init(node.list.shift());\r\n\t\t\t\t\t\tcard.node.marks.remove();\r\n\t\t\t\t\t\tcard.node.count.remove();\r\n\t\t\t\t\t\tcard.node.hp.remove();\r\n\t\t\t\t\t\tnode.nodes.push(card);\r\n\t\t\t\t\t\tcard.style.position='absolute';\r\n\t\t\t\t\t\tvar rand1=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand2=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand3=Math.round(Math.random()*40)-20;\r\n\t\t\t\t\t\tcard.style.left='calc('+rand1+'% - '+(rand1*1.5)+'px)';\r\n\t\t\t\t\t\tcard.style.top='calc('+rand2+'% - '+(rand2*1.8)+'px)';\r\n\t\t\t\t\t\tcard.style.transform='scale(1.2) rotate('+rand3+'deg)';\r\n\t\t\t\t\t\tcard.style.opacity=0;\r\n\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\tnode.appendChild(card);//[todo player]\r\n\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\tcard.style.transform='scale(0.9) rotate('+rand3+'deg)';\r\n\t\t\t\t\t\tcard.style.opacity=1;\r\n\t\t\t\t\t\tif(node.nodes.length>4){\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\twhile(node.nodes.length>3){\r\n\t\t\t\t\t\t\t\t\tnode.nodes.shift().delete();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnode.list=[];\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tnode.nodes=[];\r\n\t\t\t\t\t\tfor(var i=0;i<3;i++){\r\n\t\t\t\t\t\t\tfunc();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnode.showcaseinterval=setInterval(func,1000);\r\n\t\t\t\t},\r\n\t\t\t\tinit:function(){\r\n\t\t\t\t\tvar map={};\r\n\t\t\t\t\tvar map3=[];\r\n\t\t\t\t\tvar list1=['司','夏','诸','皇'];\r\n\t\t\t\t\tvar list2=['马','侯','葛','甫'];\r\n\t\t\t\t\tvar exclude=['界','新','大','旧','☆'];\r\n\t\t\t\t\tfor(var i in lib.character){\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tif(lib.character[i][1]=='key') continue;\r\n\t\t\t\t\t\tvar surname=lib.translate[i];\r\n\t\t\t\t\t\tfor(var j=0;j<surname.length;j++){\r\n\t\t\t\t\t\t\tif((surname[j]+surname[j+1])=='手杀'){j++;continue}\r\n\t\t\t\t\t\t\tif(['皇·','新·','海·','国战'].contains(surname[j]+surname[j+1])){j++;continue}\r\n\t\t\t\t\t\t\tif(exclude.contains(surname[j])) continue;\r\n\t\t\t\t\t\t\tif(!/[a-z]/i.test(surname[j])){\r\n\t\t\t\t\t\t\t\tvar index=list1.indexOf(surname[j]);\r\n\t\t\t\t\t\t\t\tif(index!=-1&&surname[j+1]==list2[index]){\r\n\t\t\t\t\t\t\t\t\tsurname=surname[j]+surname[j+1];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tsurname=surname[j];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!map[surname]){\r\n\t\t\t\t\t\t\tmap[surname]=[];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmap[surname].push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconsole.log(map)\r\n\t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\tif(map[i].length<3){\r\n\t\t\t\t\t\t\tdelete map[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tmap3.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.brawl.map=map;\r\n\t\t\t\t\t_status.brawl.map3=map3;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tsubmode:'two',\r\n\t\t\t\t\tchooseCharacterFixed:true,\r\n\t\t\t\t\tchooseCharacter:function(list,player){\r\n\t\t\t\t\t\tgame.versusVideoName='同姓之争';\r\n\t\t\t\t\t\t_status.noReplaceCharacter=true;\r\n\t\t\t\t\t\tif(player.side==game.me.side){\r\n\t\t\t\t\t\t\tif(_status.brawl.mylist){\r\n\t\t\t\t\t\t\t\treturn _status.brawl.mylist.randomGets(2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(_status.brawl.enemylist){\r\n\t\t\t\t\t\t\t\treturn _status.brawl.enemylist.randomGets(2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar surname=_status.brawl.map3.randomRemove();\r\n\t\t\t\t\t\tvar list=_status.brawl.map[surname];\r\n\t\t\t\t\t\tif(player==game.me){\r\n\t\t\t\t\t\t\t_status.brawl.mylist=list;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t_status.brawl.enemylist=list;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn list.randomRemove(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// tongqueduopao:{\r\n\t\t\t// \tname:'铜雀夺袍',\r\n\t\t\t// \tmode:'identity',\r\n\t\t\t// \tintro:[\r\n\t\t\t// \t\t'主公必选曹操',\r\n\t\t\t// \t\t'其余玩家从曹休、文聘、曹洪、张郃、夏侯渊、徐晃、许褚这些武将中随机选中一个',\r\n\t\t\t// \t\t'游戏开始时将毛瑟步枪和卡丁车各置于每名角色的装备区内，轿车洗入牌堆，移除其他的武器牌和坐骑牌'\r\n\t\t\t// \t],\r\n\t\t\t// \tinit:function(){\r\n\t\t\t// \t\tgame.saveConfig('player_number','8','identity');\r\n\t\t\t// \t\tgame.saveConfig('double_character',false,'identity');\r\n\t\t\t// \t},\r\n\t\t\t// \tshowcase:function(init){\r\n\t\t\t// \t\tvar node=this;\r\n\t\t\t// \t\tvar list=['caoxiu','wenpin','caohong','zhanghe','re_xiahouyuan','re_xuhuang','re_xuzhu'];\r\n\t\t\t// \t\tlist.randomSort();\r\n\t\t\t// \t\tlist.push('re_caocao');\r\n\t\t\t// \t\tvar func=function(){\r\n\t\t\t// \t\t\tvar card=ui.create.player(null,true);\r\n\t\t\t// \t\t\tcard.init(list.shift());\r\n\t\t\t// \t\t\tcard.node.marks.remove();\r\n\t\t\t// \t\t\tcard.node.count.remove();\r\n\t\t\t// \t\t\tcard.node.hp.remove();\r\n\t\t\t// \t\t\tnode.nodes.push(card);\r\n\t\t\t// \t\t\tcard.style.position='absolute';\r\n\t\t\t// \t\t\tcard.style.zIndex=2;\r\n\t\t\t// \t\t\tcard.style.transition='all 2s';\r\n\t\t\t// \t\t\tvar rand1=Math.round(Math.random()*100);\r\n\t\t\t// \t\t\tvar rand2=Math.round(Math.random()*100);\r\n\t\t\t// \t\t\tvar rand3=Math.round(Math.random()*40)-20;\r\n\t\t\t// \t\t\tcard.style.left='calc('+rand1+'% - '+(rand1*1.5)+'px)';\r\n\t\t\t// \t\t\tcard.style.top='calc('+rand2+'% - '+(rand2*1.8)+'px)';\r\n\t\t\t// \t\t\tcard.style.transform='scale(0.8) rotate('+rand3+'deg)';\r\n\t\t\t// \t\t\tnode.appendChild(card);\r\n\t\t\t// \t\t\tui.refresh(card);\r\n\t\t\t// \t\t};\r\n\r\n\t\t\t// \t\tvar list2=['qilin','dawan','zhuahuang'];\r\n\t\t\t// \t\tvar func2=function(){\r\n\t\t\t// \t\t\tvar card=game.createCard(list2.shift(),'noclick');\r\n\t\t\t// \t\t\tnode.nodes.push(card);\r\n\t\t\t// \t\t\tcard.style.position='absolute';\r\n\t\t\t// \t\t\tcard.style.zIndex=2;\r\n\t\t\t// \t\t\tcard.style.transition='all 2s';\r\n\t\t\t// \t\t\tvar rand1=Math.round(Math.random()*100);\r\n\t\t\t// \t\t\tvar rand2=Math.round(Math.random()*100);\r\n\t\t\t// \t\t\tvar rand3=Math.round(Math.random()*40)-20;\r\n\t\t\t// \t\t\tcard.style.left='calc('+rand1+'% - '+rand1+'px)';\r\n\t\t\t// \t\t\tcard.style.top='calc('+rand2+'% - '+rand2+'px)';\r\n\t\t\t// \t\t\tcard.style.transform='rotate('+rand3+'deg)';\r\n\t\t\t// \t\t\tnode.appendChild(card);\r\n\t\t\t// \t\t\tui.refresh(card);\r\n\t\t\t// \t\t};\r\n\r\n\t\t\t// \t\tif(init){\r\n\t\t\t// \t\t\tnode.nodes=[];\r\n\t\t\t// \t\t}\r\n\t\t\t// \t\telse{\r\n\t\t\t// \t\t\twhile(node.nodes.length){\r\n\t\t\t// \t\t\t\tnode.nodes.shift().remove();\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t}\r\n\t\t\t// \t\tfor(var i=0;i<5;i++){\r\n\t\t\t// \t\t\tfunc();\r\n\t\t\t// \t\t}\r\n\t\t\t// \t\tfor(var i=0;i<3;i++){\r\n\t\t\t// \t\t\tfunc2();\r\n\t\t\t// \t\t\tfunc();\r\n\t\t\t// \t\t}\r\n\t\t\t// \t\tvar func3=function(){\r\n\t\t\t// \t\t\tfor(var i=0;i<node.nodes.length;i++){\r\n\t\t\t// \t\t\t\tvar card=node.nodes[i];\r\n\t\t\t// \t\t\t\tif(card.classList.contains('player')){\r\n\t\t\t// \t\t\t\t\tvar rand1=Math.round(Math.random()*100);\r\n\t\t\t// \t\t\t\t\tvar rand2=Math.round(Math.random()*100);\r\n\t\t\t// \t\t\t\t\tvar rand3=Math.round(Math.random()*40)-20;\r\n\t\t\t// \t\t\t\t\tcard.style.left='calc('+rand1+'% - '+(rand1*1.5)+'px)';\r\n\t\t\t// \t\t\t\t\tcard.style.top='calc('+rand2+'% - '+(rand2*1.8)+'px)';\r\n\t\t\t// \t\t\t\t\tcard.style.transform='scale(0.8) rotate('+rand3+'deg)';\r\n\t\t\t// \t\t\t\t}\r\n\t\t\t// \t\t\t\telse{\r\n\t\t\t// \t\t\t\t\tvar rand1=Math.round(Math.random()*100);\r\n\t\t\t// \t\t\t\t\tvar rand2=Math.round(Math.random()*100);\r\n\t\t\t// \t\t\t\t\tvar rand3=Math.round(Math.random()*40)-20;\r\n\t\t\t// \t\t\t\t\tcard.style.left='calc('+rand1+'% - '+rand1+'px)';\r\n\t\t\t// \t\t\t\t\tcard.style.top='calc('+rand2+'% - '+rand2+'px)';\r\n\t\t\t// \t\t\t\t\tcard.style.transform='rotate('+rand3+'deg)';\r\n\t\t\t// \t\t\t\t}\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t}\r\n\t\t\t// \t\t// func3();\r\n\t\t\t// \t\t// node.showcaseinterval=setInterval(func3,5000);\r\n\t\t\t// \t},\r\n\t\t\t// \tcontent:{\r\n\t\t\t// \t\tcardPile:function(list){\r\n\t\t\t// \t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t// \t\t\t\tvar subtype=get.subtype(list[i][2]);\r\n\t\t\t// \t\t\t\tif(subtype=='equip1'||subtype=='equip3'||subtype=='equip4'){\r\n\t\t\t// \t\t\t\t\tlist.splice(i--,1);\r\n\t\t\t// \t\t\t\t}\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t\tfor(var i=0;i<8;i++){\r\n\t\t\t// \t\t\t\tlist.push([['heart','diamond','club','spade'].randomGet(),Math.ceil(Math.random()*13),'dawan']);\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t\treturn list;\r\n\t\t\t// \t\t},\r\n\t\t\t// \t\tgameStart:function(){\r\n\t\t\t// \t\t\tgame.identityVideoName='铜雀夺袍';\r\n\t\t\t// \t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t// \t\t\t\tgame.players[i].$equip(game.createCard('qilin'));\r\n\t\t\t// \t\t\t\tgame.players[i].$equip(game.createCard('zhuahuang'));\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t},\r\n\t\t\t// \t\tsubmode:'normal',\r\n\t\t\t// \t\tlist:['caoxiu','wenpin','caohong','zhanghe','re_xiahouyuan','re_xuhuang','re_xuzhu'],\r\n\t\t\t// \t\tchooseCharacterFixed:true,\r\n\t\t\t// \t\tchooseCharacterAi:function(player){\r\n\t\t\t// \t\t\tif(player==game.zhu){\r\n\t\t\t// \t\t\t\tplayer.init('re_caocao');\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t\telse{\r\n\t\t\t// \t\t\t\t_status.brawl.list.remove(game.me.name);\r\n\t\t\t// \t\t\t\tplayer.init(_status.brawl.list.randomRemove());\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t},\r\n\t\t\t// \t\tchooseCharacter:function(){\r\n\t\t\t// \t\t\t_status.noReplaceCharacter=true;\r\n\t\t\t// \t\t\tif(game.me==game.zhu){\r\n\t\t\t// \t\t\t\treturn ['re_caocao'];\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t\telse{\r\n\t\t\t// \t\t\t\t_status.brawl.list.randomSort();\r\n\t\t\t// \t\t\t\treturn _status.brawl.list;\r\n\t\t\t// \t\t\t\t// return _status.brawl.list.randomGets(1);\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t}\r\n\t\t\t// \t}\r\n\t\t\t// },\r\n\t\t\t// shenrudihou:{\r\n\t\t\t//\t name:'深入敌后',\r\n\t\t\t//\t mode:'versus',\r\n\t\t\t//\t submode:'1v1',\r\n\t\t\t//\t intro:'选将阶段选择武将和对战阶段选择上场的武将都由对手替你选择，而且你不知道对手为你选择了什么武将'\r\n\t\t\t// },\r\n\t\t\ttongjiangmoshi:{\r\n\t\t\t\tname:'同将模式',\r\n\t\t\t\tmode:'identity',\r\n\t\t\t\tintro:'玩家选择一个武将，所有角色均使用此武将',\r\n\t\t\t\tshowcase:function(init){\r\n                    \r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tthis.nodes=[];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\twhile(this.nodes.length){\r\n\t\t\t\t\t\t\tthis.nodes.shift().remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar lx=this.offsetWidth/2-120;\r\n\t\t\t\t\tvar ly=Math.min(lx,this.offsetHeight/2-60);\r\n\t\t\t\t\tvar setPos=function(node){\r\n\t\t\t\t\t\tvar i=node.index;\r\n\t\t\t\t\t\tvar deg=Math.PI/4*i;\r\n\t\t\t\t\t\tvar dx=Math.round(lx*Math.cos(deg));\r\n\t\t\t\t\t\tvar dy=Math.round(ly*Math.sin(deg));\r\n\t\t\t\t\t\tnode.style.transform='translate('+dx+'px,'+dy+'px)';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<8;i++){\r\n\t\t\t\t\t\tvar node=ui.create.player(null,true);\r\n\t\t\t\t\t\tthis.nodes.push(node);\r\n\t\t\t\t\t\tnode.init('jike');\r\n\t\t\t\t\t\tnode.classList.add('minskin');\r\n\t\t\t\t\t\tnode.node.marks.remove();\r\n\t\t\t\t\t\tnode.node.hp.remove();\r\n\t\t\t\t\t\tnode.node.count.remove();\r\n\t\t\t\t\t\tnode.style.left='calc(50% - 60px)';\r\n\t\t\t\t\t\tnode.style.top='calc(50% - 60px)';\r\n\t\t\t\t\t\tnode.index=i;\r\n\t\t\t\t\t\tnode.style.borderRadius='100%';\r\n\t\t\t\t\t\tnode.node.avatar.style.borderRadius='100%';\r\n\t\t\t\t\t\tnode.node.name.remove();\r\n\t\t\t\t\t\tsetPos(node);\r\n\t\t\t\t\t\tthis.appendChild(node);//[todo player]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar nodes=this.nodes;\r\n\t\t\t\t\tthis.showcaseinterval=setInterval(function(){\r\n\t\t\t\t\t\tfor(var i=0;i<nodes.length;i++){\r\n\t\t\t\t\t\t\tnodes[i].index++;\r\n\t\t\t\t\t\t\tif(nodes[i].index>7){\r\n\t\t\t\t\t\t\t\tnodes[i].index=0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetPos(nodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},1000);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tgameStart:function(){\r\n\t\t\t\t\t\tgame.identityVideoName='同将模式';\r\n\t\t\t\t\t\tvar target=(_status.mode=='zhong')?game.zhong:game.zhu;\r\n\t\t\t\t\t\tif(get.config('double_character')){\r\n\t\t\t\t\t\t\ttarget.init(game.me.name1,game.me.name2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\ttarget.init(game.me.name1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttarget.hp++;\r\n\t\t\t\t\t\ttarget.maxHp++;\r\n\t\t\t\t\t\ttarget.update();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tchooseCharacterAi:function(player,list,list2,back){\r\n\t\t\t\t\t\tif(player==game.zhu){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(get.config('double_character')){\r\n\t\t\t\t\t\t\t\tplayer.init(game.me.name1,game.me.name2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tplayer.init(game.me.name1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tchooseCharacter:function(list,list2,num){\r\n\t\t\t\t\t\tif(game.me!=game.zhu){\r\n\t\t\t\t\t\t\treturn list.slice(0,list2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(_status.event.zhongmode){\r\n\t\t\t\t\t\t\t\treturn list.slice(0,6);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\treturn list.concat(list2.slice(0,num));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tchooseCharacterBefore:function(){\r\n\t\t\t\t\t\tif(_status.mode=='purple') _status.mode='normal';\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjiazuzhizheng:{\r\n\t\t\t\tname:'家族之争',\r\n\t\t\t\tmode:'versus',\r\n\t\t\t\tsubmode:'2v2',\r\n\t\t\t\tintro:'势力相同的武将组合一队，获得专属势力技能',\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tvar node=this;\r\n\t\t\t\t\tvar getList=function(){\r\n\t\t\t\t\t\tvar list=[\r\n\t\t\t\t\t\t['MinatoAqua','re_NakiriAyame','re_MurasakiShion'],\r\n\t\t\t\t\t\t['MitoTsukino','SuzukaUtako','HiguchiKaede'],\r\n\t\t\t\t\t\t['Ava','Bella','Diana'],\r\n\t\t\t\t\t\t['KaguraMea','InuyamaTamaki','InabaHaneru']\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t\t//if(_status.keyVerified) list.push(['key_yuri','key_yuzuru','sp_key_kanade'])\r\n\t\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tlist2=list2.concat(list[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnode.list=list2;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar func=function(){\r\n\t\t\t\t\t\tif(!node.list.length){\r\n\t\t\t\t\t\t\tgetList();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar card=ui.create.player(null,true);\r\n\t\t\t\t\t\tcard.init(node.list.shift());\r\n\t\t\t\t\t\tcard.node.marks.remove();\r\n\t\t\t\t\t\tcard.node.count.remove();\r\n\t\t\t\t\t\tcard.node.hp.remove();\r\n\t\t\t\t\t\tnode.nodes.push(card);\r\n\t\t\t\t\t\tcard.style.position='absolute';\r\n\t\t\t\t\t\tvar rand1=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand2=Math.round(Math.random()*100);\r\n\t\t\t\t\t\tvar rand3=Math.round(Math.random()*40)-20;\r\n\t\t\t\t\t\tcard.style.left='calc('+rand1+'% - '+(rand1*1.5)+'px)';\r\n\t\t\t\t\t\tcard.style.top='calc('+rand2+'% - '+(rand2*1.8)+'px)';\r\n\t\t\t\t\t\tcard.style.transform='scale(1.2) rotate('+rand3+'deg)';\r\n\t\t\t\t\t\tcard.style.opacity=0;\r\n\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\tnode.appendChild(card);//[todo player]\r\n\t\t\t\t\t\tui.refresh(card);\r\n\t\t\t\t\t\tcard.style.transform='scale(0.9) rotate('+rand3+'deg)';\r\n\t\t\t\t\t\tcard.style.opacity=1;\r\n\t\t\t\t\t\tif(node.nodes.length>4){\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\twhile(node.nodes.length>3){\r\n\t\t\t\t\t\t\t\t\tnode.nodes.shift().delete();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnode.list=[];\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tnode.nodes=[];\r\n\t\t\t\t\t\tfor(var i=0;i<3;i++){\r\n\t\t\t\t\t\t\tfunc();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnode.showcaseinterval=setInterval(func,1000);\r\n\t\t\t\t},\r\n\t\t\t\tinit:function(){},\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tsubmode:'two',\r\n\t\t\t\t\tchooseCharacterFixed:true,\r\n \t\t\t\tchooseCharacterBefore:function(){\r\n\t\t\t\t\t_status.noReplaceCharacter=true;\r\n \t\t\t\t\tgame.versusVideoName='家族之争';\r\n \t\t\t\t\tvar map={\r\n \t\t\t\t\t\t// wei:[],\r\n \t\t\t\t\t\t// shu:[],\r\n \t\t\t\t\t\t// wu:[],\r\n \t\t\t\t\t\t// key:[],\r\n \t\t\t\t\t\tqun:[],\r\n \t\t\t\t\t\tholo:[],\r\n \t\t\t\t\t\tpsp:[],\r\n \t\t\t\t\t\tparyi:[],\r\n \t\t\t\t\t\tasoul:[],\r\n \t\t\t\t\t};\r\n \t\t\t\t\tvar map3=[];\r\n \t\t\t\t\tvar banned=['zuoci','re_zuoci','tw_xiahouba'];\r\n \t\t\t\t\tfor(var i in lib.character){\r\n \t\t\t\t\t\tif(lib.filter.characterDisabled2(i)||lib.filter.characterDisabled(i)||banned.contains(i)) continue;\r\n \t\t\t\t\t\tvar group=lib.character[i][1];\r\n \t\t\t\t\t\tif(group&&map[group]) map[group].push(i);\r\n \t\t\t\t\t}\r\n \t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\tif(map[i].length<5||(i=='key'&&!_status.keyVerified)){\r\n \t\t\t\t\t\t\tdelete map[i];\r\n \t\t\t\t\t\t}\r\n \t\t\t\t\t\telse{\r\n \t\t\t\t\t\t\tmap3.push(i);\r\n \t\t\t\t\t\t}\r\n \t\t\t\t\t}\r\n \t\t\t\t\t_status.brawl.map=map;\r\n \t\t\t\t\t_status.brawl.map3=map3;\r\n \t\t\t\t\tvar skill={\r\n \t\t\t\t\t\t_jiazu_wei:{\r\n \t\t\t\t\t\t\ttrigger:{player:'phaseBegin'},\r\n \t\t\t\t\t\t\tdirect:true,\r\n \t\t\t\t\t\t\tpopup:'魏业',\r\n \t\t\t\t\t\t\tprompt2:'回合开始时，你可以弃置一张牌并指定一名敌方角色，该角色须弃置一张牌，否则你摸一张牌。',\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player.group=='wei'&&player.countCards('he')>0;\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){\r\n \t\t\t\t\t\t\t\t'step 0'\r\n \t\t\t\t\t\t\t\tplayer.chooseCardTarget({\r\n \t\t\t\t\t\t\t\t\tprompt:get.prompt2(event.name),\r\n \t\t\t\t\t\t\t\t\tfilterCard:lib.filter.cardDiscardable,\r\n \t\t\t\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n \t\t\t\t\t\t\t\t\t\treturn player.side!=target.side;\r\n \t\t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t\t\tposition:'he',\r\n \t\t\t\t\t\t\t\t\tai1:function(card){\r\n \t\t\t\t\t\t\t\t\t\treturn 6-get.value(card);\r\n \t\t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t\t\tai2:function(target){\r\n \t\t\t\t\t\t\t\t\t\treturn 1/(1+target.countCards('he'));\r\n \t\t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t\t});\r\n \t\t\t\t\t\t\t\t'step 1'\r\n \t\t\t\t\t\t\t\tif(result.bool){\r\n \t\t\t\t\t\t\t\t\tplayer.logSkill(event.name,result.targets);\r\n \t\t\t\t\t\t\t\t\tplayer.discard(result.cards);\r\n \t\t\t\t\t\t\t\t\tresult.targets[0].chooseToDiscard('弃置一张牌，或令'+get.translation(player)+'摸一张牌','he').ai=lib.skill.zhiheng.check;\r\n \t\t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\t\telse event.finish();\r\n \t\t\t\t\t\t\t\t'step 2'\r\n \t\t\t\t\t\t\t\tif(!result.bool) player.draw();\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_shu:{\r\n \t\t\t\t\t\t\tpopup:'蜀义',\r\n \t\t\t\t\t\t\tprompt2:'你使用【杀】上限+1；出牌阶段结束时，若你于此阶段使用【杀】次数不少于2，摸一张牌。',\r\n \t\t\t\t\t\t\tmod:{\r\n \t\t\t\t\t\t\t\tcardUsable:function(card,player,num){\r\n \t\t\t\t\t\t\t\t\tif(card.name=='sha'&&player.group=='shu') return num+1;\r\n \t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{player:'phaseUseEnd'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player.group=='shu'&&player.getHistory('useCard',function(evt){\r\n \t\t\t\t\t\t\t\t\treturn evt.card&&evt.card.name=='sha'&&evt.getParent('phaseUse')==event;\r\n \t\t\t\t\t\t\t\t}).length>1;\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_wu:{\r\n \t\t\t\t\t\t\ttrigger:{player:'phaseEnd'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tpopup:'吴耀',\r\n \t\t\t\t\t\t\tprompt2:'回合结束时，若你的手牌数不等于你的体力值，则你摸一张牌。',\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player.group=='wu'&&player.countCards('h')!=player.hp;\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_qun:{\r\n \t\t\t\t\t\t\tpopup:'群心',\r\n \t\t\t\t\t\t\tprompt2:'锁定技，弃牌阶段开始时，若你的手牌数比体力值多2或更多，你本回合手牌上限+1；若你已损失体力值大于1，你手牌上限+1',\r\n \t\t\t\t\t\t\ttrigger:{player:'phaseDiscardBegin'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player.group=='qun'&&(player.isDamaged()||player.countCards('h')-player.hp>1);\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){\r\n \t\t\t\t\t\t\t\tvar num=0;\r\n \t\t\t\t\t\t\t\tif(player.isDamaged()) num++;\r\n \t\t\t\t\t\t\t\tif(player.countCards('h')-player.hp>1) num++;\r\n \t\t\t\t\t\t\t\tplayer.addMark('qunxin_temp',num,false);\r\n \t\t\t\t\t\t\t\tplayer.addTempSkill('qunxin_temp','phaseDiscardEnd');\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_key:{\r\n \t\t\t\t\t\t\tenable:'phaseUse',\r\n \t\t\t\t\t\t\tusable:1,\r\n \t\t\t\t\t\t\tpopup:'键魂',\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player.group=='key';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tprompt2:'出牌阶段限一次，你可以摸一张牌并获得1点护甲。若如此做，你于当前回合结束时失去1点体力。',\r\n \t\t\t\t\t\t\tcontent:function(){\r\n \t\t\t\t\t\t\t\t\"step 0\"\r\n \t\t\t\t\t\t\t\tplayer.draw();\r\n \t\t\t\t\t\t\t\t\"step 1\"\r\n \t\t\t\t\t\t\t\tplayer.changeHujia(1);\r\n \t\t\t\t\t\t\t\t\"step 2\"\r\n \t\t\t\t\t\t\t\tvar evt=event.getParent('phase');\r\n \t\t\t\t\t\t\t\tif(evt&&evt.after){\r\n \t\t\t\t\t\t\t\t\tvar next=player.loseHp();\r\n \t\t\t\t\t\t\t\t\tevent.next.remove(next);\r\n \t\t\t\t\t\t\t\t\tevt.after.push(next);\r\n \t\t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tai:{\r\n \t\t\t\t\t\t\t\torder:10,\r\n \t\t\t\t\t\t\t\tresult:{\r\n \t\t\t\t\t\t\t\t\tplayer:function(player){\r\n \t\t\t\t\t\t\t\t\t\treturn player.hp-1;\r\n \t\t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_holo:{\r\n\t\t\t\t\t\t\tpopup:'杏仁',\r\n\t\t\t\t\t\t\tprompt2:'你使用【杀】上限+1；出牌阶段结束时，若你于此阶段使用【杀】次数不少于2，摸一张牌。',\r\n\t\t\t\t\t\t\tmod:{\r\n\t\t\t\t\t\t\t\tcardUsable:function(card,player,num){\r\n\t\t\t\t\t\t\t\t\tif(card.name=='sha'&&player.group=='holo') return num+1;\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ttrigger:{player:'phaseUseEnd'},\r\n\t\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\t\treturn player.group=='holo'&&player.getHistory('useCard',function(evt){\r\n\t\t\t\t\t\t\t\t\treturn evt.card&&evt.card.name=='holo'&&evt.getParent('phaseUse')==event;\r\n\t\t\t\t\t\t\t\t}).length>1;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_psp:{\r\n \t\t\t\t\t\t\ttrigger:{player:'phaseEnd'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tpopup:'残烛',\r\n \t\t\t\t\t\t\tprompt2:'回合结束时，若你的手牌数不等于你的体力值，则你摸一张牌。',\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player.group=='psp'&&player.countCards('h')!=player.hp;\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_paryi:{\r\n \t\t\t\t\t\t\ttrigger:{player:'phaseBegin'},\r\n \t\t\t\t\t\t\tdirect:true,\r\n \t\t\t\t\t\t\tpopup:'幻业',\r\n \t\t\t\t\t\t\tprompt2:'回合开始时，你可以弃置一张牌并指定一名敌方角色，该角色须弃置一张牌，否则你摸一张牌。',\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player.group=='paryi'&&player.countCards('he')>0;\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){\r\n \t\t\t\t\t\t\t\t'step 0'\r\n \t\t\t\t\t\t\t\tplayer.chooseCardTarget({\r\n \t\t\t\t\t\t\t\t\tprompt:get.prompt2(event.name),\r\n \t\t\t\t\t\t\t\t\tfilterCard:lib.filter.cardDiscardable,\r\n \t\t\t\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n \t\t\t\t\t\t\t\t\t\treturn player.side!=target.side;\r\n \t\t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t\t\tposition:'he',\r\n \t\t\t\t\t\t\t\t\tai1:function(card){\r\n \t\t\t\t\t\t\t\t\t\treturn 6-get.value(card);\r\n \t\t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t\t\tai2:function(target){\r\n \t\t\t\t\t\t\t\t\t\treturn 1/(1+target.countCards('he'));\r\n \t\t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t\t});\r\n \t\t\t\t\t\t\t\t'step 1'\r\n \t\t\t\t\t\t\t\tif(result.bool){\r\n \t\t\t\t\t\t\t\t\tplayer.logSkill(event.name,result.targets);\r\n \t\t\t\t\t\t\t\t\tplayer.discard(result.cards);\r\n \t\t\t\t\t\t\t\t\tresult.targets[0].chooseToDiscard('弃置一张牌，或令'+get.translation(player)+'摸一张牌','he').ai=lib.skill.zhiheng.check;\r\n \t\t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\t\telse event.finish();\r\n \t\t\t\t\t\t\t\t'step 2'\r\n \t\t\t\t\t\t\t\tif(!result.bool) player.draw();\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_asoul:{\r\n \t\t\t\t\t\t\tenable:'phaseUse',\r\n \t\t\t\t\t\t\tusable:1,\r\n \t\t\t\t\t\t\tpopup:'魂守',\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player.group=='asoul';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tprompt2:'出牌阶段限一次，你可以摸一张牌并获得1点护甲。若如此做，你于当前回合结束时失去1点体力。',\r\n \t\t\t\t\t\t\tcontent:function(){\r\n \t\t\t\t\t\t\t\t\"step 0\"\r\n \t\t\t\t\t\t\t\tplayer.draw();\r\n \t\t\t\t\t\t\t\t\"step 1\"\r\n \t\t\t\t\t\t\t\tplayer.changeHujia(1);\r\n \t\t\t\t\t\t\t\t\"step 2\"\r\n \t\t\t\t\t\t\t\tvar evt=event.getParent('phase');\r\n \t\t\t\t\t\t\t\tif(evt&&evt.after){\r\n \t\t\t\t\t\t\t\t\tvar next=player.loseHp();\r\n \t\t\t\t\t\t\t\t\tevent.next.remove(next);\r\n \t\t\t\t\t\t\t\t\tevt.after.push(next);\r\n \t\t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tai:{\r\n \t\t\t\t\t\t\t\torder:10,\r\n \t\t\t\t\t\t\t\tresult:{\r\n \t\t\t\t\t\t\t\t\tplayer:function(player){\r\n \t\t\t\t\t\t\t\t\t\treturn player.hp-1;\r\n \t\t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\tqunxin_temp:{\r\n \t\t\t\t\t\t\tnoGlobal:true,\r\n \t\t\t\t\t\t\tonremove:true,\r\n \t\t\t\t\t\t\tmod:{\r\n \t\t\t\t\t\t\t\tmaxHandcard:function(player,num){\r\n \t\t\t\t\t\t\t\t\treturn num+player.countMark('qunxin_temp');\r\n \t\t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken_wei:{\r\n \t\t\t\t\t\t\tpopup:'许昌',\r\n \t\t\t\t\t\t\tintro:{\r\n \t\t\t\t\t\t\t\tcontent:'锁定技，当你受到伤害后，你摸一张牌。',\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{player:'damageEnd'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player._jiazuAwaken&&player.group=='wei';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken_shu:{\r\n \t\t\t\t\t\t\tpopup:'成都',\r\n \t\t\t\t\t\t\tintro:{\r\n \t\t\t\t\t\t\t\tcontent:'锁定技，当你使用【杀】造成伤害后，你摸一张牌。',\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{source:'damageEnd'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player._jiazuAwaken&&player.group=='shu'&&event.card&&event.card.name=='sha';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken_wu:{\r\n \t\t\t\t\t\t\tpopup:'武昌',\r\n \t\t\t\t\t\t\tintro:{\r\n \t\t\t\t\t\t\t\tcontent:'锁定技，当你使用装备牌时，你摸一张牌。',\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{player:'useCard'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player._jiazuAwaken&&player.group=='wu'&&get.type(event.card)=='equip';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken_qun:{\r\n \t\t\t\t\t\t\tpopup:'VRChat',\r\n \t\t\t\t\t\t\tintro:{\r\n \t\t\t\t\t\t\t\tcontent:'锁定技，当你使用锦囊牌指定其他角色为目标后，你摸一张牌。',\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{player:'useCardToPlayered'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\tif(!player._jiazuAwaken||player.group!='qun'||!event.isFirstTarget||get.type(event.card,'trick')!='trick') return false;\r\n \t\t\t\t\t\t\t\tfor(var i=0;i<event.targets.length;i++){\r\n \t\t\t\t\t\t\t\t\tif(event.targets[i]!=player) return true;\r\n \t\t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\t\treturn false;\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken_key:{\r\n \t\t\t\t\t\t\tpopup:'光坂',\r\n \t\t\t\t\t\t\tintro:{\r\n \t\t\t\t\t\t\t\tcontent:'锁定技，当你回复/失去体力后，你摸一张牌。',\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{player:['loseHpEnd','recoverEnd']},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player._jiazuAwaken&&player.group=='key';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){\r\n \t\t\t\t\t\t\t\tplayer.draw();\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken:{\r\n \t\t\t\t\t\t\ttrigger:{global:'die'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn !player._jiazuAwaken&&event.player.side==player.side;\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){\r\n \t\t\t\t\t\t\t\tplayer._jiazuAwaken=true;\r\n \t\t\t\t\t\t\t\tvar name='_jiazu_awaken_'+player.group;\r\n \t\t\t\t\t\t\t\tif(lib.skill[name]) player.markSkill(name);\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken_holo:{\r\n \t\t\t\t\t\t\tpopup:'温暖大家庭',\r\n \t\t\t\t\t\t\tintro:{\r\n \t\t\t\t\t\t\t\tcontent:'锁定技，当你使用【杀】造成伤害后，你摸一张牌。',\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{source:'damageEnd'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player._jiazuAwaken&&player.group=='holo'&&event.card&&event.card.name=='sha';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken_psp:{\r\n \t\t\t\t\t\t\tpopup:'高性能机体',\r\n \t\t\t\t\t\t\tintro:{\r\n \t\t\t\t\t\t\t\tcontent:'锁定技，当你使用装备牌时，你摸一张牌。',\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{player:'useCard'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player._jiazuAwaken&&player.group=='psp'&&get.type(event.card)=='equip';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken_paryi:{\r\n \t\t\t\t\t\t\tpopup:'巧可拉拉',\r\n \t\t\t\t\t\t\tintro:{\r\n \t\t\t\t\t\t\t\tcontent:'锁定技，当你受到伤害后，你摸一张牌。',\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{player:'damageEnd'},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player._jiazuAwaken&&player.group=='psp';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){player.draw()},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\t_jiazu_awaken_asoul:{\r\n \t\t\t\t\t\t\tpopup:'工具人升级',\r\n \t\t\t\t\t\t\tintro:{\r\n \t\t\t\t\t\t\t\tcontent:'锁定技，当你回复/失去体力后，你摸一张牌。',\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\ttrigger:{player:['loseHpEnd','recoverEnd']},\r\n \t\t\t\t\t\t\tforced:true,\r\n \t\t\t\t\t\t\tfilter:function(event,player){\r\n \t\t\t\t\t\t\t\treturn player._jiazuAwaken&&player.group=='asoul';\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t\tcontent:function(){\r\n \t\t\t\t\t\t\t\tplayer.draw();\r\n \t\t\t\t\t\t\t},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t};\r\n \t\t\t\t\tvar translate={};\r\n \t\t\t\t\tfor(var i in skill){\r\n \t\t\t\t\t\tlib.skill[i]=skill[i];\r\n \t\t\t\t\t\tif(skill[i].popup){\r\n \t\t\t\t\t\t\tlib.translate[i]=skill[i].popup;\r\n \t\t\t\t\t\t\ttranslate[i]=skill[i].popup;\r\n \t\t\t\t\t\t}\r\n \t\t\t\t\t\tif(skill[i].prompt2){\r\n \t\t\t\t\t\t\tlib.translate[i+'_info']=skill[i].prompt2;\r\n \t\t\t\t\t\t\ttranslate[i+'_info']=skill[i].prompt2;\r\n \t\t\t\t\t\t}\r\n \t\t\t\t\t\tif(!skill[i].noGlobal) game.addGlobalSkill(i);\r\n \t\t\t\t\t};\r\n \t\t\t\t\tgame.addVideo('arrangeLib',null,{\r\n \t\t\t\t\t\tskill:{\r\n  \t\t\t\t\t\t_jiazu_wei:{\r\n  \t\t\t\t\t\t\tpopup:'魏业',\r\n  \t\t\t\t\t\t\tprompt2:'回合开始时，你可以弃置一张牌并指定一名敌方角色，该角色须弃置一张牌，否则你摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_shu:{\r\n  \t\t\t\t\t\t\tpopup:'蜀义',\r\n  \t\t\t\t\t\t\tprompt2:'你使用【杀】上限+1；出牌阶段结束时，若你于此阶段使用【杀】次数不少于2，摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_wu:{\r\n  \t\t\t\t\t\t\tpopup:'吴耀',\r\n  \t\t\t\t\t\t\tprompt2:'回合结束时，若你的手牌数不等于你的体力值，则你摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_qun:{\r\n  \t\t\t\t\t\t\tpopup:'群心',\r\n  \t\t\t\t\t\t\tprompt2:'锁定技，弃牌阶段开始时，若你的手牌数比体力值多2或更多，你本回合手牌上限+1；若你已损失体力值大于1，你手牌上限+1',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_key:{\r\n  \t\t\t\t\t\t\tpopup:'键魂',\r\n  \t\t\t\t\t\t\tprompt2:'出牌阶段限一次，你可以摸一张牌并获得1点护甲。若如此做，你于当前回合结束时失去1点体力。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_holo:{\r\n  \t\t\t\t\t\t\tpopup:'杏仁',\r\n  \t\t\t\t\t\t\tprompt2:'你使用【杀】上限+1；出牌阶段结束时，若你于此阶段使用【杀】次数不少于2，摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_psp:{\r\n  \t\t\t\t\t\t\tpopup:'残烛',\r\n  \t\t\t\t\t\t\tprompt2:'回合结束时，若你的手牌数不等于你的体力值，则你摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_paryi:{\r\n  \t\t\t\t\t\t\tpopup:'幻业',\r\n  \t\t\t\t\t\t\tprompt2:'回合开始时，你可以弃置一张牌并指定一名敌方角色，该角色须弃置一张牌，否则你摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_asoul:{\r\n  \t\t\t\t\t\t\tpopup:'魂守',\r\n  \t\t\t\t\t\t\tprompt2:'出牌阶段限一次，你可以摸一张牌并获得1点护甲。若如此做，你于当前回合结束时失去1点体力。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken_wei:{\r\n  \t\t\t\t\t\t\tpopup:'许昌',\r\n  \t\t\t\t\t\t\tintro:{\r\n  \t\t\t\t\t\t\t\tcontent:'锁定技，当你受到伤害后，你摸一张牌。',\r\n  \t\t\t\t\t\t\t},\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken_shu:{\r\n  \t\t\t\t\t\t\tpopup:'成都',\r\n  \t\t\t\t\t\t\tintro:{\r\n  \t\t\t\t\t\t\t\tcontent:'锁定技，当你使用【杀】造成伤害后，你摸一张牌。',\r\n  \t\t\t\t\t\t\t},\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken_wu:{\r\n  \t\t\t\t\t\t\tpopup:'武昌',\r\n  \t\t\t\t\t\t\tintro:{\r\n  \t\t\t\t\t\t\t\tcontent:'锁定技，当你使用装备牌时，你摸一张牌。',\r\n  \t\t\t\t\t\t\t},\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken_qun:{\r\n  \t\t\t\t\t\t\tpopup:'VRChat',\r\n  \t\t\t\t\t\t\tintro:{\r\n  \t\t\t\t\t\t\t\tcontent:'锁定技，当你使用锦囊牌指定其他角色为目标后，你摸一张牌。',\r\n  \t\t\t\t\t\t\t},\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken_key:{\r\n  \t\t\t\t\t\t\tpopup:'光坂',\r\n  \t\t\t\t\t\t\tintro:{\r\n  \t\t\t\t\t\t\t\tcontent:'锁定技，当你回复/失去体力后，你摸一张牌。',\r\n  \t\t\t\t\t\t\t},\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken_holo:{\r\n  \t\t\t\t\t\t\tpopup:'温暖大家庭',\r\n  \t\t\t\t\t\t\tprompt2:'锁定技，当你使用【杀】造成伤害后，你摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken_psp:{\r\n  \t\t\t\t\t\t\tpopup:'高性能机体',\r\n  \t\t\t\t\t\t\tprompt2:'锁定技，当你使用装备牌时，你摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken_paryi:{\r\n  \t\t\t\t\t\t\tpopup:'巧可拉拉',\r\n  \t\t\t\t\t\t\tprompt2:'锁定技，当你受到伤害后，你摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken_asoul:{\r\n  \t\t\t\t\t\t\tpopup:'工具人升级',\r\n  \t\t\t\t\t\t\tprompt2:'锁定技，当你回复/失去体力后，你摸一张牌。',\r\n  \t\t\t\t\t\t},\r\n  \t\t\t\t\t\t_jiazu_awaken:{},\r\n \t\t\t\t\t\t},\r\n \t\t\t\t\t\ttranslate:translate,\r\n \t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tchooseCharacter:function(list,player){\r\n\t\t\t\t\t\tif(player.side==game.me.side){\r\n\t\t\t\t\t\t\tif(_status.brawl.mylist){\r\n\t\t\t\t\t\t\t\treturn _status.brawl.mylist.randomGets(player==game.me?5:3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(_status.brawl.enemylist){\r\n\t\t\t\t\t\t\t\treturn _status.brawl.enemylist.randomGets(player==game.me?5:3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar surname=_status.brawl.map3.randomRemove();\r\n\t\t\t\t\t\tvar list=_status.brawl.map[surname];\r\n\t\t\t\t\t\tif(player==game.me){\r\n\t\t\t\t\t\t\t_status.brawl.mylist=list;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t_status.brawl.enemylist=list;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn list.randomRemove(player==game.me?5:3);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// baiyidujiang:{\r\n\t\t\t// \tname:'白衣渡江',\r\n\t\t\t// \tmode:'versus',\r\n\t\t\t// \tsubmode:'2v2',\r\n\t\t\t// \tshowcase:function(init){\r\n\t\t\t// \t\tvar node=this;\r\n\t\t\t// \t\tvar player1,player2;\r\n\t\t\t// \t\tif(init){\r\n\t\t\t// \t\t\tplayer1=ui.create.player(null,true).init('lvmeng');\r\n\t\t\t// \t\t\tplayer2=ui.create.player(null,true).init('guanyu');\r\n\t\t\t// \t\t\tplayer1.node.marks.remove();\r\n\t\t\t// \t\t\tplayer1.node.hp.remove();\r\n\t\t\t// \t\t\tplayer2.node.marks.remove();\r\n\t\t\t// \t\t\tplayer2.node.hp.remove();\r\n\t\t\t// \t\t\tplayer1.style.left='20px';\r\n\t\t\t// \t\t\tplayer1.style.top='20px';\r\n\t\t\t// \t\t\tplayer1.style.transform='scale(0.9)';\r\n\t\t\t// \t\t\tplayer1.node.count.remove();\r\n\t\t\t// \t\t\tplayer2.style.left='auto';\r\n\t\t\t// \t\t\tplayer2.style.right='20px';\r\n\t\t\t// \t\t\tplayer2.style.top='20px';\r\n\t\t\t// \t\t\tplayer2.style.transform='scale(0.9)';\r\n\t\t\t// \t\t\tplayer2.node.count.remove();\r\n\t\t\t// \t\t\tthis.appendChild(player1);\r\n\t\t\t// \t\t\tthis.appendChild(player2);\r\n\t\t\t// \t\t\tthis.player1=player1;\r\n\t\t\t// \t\t\tthis.player2=player2;\r\n\t\t\t// \t\t}\r\n\t\t\t// \t\telse{\r\n\t\t\t// \t\t\tplayer1=this.player1;\r\n\t\t\t// \t\t\tplayer2=this.player2;\r\n\t\t\t// \t\t}\r\n\t\t\t// \t\tvar rect1=player1.getBoundingClientRect();\r\n\t\t\t// \t\tvar rect2=player2.getBoundingClientRect();\r\n\t\t\t// \t\tvar left1=rect1.left+rect1.width/2-ui.arena.offsetLeft;\r\n\t\t\t// \t\tvar left2=rect2.left+rect2.width/2-ui.arena.offsetLeft;\r\n\t\t\t// \t\tvar top1=rect1.top+rect1.height/2-ui.arena.offsetTop;\r\n\t\t\t// \t\tvar top2=rect2.top+rect2.height/2-ui.arena.offsetTop;\r\n\t\t\t// \t\tvar func=function(){\r\n\t\t\t// \t\t\t//game.linexy([left1,top1,left2,top2]);\r\n\t\t\t// \t\t\tsetTimeout(function(){\r\n\t\t\t// \t\t\t\tplayer1.reinit(player1.name,'re_lvmeng');\r\n\t\t\t// \t\t\t\tplayer2.reinit(player2.name,'re_guanyu');\r\n\t\t\t// \t\t\t\t//game.linexy([left2,top2,left1,top1],'green');\r\n\t\t\t// \t\t\t},1500);\r\n\t\t\t// \t\t\tsetTimeout(function(){\r\n\t\t\t// \t\t\t\tplayer1.reinit(player1.name,'sp_lvmeng');\r\n\t\t\t// \t\t\t\tplayer2.reinit(player2.name,'jsp_guanyu');\r\n\t\t\t// \t\t\t\t//game.linexy([left1,top1,left2,top2],'thunder');\r\n\t\t\t// \t\t\t},3000);\r\n\t\t\t// \t\t\tsetTimeout(function(){\r\n\t\t\t// \t\t\t\tplayer1.reinit(player1.name,'shen_lvmeng');\r\n\t\t\t// \t\t\t\tplayer2.reinit(player2.name,'shen_guanyu');\r\n\t\t\t// \t\t\t\t//game.linexy([left2,top2,left1,top1],'fire');\r\n\t\t\t// \t\t\t},4500);\r\n\t\t\t// \t\t\tsetTimeout(function(){\r\n\t\t\t// \t\t\t\tplayer1.reinit(player1.name,'lvmeng');\r\n\t\t\t// \t\t\t\tplayer2.reinit(player2.name,'guanyu');\r\n\t\t\t// \t\t\t},6000);\r\n\t\t\t// \t\t};\r\n\t\t\t// \t\tnode.showcaseinterval=setInterval(func,6000);\r\n\t\t\t// \t\tfunc();\r\n\t\t\t// \t},\r\n\t\t\t// \tintro:[\r\n\t\t\t// \t\t'玩家在选将时可从8张武将牌里选择两张武将牌，一张面向大家可见（加入游戏），另一张是隐藏面孔（暗置）',\r\n\t\t\t// \t\t'选择的两张武将牌需满足以下至少两个条件：1.性别相同；2.体力上限相同；3.技能数量相同',\r\n\t\t\t// \t\t'每名玩家在其回合开始或回合结束时，可以选择将自己的武将牌弃置，然后使用暗置的武将牌进行剩余的游戏'\r\n\t\t\t// \t],\r\n\t\t\t// \tcontent:{\r\n\t\t\t// \t\tsubmode:'two',\r\n\t\t\t// \t\tchooseCharacterBefore:function(){\r\n   \t\t\t// game.versusVideoName='白衣渡江';\r\n   \t\t\t// lib.skill._changeCharacter={\r\n   \t\t\t// \ttrigger:{player:['phaseBefore','phaseAfter']},\r\n   \t\t\t// \tforced:true,\r\n   \t\t\t// \tsilent:true,\r\n   \t\t\t// \tpopup:false,\r\n   \t\t\t// \tfilter:function(event,player){\r\n   \t\t\t// \t\treturn player._backupCharacter!=undefined;\r\n   \t\t\t// \t},\r\n   \t\t\t// \tcontent:function(){\r\n   \t\t\t// \t\t\"step 0\"\r\n   \t\t\t// \t\tplayer.chooseControl('确定','取消').set('dialog',['是否替换自己的武将牌？',[[player._backupCharacter],'character']]).set('ai',function(){\r\n   \t\t\t// \t\t\treturn Math.random()<0.15?'确定':'取消';\r\n   \t\t\t// \t\t});\r\n   \t\t\t// \t\t\"step 1\"\r\n   \t\t\t// \t\tif(result.control=='确定'){\r\n   \t\t\t// \t\t\tgame.log(player,'将',player.name,'替换为了',player._backupCharacter);\r\n   \t\t\t// \t\t\tplayer.reinit(player.name,player._backupCharacter);\r\n   \t\t\t// \t\t\tplayer.changeGroup(lib.character[player._backupCharacter][1],false);\r\n   \t\t\t// \t\t\tdelete player._backupCharacter;\r\n   \t\t\t// \t\t}\r\n   \t\t\t// \t},\r\n   \t\t\t// },\r\n   \t\t\t// game.addGlobalSkill('_changeCharacter');\r\n   \t\t\t// game.chooseCharacterTwo=function(){\r\n   \t\t\t// \tvar next=game.createEvent('chooseCharacter',false);\r\n   \t\t\t// \tnext.setContent(function(){\r\n   \t\t\t// \t\t'step 0'\r\n   \t\t\t// \t\tui.arena.classList.add('choose-character');\r\n   \t\t\t// \t\tfor(var i in lib.skill){\r\n   \t\t\t// \t\t\tif(lib.skill[i].changeSeat){\r\n   \t\t\t// \t\t\t\tlib.skill[i]={};\r\n   \t\t\t// \t\t\t\tif(lib.translate[i+'_info']){\r\n   \t\t\t// \t\t\t\t\tlib.translate[i+'_info']='此模式下不可用';\r\n   \t\t\t// \t\t\t\t}\r\n   \t\t\t// \t\t\t}\r\n   \t\t\t// \t\t}\r\n   \t\t\t// \t\tvar bool=Math.random()<0.5;\r\n   \t\t\t// \t\tvar bool2=Math.random()<0.5;\r\n   \t\t\t// \t\tvar ref=game.players[0];\r\n   \r\n   \t\t\t// \t\tref.side=bool;\r\n   \t\t\t// \t\tref.next.side=bool2;\r\n   \t\t\t// \t\tref.next.next.side=!bool;\r\n   \t\t\t// \t\tref.previous.side=!bool2;\r\n   \r\n   \t\t\t// \t\tvar firstChoose=game.players.randomGet();\r\n   \t\t\t// \t\tif(firstChoose.next.side==firstChoose.side){\r\n   \t\t\t// \t\t\tfirstChoose=firstChoose.next;\r\n   \t\t\t// \t\t}\r\n   \t\t\t// \t\t_status.firstAct=firstChoose;\r\n   \t\t\t// \t\tfor(var i=0;i<4;i++){\r\n   \t\t\t// \t\t\tfirstChoose.node.name.innerHTML=get.verticalStr(get.cnNumber(i+1,true)+'号位');\r\n   \t\t\t// \t\t\tfirstChoose=firstChoose.next;\r\n   \t\t\t// \t\t}\r\n   \r\n   \t\t\t// \t\tfor(var i=0;i<game.players.length;i++){\r\n   \t\t\t// \t\t\tif(game.players[i].side==game.me.side){\r\n   \t\t\t// \t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n   \t\t\t// \t\t\t}\r\n   \t\t\t// \t\t\telse{\r\n   \t\t\t// \t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n   \t\t\t// \t\t\t}\r\n   \t\t\t// \t\t\tgame.players[i].node.identity.dataset.color=game.players[i].side+'zhu';\r\n   \t\t\t// \t\t}\r\n   \t\t\t// \t\tvar list=[];\r\n   \t\t\t// \t\tfor(i in lib.character){\r\n   \t\t\t// \t\t\tif(!lib.filter.characterDisabled(i)){\r\n   \t\t\t// \t\t\t\tlist.push(i);\r\n   \t\t\t// \t\t\t}\r\n   \t\t\t// \t\t}\r\n   \t\t\t// \t\tvar choose=[];\r\n   \t\t\t// \t\t_status.characterlist=list;\r\n   \t\t\t// \t\tevent.filterChoice=function(name1,name2){\r\n   \t\t\t// \t\t\tvar info1=lib.character[name1];\r\n   \t\t\t// \t\t\tvar info2=lib.character[name2];\r\n   \t\t\t// \t\t\tif(!info1||!info2) return;\r\n   \t\t\t// \t\t\tvar num=0;\r\n   \t\t\t// \t\t\tif(info1[0]==info2[0]) num++;\r\n   \t\t\t// \t\t\tif(get.infoMaxHp(info1[2])==get.infoMaxHp(info2[2])) num++;\r\n   \t\t\t// \t\t\tif(info1[3].length==info2[3].length) num++;\r\n   \t\t\t// \t\t\treturn num>1;\r\n   \t\t\t// \t\t};\r\n   \t\t\t// \t\tvar list2=list.randomGets(8);\r\n   \t\t\t// \t\tvar next=game.me.chooseButton(2,true,['请选择您的武将牌',[list2,'character']]);\r\n   \t\t\t// \t\tnext.set('onfree',true);\r\n   \t\t\t// \t\tnext.set('filterButton',function(button){\r\n   \t\t\t// \t\t\tif(!ui.selected.buttons.length){\r\n   \t\t\t// \t\t\t\tfor(var i=0;i<list2.length;i++){\r\n   \t\t\t// \t\t\t\t\tif(list2[i]!=button.link&&event.filterChoice(button.link,list2[i])) return true;\r\n   \t\t\t// \t\t\t\t}\r\n   \t\t\t// \t\t\t\treturn false;\r\n   \t\t\t// \t\t\t}\r\n   \t\t\t// \t\t\treturn event.filterChoice(button.link,ui.selected.buttons[0].link)\r\n   \t\t\t// \t\t});\r\n   \t\t\t// \t\t'step 1'\r\n   \t\t\t// \t\tgame.me.init(result.links[0]);\r\n   \t\t\t// \t\tgame.me._backupCharacter=result.links[1];\r\n   \t\t\t// \t\t_status.characterlist.removeArray(result.links);\r\n   \t\t\t// \t\tvar list=_status.characterlist;\r\n   \t\t\t// \t\tfor(var i=0;i<game.players.length;i++){\r\n   \t\t\t// \t\t\tif(game.players[i]!=game.me){\r\n   \t\t\t// \t\t\t\tlist.randomSort();\r\n   \t\t\t// \t\t\t\tvar bool=false;\r\n   \t\t\t// \t\t\t\tfor(var k=0;k<list.length;k++){\r\n   \t\t\t// \t\t\t\t\tfor(var j=i+1;j<list.length;j++){\r\n   \t\t\t// \t\t\t\t\t\tif(event.filterChoice(list[k],list[j])){\r\n   \t\t\t// \t\t\t\t\t\t\tbool=true;\r\n   \t\t\t// \t\t\t\t\t\t\tgame.players[i].init(list[k]);\r\n   \t\t\t// \t\t\t\t\t\t\tgame.players[i]._backupCharacter=list[j];\r\n   \t\t\t// \t\t\t\t\t\t\tbreak;\r\n   \t\t\t// \t\t\t\t\t\t}\r\n   \t\t\t// \t\t\t\t\t}\r\n   \t\t\t// \t\t\t\t\tif(bool) break;\r\n   \t\t\t// \t\t\t\t}\r\n   \t\t\t// \t\t\t}\r\n   \t\t\t// \t\t}\r\n   \t\t\t// \t\tsetTimeout(function(){\r\n   \t\t\t// \t\t\tui.arena.classList.remove('choose-character');\r\n   \t\t\t// \t\t},500);\r\n   \t\t\t// \t\tif(get.config('two_phaseswap')){\r\n   \t\t\t// \t\t\tgame.addGlobalSkill('autoswap');\r\n   \t\t\t// \t\t\tif(lib.config.show_handcardbutton){\r\n   \t\t\t// \t\t\t\tui.versushs=ui.create.system('手牌',null,true);\r\n   \t\t\t// \t\t\t\tlib.setPopped(ui.versushs,game.versusHoverHandcards,220);\r\n   \t\t\t// \t\t\t}\r\n   \t\t\t// \t\t}\r\n   \t\t\t// \t});\r\n   \t\t\t// };\r\n\t\t\t// \t\t}\r\n\t\t\t// \t}\r\n\t\t\t// },\r\n\t\t\tqianlidanji:{\r\n\t\t\t\tname:'千里单骑',\r\n\t\t\t\tmode:'identity',\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tvar node=this;\r\n\t\t\t\t\tvar player1;\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tplayer1=ui.create.player(null,true).init('Bella');\r\n\t\t\t\t\t\tplayer1.node.marks.remove();\r\n\t\t\t\t\t\tplayer1.node.hp.remove();\r\n\t\t\t\t\t\tplayer1.style.left='20px';\r\n\t\t\t\t\t\tplayer1.style.top='20px';\r\n\t\t\t\t\t\tplayer1.style.transform='scale(0.9)';\r\n\t\t\t\t\t\tplayer1.node.count.remove();\r\n\t\t\t\t\t\tthis.appendChild(player1);//[todo player]\r\n\t\t\t\t\t\tthis.player1=player1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer1=this.player1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar rect1=player1.getBoundingClientRect();\r\n\t\t\t\t\tvar func=function(){\r\n\t\t\t\t\t\tvar player2=ui.create.player(null,true).init('caiyang');\r\n\t\t\t\t\t\tplayer2.node.marks.remove();\r\n\t\t\t\t\t\tplayer2.node.hp.remove();\r\n\t\t\t\t\t\tplayer2.style.left='auto';\r\n\t\t\t\t\t\tplayer2.style.right='20px';\r\n\t\t\t\t\t\tplayer2.style.top='20px';\r\n\t\t\t\t\t\tplayer2.node.count.remove();\r\n\t\t\t\t\t\tplayer2.style.transform='scale(0.7)';\r\n\t\t\t\t\t\tplayer2.style.opacity=0;\r\n\t\t\t\t\t\tnode.appendChild(player2);//[todo player]\r\n\t\t\t\t\t\tui.refresh(player2);\r\n\t\t\t\t\t\tplayer2.style.opacity=1;\r\n\t\t\t\t\t\tplayer2.style.transform='scale(0.9)';\r\n\t\t\t\t\t\tvar rect2=player2.getBoundingClientRect();\r\n\t\t\t\t\t\tvar left1=rect1.left+rect1.width/2-ui.arena.offsetLeft;\r\n\t\t\t\t\t\tvar left2=rect2.left+rect2.width/2-ui.arena.offsetLeft;\r\n\t\t\t\t\t\tvar top1=rect1.top+rect1.height/2-ui.arena.offsetTop;\r\n\t\t\t\t\t\tvar top2=rect2.top+rect2.height/2-ui.arena.offsetTop;\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n \t\t\t\t\t\tif(!player2) return;\r\n \t\t\t\t\t\tgame.linexy([left1,top1,left2,top2]);\r\n \t\t\t\t\t\tvar popup=ui.create.div('.damage');\r\n \t\t\t\t\t\tpopup.innerHTML='-1';\r\n \t\t\t\t\t\tpopup.dataset.nature='soil';\r\n \t\t\t\t\t\tplayer2.appendChild(popup);\r\n \t\t\t\t\t\tui.refresh(popup);\r\n \t\t\t\t\t\tpopup.classList.add('damageadded');\r\n \t\t\t\t\t\tpopup.listenTransition(function(){\r\n \t\t\t\t\t\t\tsetTimeout(function(){\r\n \t\t\t\t\t\t\t\tpopup.delete();\r\n \t\t\t\t\t\t\t},200);\r\n \t\t\t\t\t\t});\r\n\t\t\t\t\t\t},600);\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tif(!player2) return;\r\n\t\t\t\t\t\t\tplayer2.style.transition='all 0.5s';\r\n\t\t\t\t\t\t\tplayer2.style.transform='scale(1.2)';\r\n\t\t\t\t\t\t\tplayer2.delete();\r\n\t\t\t\t\t\t},1100);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnode.showcaseinterval=setInterval(func,2600);\r\n\t\t\t\t\tfunc();\r\n\t\t\t\t},\r\n\t\t\t\tintro:[\r\n\t\t\t\t\t'无尽而漫长的单挑试炼',\r\n\t\t\t\t\t(lib.config.qianlidanji_level?('你的最高纪录是连续通过'+lib.config.qianlidanji_level+'关，是否能够突破这一记录呢？'):'你能否过五关斩六将，击败古城战神蔡阳呢？'),\r\n\t\t\t\t],\r\n\t\t\t\tinit:function(){\r\n\t\t\t\t\tif(!_status.qianlidanji) _status.qianlidanji={\r\n\t\t\t\t\t\tcompleteNumber:0,\r\n\t\t\t\t\t\tused:['pujing','huban','caiyang'],\r\n\t\t\t\t\t\taddFellow:function(name){\r\n\t\t\t\t\t\t\tgame.fan.dataset.position = 2;\r\n\t\t\t\t\t\t\tui.arena.setNumber(3);\r\n\t\t\t\t\t\t\tgame.fellow = game.addFellow(1, name);\r\n\t\t\t\t\t\t\tgame.fellow.gain(get.cards(4));\r\n\t\t\t\t\t\t\tgame.fellow.identity = 'zhong';\r\n\t\t\t\t\t\t\tgame.fellow.setIdentity();\r\n\t\t\t\t\t\t\tgame.fellow.identityShown = true;\r\n\t\t\t\t\t\t\tgame.fellow.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t\t_status.event.getParent('phaseLoop').player = game.fellow;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcompleteReward:[\r\n\t\t\t\t\t\t\t['回复1点体力并摸一张牌',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.recover();\r\n\t\t\t\t\t\t\t\tgame.zhu.draw();\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['摸三张牌',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.draw(3);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['将一张防具牌置入装备区并摸一张牌',function(){\r\n\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\treturn get.subtype(card)=='equip2'&&!get.cardtag(card,'gifts');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(card) game.zhu.equip(card);\r\n\t\t\t\t\t\t\t\tgame.zhu.draw();\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['将一张武器牌置入装备区并摸一张牌',function(){\r\n\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\treturn get.subtype(card)=='equip1'&&!get.cardtag(card,'gifts');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(card) game.zhu.equip(card);\r\n\t\t\t\t\t\t\t\tgame.zhu.draw();\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['回复2点体力并弃置一张牌',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.recover(2);\r\n\t\t\t\t\t\t\t\tgame.zhu.chooseToDiscard('he',true);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['摸五张牌，然后弃置三张牌',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.draw(5);\r\n\t\t\t\t\t\t\t\tgame.zhu.chooseToDiscard(3,'he',true);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['摸五张牌，然后对手摸两张牌',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.draw(5);\r\n\t\t\t\t\t\t\t\tgame.fan.draw(2);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['将一张武器牌和一张防具牌置入装备区',function(){\r\n\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\treturn get.subtype(card)=='equip1'&&!get.cardtag(card,'gifts');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(card) game.zhu.equip(card);\r\n\t\t\t\t\t\t\t\tvar card2=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\treturn get.subtype(card)=='equip2'&&!get.cardtag(card,'gifts');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(card2) game.zhu.equip(card2);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['将一张武器牌和一张防御坐骑牌置入装备区',function(){\r\n\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\treturn get.subtype(card)=='equip1'&&!get.cardtag(card,'gifts');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(card) game.zhu.equip(card);\r\n\t\t\t\t\t\t\t\tvar card2=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\treturn get.subtype(card)=='equip3'&&!get.cardtag(card,'gifts');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(card2) game.zhu.equip(card2);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['弃置所有手牌并于下一关获得【涅槃】(标)',function(){\r\n\t\t\t\t\t\t\t\tvar hs=game.zhu.getCards('h');\r\n\t\t\t\t\t\t\t\tif(hs.length) game.zhu.discard(hs);\r\n\t\t\t\t\t\t\t\tgame.zhu.addSkill('oldniepan');\r\n\t\t\t\t\t\t\t\tgame.zhu.restoreSkill('oldniepan');\r\n\t\t\t\t\t\t\t\tgame.zhu._oldniepan=true;\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['获得两张锦囊牌',function(){\r\n\t\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\t\twhile(list.length<2){\r\n\t\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\t\treturn !list.contains(card)&&get.type(card,'trick')=='trick';\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tif(!card) break;\r\n\t\t\t\t\t\t\t\t\tlist.push(card);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(list.length) game.zhu.gain(list,'gain2','log');\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['将体力回复至体力上限，然后弃置一张牌',function(){\r\n\t\t\t\t\t\t\t\tvar num=game.zhu.maxHp-game.zhu.hp;\r\n\t\t\t\t\t\t\t\tif(num) game.zhu.recover(num);\r\n\t\t\t\t\t\t\t\tgame.zhu.chooseToDiscard('he',true);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['弃置两张牌，在下一关的第一个回合后进行一个额外的回合',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.chooseToDiscard(2,true,'he');\r\n\t\t\t\t\t\t\t\tgame.zhu.addSkill('qianlidanji_phase');\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['摸一张牌，然后将对手翻面',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.draw();\r\n\t\t\t\t\t\t\t\tgame.fan.turnOver(true);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['摸一张牌，然后令对手受到1点伤害',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.draw();\r\n\t\t\t\t\t\t\t\tgame.fan.damage(game.zhu);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['获得五张基本牌',function(){\r\n\t\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\t\twhile(list.length<5){\r\n\t\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\t\treturn !list.contains(card)&&get.type(card)=='basic';\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tif(!card) break;\r\n\t\t\t\t\t\t\t\t\tlist.push(card);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(list.length) game.zhu.gain(list,'gain2','log');\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['失去1点体力，然后摸五张牌',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.loseHp();\r\n\t\t\t\t\t\t\t\tgame.zhu.draw(5);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['失去体力至1点，然后摸七张牌',function(){\r\n\t\t\t\t\t\t\t\tvar num=game.zhu.hp-1;\r\n\t\t\t\t\t\t\t\tif(num) game.zhu.loseHp(num);\r\n\t\t\t\t\t\t\t\tgame.zhu.draw(7)\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['弃置一张牌，然后令对手受到2点伤害',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.chooseToDiscard('he',true);\r\n\t\t\t\t\t\t\t\tgame.fan.damage(game.zhu,2);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['在下一关中召唤普净一同战斗',function(){\r\n\t\t\t\t\t\t\t\t_status.qianlidanji.addFellow('pujing');\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['在下一关中召唤胡班一同战斗',function(){\r\n\t\t\t\t\t\t\t\t_status.qianlidanji.addFellow('huban');\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['将一张宝物牌置入装备区并摸一张牌',function(){\r\n\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\treturn get.subtype(card)=='equip5'&&!get.cardtag(card,'gifts');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(card) game.zhu.equip(card);\r\n\t\t\t\t\t\t\t\tgame.zhu.draw();\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['摸五张牌，然后将自己翻面',function(){\r\n\t\t\t\t\t\t\t\tgame.zhu.draw(5);\r\n\t\t\t\t\t\t\t\tgame.zhu.turnOver(true);\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t\t['获得一张【酒】和一张【杀】',function(){\r\n\t\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\t\treturn card.name=='sha';\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(card) list.push(card);\r\n\t\t\t\t\t\t\t\tvar card=get.cardPile(function(card){\r\n\t\t\t\t\t\t\t\t\t\treturn card.name=='jiu';\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(card) list.push(card);\r\n\t\t\t\t\t\t\t\tif(list.length) game.zhu.gain(list,'gain2','log');\r\n\t\t\t\t\t\t\t}],\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\treplace_character:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tif(game.zhu._oldniepan){\r\n\t\t\t\t\t\t\t\tgame.zhu.removeSkill('oldniepan');\r\n\t\t\t\t\t\t\t\tdelete game.zhu._oldniepan;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_status.qianlidanji.completeNumber++;\r\n\t\t\t\t\t\t\tif(!lib.config.qianlidanji_level||lib.config.qianlidanji_level<_status.qianlidanji.completeNumber){\r\n\t\t\t\t\t\t\t\tlib.config.qianlidanji_level=_status.qianlidanji.completeNumber;\r\n\t\t\t\t\t\t\t\tgame.saveConfig('qianlidanji_level',lib.config.qianlidanji_level);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(game.fellow&&game.fellow.isAlive()){\r\n   \t\t\t\t\tif(ui.land&&ui.land.player==game.fellow){\r\n   \t\t\t\t\t\tgame.addVideo('destroyLand');\r\n   \t\t\t\t\t\tui.land.destroy();\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tgame.zhu.next=game.fan;\r\n   \t\t\t\t\tgame.fan.next=game.zhu;\r\n   \t\t\t\t\tgame.zhu.nextSeat=game.fan;\r\n   \t\t\t\t\tgame.fan.nextSeat=game.zhu;\r\n  \t\t\t\t\t\tgame.players.remove(game.fellow);\r\n  \t\t\t\t\t\t_status.dying.remove(game.fellow);\r\n  \t\t\t\t\t\tgame.fellow.out();\r\n  \t\t\t\t\t\tfor(var mark in game.fellow.marks){\r\n  \t\t\t\t\t\t\tgame.fellow.unmarkSkill(mark);\r\n  \t\t\t\t\t\t}\r\n  \t\t\t\t\t\twhile(game.fellow.node.marks.childNodes.length>1){\r\n  \t\t\t\t\t\t\tgame.fellow.node.marks.lastChild.remove();\r\n  \t\t\t\t\t\t}\r\n   \t\t\t\t\tfor(var i in game.fellow.tempSkills){\r\n   \t\t\t\t\t\tgame.fellow.removeSkill(i);\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tvar skills=game.fellow.getSkills();\r\n   \t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n   \t\t\t\t\t\tif(lib.skill[skills[i]].temp){\r\n   \t\t\t\t\t\t\tgame.fellow.removeSkill(skills[i]);\r\n   \t\t\t\t\t\t}\r\n   \t\t\t\t\t}\r\n  \t\t\t\t\t\tvar cards=game.fellow.getCards('hej');\t\t\r\n\t\t\t\t\t\t\t\twhile(cards.length){\r\n\t\t\t\t\t\t\t\t\tui.discardPile.appendChild(cards.shift());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(game.fellow){\r\n\t\t\t\t\t\t\t\tgame.dead.remove(game.fellow);\r\n\t\t\t\t\t\t\t\tgame.fellow.remove();\r\n\t\t\t\t\t\t\t\tgame.fan.dataset.position=1;\r\n\t\t\t\t\t\t\t\tui.arena.setNumber(2);\r\n   \t\t\t\t\tgame.zhu.next=game.fan;\r\n   \t\t\t\t\tgame.fan.next=game.zhu;\r\n   \t\t\t\t\tgame.zhu.nextSeat=game.fan;\r\n   \t\t\t\t\tgame.fan.nextSeat=game.zhu;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(_status.qianlidanji.completeNumber!=5){\r\n \t\t\t\t\t\t\tvar list=_status.qianlidanji.completeReward.randomGets(3);\r\n \t\t\t\t\t\t\tvar list2=[];\r\n \t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n \t\t\t\t\t\t\t\tlist2.push(list[i][1]);\r\n \t\t\t\t\t\t\t\tlist[i]=list[i][0];\r\n \t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\tif(_status.qianlidanji.completeNumber>=6){\r\n \t\t\t\t\t\t\t\tlist.push('我不想再打了，直接在这里结束吧！');\r\n \t\t\t\t\t\t\t\tlist2.push(function(){\r\n \t\t\t\t\t\t\t\t\tgame.over(true);\r\n \t\t\t\t\t\t\t\t});\r\n \t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\tevent.list=list2;\r\n \t\t\t\t\t\t\tgame.zhu.chooseControl().set('choiceList',list).set('prompt','请选择一项奖励（当前已通过'+_status.qianlidanji.completeNumber+'关）');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tif(_status.qianlidanji.completeNumber!=5){\r\n\t\t\t\t\t\t\t\tif(result.index==3){\r\n\t\t\t\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tevent.reward=event.list[result.index];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_status.characterlist.removeArray(_status.qianlidanji.used);\r\n\t\t\t\t\t\t\tif(_status.qianlidanji.completeNumber==5) event._result={links:['caiyang']};\r\n\t\t\t\t\t\t\telse game.zhu.chooseButton(['选择下一关出战的对手',[_status.characterlist.randomGets(3),'character']],true);\r\n\t\t\t\t\t\t\t'step 3'\r\n\t\t\t\t\t\t\t_status.event.getParent('phaseLoop').player=game.zhu;\r\n\t\t\t\t\t\t\tvar source=game.fan;\r\n\t\t\t\t\t\t\tvar name=result.links[0];\r\n \t\t\t\t\t\tsource.revive(null,false);\r\n \t\t\t\t\t\t_status.characterlist.remove(name);\r\n \t\t\t\t\t\t_status.qianlidanji.used.push(name);\r\n \t\t\t\t\t\tsource.uninit();\r\n \t\t\t\t\t\tsource.init(name);\r\n \t\t\t\t\t\tgame.addVideo('reinit',source,[name]);\r\n \t\t\t\t\t\tsource.lose(source.getCards('hej'))._triggered=null;\r\n \t\t\t\t\t\tvar gain=4;\r\n \t\t\t\t\t\tvar add=0;\r\n \t\t\t\t\t\tswitch(_status.qianlidanji.completeNumber){\r\n \t\t\t\t\t\t\tcase 5:break;\r\n \t\t\t\t\t\t\tcase 1:gain=5;break;\r\n \t\t\t\t\t\t\tcase 2:gain=5;add=1;break;\r\n \t\t\t\t\t\t\tcase 3:gain=6;add=1;break;\r\n \t\t\t\t\t\t\tdefault:gain=6;add=2;break;\r\n \t\t\t\t\t\t};\r\n \t\t\t\t\t\tsource.hp+=add;\r\n \t\t\t\t\t\tsource.maxHp+=add;\r\n \t\t\t\t\t\tsource.update();\r\n \t\t\t\t\t\tsource.gain(get.cards(gain))._triggered=null;\r\n \t\t\t\t\t\tgame.triggerEnter(source);\r\n \t\t\t\t\t\tif(event.reward) event.reward();\r\n \t\t\t\t\t\t'step 4'\r\n \t\t\t\t\t\tvar cards=Array.from(ui.ordering.childNodes);\r\n\t\t\t\t\t\t\twhile(cards.length){\r\n\t\t\t\t\t\t\t\tcards.shift().discard();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar evt=_status.event.getParent('phase');\r\n\t\t\t\t\t\t\tif(evt){\r\n\t\t\t\t\t\t\t\tgame.resetSkills();\r\n \t\t\t\t\t\t\t_status.event=evt;\r\n\t\t\t\t\t\t\t\t_status.event.finish();\r\n\t\t\t\t\t\t\t\t_status.event.untrigger(true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\t\t\t\t\t_status.qianlidanji.player_number=get.config('player_number');\r\n\t\t\t\t\tgame.saveConfig('player_number','2','identity');\r\n\t\t\t\t},\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tsubmode:'normal',\r\n\t\t\t\t\tchooseCharacterBefore:function(){\r\n   \t\t\tgame.identityVideoName='千里单骑';\r\n   \t\t\tgame.saveConfig('player_number',_status.qianlidanji.player_number,'identity');\r\n   \t\t\tgame.chooseCharacter=function(){\r\n      \tvar next=game.createEvent('chooseCharacter',false);\r\n   \t\t\t\tnext.showConfig=true;\r\n   \t\t\t\tnext.setContent(function(){\r\n   \t\t\t\t\t\"step 0\"\r\n   \t\t\t\t\tui.arena.classList.add('choose-character');\r\n   \t\t\t\t\tgame.me.identity='zhu';\r\n   \t\t\t\t\tgame.zhu=game.me;\r\n   \t\t\t\t\tgame.fan=game.me.next;\r\n   \t\t\t\t\tgame.fan.identity='fan';\r\n   \t\t\t\t\tgame.zhu.setIdentity();\r\n   \t\t\t\t\tgame.zhu.identityShown=true;\r\n   \t\t\t\t\tgame.zhu.node.identity.classList.remove('guessing');\r\n   \t\t\t\t\tgame.fan.setIdentity();\r\n   \t\t\t\t\tgame.fan.identityShown=true;\r\n   \t\t\t\t\tgame.fan.node.identity.classList.remove('guessing');\r\n   \t\t\t\t\t\r\n   \t\t\t\t\tevent.list=[];\r\n   \t\t\t\t\tfor(var i in lib.character){\r\n   \t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n   \t\t\t\t\t\tevent.list.push(i);\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tevent.list.randomSort();\r\n   \t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n   \t\t\t\t\tvar list=event.list.slice(0,5);\r\n   \t\t\t\t\tdelete event.swapnochoose;\r\n   \t\t\t\t\tvar dialog;\r\n   \t\t\t\t\tif(event.swapnodialog){\r\n   \t\t\t\t\t\tdialog=ui.dialog;\r\n   \t\t\t\t\t\tevent.swapnodialog(dialog,list);\r\n   \t\t\t\t\t\tdelete event.swapnodialog;\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\telse{\r\n   \t\t\t\t\t\tvar str='选择角色';\r\n   \t\t\t\t\t\tdialog=ui.create.dialog(str,'hidden',[list,'character']);\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tdialog.setCaption('选择角色');\r\n   \t\t\t\t\tgame.me.chooseButton(dialog,true).set('onfree',true);\r\n   \t\t\t\t\t\r\n   \t\t\t\t\tui.create.cheat=function(){\r\n   \t\t\t\t\t\t_status.createControl=ui.cheat2;\r\n   \t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n   \t\t\t\t\t\t\tif(ui.cheat2&&ui.cheat2.dialog==_status.event.dialog){\r\n   \t\t\t\t\t\t\t\treturn;\r\n   \t\t\t\t\t\t\t}\r\n   \t\t\t\t\t\t\tif(game.changeCoin){\r\n   \t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n   \t\t\t\t\t\t\t}\r\n   \t\t\t\t\t\t\t\r\n   \t\t\t\t\t\t\tevent.list.randomSort();\r\n   \t\t\t\t\t\t\tlist=event.list.slice(0,5);\r\n   \t\t\t\t\t\t\t\r\n   \t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n   \t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n   \t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list,'character',buttons);\r\n   \t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n   \t\t\t\t\t\t\tbuttons.animate('start');\r\n   \t\t\t\t\t\t\tnode.remove();\r\n   \t\t\t\t\t\t\tgame.uncheck();\r\n   \t\t\t\t\t\t\tgame.check();\r\n   \t\t\t\t\t\t});\r\n   \t\t\t\t\t\tdelete _status.createControl;\r\n   \t\t\t\t\t};\r\n   \t\t\t\t\tif(lib.onfree){\r\n   \t\t\t\t\t\tlib.onfree.push(function(){\r\n   \t\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n   \t\t\t\t\t\t\tif(ui.cheat2){\r\n   \t\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx',500);\r\n   \t\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n   \t\t\t\t\t\t\t}\r\n   \t\t\t\t\t\t});\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\telse{\r\n   \t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n   \t\t\t\t\t}\r\n   \r\n   \t\t\t\t\tui.create.cheat2=function(){\r\n   \t\t\t\t\t\tui.cheat2=ui.create.control('自由选将',function(){\r\n   \t\t\t\t\t\t\tif(this.dialog==_status.event.dialog){\r\n   \t\t\t\t\t\t\t\tif(game.changeCoin){\r\n   \t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n   \t\t\t\t\t\t\t\t}\r\n   \t\t\t\t\t\t\t\tthis.dialog.close();\r\n   \t\t\t\t\t\t\t\t_status.event.dialog=this.backup;\r\n   \t\t\t\t\t\t\t\tthis.backup.open();\r\n   \t\t\t\t\t\t\t\tdelete this.backup;\r\n   \t\t\t\t\t\t\t\tgame.uncheck();\r\n   \t\t\t\t\t\t\t\tgame.check();\r\n   \t\t\t\t\t\t\t\tif(ui.cheat){\r\n   \t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx',500);\r\n   \t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n   \t\t\t\t\t\t\t\t}\r\n   \t\t\t\t\t\t\t}\r\n   \t\t\t\t\t\t\telse{\r\n   \t\t\t\t\t\t\t\tif(game.changeCoin){\r\n   \t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n   \t\t\t\t\t\t\t\t}\r\n   \t\t\t\t\t\t\t\tthis.backup=_status.event.dialog;\r\n   \t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n   \t\t\t\t\t\t\t\t_status.event.dialog=_status.event.parent.dialogxx;\r\n   \t\t\t\t\t\t\t\tthis.dialog=_status.event.dialog;\r\n   \t\t\t\t\t\t\t\tthis.dialog.open();\r\n   \t\t\t\t\t\t\t\tgame.uncheck();\r\n   \t\t\t\t\t\t\t\tgame.check();\r\n   \t\t\t\t\t\t\t\tif(ui.cheat){\r\n   \t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n   \t\t\t\t\t\t\t\t}\r\n   \t\t\t\t\t\t\t}\r\n   \t\t\t\t\t\t});\r\n   \t\t\t\t\t\tif(lib.onfree){\r\n   \t\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n   \t\t\t\t\t\t}\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tif(!_status.brawl||!_status.brawl.chooseCharacterFixed){\r\n   \t\t\t\t\t\tif(!ui.cheat&&get.config('change_choice'))\r\n   \t\t\t\t\t\tui.create.cheat();\r\n   \t\t\t\t\t\tif(!ui.cheat2&&get.config('free_choose'))\r\n   \t\t\t\t\t\tui.create.cheat2();\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\t\"step 1\"\r\n   \t\t\t\t\tif(ui.cheat){\r\n   \t\t\t\t\t\tui.cheat.close();\r\n   \t\t\t\t\t\tdelete ui.cheat;\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tif(ui.cheat2){\r\n   \t\t\t\t\t\tui.cheat2.close();\r\n   \t\t\t\t\t\tdelete ui.cheat2;\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link);\r\n   \t\t\t\t\tgame.zhu.init(result.buttons[0].link);\r\n   \t\t\t\t\t_status.characterlist.remove(result.buttons[0].link);\r\n   \t\t\t\t\t_status.qianlidanji.used.add(result.buttons[0].link);\r\n   \t\t\t\t\tgame.zhu.chooseControl('地狱','困难','普通','简单','无双').set('prompt','请选择游戏难度');\r\n   \t\t\t\t\t\"step 2\"\r\n   \t\t\t\t\tvar hp=Math.floor(result.index/2);\r\n   \t\t\t\t\tevent.draw=Math.floor((result.index+1)/2);\r\n   \t\t\t\t\tif(hp){\r\n   \t\t\t\t\t\tgame.zhu.hp+=hp;\r\n   \t\t\t\t\t\tgame.zhu.maxHp+=hp;\r\n   \t\t\t\t\t\tgame.zhu.update();\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tgame.zhu.chooseButton(['请选择对手的登场武将',[_status.characterlist.randomGets(3),'character']],true);\r\n   \t\t\t\t\t\"step 3\"\r\n   \t\t\t\t\tgame.fan.init(result.links[0]);\r\n   \t\t\t\t\t_status.characterlist.remove(result.links[0]);\r\n   \t\t\t\t\t_status.qianlidanji.used.add(result.links[0]);\r\n   \t\t\t\t\tif(event.draw){\r\n   \t\t\t\t\t\tgame.zhu.directgain(get.cards(event.draw));\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tsetTimeout(function(){\r\n   \t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n   \t\t\t\t\t},500);\r\n   \t\t\t\t\t\r\n   \t\t\t\t\tvar pack={\r\n   \t\t\t\t\t\tcharacter:{\r\n   \t\t\t\t\t\t\tpujing:['male','qun',1,[],[]],\r\n   \t\t\t\t\t\t\thuban:['male','qun',2,[],[]],\r\n   \t\t\t\t\t\t\tcaiyang:['male','qun',1,['zhuixi'],[]],\r\n   \t\t\t\t\t\t},\r\n   \t\t\t\t\t\ttranslate:{\r\n   \t\t\t\t\t\t\tpujing:'普净',\r\n   \t\t\t\t\t\t\thuban:'胡班',\r\n   \t\t\t\t\t\t},\r\n   \t\t\t\t\t\tskill:{\r\n   \t\t\t\t\t\t\tqianlidanji_phase:{\r\n   \t\t\t\t\t\t\t\ttrigger:{global:'phaseBefore'},\r\n   \t\t\t\t\t\t\t\tforced:true,\r\n   \t\t\t\t\t\t\t\tsilent:true,\r\n   \t\t\t\t\t\t\t\tfirstDo:true,\r\n   \t\t\t\t\t\t\t\tcontent:function(){\r\n   \t\t\t\t\t\t\t\t\tplayer.removeSkill('qianlidanji_phase');\r\n   \t\t\t\t\t\t\t\t\tplayer.insertPhase();\r\n   \t\t\t\t\t\t\t\t},\r\n   \t\t\t\t\t\t\t},\r\n   \t\t\t\t\t\t},\r\n   \t\t\t\t\t};\r\n   \t\t\t\t\tfor(var i in pack){\r\n   \t\t\t\t\t\tfor(var j in pack[i]){\r\n   \t\t\t\t\t\t\tlib[i][j]=pack[i][j];\r\n   \t\t\t\t\t\t}\r\n   \t\t\t\t\t}\r\n   \t\t\t\t\tdelete pack.skill;\r\n  \t\t\t\t\t\tgame.addVideo('arrangeLib',null,pack);\r\n  \t\t\t\t\t\tgame.addOverDialog=function(dialog){\r\n  \t\t\t\t\t\t\tdialog.addText('共计通过'+_status.qianlidanji.completeNumber+'关');\r\n  \t\t\t\t\t\t};\r\n  \t\t\t\t\t\tlib.element.player.dieAfter=function(){\r\n  \t\t\t\t\t\t\tif(this==game.fellow) return;\r\n  \t\t\t\t\t\t\t_status.characterlist.removeArray(_status.qianlidanji.used);\r\n  \t\t\t\t\t\t\tif(game.zhu==this||!_status.characterlist.length){\r\n  \t\t\t\t\t\t\t\tvar bool=false;\r\n  \t\t\t\t\t\t\t\tif(_status.qianlidanji.completeNumber>5) bool=true;\r\n  \t\t\t\t\t\t\t\tgame.over(bool);\r\n  \t\t\t\t\t\t\t}\r\n  \t\t\t\t\t\t\telse{\r\n  \t\t\t\t\t\t\t\tvar next=game.createEvent('qianlidanji_replace',false);\r\n  \t\t\t\t\t\t\t\tnext.setContent(_status.qianlidanji.replace_character);\r\n  \t\t\t\t\t\t\t}\r\n  \t\t\t\t\t\t};\r\n  \t\t\t\t\t\tlib.element.player.dieAfter2=function(){\r\n  \t\t\t\t\t\t\t_status.characterlist.removeArray(_status.qianlidanji.used);\r\n  \t\t\t\t\t\t};\r\n  \t\t\t\t\t\tgame.zhu.dieAfter=lib.element.player.dieAfter;\r\n  \t\t\t\t\t\tgame.fan.dieAfter=lib.element.player.dieAfter;\r\n  \t\t\t\t\t\tgame.zhu.dieAfter2=lib.element.player.dieAfter2;\r\n  \t\t\t\t\t\tgame.fan.dieAfter2=lib.element.player.dieAfter2;\r\n   \t\t\t\t});\r\n   \t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tscene:{\r\n\t\t\t\tname:'创建场景',\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tsubmode:'normal'\r\n\t\t\t\t},\r\n\t\t\t\tnostart:true,\r\n\t\t\t\tfullshow:true,\r\n\t\t\t\ttemplate:{\r\n\t\t\t\t\tmode:'identity',\r\n\t\t\t\t\tinit:function(){\r\n\t\t\t\t\t\tgame.saveConfig('double_character',false,'identity');\r\n\t\t\t\t\t\t_status.brawl.playerNumber=_status.brawl.scene.players.length;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\t\tif(init){\r\n\t\t\t\t\t\t\tvar name=lib.brawl[this.link].name;\r\n\t\t\t\t\t\t\tvar scene=lib.storage.scene[name];\r\n\t\t\t\t\t\t\tui.create.node('button','编辑场景',this,function(){\r\n\t\t\t\t\t\t\t\t_status.sceneToLoad=scene;\r\n\t\t\t\t\t\t\t\tgame.switchScene();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(_status.extensionmade.contains(name)){\r\n\t\t\t\t\t\t\t\tui.create.node('button','管理扩展',this,function(){\r\n\t\t\t\t\t\t\t\t\tui.click.configMenu();\r\n\t\t\t\t\t\t\t\t\tui.click.extensionTab(name);\r\n\t\t\t\t\t\t\t\t},{marginLeft:'6px'});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tui.create.node('button','删除场景',this,function(){\r\n\t\t\t\t\t\t\t\t\tif(confirm('确定删除'+name+'？')){\r\n\t\t\t\t\t\t\t\t\t\tgame.removeScene(name);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},{marginLeft:'6px'});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.create.node('button','导出扩展',this,function(){\r\n\t\t\t\t\t\t\t\tvar str='{name:\"'+name+'\",content:function(){\\nif(lib.config.mode==\"brawl\"){\\n'+\r\n\t\t\t\t\t\t\t\t'if(!lib.storage.scene) lib.storage.scene={};\\n'+\r\n\t\t\t\t\t\t\t\t'if(!lib.storage.scene[\"'+name+'\"]){\\nlib.storage.scene[\"'+name+'\"]='+get.stringify(scene)+';\\n_status.extensionscene=true;}\\n'+\r\n\t\t\t\t\t\t\t\t'if(!_status.extensionmade) _status.extensionmade=[];\\n'+\r\n\t\t\t\t\t\t\t\t'_status.extensionmade.push(\"'+name+'\");\\n}}\\n}';\r\n\t\t\t\t\t\t\t\tvar extension={'extension.js':'game.import(\"extension\",function(lib,game,ui,get,ai,_status){return '+str+'})'};\r\n\t\t\t\t\t\t\t\tgame.importExtension(extension,null,name);\r\n\t\t\t\t\t\t\t},{marginLeft:'6px'});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcontent:{\r\n\t\t\t\t\t\tsubmode:'normal',\r\n\t\t\t\t\t\tnoAddSetting:true,\r\n\t\t\t\t\t\tidentityShown:true,\r\n\t\t\t\t\t\torderedPile:true,\r\n\t\t\t\t\t\tcardPile:function(list){\r\n\t\t\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\t\t\tvar scene=_status.brawl.scene;\r\n\t\t\t\t\t\t\tvar inpile=[];\r\n\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\tif(lib.card[list[i][2]]){\r\n\t\t\t\t\t\t\t\t\tif(lib.config.bannedcards.contains(list[i][2])) continue;\r\n\t\t\t\t\t\t\t\t\tif(game.bannedcards&&game.bannedcards.contains(list[i][2])) continue;\r\n\t\t\t\t\t\t\t\t\tinpile.add(list[i][2]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar parseInfo=function(info){\r\n\t\t\t\t\t\t\t\tvar info2=[];\r\n\t\t\t\t\t\t\t\tif(info[1]=='random'){\r\n\t\t\t\t\t\t\t\t\tinfo2.push(['club','spade','heart','diamond'].randomGet());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tinfo2.push(info[1]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(info[2]=='random'){\r\n\t\t\t\t\t\t\t\t\tinfo2.push(Math.ceil(Math.random()*13));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tinfo2.push(info[2]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(info[0]=='random'){\r\n\t\t\t\t\t\t\t\t\tinfo2.push(inpile.randomGet());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tinfo2.push(info[0]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn info2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(scene.replacepile){\r\n\t\t\t\t\t\t\t\tlist.length=0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=scene.cardPileTop.length-1;i>=0;i--){\r\n\t\t\t\t\t\t\t\tlist.unshift(parseInfo(scene.cardPileTop[i]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.cardPileBottom.length;i++){\r\n\t\t\t\t\t\t\t\tlist.push(parseInfo(scene.cardPileBottom[i]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.discardPile.length;i++){\r\n\t\t\t\t\t\t\t\tui.create.card(ui.discardPile).init(parseInfo(scene.discardPile[i]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn list;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tgameStart:function(){\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tgame.players[i].node.marks.show();\r\n\t\t\t\t\t\t\t\tgame.players[i].node.name.show();\r\n\t\t\t\t\t\t\t\tgame.players[i].node.name2.show();\r\n\t\t\t\t\t\t\t\tvar info=game.players[i].brawlinfo;\r\n\t\t\t\t\t\t\t\tif(info.maxHp){\r\n\t\t\t\t\t\t\t\t\tgame.players[i].maxHp=info.maxHp;\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].hp>game.players[i].maxHp){\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].hp=game.players[i].maxHp;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(info.hp){\r\n\t\t\t\t\t\t\t\t\tgame.players[i].hp=info.hp;\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].hp>game.players[i].maxHp){\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].maxHp=game.players[i].hp;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.players[i].update();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar scene=_status.brawl.scene;\r\n\t\t\t\t\t\t\tvar over=function(str){\r\n\t\t\t\t\t\t\t\tswitch(str){\r\n\t\t\t\t\t\t\t\t\tcase 'win':game.over(true);break;\r\n\t\t\t\t\t\t\t\t\tcase 'lose':game.over(false);break;\r\n\t\t\t\t\t\t\t\t\tcase 'tie':game.over('平局');break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(scene.turns){\r\n\t\t\t\t\t\t\t\tvar turns=scene.turns[0];\r\n\t\t\t\t\t\t\t\tlib.onphase.push(function(){\r\n\t\t\t\t\t\t\t\t\tturns--;\r\n\t\t\t\t\t\t\t\t\tif(turns<0){\r\n\t\t\t\t\t\t\t\t\t\tover(scene.turns[1]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(scene.washes){\r\n\t\t\t\t\t\t\t\tvar washes=scene.washes[0];\r\n\t\t\t\t\t\t\t\tlib.onwash.push(function(){\r\n\t\t\t\t\t\t\t\t\twashes--;\r\n\t\t\t\t\t\t\t\t\tif(washes<=0){\r\n\t\t\t\t\t\t\t\t\t\tover(scene.washes[1]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tchooseCharacterBefore:function(){\r\n\t\t\t\t\t\t\tvar scene=_status.brawl.scene;\r\n\t\t\t\t\t\t\tvar playercontrol=[];\r\n\t\t\t\t\t\t\tvar maxpos=0;\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(scene.players[i].playercontrol){\r\n\t\t\t\t\t\t\t\t\tplayercontrol.push(scene.players[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tmaxpos=Math.max(maxpos,scene.players[i].position);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(maxpos<scene.players.length){\r\n\t\t\t\t\t\t\t\tmaxpos=scene.players.length;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar posmap=[];\r\n\t\t\t\t\t\t\tfor(var i=1;i<=maxpos;i++){\r\n\t\t\t\t\t\t\t\tposmap.push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(scene.players[i].position){\r\n\t\t\t\t\t\t\t\t\tposmap.remove(scene.players[i].position);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(!scene.players[i].position){\r\n\t\t\t\t\t\t\t\t\tscene.players[i].position=posmap.randomRemove();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(playercontrol.length){\r\n\t\t\t\t\t\t\t\tgame.me.brawlinfo=playercontrol.randomGet();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.me.brawlinfo=scene.players.randomGet();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar getpos=function(info){\r\n\t\t\t\t\t\t\t\tvar dp=info.position-game.me.brawlinfo.position;\r\n\t\t\t\t\t\t\t\tif(dp<0){\r\n\t\t\t\t\t\t\t\t\tdp+=maxpos;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn dp;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tscene.players.sort(function(a,b){\r\n\t\t\t\t\t\t\t\treturn getpos(a)-getpos(b);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tvar target=game.me;\r\n\t\t\t\t\t\t\tvar createCard=function(info){\r\n\t\t\t\t\t\t\t\tvar info2=[];\r\n\t\t\t\t\t\t\t\tif(info[1]=='random'){\r\n\t\t\t\t\t\t\t\t\tinfo2.push(['club','spade','heart','diamond'].randomGet());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tinfo2.push(info[1]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(info[2]=='random'){\r\n\t\t\t\t\t\t\t\t\tinfo2.push(Math.ceil(Math.random()*13));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tinfo2.push(info[2]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(info[0]=='random'){\r\n\t\t\t\t\t\t\t\t\tinfo2.push(lib.inpile.randomGet());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tinfo2.push(info[0]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn ui.create.card().init(info2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_status.firstAct=game.me;\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.players.length;i++){\r\n\t\t\t\t\t\t\t\tvar info=scene.players[i];\r\n\t\t\t\t\t\t\t\ttarget.brawlinfo=info;\r\n\t\t\t\t\t\t\t\ttarget.identity=info.identity;\r\n\t\t\t\t\t\t\t\ttarget.setIdentity(info.identity);\r\n\t\t\t\t\t\t\t\ttarget.node.marks.hide();\r\n\t\t\t\t\t\t\t\tif(info.name2!='none'&&info.name2!='random'){\r\n\t\t\t\t\t\t\t\t\tif(info.name=='random'){\r\n\t\t\t\t\t\t\t\t\t\ttarget.init(info.name2,info.name2);\r\n\t\t\t\t\t\t\t\t\t\ttarget.node.name.hide();\r\n\t\t\t\t\t\t\t\t\t\ttarget.node.avatar.hide();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\ttarget.init(info.name,info.name2);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tif(info.name!='random'){\r\n\t\t\t\t\t\t\t\t\t\tif(info.name2=='random'){\r\n\t\t\t\t\t\t\t\t\t\t\ttarget.init(info.name,info.name);\r\n\t\t\t\t\t\t\t\t\t\t\ttarget.node.name2.hide();\r\n\t\t\t\t\t\t\t\t\t\t\ttarget.node.avatar2.hide();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\ttarget.init(info.name);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(info.linked) target.classList.add('linked');\r\n\t\t\t\t\t\t\t\tif(info.turnedover) target.classList.add('turnedover');\r\n\t\t\t\t\t\t\t\tif(info.position<_status.firstAct.brawlinfo.position) _status.firstAct=target;\r\n\t\t\t\t\t\t\t\tvar hs=[];\r\n\t\t\t\t\t\t\t\tfor(var j=0;j<info.handcards.length;j++){\r\n\t\t\t\t\t\t\t\t\ths.push(createCard(info.handcards[j]));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(hs.length){\r\n\t\t\t\t\t\t\t\t\ttarget.directgain(hs);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfor(var j=0;j<info.equips.length;j++){\r\n\t\t\t\t\t\t\t\t\ttarget.$equip(createCard(info.equips[j]));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfor(var j=0;j<info.judges.length;j++){\r\n\t\t\t\t\t\t\t\t\ttarget.node.judges.appendChild(createCard(info.judges[j]));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\ttarget=target.next;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tchooseCharacterAi:function(player,list,list2){\r\n\t\t\t\t\t\t\tvar info=player.brawlinfo;\r\n\t\t\t\t\t\t\tif(info.name2!='none'){\r\n\t\t\t\t\t\t\t\tif(info.name=='random'&&info.name2=='random'){\r\n\t\t\t\t\t\t\t\t\tlist=list.slice(0);\r\n\t\t\t\t\t\t\t\t\tplayer.init(list.randomRemove(),list.randomRemove());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(info.name=='random'){\r\n\t\t\t\t\t\t\t\t\tplayer.init(list.randomGet(),info.name2);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(info.name2=='random'){\r\n\t\t\t\t\t\t\t\t\tplayer.init(info.name,list.randomGet());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(info.name=='random'){\r\n\t\t\t\t\t\t\t\t\tplayer.init(list.randomGet());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tchooseCharacter:function(list){\r\n\t\t\t\t\t\t\tvar info=game.me.brawlinfo;\r\n\t\t\t\t\t\t\tvar event=_status.event;\r\n\t\t\t\t\t\t\tif(info.name2=='none'){\r\n\t\t\t\t\t\t\t\tif(info.name!='random'){\r\n\t\t\t\t\t\t\t\t\tevent.chosen=[info.name];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(info.name2=='random'&&info.name=='random'){\r\n\t\t\t\t\t\t\t\t\t_status.brawl.doubleCharacter=true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(info.name=='random'){\r\n\t\t\t\t\t\t\t\t\tgame.me.init(info.name2,info.name2);\r\n\t\t\t\t\t\t\t\t\tgame.me.node.avatar.hide();\r\n\t\t\t\t\t\t\t\t\tgame.me.node.name.hide();\r\n\t\t\t\t\t\t\t\t\t_status.brawl.chooseCharacterStr='选择主将';\r\n\t\t\t\t\t\t\t\t\tevent.modchosen=[info.name,info.name2];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(info.name2=='random'){\r\n\t\t\t\t\t\t\t\t\tgame.me.init(info.name,info.name);\r\n\t\t\t\t\t\t\t\t\tgame.me.node.avatar2.hide();\r\n\t\t\t\t\t\t\t\t\tgame.me.node.name2.hide();\r\n\t\t\t\t\t\t\t\t\t_status.brawl.chooseCharacterStr='选择副将';\r\n\t\t\t\t\t\t\t\t\tevent.modchosen=[info.name,info.name2];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tevent.chosen=[info.name,info.name2];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(game.me.identity=='zhu') return false;\r\n\t\t\t\t\t\t\treturn 'nozhu';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tlib.translate.zhu=lib.translate.zhu||'主';\r\n\t\t\t\t\t\tlib.translate.zhong=lib.translate.zhong||'忠';\r\n\t\t\t\t\t\tlib.translate.nei=lib.translate.nei||'内';\r\n\t\t\t\t\t\tlib.translate.fan=lib.translate.fan||'反';\r\n\r\n\r\n\t\t\t\t\t\tthis.style.transition='all 0s';\r\n\t\t\t\t\t\tthis.style.height=(this.offsetHeight-10)+'px';\r\n\t\t\t\t\t\tthis.style.overflow='scroll';\r\n\t\t\t\t\t\tlib.setScroll(this);\r\n\t\t\t\t\t\tvar style={marginLeft:'3px',marginRight:'3px'};\r\n\t\t\t\t\t\tvar style2={position:'relative',display:'block',left:0,top:0,marginBottom:'6px',padding:0,width:'100%'};\r\n\t\t\t\t\t\tvar style3={marginLeft:'4px',marginRight:'4px',position:'relative'}\r\n\r\n\r\n\t\t\t\t\t\tvar scenename=ui.create.node('input',ui.create.div(style2,'','场景名称：',this),{width:'120px'});\r\n\t\t\t\t\t\tscenename.type='text';\r\n\t\t\t\t\t\tscenename.style.marginTop='20px';\r\n\t\t\t\t\t\tvar sceneintro=ui.create.node('input',ui.create.div(style2,'','场景描述：',this),{width:'120px'});\r\n\t\t\t\t\t\tsceneintro.type='text';\r\n\t\t\t\t\t\tsceneintro.style.marginBottom='10px';\r\n\r\n\t\t\t\t\t\tvar line1=ui.create.div(style2,this);\r\n\t\t\t\t\t\tvar addCharacter=ui.create.node('button','添加角色',line1,function(){\r\n\t\t\t\t\t\t\t// line1.style.display='none';\r\n\t\t\t\t\t\t\tresetStatus();\r\n\t\t\t\t\t\t\teditPile.disabled=true;\r\n\t\t\t\t\t\t\t// editCode.disabled=true;\r\n\t\t\t\t\t\t\tsaveButton.disabled=true;\r\n\t\t\t\t\t\t\t// exportButton.disabled=true;\r\n\t\t\t\t\t\t\tline7.style.display='none';\r\n\t\t\t\t\t\t\tline2.style.display='block';\r\n\t\t\t\t\t\t\tline2_t.style.display='block';\r\n\t\t\t\t\t\t\tline3.style.display='block';\r\n\t\t\t\t\t\t\tline4.style.display='block';\r\n\t\t\t\t\t\t\tline5.style.display='block';\r\n\t\t\t\t\t\t\tline6_h.style.display='block';\r\n\t\t\t\t\t\t\tline6_e.style.display='block';\r\n\t\t\t\t\t\t\tline6_j.style.display='block';\r\n\t\t\t\t\t\t\tcapt1.style.display='block';\r\n\t\t\t\t\t\t\tcapt2.style.display='block';\r\n\t\t\t\t\t\t\tif(line6_h.childElementCount) capt_h.style.display='block';\r\n\t\t\t\t\t\t\tif(line6_e.childElementCount) capt_e.style.display='block';\r\n\t\t\t\t\t\t\tif(line6_j.childElementCount) capt_j.style.display='block';\r\n\t\t\t\t\t\t},style);\r\n\t\t\t\t\t\tvar editPile=ui.create.node('button','场景选项',line1,function(){\r\n\t\t\t\t\t\t\tresetCharacter();\r\n\t\t\t\t\t\t\taddCharacter.disabled=true;\r\n\t\t\t\t\t\t\t// editCode.disabled=true;\r\n\t\t\t\t\t\t\tsaveButton.disabled=true;\r\n\t\t\t\t\t\t\t// exportButton.disabled=true;\r\n\t\t\t\t\t\t\tline7.style.display='none';\r\n\t\t\t\t\t\t\tline8.style.display='block';\r\n\t\t\t\t\t\t\tcapt8.style.display='block';\r\n\t\t\t\t\t\t\tline9.style.display='block';\r\n\t\t\t\t\t\t\tline10.style.display='block';\r\n\t\t\t\t\t\t\tline11.style.display='block';\r\n\t\t\t\t\t\t\tcapt9.style.display='block';\r\n\t\t\t\t\t\t\tline3.style.display='block';\r\n\r\n\t\t\t\t\t\t\tline6_t.style.display='block';\r\n\t\t\t\t\t\t\tline6_b.style.display='block';\r\n\t\t\t\t\t\t\tline6_d.style.display='block';\r\n\t\t\t\t\t\t\tif(line6_t.childElementCount) capt_t.style.display='block';\r\n\t\t\t\t\t\t\tif(line6_b.childElementCount) capt_b.style.display='block';\r\n\t\t\t\t\t\t\tif(line6_d.childElementCount) capt_d.style.display='block';\r\n\t\t\t\t\t\t},style);\r\n\t\t\t\t\t\t// var editCode=ui.create.node('button','编辑代码',line1,function(){\r\n\t\t\t\t\t\t//\t console.log(1);\r\n\t\t\t\t\t\t// },style);\r\n\t\t\t\t\t\tvar saveButton=ui.create.node('button','保存场景',line1,function(){\r\n\t\t\t\t\t\t\tif(!scenename.value){\r\n\t\t\t\t\t\t\t\talert('请填写场景名称');\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar scene={\r\n\t\t\t\t\t\t\t\tname:scenename.value,\r\n\t\t\t\t\t\t\t\tintro:sceneintro.value,\r\n\t\t\t\t\t\t\t\tplayers:[],\r\n\t\t\t\t\t\t\t\tcardPileTop:[],\r\n\t\t\t\t\t\t\t\tcardPileBottom:[],\r\n\t\t\t\t\t\t\t\tdiscardPile:[],\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tfor(var i=0;i<line7.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tscene.players.push(line7.childNodes[i].info);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(scene.players.length<2){\r\n\t\t\t\t\t\t\t\talert('请添加至少两名角色');\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(lib.storage.scene[scenename.value]){\r\n\t\t\t\t\t\t\t\tif(_status.currentScene!=scenename.value){\r\n\t\t\t\t\t\t\t\t\tif(!confirm('场景名与现有场景重复，是否覆盖？')){\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.removeScene(scenename.value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<line6_t.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tscene.cardPileTop.push(line6_t.childNodes[i].info);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<line6_b.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tscene.cardPileBottom.push(line6_b.childNodes[i].info);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<line6_d.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tscene.discardPile.push(line6_d.childNodes[i].info);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(replacepile.checked){\r\n\t\t\t\t\t\t\t\tscene.replacepile=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(gameDraw.checked){\r\n\t\t\t\t\t\t\t\tscene.gameDraw=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(turnsresult.value!='none'){\r\n\t\t\t\t\t\t\t\tscene.turns=[parseInt(turns.value),turnsresult.value]\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(washesresult.value!='none'){\r\n\t\t\t\t\t\t\t\tscene.washes=[parseInt(washes.value),washesresult.value]\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlib.storage.scene[scene.name]=scene;\r\n\t\t\t\t\t\t\tgame.save('scene',lib.storage.scene);\r\n\t\t\t\t\t\t\tgame.addScene(scene.name,true);\r\n\t\t\t\t\t\t},style);\r\n\r\n\r\n\t\t\t\t\t\tvar capt1=ui.create.div(style2,'','角色信息',this);\r\n\t\t\t\t\t\tvar line2=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline2.style.display='none';\r\n\t\t\t\t\t\tvar identity=ui.create.selectlist([['zhu','主公'],['zhong','忠臣'],['nei','内奸'],['fan','反贼']],'zhu',line2);\r\n\t\t\t\t\t\tidentity.value='fan';\r\n\t\t\t\t\t\tidentity.style.marginLeft='3px';\r\n\t\t\t\t\t\tidentity.style.marginRight='3px';\r\n\t\t\t\t\t\tvar position=ui.create.selectlist([['0','随机位置'],['1','一号位'],['2','二号位'],['3','三号位'],['4','四号位'],['5','五号位'],['6','六号位'],['7','七号位'],['8','八号位']],'1',line2);\r\n\t\t\t\t\t\tposition.style.marginLeft='3px';\r\n\t\t\t\t\t\tposition.style.marginRight='3px';\r\n\t\t\t\t\t\tvar line2_t=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline2_t.style.display='none';\r\n\t\t\t\t\t\t// line2_t.style.marginBottom='10px';\r\n\t\t\t\t\t\tui.create.node('span','体力：',line2_t);\r\n\t\t\t\t\t\tvar hp=ui.create.node('input',line2_t,{width:'40px'});\r\n\t\t\t\t\t\thp.type='text';\r\n\t\t\t\t\t\tui.create.node('span','体力上限：',line2_t,{marginLeft:'10px'});\r\n\t\t\t\t\t\tvar maxHp=ui.create.node('input',line2_t,{width:'40px'});\r\n\t\t\t\t\t\tmaxHp.type='text';\r\n\t\t\t\t\t\tui.create.node('span','横置 ',line2_t,{marginLeft:'20px'});\r\n\t\t\t\t\t\tvar linked=ui.create.node('input',line2_t);\r\n\t\t\t\t\t\tlinked.type='checkbox';\r\n\t\t\t\t\t\tui.create.node('span','翻面 ',line2_t,{marginLeft:'10px'});\r\n\t\t\t\t\t\tvar turnedover=ui.create.node('input',line2_t);\r\n\t\t\t\t\t\tturnedover.type='checkbox';\r\n\t\t\t\t\t\tui.create.node('span','玩家 ',line2_t,{marginLeft:'10px'});\r\n\t\t\t\t\t\tvar playercontrol=ui.create.node('input',line2_t);\r\n\t\t\t\t\t\tplayercontrol.type='checkbox';\r\n\r\n\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\tfor(var i in lib.character){\r\n\t\t\t\t\t\t\tlist.push([i,lib.translate[i]]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlist.sort(function(a,b){\r\n\t\t\t\t\t\t\ta=a[0];b=b[0];\r\n\t\t\t\t\t\t\tvar aa=a,bb=b;\r\n\t\t\t\t\t\t\tif(aa.indexOf('_')!=-1){\r\n\t\t\t\t\t\t\t\taa=aa.slice(aa.indexOf('_')+1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(bb.indexOf('_')!=-1){\r\n\t\t\t\t\t\t\t\tbb=bb.slice(bb.indexOf('_')+1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(aa!=bb){\r\n\t\t\t\t\t\t\t\treturn aa>bb?1:-1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn a>b?1:-1;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tlist.unshift(['random','自选主将']);\r\n\t\t\t\t\t\tvar name1=ui.create.selectlist(list,list[0],line2);\r\n\t\t\t\t\t\tname1.style.marginLeft='3px';\r\n\t\t\t\t\t\tname1.style.marginRight='3px';\r\n\t\t\t\t\t\tname1.style.maxWidth='80px';\r\n\t\t\t\t\t\tlist[0][1]='自选副将';\r\n\t\t\t\t\t\tlist.unshift(['none','无副将']);\r\n\t\t\t\t\t\tvar name2=ui.create.selectlist(list,list[0],line2);\r\n\t\t\t\t\t\tname2.style.marginLeft='3px';\r\n\t\t\t\t\t\tname2.style.marginRight='3px';\r\n\t\t\t\t\t\tname2.style.maxWidth='80px';\r\n\r\n\t\t\t\t\t\tvar capt9=ui.create.div(style2,'','编辑牌堆',this);\r\n\t\t\t\t\t\tcapt9.style.display='none';\r\n\r\n\r\n\t\t\t\t\t\tvar capt2=ui.create.div(style2,'','添加卡牌',this);\r\n\t\t\t\t\t\tvar line3=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline3.style.display='none';\r\n\t\t\t\t\t\tcapt1.style.display='none';\r\n\t\t\t\t\t\tcapt2.style.display='none';\r\n\r\n\t\t\t\t\t\tvar line5=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline5.style.display='none';\r\n\t\t\t\t\t\tvar pileaddlist=[];\r\n\t\t\t\t\t\tfor(var i=0;i<lib.config.cards.length;i++){\r\n\t\t\t\t\t\t\tif(!lib.cardPack[lib.config.cards[i]]) continue;\r\n\t\t\t\t\t\t\tfor(var j=0;j<lib.cardPack[lib.config.cards[i]].length;j++){\r\n\t\t\t\t\t\t\t\tvar cname=lib.cardPack[lib.config.cards[i]][j];\r\n\t\t\t\t\t\t\t\tpileaddlist.push([cname,get.translation(cname)]);\r\n\t\t\t\t\t\t\t\tif(cname=='sha'){\r\n\t\t\t\t\t\t\t\t\tpileaddlist.push(['huosha','火杀']);\r\n\t\t\t\t\t\t\t\t\tpileaddlist.push(['leisha','雷杀']);\r\n\t\t\t\t\t\t\t\t\tpileaddlist.push(['icesha','冰杀']);\r\n\t\t\t\t\t\t\t\t\tpileaddlist.push(['kamisha','神杀']);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var i in lib.cardPack){\r\n\t\t\t\t\t\t\tif(lib.config.all.cards.contains(i)) continue;\r\n\t\t\t\t\t\t\tfor(var j=0;j<lib.cardPack[i].length;j++){\r\n\t\t\t\t\t\t\t\tvar cname=lib.cardPack[i][j];\r\n\t\t\t\t\t\t\t\tpileaddlist.push([cname,get.translation(cname)]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpileaddlist.unshift(['random',['随机卡牌']]);\r\n\t\t\t\t\t\tvar cardpileaddname=ui.create.selectlist(pileaddlist,null,line3);\r\n\t\t\t\t\t\tcardpileaddname.style.marginLeft='3px';\r\n\t\t\t\t\t\tcardpileaddname.style.marginRight='3px';\r\n\t\t\t\t\t\tcardpileaddname.style.width='85px';\r\n\t\t\t\t\t\tvar cardpileaddsuit=ui.create.selectlist([\r\n\t\t\t\t\t\t\t['random','随机花色'],\r\n\t\t\t\t\t\t\t['heart','红桃'],\r\n\t\t\t\t\t\t\t['diamond','方片'],\r\n\t\t\t\t\t\t\t['club','梅花'],\r\n\t\t\t\t\t\t\t['spade','黑桃'],\r\n\t\t\t\t\t\t],null,line3);\r\n\t\t\t\t\t\tcardpileaddsuit.style.marginLeft='3px';\r\n\t\t\t\t\t\tcardpileaddsuit.style.marginRight='3px';\r\n\t\t\t\t\t\tcardpileaddsuit.style.width='85px';\r\n\t\t\t\t\t\tvar cardpileaddnumber=ui.create.selectlist([\r\n\t\t\t\t\t\t\t['random','随机点数'],1,2,3,4,5,6,7,8,9,10,11,12,13\r\n\t\t\t\t\t\t],null,line3);\r\n\t\t\t\t\t\tcardpileaddnumber.style.marginLeft='3px';\r\n\t\t\t\t\t\tcardpileaddnumber.style.marginRight='3px';\r\n\t\t\t\t\t\tcardpileaddnumber.style.width='85px';\r\n\r\n\t\t\t\t\t\tvar fakecard=function(info,position,capt){\r\n\t\t\t\t\t\t\tvar name=info[0],suit=info[1],number=info[2];\r\n\t\t\t\t\t\t\tvar card=ui.create.card(null,'noclick',true);\r\n\t\t\t\t\t\t\tcard.style.zoom=0.6;\r\n\t\t\t\t\t\t\tnumber=parseInt(cardpileaddnumber.value);\r\n\t\t\t\t\t\t\tvar name2=name;\r\n\t\t\t\t\t\t\tvar suit2=suit;\r\n\t\t\t\t\t\t\tvar number2=number;\r\n\t\t\t\t\t\t\tif(name2=='random') name2='sha';\r\n\t\t\t\t\t\t\tif(suit2=='random') suit2='?';\r\n\t\t\t\t\t\t\tif(!number2){\r\n\t\t\t\t\t\t\t\tnumber='random';\r\n\t\t\t\t\t\t\t\tnumber2='?';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcard.init([suit2,number2,name2]);\r\n\t\t\t\t\t\t\tcard.info=info;\r\n\t\t\t\t\t\t\tif(name=='random'){\r\n\t\t\t\t\t\t\t\tcard.node.name.innerHTML=get.verticalStr('随机卡牌');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(position&&capt){\r\n\t\t\t\t\t\t\t\tcard.listen(function(){\r\n\t\t\t\t\t\t\t\t\tthis.remove();\r\n\t\t\t\t\t\t\t\t\tif(!position.childElementCount) capt.style.display='none';\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tposition.appendChild(card);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn card;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar cc_h=ui.create.node('button','加入手牌区',line5,function(){\r\n\t\t\t\t\t\t\tfakecard([cardpileaddname.value,cardpileaddsuit.value,cardpileaddnumber.value],line6_h,capt_h);\r\n\t\t\t\t\t\t\tcapt_h.style.display='block';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar cc_e=ui.create.node('button','加入装备区',line5,function(){\r\n\t\t\t\t\t\t\tif(get.type(cardpileaddname.value)!='equip') return;\r\n\t\t\t\t\t\t\tvar subtype=get.subtype(cardpileaddname.value);\r\n\t\t\t\t\t\t\tfor(var i=0;i<line6_e.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tif(get.subtype(line6_e.childNodes[i].name)==subtype){\r\n\t\t\t\t\t\t\t\t\tline6_e.childNodes[i].remove();break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfakecard([cardpileaddname.value,cardpileaddsuit.value,cardpileaddnumber.value],line6_e,capt_e);\r\n\t\t\t\t\t\t\tcapt_e.style.display='block';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar cc_j=ui.create.node('button','加入判定区',line5,function(){\r\n\t\t\t\t\t\t\tif(get.type(cardpileaddname.value)!='delay') return;\r\n\t\t\t\t\t\t\tfor(var i=0;i<line6_j.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tif(line6_j.childNodes[i].name==cardpileaddname.value){\r\n\t\t\t\t\t\t\t\t\tline6_j.childNodes[i].remove();break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfakecard([cardpileaddname.value,cardpileaddsuit.value,cardpileaddnumber.value],line6_j,capt_j);\r\n\t\t\t\t\t\t\tcapt_j.style.display='block';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tcc_h.style.marginLeft='3px';\r\n\t\t\t\t\t\tcc_h.style.marginRight='3px';\r\n\t\t\t\t\t\tcc_h.style.width='85px';\r\n\t\t\t\t\t\tcc_e.style.marginLeft='3px';\r\n\t\t\t\t\t\tcc_e.style.marginRight='3px';\r\n\t\t\t\t\t\tcc_e.style.width='85px';\r\n\t\t\t\t\t\tcc_j.style.marginLeft='3px';\r\n\t\t\t\t\t\tcc_j.style.marginRight='3px';\r\n\t\t\t\t\t\tcc_j.style.width='85px';\r\n\r\n\t\t\t\t\t\tvar capt_h=ui.create.div(style2,'','手牌区',this);\r\n\t\t\t\t\t\tvar line6_h=ui.create.div(style2,this);\r\n\t\t\t\t\t\tvar capt_e=ui.create.div(style2,'','装备区',this);\r\n\t\t\t\t\t\tvar line6_e=ui.create.div(style2,this);\r\n\t\t\t\t\t\tvar capt_j=ui.create.div(style2,'','判定区',this);\r\n\t\t\t\t\t\tvar line6_j=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline6_j.style.marginBottom='10px';\r\n\t\t\t\t\t\tcapt_h.style.display='none';\r\n\t\t\t\t\t\tcapt_e.style.display='none';\r\n\t\t\t\t\t\tcapt_j.style.display='none';\r\n\r\n\t\t\t\t\t\tvar line10=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline10.style.display='none';\r\n\t\t\t\t\t\tvar ac_h=ui.create.node('button','加入牌堆顶',line10,function(){\r\n\t\t\t\t\t\t\tfakecard([cardpileaddname.value,cardpileaddsuit.value,cardpileaddnumber.value],line6_t,capt_t);\r\n\t\t\t\t\t\t\tcapt_t.style.display='block';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar ac_e=ui.create.node('button','加入牌堆底',line10,function(){\r\n\t\t\t\t\t\t\tfakecard([cardpileaddname.value,cardpileaddsuit.value,cardpileaddnumber.value],line6_b,capt_b);\r\n\t\t\t\t\t\t\tcapt_b.style.display='block';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar ac_j=ui.create.node('button','加入弃牌堆',line10,function(){\r\n\t\t\t\t\t\t\tfakecard([cardpileaddname.value,cardpileaddsuit.value,cardpileaddnumber.value],line6_d,capt_d);\r\n\t\t\t\t\t\t\tcapt_d.style.display='block';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tac_h.style.marginLeft='3px';\r\n\t\t\t\t\t\tac_h.style.marginRight='3px';\r\n\t\t\t\t\t\tac_h.style.width='85px';\r\n\t\t\t\t\t\tac_e.style.marginLeft='3px';\r\n\t\t\t\t\t\tac_e.style.marginRight='3px';\r\n\t\t\t\t\t\tac_e.style.width='85px';\r\n\t\t\t\t\t\tac_j.style.marginLeft='3px';\r\n\t\t\t\t\t\tac_j.style.marginRight='3px';\r\n\t\t\t\t\t\tac_j.style.width='85px';\r\n\r\n\t\t\t\t\t\tvar line11=ui.create.div(style2,this,'','<span>替换牌堆</span>');\r\n\t\t\t\t\t\tline11.style.display='none';\r\n\t\t\t\t\t\tvar replacepile=ui.create.node('input',line11);\r\n\t\t\t\t\t\treplacepile.type='checkbox';\r\n\r\n\t\t\t\t\t\tui.create.node('span',line11,'开局摸牌',{marginLeft:'10px'});\r\n\t\t\t\t\t\tvar gameDraw=ui.create.node('input',line11);\r\n\t\t\t\t\t\tgameDraw.type='checkbox';\r\n\t\t\t\t\t\tgameDraw.checked=true;\r\n\r\n\t\t\t\t\t\tvar capt_t=ui.create.div(style2,'','牌堆顶',this);\r\n\t\t\t\t\t\tvar line6_t=ui.create.div(style2,this);\r\n\t\t\t\t\t\tvar capt_b=ui.create.div(style2,'','牌堆底',this);\r\n\t\t\t\t\t\tvar line6_b=ui.create.div(style2,this);\r\n\t\t\t\t\t\tvar capt_d=ui.create.div(style2,'','弃牌堆',this);\r\n\t\t\t\t\t\tvar line6_d=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline6_d.style.marginBottom='10px';\r\n\t\t\t\t\t\tcapt_t.style.display='none';\r\n\t\t\t\t\t\tcapt_b.style.display='none';\r\n\t\t\t\t\t\tcapt_d.style.display='none';\r\n\r\n\t\t\t\t\t\tvar line4=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline4.style.display='none';\r\n\t\t\t\t\t\tline4.style.marginTop='20px';\r\n\t\t\t\t\t\tvar resetCharacter=function(){\r\n\t\t\t\t\t\t\t// line1.style.display='block';\r\n\t\t\t\t\t\t\teditPile.disabled=false;\r\n\t\t\t\t\t\t\t// editCode.disabled=false;\r\n\t\t\t\t\t\t\tsaveButton.disabled=false;\r\n\t\t\t\t\t\t\t// exportButton.disabled=false;\r\n\t\t\t\t\t\t\tline7.style.display='block';\r\n\t\t\t\t\t\t\tline2.style.display='none';\r\n\t\t\t\t\t\t\tline2_t.style.display='none';\r\n\t\t\t\t\t\t\tline3.style.display='none';\r\n\t\t\t\t\t\t\tline4.style.display='none';\r\n\t\t\t\t\t\t\tline5.style.display='none';\r\n\t\t\t\t\t\t\tline6_h.style.display='none';\r\n\t\t\t\t\t\t\tline6_e.style.display='none';\r\n\t\t\t\t\t\t\tline6_j.style.display='none';\r\n\t\t\t\t\t\t\tcapt1.style.display='none';\r\n\t\t\t\t\t\t\tcapt2.style.display='none';\r\n\t\t\t\t\t\t\tcapt_h.style.display='none';\r\n\t\t\t\t\t\t\tcapt_e.style.display='none';\r\n\t\t\t\t\t\t\tcapt_j.style.display='none';\r\n\r\n\t\t\t\t\t\t\tname1.value='random';\r\n\t\t\t\t\t\t\tname2.value='none';\r\n\t\t\t\t\t\t\tidentity.value='fan';\r\n\t\t\t\t\t\t\tposition.value='0';\r\n\t\t\t\t\t\t\thp.value='';\r\n\t\t\t\t\t\t\tmaxHp.value='';\r\n\t\t\t\t\t\t\tline6_h.innerHTML='';\r\n\t\t\t\t\t\t\tline6_e.innerHTML='';\r\n\t\t\t\t\t\t\tline6_j.innerHTML='';\r\n\t\t\t\t\t\t\tcardpileaddname.value='random';\r\n\t\t\t\t\t\t\tcardpileaddsuit.value='random';\r\n\t\t\t\t\t\t\tcardpileaddnumber.value='random';\r\n\t\t\t\t\t\t\tlinked.checked=false;\r\n\t\t\t\t\t\t\tturnedover.checked=false;\r\n\t\t\t\t\t\t\tplayercontrol.checked=false;\r\n\t\t\t\t\t\t};\r\n                        \r\n\t\t\t\t\t\tvar createCharacter=function(info){\r\n\t\t\t\t\t\t\tvar player=ui.create.player(null,true);\r\n\t\t\t\t\t\t\tplayer._customintro=function(uiintro){\r\n\t\t\t\t\t\t\t\tif(info.handcards.length){\r\n\t\t\t\t\t\t\t\t\tuiintro.addText('手牌',true);\r\n\t\t\t\t\t\t\t\t\tvar hs=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<info.handcards.length;i++){\r\n\t\t\t\t\t\t\t\t\t\ths.appendChild(fakecard(info.handcards[i]));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tuiintro.add(hs);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.info=info;\r\n\t\t\t\t\t\t\tvar name=info.name,name3=info.name2;\r\n\t\t\t\t\t\t\tif(name=='random'){\r\n\t\t\t\t\t\t\t\tname='re_caocao';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(name3!='none'){\r\n\t\t\t\t\t\t\t\tif(name3=='random'){\r\n\t\t\t\t\t\t\t\t\tname3='liubei';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tplayer.init(name,name3);\r\n\t\t\t\t\t\t\t\tif(info.name2=='random'){\r\n\t\t\t\t\t\t\t\t\tplayer.node.name2.innerHTML=get.verticalStr('自选副将');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tplayer.init(name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(info.name=='random'){\r\n\t\t\t\t\t\t\t\tplayer.node.name.innerHTML=get.verticalStr('自选主将');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(info.maxHp){\r\n\t\t\t\t\t\t\t\tplayer.maxHp=info.maxHp;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(info.hp){\r\n\t\t\t\t\t\t\t\tplayer.hp=Math.min(info.hp,player.maxHp);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<info.handcards.length;i++){\r\n\t\t\t\t\t\t\t\tplayer.node.handcards1.appendChild(ui.create.card());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<info.equips.length;i++){\r\n\t\t\t\t\t\t\t\tplayer.$equip(fakecard(info.equips[i]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<info.judges.length;i++){\r\n\t\t\t\t\t\t\t\tplayer.node.judges.appendChild(fakecard(info.judges[i]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.setIdentity(info.identity);\r\n\t\t\t\t\t\t\tvar pos=info.position;\r\n\t\t\t\t\t\t\tif(pos==0){\r\n\t\t\t\t\t\t\t\tpos='随机位置';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tpos=get.cnNumber(pos,true)+'号位'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(info.linked&&info.turnedover){\r\n\t\t\t\t\t\t\t\tpos+='<br>横置 - 翻面'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(info.linked) pos+=' - 横置';\r\n\t\t\t\t\t\t\t\tif(info.turnedover) pos+=' - 翻面';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.setNickname(pos);\r\n\t\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t\t\tplayer.style.transform='scale(0.7)';\r\n\t\t\t\t\t\t\tplayer.style.position='relative';\r\n\t\t\t\t\t\t\tplayer.style.left=0;\r\n\t\t\t\t\t\t\tplayer.style.top=0;\r\n\t\t\t\t\t\t\tplayer.style.margin='-18px';\r\n\t\t\t\t\t\t\tplayer.node.marks.remove();\r\n\r\n\r\n\t\t\t\t\t\t\tline7.appendChild(player);//[todo player]\r\n\t\t\t\t\t\t\tplayer.listen(function(){\r\n\t\t\t\t\t\t\t\tif(confirm('是否删除此角色？')){\r\n\t\t\t\t\t\t\t\t\tthis.remove();\r\n\t\t\t\t\t\t\t\t\tif(line7.childElementCount<8){\r\n\t\t\t\t\t\t\t\t\t\taddCharacter.disabled=false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(line7.childElementCount>=8){\r\n\t\t\t\t\t\t\t\taddCharacter.disabled=true;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn player;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tui.create.div('.menubutton.large','确定',line4,style3,function(){\r\n\t\t\t\t\t\t\tvar info={\r\n\t\t\t\t\t\t\t\tname:name1.value,\r\n\t\t\t\t\t\t\t\tname2:name2.value,\r\n\t\t\t\t\t\t\t\tidentity:identity.value,\r\n\t\t\t\t\t\t\t\tposition:parseInt(position.value),\r\n\t\t\t\t\t\t\t\thp:parseInt(hp.value),\r\n\t\t\t\t\t\t\t\tmaxHp:parseInt(maxHp.value),\r\n\t\t\t\t\t\t\t\tlinked:linked.checked,\r\n\t\t\t\t\t\t\t\tturnedover:turnedover.checked,\r\n\t\t\t\t\t\t\t\tplayercontrol:playercontrol.checked,\r\n\t\t\t\t\t\t\t\thandcards:[],\r\n\t\t\t\t\t\t\t\tequips:[],\r\n\t\t\t\t\t\t\t\tjudges:[]\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tfor(var i=0;i<line7.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tif(info.identity=='zhu'&&line7.childNodes[i].info.identity=='zhu'){\r\n\t\t\t\t\t\t\t\t\talert('不能有两个主公');\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(info.position!=0&&info.position==line7.childNodes[i].info.position){\r\n\t\t\t\t\t\t\t\t\talert('座位与现在角色相同');\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<line6_h.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tinfo.handcards.push(line6_h.childNodes[i].info);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<line6_e.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tinfo.equips.push(line6_e.childNodes[i].info);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<line6_j.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tinfo.judges.push(line6_j.childNodes[i].info);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcreateCharacter(info);\r\n\t\t\t\t\t\t\tresetCharacter();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tui.create.div('.menubutton.large','取消',line4,style3,resetCharacter);\r\n\t\t\t\t\t\tvar line7=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline7.style.marginTop='12px';\r\n\r\n\r\n\t\t\t\t\t\tvar capt8=ui.create.div(style2,'','胜负条件',this);\r\n\t\t\t\t\t\tcapt8.style.display='none';\r\n\t\t\t\t\t\tvar line8=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline8.style.display='none';\r\n\t\t\t\t\t\tline8.style.marginTop='10px';\r\n\t\t\t\t\t\tline8.style.marginBottom='10px';\r\n\t\t\t\t\t\tvar turnslist=[['1','一'],['2','两'],['3','三'],['4','四'],['5','五'],['6','六'],['7','七'],['8','八'],['9','九'],['10','十']];\r\n\t\t\t\t\t\tvar results=[['none','无'],['win','胜利'],['lose','失败'],['tie','平局']];\r\n\t\t\t\t\t\tvar turns=ui.create.selectlist(turnslist,'1',line8);\r\n\t\t\t\t\t\tui.create.node('span','个回合后',line8,style);\r\n\t\t\t\t\t\tvar turnsresult=ui.create.selectlist(results,'none',line8);\r\n\r\n\r\n\t\t\t\t\t\tvar washes=ui.create.selectlist(turnslist,'1',line8);\r\n\t\t\t\t\t\twashes.style.marginLeft='20px';\r\n\t\t\t\t\t\tui.create.node('span','次洗牌后',line8,style);\r\n\t\t\t\t\t\tvar washesresult=ui.create.selectlist(results,'none',line8);\r\n\r\n\t\t\t\t\t\tvar line9=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline9.style.display='none';\r\n\t\t\t\t\t\tline9.style.marginTop='20px';\r\n\t\t\t\t\t\tvar resetStatus=function(all){\r\n\t\t\t\t\t\t\tif(line7.childElementCount>=8){\r\n\t\t\t\t\t\t\t\taddCharacter.disabled=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\taddCharacter.disabled=false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// editCode.disabled=false;\r\n\t\t\t\t\t\t\tsaveButton.disabled=false;\r\n\t\t\t\t\t\t\t// exportButton.disabled=false;\r\n\t\t\t\t\t\t\tcardpileaddname.value='random';\r\n\t\t\t\t\t\t\tcardpileaddsuit.value='random';\r\n\t\t\t\t\t\t\tcardpileaddnumber.value='random';\r\n\r\n\t\t\t\t\t\t\tline8.style.display='none';\r\n\t\t\t\t\t\t\tcapt8.style.display='none';\r\n\t\t\t\t\t\t\tcapt9.style.display='none';\r\n\t\t\t\t\t\t\tline9.style.display='none';\r\n\t\t\t\t\t\t\tline10.style.display='none';\r\n\t\t\t\t\t\t\tline11.style.display='none';\r\n\t\t\t\t\t\t\tline3.style.display='none';\r\n\t\t\t\t\t\t\tline7.style.display='block';\r\n\r\n\r\n\t\t\t\t\t\t\tline6_t.style.display='none';\r\n\t\t\t\t\t\t\tline6_b.style.display='none';\r\n\t\t\t\t\t\t\tline6_d.style.display='none';\r\n\t\t\t\t\t\t\tcapt_t.style.display='none';\r\n\t\t\t\t\t\t\tcapt_b.style.display='none';\r\n\t\t\t\t\t\t\tcapt_d.style.display='none';\r\n\r\n\t\t\t\t\t\t\tif(all===true){\r\n\t\t\t\t\t\t\t\treplacepile.checked=false;\r\n\t\t\t\t\t\t\t\tgameDraw.checked=true;\r\n\t\t\t\t\t\t\t\tturns.value='1';\r\n\t\t\t\t\t\t\t\tturnsresult.value='none';\r\n\t\t\t\t\t\t\t\twashes.value='1';\r\n\t\t\t\t\t\t\t\twashesresult.value='none';\r\n\t\t\t\t\t\t\t\tline6_t.innerHTML='';\r\n\t\t\t\t\t\t\t\tline6_b.innerHTML='';\r\n\t\t\t\t\t\t\t\tline6_d.innerHTML='';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tui.create.div('.menubutton.large','确定',line9,style3,resetStatus);\r\n\r\n\t\t\t\t\t\tgame.addSceneClear=function(){\r\n\t\t\t\t\t\t\tresetCharacter();\r\n\t\t\t\t\t\t\tresetStatus(true);\r\n\t\t\t\t\t\t\tscenename.value='';\r\n\t\t\t\t\t\t\tsceneintro.value='';\r\n\t\t\t\t\t\t\tline7.innerHTML='';\r\n\t\t\t\t\t\t\tdelete _status.currentScene;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tgame.loadScene=function(scene){\r\n\t\t\t\t\t\t\tresetCharacter();\r\n\t\t\t\t\t\t\tresetStatus(true);\r\n\t\t\t\t\t\t\tscenename.value=scene.name;\r\n\t\t\t\t\t\t\tsceneintro.value=scene.intro;\r\n\t\t\t\t\t\t\t_status.currentScene=scene.name;\r\n\t\t\t\t\t\t\tline7.innerHTML='';\r\n\t\t\t\t\t\t\tif(scene.replacepile) replacepile.checked=true;\r\n\t\t\t\t\t\t\tif(scene.gameDraw) gameDraw.checked=true;\r\n\t\t\t\t\t\t\telse gameDraw.checked=false;\r\n\t\t\t\t\t\t\tif(scene.turns){\r\n\t\t\t\t\t\t\t\tturns.value=scene.turns[0].toString();\r\n\t\t\t\t\t\t\t\tturnsresult.value=scene.turns[1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(scene.washes){\r\n\t\t\t\t\t\t\t\twashes.value=scene.washes[0].toString();\r\n\t\t\t\t\t\t\t\twashesresult.value=scene.washes[1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.cardPileTop.length;i++){\r\n\t\t\t\t\t\t\t\tfakecard(scene.cardPileTop[i],line6_t,capt_t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.cardPileBottom.length;i++){\r\n\t\t\t\t\t\t\t\tfakecard(scene.cardPileBottom[i],line6_b,capt_b);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.discardPile.length;i++){\r\n\t\t\t\t\t\t\t\tfakecard(scene.discardPile[i],line6_d,capt_d);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tfor(var i=0;i<scene.players.length;i++){\r\n\t\t\t\t\t\t\t\tcreateCharacter(scene.players[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_status.sceneToLoad){\r\n\t\t\t\t\t\tvar scene=_status.sceneToLoad;\r\n\t\t\t\t\t\tdelete _status.sceneToLoad;\r\n\t\t\t\t\t\tgame.loadScene(scene);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tstage:{\r\n\t\t\t\tname:'创建关卡',\r\n\t\t\t\tcontent:{\r\n\t\t\t\t\tsubmode:'normal'\r\n\t\t\t\t},\r\n\t\t\t\tnostart:true,\r\n\t\t\t\tfullshow:true,\r\n\t\t\t\ttemplate:{\r\n\t\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\t\tif(init){\r\n\t\t\t\t\t\t\tvar name=lib.brawl[this.link].name;\r\n\t\t\t\t\t\t\tvar stage=lib.storage.stage[name];\r\n\t\t\t\t\t\t\tvar style2={position:'relative',display:'block',left:0,top:0,marginBottom:'10px',padding:0,width:'100%'};\r\n\t\t\t\t\t\t\tvar style3={marginLeft:'4px',marginRight:'4px',position:'relative'}\r\n\t\t\t\t\t\t\tvar line1=ui.create.div(style2,this);\r\n\t\t\t\t\t\t\tvar line2=ui.create.div(style2,this);\r\n\t\t\t\t\t\t\tline2.style.lineHeight='50px';\r\n\t\t\t\t\t\t\tline2.style.overflow='scroll';\r\n\t\t\t\t\t\t\tlib.setScroll(line2);\r\n\t\t\t\t\t\t\tvar container=this.parentNode.parentNode;\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\tvar rect1=container.getBoundingClientRect();\r\n\t\t\t\t\t\t\t\tvar rect2=line2.getBoundingClientRect();\r\n\t\t\t\t\t\t\t\tline2.style.height=(rect1.height-(rect2.top-rect1.top))+'px';\r\n\t\t\t\t\t\t\t},1000);\r\n\t\t\t\t\t\t\tif(_status.extensionmade.contains(name)){\r\n\t\t\t\t\t\t\t\tui.create.node('button','管理扩展',line1,function(){\r\n\t\t\t\t\t\t\t\t\tui.click.configMenu();\r\n\t\t\t\t\t\t\t\t\tui.click.extensionTab(name);\r\n\t\t\t\t\t\t\t\t},{marginLeft:'6px'});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tui.create.node('button','删除关卡',line1,function(){\r\n\t\t\t\t\t\t\t\t\tif(confirm('确定删除'+name+'？')){\r\n\t\t\t\t\t\t\t\t\t\tgame.removeStage(name);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},{marginLeft:'6px'});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.create.node('button','导出扩展',line1,function(){\r\n\t\t\t\t\t\t\t\tvar level=stage.level;\r\n\t\t\t\t\t\t\t\tstage.level=0;\r\n\t\t\t\t\t\t\t\tvar str='{name:\"'+name+'\",content:function(){\\nif(lib.config.mode==\"brawl\"){\\n'+\r\n\t\t\t\t\t\t\t\t'if(!lib.storage.stage) lib.storage.stage={};\\n'+\r\n\t\t\t\t\t\t\t\t'if(!lib.storage.stage[\"'+name+'\"]){\\nlib.storage.stage[\"'+name+'\"]='+get.stringify(stage)+';\\n_status.extensionstage=true;}\\n'+\r\n\t\t\t\t\t\t\t\t'if(!_status.extensionmade) _status.extensionmade=[];\\n'+\r\n\t\t\t\t\t\t\t\t'_status.extensionmade.push(\"'+name+'\");\\n}}\\n}';\r\n\t\t\t\t\t\t\t\tstage.level=level;\r\n\t\t\t\t\t\t\t\tvar extension={'extension.js':'game.import(\"extension\",function(lib,game,ui,get,ai,_status){return '+str+'})'};\r\n\t\t\t\t\t\t\t\tgame.importExtension(extension,null,name);\r\n\t\t\t\t\t\t\t},{marginLeft:'6px'});\r\n\t\t\t\t\t\t\tvar noactive=true;\r\n\t\t\t\t\t\t\tvar clickNode=function(){\r\n\t\t\t\t\t\t\t\tif(this.classList.contains('unselectable')) return;\r\n\t\t\t\t\t\t\t\tif(!this.classList.contains('active')){\r\n\t\t\t\t\t\t\t\t\tvar active=this.parentNode.querySelector('.menubutton.large.active');\r\n\t\t\t\t\t\t\t\t\tif(active){\r\n\t\t\t\t\t\t\t\t\t\tactive.classList.remove('active');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis.classList.add('active');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<stage.scenes.length;i++){\r\n\t\t\t\t\t\t\t\tvar node=ui.create.div('.menubutton.large',line2,stage.scenes[i].name,style3,clickNode);\r\n\t\t\t\t\t\t\t\tnode.index=i;\r\n\t\t\t\t\t\t\t\tif(stage.mode=='sequal'){\r\n\t\t\t\t\t\t\t\t\tif(i==stage.level){\r\n\t\t\t\t\t\t\t\t\t\tnode.classList.add('active');\r\n\t\t\t\t\t\t\t\t\t\tnoactive=false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tnode.classList.add('unselectable');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(stage.mode=='normal'){\r\n\t\t\t\t\t\t\t\t\tif(i>stage.level){\r\n\t\t\t\t\t\t\t\t\t\tnode.classList.add('unselectable');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(lib.storage.lastStage==i&&!node.classList.contains('unselectable')){\r\n\t\t\t\t\t\t\t\t\tnode.classList.add('active');\r\n\t\t\t\t\t\t\t\t\tnoactive=false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(lib.storage.lastStage==undefined&&noactive&&!node.classList.contains('unselectable')){\r\n\t\t\t\t\t\t\t\t\tnode.classList.add('active');\r\n\t\t\t\t\t\t\t\t\tnoactive=false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tshowcase:function(init){\r\n\t\t\t\t\tif(_status.sceneChanged){\r\n\t\t\t\t\t\tinit=true;\r\n\t\t\t\t\t\tthis.innerHTML='';\r\n\t\t\t\t\t\tdelete _status.sceneChanged;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(init){\r\n\t\t\t\t\t\tthis.style.transition='all 0s';\r\n\t\t\t\t\t\tthis.style.height=(this.offsetHeight-10)+'px';\r\n\t\t\t\t\t\t// this.style.overflow='scroll';\r\n\t\t\t\t\t\t// lib.setScroll(this);\r\n\t\t\t\t\t\tvar style2={position:'relative',display:'block',left:0,top:0,marginBottom:'6px',padding:0,width:'100%'};\r\n\t\t\t\t\t\tvar style3={marginLeft:'4px',marginRight:'4px',position:'relative'}\r\n\r\n\t\t\t\t\t\tvar scenename=ui.create.node('input',ui.create.div(style2,'','关卡名称：',this),{width:'120px'});\r\n\t\t\t\t\t\tscenename.type='text';\r\n\t\t\t\t\t\tscenename.style.marginTop='20px';\r\n\t\t\t\t\t\tvar sceneintro=ui.create.node('input',ui.create.div(style2,'','关卡描述：',this),{width:'120px'});\r\n\t\t\t\t\t\tsceneintro.type='text';\r\n\t\t\t\t\t\tsceneintro.style.marginBottom='10px';\r\n\r\n\t\t\t\t\t\tvar line1=ui.create.div(style2,this);\r\n\t\t\t\t\t\tvar line2=ui.create.div(style2,this);\r\n\t\t\t\t\t\tline1.style.marginBottom='10px';\r\n\t\t\t\t\t\tline2.style.lineHeight='50px';\r\n\t\t\t\t\t\tline2.style.overflow='scroll';\r\n\t\t\t\t\t\tlib.setScroll(line2);\r\n\t\t\t\t\t\tvar container=this.parentNode.parentNode;\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tvar rect1=container.getBoundingClientRect();\r\n\t\t\t\t\t\t\tvar rect2=line2.getBoundingClientRect();\r\n\t\t\t\t\t\t\tline2.style.height=(rect1.height-(rect2.top-rect1.top))+'px';\r\n\t\t\t\t\t\t},1000);\r\n\t\t\t\t\t\tvar scenes=[];\r\n\t\t\t\t\t\tfor(var i in lib.storage.scene){\r\n\t\t\t\t\t\t\tscenes.push([i,i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!scenes.length){\r\n\t\t\t\t\t\t\talert('请创建至少1个场景');\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar scenelist=ui.create.selectlist(scenes,null,line1);\r\n\t\t\t\t\t\tvar e1=function(){\r\n\t\t\t\t\t\t\tif(this.nextSibling){\r\n\t\t\t\t\t\t\t\tthis.parentNode.insertBefore(this,this.nextSibling.nextSibling);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar e2=function(){\r\n\t\t\t\t\t\t\tvar that=this;\r\n\t\t\t\t\t\t\tthis.movetimeout=setTimeout(function(){\r\n\t\t\t\t\t\t\t\te1.call(that);\r\n\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar e3=function(){\r\n\t\t\t\t\t\t\tclearTimeout(this.movetimeout);\r\n\t\t\t\t\t\t\tdelete this.movetimeout;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar e4=function(value){\r\n\t\t\t\t\t\t\tvar node=ui.create.div('.menubutton.large',value,line2,style3,function(){\r\n\t\t\t\t\t\t\t\tif(confirm('是否移除'+this.innerHTML+'？')){\r\n\t\t\t\t\t\t\t\t\tthis.remove();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(lib.config.touchscreen){\r\n\t\t\t\t\t\t\t\tnode.ontouchstart=e2;\r\n\t\t\t\t\t\t\t\tnode.ontouchend=e3;\r\n\t\t\t\t\t\t\t\tnode.ontouchmove=e3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tnode.oncontextmenu=e1;\r\n\t\t\t\t\t\t\t\tnode.onmousedown=e2;\r\n\t\t\t\t\t\t\t\tnode.onmouseup=e3;\r\n\t\t\t\t\t\t\t\tnode.onmouseleave=e3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar addButton=ui.create.node('button','添加场景',line1,function(){\r\n\t\t\t\t\t\t\te4(scenelist.value);\r\n\t\t\t\t\t\t},{marginLeft:'6px',marginRight:'12px'});\r\n\t\t\t\t\t\tvar sceneconfig=ui.create.selectlist([\r\n\t\t\t\t\t\t\t['normal','默认模式'],\r\n\t\t\t\t\t\t\t['sequal','连续闯关'],\r\n\t\t\t\t\t\t\t['free','自由选关']\r\n\t\t\t\t\t\t],null,line1);\r\n\t\t\t\t\t\tvar saveButton=ui.create.node('button','保存关卡',line1,function(){\r\n\t\t\t\t\t\t\tif(!scenename.value){\r\n\t\t\t\t\t\t\t\talert('请填写关卡名称');\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(line2.childElementCount<2){\r\n\t\t\t\t\t\t\t\talert('请添加至少2个场景');\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar stage={\r\n\t\t\t\t\t\t\t\tname:scenename.value,\r\n\t\t\t\t\t\t\t\tintro:sceneintro.value,\r\n\t\t\t\t\t\t\t\tscenes:[],\r\n\t\t\t\t\t\t\t\tmode:sceneconfig.value,\r\n\t\t\t\t\t\t\t\tlevel:0\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tfor(var i=0;i<line2.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tstage.scenes.push(lib.storage.scene[line2.childNodes[i].innerHTML]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(lib.storage.stage[scenename.value]){\r\n\t\t\t\t\t\t\t\tif(!confirm('关卡名与现有关卡重复，是否覆盖？')){\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.removeStage(scenename.value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlib.storage.stage[stage.name]=stage;\r\n\t\t\t\t\t\t\tgame.save('stage',lib.storage.stage);\r\n\t\t\t\t\t\t\tgame.addStage(stage.name,true);\r\n\t\t\t\t\t\t},{marginLeft:'6px'});\r\n\t\t\t\t\t\tgame.addStageClear=function(){\r\n\t\t\t\t\t\t\tscenelist.value=scenes[0][0];\r\n\t\t\t\t\t\t\tsceneconfig.value='normal';\r\n\t\t\t\t\t\t\tscenename.value='';\r\n\t\t\t\t\t\t\tsceneintro.value='';\r\n\t\t\t\t\t\t\tline2.innerHTML='';\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/brawl.js?")},"./src/mode/connect.js":function(){eval("\r\ngame.import('mode', function (lib, game, ui, get, ai, _status) {\r\n\treturn {\r\n\t\tname: 'connect',\r\n\t\tstart: function () {\r\n\t\t\tvar directstartmode = lib.config.directstartmode;\r\n\t\t\tui.create.menu(true);\r\n\t\t\tevent.textnode = ui.create.div('', '输入联机地址');\r\n\t\t\tvar createNode = function () {\r\n\t\t\t\tif (event.created) return;\r\n\t\t\t\tif (directstartmode && lib.node) {\r\n\t\t\t\t\tui.exitroom = ui.create.system('退出房间', function () {\r\n\t\t\t\t\t\tgame.saveConfig('directstartmode');\r\n\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t}, true);\r\n\t\t\t\t\tgame.switchMode(directstartmode);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (lib.node && window.require) {\r\n\t\t\t\t\tui.startServer = ui.create.system('启动服务器', function (e) {\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\tui.click.connectMenu();\r\n\t\t\t\t\t}, true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tevent.created = true;\r\n\t\t\t\tvar node = ui.create.div('.shadowed');\r\n\t\t\t\tnode.style.width = '400px';\r\n\t\t\t\tnode.style.height = '30px';\r\n\t\t\t\tnode.style.lineHeight = '30px';\r\n\t\t\t\tnode.style.fontFamily = 'xinwei';\r\n\t\t\t\tnode.style.fontSize = '30px';\r\n\t\t\t\tnode.style.padding = '10px';\r\n\t\t\t\tnode.style.left = 'calc(50% - 210px)';\r\n\t\t\t\tnode.style.top = 'calc(50% - 20px)';\r\n\t\t\t\tnode.style.whiteSpace = 'nowrap';\r\n\t\t\t\tnode.innerHTML = lib.config.last_ip || lib.hallURL;\r\n\t\t\t\tnode.contentEditable = true;\r\n\t\t\t\tnode.style.webkitUserSelect = 'text';//[deprecated]\r\n\t\t\t\tnode.style.textAlign = 'center';\r\n\r\n\t\t\t\tvar connect = function (e) {\r\n\t\t\t\t\tevent.textnode.innerHTML = '正在连接...';\r\n\t\t\t\t\tclearTimeout(event.timeout);\r\n\t\t\t\t\tif (e) e.preventDefault();\r\n\t\t\t\t\tgame.saveConfig('last_ip', node.innerHTML);\r\n\t\t\t\t\tgame.connect(node.innerHTML, function (success) {\r\n\t\t\t\t\t\tif (!success && event.textnode) {\r\n\t\t\t\t\t\t\talert('连接失败');\r\n\t\t\t\t\t\t\tevent.textnode.innerHTML = '输入联机地址';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t\tnode.addEventListener('keydown', function (e) {\r\n\t\t\t\t\tif (e.keyCode == 13) {\r\n\t\t\t\t\t\tconnect(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tui.window.appendChild(node);\r\n\t\t\t\tui.ipnode = node;\r\n\r\n\t\t\t\tvar text = event.textnode;\r\n\t\t\t\ttext.style.width = '400px';\r\n\t\t\t\ttext.style.height = '30px';\r\n\t\t\t\ttext.style.lineHeight = '30px';\r\n\t\t\t\ttext.style.fontFamily = 'xinwei';\r\n\t\t\t\ttext.style.fontSize = '30px';\r\n\t\t\t\ttext.style.padding = '10px';\r\n\t\t\t\ttext.style.left = 'calc(50% - 200px)';\r\n\t\t\t\ttext.style.top = 'calc(50% - 80px)';\r\n\t\t\t\ttext.style.textAlign = 'center';\r\n\t\t\t\tui.window.appendChild(text);\r\n\t\t\t\tui.iptext = text;\r\n\r\n\t\t\t\tvar button = ui.create.div('.menubutton.highlight.large.pointerdiv', '连接', connect);\r\n\t\t\t\tbutton.style.width = '70px';\r\n\t\t\t\tbutton.style.left = 'calc(50% - 35px)';\r\n\t\t\t\tbutton.style.top = 'calc(50% + 60px)';\r\n\t\t\t\tui.window.appendChild(button);\r\n\t\t\t\tui.ipbutton = button;\r\n\r\n\t\t\t\tui.hall_button = ui.create.system('联机大厅', function () {\r\n\t\t\t\t\tnode.innerHTML = get.config('hall_ip') || lib.hallURL;\r\n\t\t\t\t\tconnect();\r\n\t\t\t\t}, true);\r\n\t\t\t\tif (!get.config('hall_button')) {\r\n\t\t\t\t\tui.hall_button.style.display = 'none';\r\n\t\t\t\t}\r\n\t\t\t\tui.recentIP = ui.create.system('最近连接', null, true);\r\n\t\t\t\tvar clickLink = function () {\r\n\t\t\t\t\tnode.innerHTML = this.innerHTML;\r\n\t\t\t\t\tconnect();\r\n\t\t\t\t};\r\n\t\t\t\tlib.setPopped(ui.recentIP, function () {\r\n\t\t\t\t\tif (!lib.config.recentIP.length) return;\r\n\t\t\t\t\tvar uiintro = ui.create.dialog('hidden');\r\n\t\t\t\t\tuiintro.listen(function (e) {\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar list = ui.create.div('.caption');\r\n\t\t\t\t\tfor (var i = 0; i < lib.config.recentIP.length; i++) {\r\n\t\t\t\t\t\tui.create.div('.text.textlink', list, clickLink).innerHTML = get.trimip(lib.config.recentIP[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tuiintro.add(list);\r\n\t\t\t\t\tvar clear = uiintro.add('<div class=\"text center\">清除</div>');\r\n\t\t\t\t\tclear.style.paddingTop = 0;\r\n\t\t\t\t\tclear.style.paddingBottom = '3px';\r\n\t\t\t\t\tclear.listen(function () {\r\n\t\t\t\t\t\tlib.config.recentIP.length = 0;\r\n\t\t\t\t\t\tgame.saveConfig('recentIP', []);\r\n\t\t\t\t\t\tuiintro.delete();\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn uiintro;\r\n\t\t\t\t}, 220);\r\n\t\t\t\tlib.init.onfree();\r\n\t\t\t}\r\n\t\t\tif (window.isNonameServer) {\r\n\t\t\t\tgame.connect(window.isNonameServerIp || 'localhost');\r\n\t\t\t}\r\n\t\t\telse if (lib.config.reconnect_info) {\r\n\t\t\t\tvar info = lib.config.reconnect_info;\r\n\t\t\t\tgame.onlineID = info[1];\r\n\t\t\t\tgame.roomId = info[2];\r\n\t\t\t\tif (typeof game.roomId == 'string') {\r\n\t\t\t\t\tgame.roomIdServer = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar n = 5;\r\n\t\t\t\tvar connect = function () {\r\n\t\t\t\t\tevent.textnode.innerHTML = '正在连接...';\r\n\t\t\t\t\tgame.connect(info[0], function (success) {\r\n\t\t\t\t\t\tif (!success && n--) {\r\n\t\t\t\t\t\t\tcreateNode();\r\n\t\t\t\t\t\t\tevent.timeout = setTimeout(connect, 1000);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tevent.textnode.innerHTML = '输入联机地址';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t\tevent.timeout = setTimeout(connect, 500);\r\n\t\t\t\t_status.createNodeTimeout = setTimeout(createNode, 2000);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tcreateNode();\r\n\t\t\t}\r\n\t\t\tif (!game.onlineKey) {\r\n\t\t\t\tgame.onlineKey = localStorage.getItem(lib.configprefix + 'key');\r\n\t\t\t\tif (!game.onlineKey) {\r\n\t\t\t\t\tgame.onlineKey = get.id();\r\n\t\t\t\t\tlocalStorage.setItem(lib.configprefix + 'key', game.onlineKey);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t_status.connectDenied = createNode;\r\n\t\t\tfor (var i in lib.element.event) {\r\n\t\t\t\tevent.parent[i] = lib.element.event[i];\r\n\t\t\t}\r\n\t\t\tevent.parent.custom = {\r\n\t\t\t\tadd: {},\r\n\t\t\t\treplace: {}\r\n\t\t\t};\r\n\t\t\tsetTimeout(lib.init.onfree, 1000);\r\n\t\t}\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/connect.js?")},"./src/mode/doudizhu.js":function(){eval("\r\ngame.import('mode',function(lib,game,ui,get,ai,_status){\r\n\treturn {\r\n\t\tname:'doudizhu',\r\n\t\tstart:function(){\r\n\t\t\t\"step 0\"\r\n\t\t\tvar playback=localStorage.getItem(lib.configprefix+'playback');\r\n\t\t\tif(playback){\r\n\t\t\t\tui.create.me();\r\n\t\t\t\tui.arena.style.display='none';\r\n\t\t\t\tui.system.style.display='none';\r\n\t\t\t\t_status.playback=playback;\r\n\t\t\t\tlocalStorage.removeItem(lib.configprefix+'playback');\r\n\t\t\t\tvar store=lib.db.transaction(['video'],'readwrite').objectStore('video');\r\n\t\t\t\tstore.get(parseInt(playback)).onsuccess=function(e){\r\n\t\t\t\t\tif(e.target.result){\r\n\t\t\t\t\t\tgame.playVideoContent(e.target.result.video);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\talert('播放失败：找不到录像');\r\n\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tevent.finish();\r\n\t\t\t}\r\n\t\t\telse if(!_status.connectMode){\r\n\t\t\t\tgame.prepareArena(3);\r\n\t\t\t}\r\n\t\t\t\"step 1\"\r\n\t\t\tevent.replacePile=function(){\r\n\t\t\t\tvar map={\r\n\t\t\t\t\tshuiyanqijunx:'shuiyanqijuny',\r\n\t\t\t\t\tbingliang:'binglinchengxia',\r\n\t\t\t\t\tfangtian:'toushiche',\r\n\t\t\t\t\twutiesuolian:'toushiche',\r\n\t\t\t\t};\r\n\t\t\t\tfor(var i=0;i<lib.card.list.length;i++){\r\n\t\t\t\t\tvar name=lib.card.list[i][2];\r\n\t\t\t\t\tif(map[name]){\r\n\t\t\t\t\t\tlib.card.list[i][2]=map[name];\r\n\t\t\t\t\t\tlib.card.list[i][4]=null;\r\n\t\t\t\t\t\tlib.card.list[i]._replaced=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(name=='lebu'){\r\n\t\t\t\t\t\tswitch(lib.card.list[i][0]){\r\n\t\t\t\t\t\t\tcase 'spade': lib.card.list[i][2]='shuiyanqijuny';break;\r\n\t\t\t\t\t\t\tcase 'club': lib.card.list[i][2]='luojingxiashi';break;\r\n\t\t\t\t\t\t\tdefault: lib.card.list[i][2]='baiyidujiang';break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlib.card.list[i]._replaced=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t_status.mode=get.config('doudizhu_mode');\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\t_status.mode=lib.configOL.doudizhu_mode;\r\n\t\t\t\tgame.waitForPlayer(function(){\r\n\t\t\t\t\t\tlib.configOL.number=3;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='binglin'){\r\n\t\t\t\tevent.replacePile();\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='online'){\r\n\t\t\t\tlib.card.list=lib.online_cardPile.slice(0);\r\n\t\t\t\tlib.inpile.addArray(['nanman','wanjian','taoyuan','wugu']);\r\n\t\t\t\tgame.fixedPile=true;\r\n\t\t\t}\r\n\t\t\t\"step 2\"\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\tif(_status.mode=='online'){\r\n\t\t\t\t\tlib.card.list=lib.online_cardPile.slice(0);\r\n\t\t\t\t\tlib.inpile.addArray(['nanman','wanjian','taoyuan','wugu']);\r\n\t\t\t\t\tgame.fixedPile=true;\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='binglin') event.replacePile();\r\n\t\t\t\tif(lib.configOL.number<3){\r\n\t\t\t\t\tlib.configOL.number=3;\r\n\t\t\t\t}\r\n\t\t\t\tgame.randomMapOL();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacter();\r\n\t\t\t}\r\n\t\t\t\"step 3\"\r\n\t\t\tif(ui.coin){\r\n\t\t\t\t_status.coinCoeff=get.coinCoeff([game.me.name]);\r\n\t\t\t}\r\n\t\t\tgame.showIdentity(true);\r\n\t\t\tvar map={};\r\n\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\tmap[i]=lib.playerOL[i].identity;\r\n\t\t\t}\r\n\t\t\tgame.broadcast(function(map){\r\n\t\t\t\tfor(var i in map){\r\n\t\t\t\t\tlib.playerOL[i].identity=map[i];\r\n\t\t\t\t\tlib.playerOL[i].setIdentity();\r\n\t\t\t\t\tlib.playerOL[i].ai.shown=1;\r\n\t\t\t\t}\r\n\t\t\t},map);\r\n\t\t\t\r\n\t\t\tgame.syncState();\r\n\t\t\tevent.trigger('gameStart');\r\n\t\t\t\r\n\t\t\tvar players=get.players(lib.sort.position);\r\n\t\t\tvar info=[];\r\n\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\tinfo.push({\r\n\t\t\t\t\tname:players[i].name1,\r\n\t\t\t\t\tname2:players[i].name2,\r\n\t\t\t\t\tidentity:players[i].identity\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t_status.videoInited=true;\r\n\t\t\tgame.addVideo('init',null,info);\r\n\t\t\tif(_status.mode=='kaihei') game.addGlobalSkill('kaihei');\r\n\r\n\t\t\tvar next=game.gameDraw(game.zhu||_status.firstAct||game.me);\r\n\t\t\tif(_status.mode=='online'){\r\n\t\t\t\tgame.zhu.$equip(game.createCard('diqi','club',13));\r\n\t\t\t\tnext.num=function(player){\r\n\t\t\t\t\tvar num=4;\r\n\t\t\t\t\tif(player==game.zhu){\r\n\t\t\t\t\t\tif(lib.character[player.name1]&&get.infoHp(lib.character[player.name1][2])>3) num++;\r\n\t\t\t\t\t\tif(lib.character[player.name2]&&get.infoHp(lib.character[player.name2][2])>3) num++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn num;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='binglin'){\r\n\t\t\t\tnext.num=function(player){\r\n\t\t\t\t\treturn (player==game.zhu?5:4);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tif(_status.mode!='online'&&_status.connectMode&&lib.configOL.change_card) game.replaceHandcards(game.players.slice(0));\r\n\t\t\t\"step 4\"\r\n\t\t\tevent.trigger('phaseLoopBefore');\r\n\t\t\t\"step 5\"\r\n\t\t\tgame.phaseLoop(game.zhu||_status.firstAct||game.me);\r\n\t\t\tgame.zhu.showGiveup();\r\n\t\t},\r\n\t\tgame:{\r\n\t\t\trecommendDizhu:[\r\n\t\t\t\t're_guojia','re_huanggai','re_lvbu','re_guanyu','re_sunquan','re_xusheng','re_wuyi','re_sunben',\r\n\t\t\t\t'xuyou','zhangchunhua','caochong','zhangsong','zhongyao','wangyi',\r\n\t\t\t\t'caochun','maliang','sp_diaochan','quyi','sp_zhaoyun','shamoke',\r\n\t\t\t\t'lijue','liuzan','wenyang','shen_lvmeng','shen_ganning',\r\n\t\t\t\t'jiakui','wangyuanji','lingcao','miheng',\r\n\t\t\t\t'sp_key_yuri','key_hinata','key_rin','key_kyousuke',\r\n\t\t\t\t'ns_chendao','jiakui','haozhao',\r\n\t\t\t],\r\n\t\t\taddRecord:function(bool){\r\n\t\t\t\tif(typeof bool=='boolean'){\r\n\t\t\t\t\tvar data=lib.config.gameRecord.doudizhu.data;\r\n\t\t\t\t\tvar identity=game.me.identity;\r\n\t\t\t\t\tif(!data[identity]){\r\n\t\t\t\t\t\tdata[identity]=[0,0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(bool){\r\n\t\t\t\t\t\tdata[identity][0]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tdata[identity][1]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list=['zhu','fan'];\r\n\t\t\t\t\tvar str='';\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(data[list[i]]){\r\n\t\t\t\t\t\t\tstr+=lib.translate[list[i]+'2']+'：'+data[list[i]][0]+'胜'+' '+data[list[i]][1]+'负<br>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.config.gameRecord.doudizhu.str=str;\r\n\t\t\t\t\tgame.saveConfig('gameRecord',lib.config.gameRecord);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetState:function(){\r\n\t\t\t\tvar state={};\r\n\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\tstate[i]={identity:player.identity};\r\n\t\t\t\t}\r\n\t\t\t\treturn state;\r\n\t\t\t},\r\n\t\t\tupdateState:function(state){\r\n\t\t\t\tfor(var i in state){\r\n\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\tif(player){\r\n\t\t\t\t\t\tplayer.identity=state[i].identity;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupdateRoundNumber:function(){\r\n\t\t\t\tif(_status.mode=='online'){\r\n\t\t\t\t\tgame.broadcastAll(function(num1,num2,top,bonusNum){\r\n\t\t\t\t\t\tif(ui.cardPileNumber){\r\n\t\t\t\t\t\t\tvar str=num1+'轮 公共牌堆: '+num2;\r\n\t\t\t\t\t\t\tif(game.me&&game.me.$.doudizhu_cardPile&&game.me.$.doudizhu_cardPile.length) str+=(' 个人牌堆: '+game.me.$.doudizhu_cardPile.length);\r\n\t\t\t\t\t\t\tif(bonusNum) str+=('<br>本场叫价: '+bonusNum*100);\r\n\t\t\t\t\t\t\tui.cardPileNumber.innerHTML=str;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_status.pileTop=top;\r\n\t\t\t\t\t},game.roundNumber,ui.cardPile.childNodes.length,ui.cardPile.firstChild,game.bonusNum);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tgame.broadcastAll(function(num1,num2,top){\r\n\t\t\t\t\tif(ui.cardPileNumber) ui.cardPileNumber.innerHTML=num1+'轮 剩余牌: '+num2;\r\n\t\t\t\t\t_status.pileTop=top;\r\n\t\t\t\t},game.roundNumber,ui.cardPile.childNodes.length,ui.cardPile.firstChild);\r\n\t\t\t},\r\n\t\t\tgetRoomInfo:function(uiintro){\r\n\t\t\t\tuiintro.add('<div class=\"text chat\">双将模式：'+(lib.configOL.double_character?'开启':'关闭'));\r\n\t\t\t\t// uiintro.add('<div class=\"text chat\">屏蔽弱将：'+(lib.configOL.ban_weak?'开启':'关闭'));\r\n\t\t\t\t// var last=uiintro.add('<div class=\"text chat\">屏蔽强将：'+(lib.configOL.ban_strong?'开启':'关闭'));\r\n\t\t\t\tif(lib.configOL.banned.length){\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">禁用武将：'+get.translation(lib.configOL.banned));\r\n\t\t\t\t}\r\n\t\t\t\tif(lib.configOL.bannedcards.length){\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">禁用卡牌：'+get.translation(lib.configOL.bannedcards));\r\n\t\t\t\t}\r\n\t\t\t\tuiintro.style.paddingBottom='8px';\r\n\t\t\t},\r\n\t\t\tgetVideoName:function(){\r\n\t\t\t\tvar str=get.translation(game.me.name);\r\n\t\t\t\tif(game.me.name2){\r\n\t\t\t\t\tstr+='/'+get.translation(game.me.name2);\r\n\t\t\t\t}\r\n\t\t\t\tvar namex;\r\n\t\t\t\tswitch(_status.mode){\r\n\t\t\t\t\tcase 'normal':namex='休闲斗地主';break;\r\n\t\t\t\t\tcase 'kaihei':namex='开黑斗地主';break;\r\n\t\t\t\t\tcase 'huanle':namex='欢乐斗地主';break;\r\n\t\t\t\t\tcase 'binglin':namex='兵临城下';break;\r\n\t\t\t\t\tcase 'online':namex='智斗三国';break;\r\n\t\t\t\t}\r\n\t\t\t\tvar name=[\r\n\t\t\t\t\tstr,\r\n\t\t\t\t\tnamex+' - '+lib.translate[game.me.identity+'2']\r\n\t\t\t\t];\r\n\t\t\t\treturn name;\r\n\t\t\t},\r\n\t\t\tshowIdentity:function(me){\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t// if(me===false&&game.players[i]==game.me) continue;\r\n\t\t\t\t\tgame.players[i].node.identity.classList.remove('guessing');\r\n\t\t\t\t\tgame.players[i].identityShown=true;\r\n\t\t\t\t\tgame.players[i].ai.shown=1;\r\n\t\t\t\t\tgame.players[i].setIdentity(game.players[i].identity);\r\n\t\t\t\t\tif(game.players[i].identity=='zhu'){\r\n\t\t\t\t\t\tgame.players[i].isZhu=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(_status.clickingidentity){\r\n\t\t\t\t\tfor(var i=0;i<_status.clickingidentity[1].length;i++){\r\n\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform='';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcheckResult:function(){\r\n\t\t\t\tvar me=game.me._trueMe||game.me;\r\n\t\t\t\tif(game.zhu.isAlive()){\r\n\t\t\t\t\tif(_status.mode!='online'&&(_status.mode!='binglin'||game.roundNumber<3)&&game.players.length>1) return;\r\n\t\t\t\t\tif(me==game.zhu){\r\n\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(me==game.zhu){\r\n\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcheckOnlineResult:function(player){\r\n\t\t\t\tif(game.zhu.isAlive()){\r\n\t\t\t\t\treturn player.identity=='zhu';\r\n\t\t\t\t}\r\n\t\t\t\telse return player.identity=='fan';\r\n\t\t\t},\r\n\t\t\tchooseCharacterZhidou:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tgame.no_continue_game=true;\r\n\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar groups=[];\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tevent.map={};\r\n\t\t\t\t\tvar chara=(get.config('character_online')||lib.characterOnline);\r\n\t\t\t\t\tfor(i in chara){\r\n\t\t\t\t\t\tvar list=chara[i];\r\n\t\t\t\t\t\tfor(var j=0;j<list.length;j++){\r\n\t\t\t\t\t\t\tif(!lib.character[list[j]]||(i=='key'&&lib.filter.characterDisabled(list[j]))) list.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(list.length>=3){\r\n\t\t\t\t\t\t\tgroups.push(i);\r\n\t\t\t\t\t\t\tevent.list.addArray(list);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\tevent.controls=['不叫地主','一倍','两倍','三倍'];\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tvar id=player.playerid;\r\n\t\t\t\t\t\tplayer._group=groups.randomRemove(1)[0];\r\n\t\t\t\t\t\tevent.map[id]=chara[player._group].randomGets(3);\r\n\t\t\t\t\t\tplayer.$.doudizhu_cardPile=get.cards(20).sort(function(a,b){\r\n\t\t\t\t\t\t\tif(a.name!=b.name) return lib.sort.card(a.name,b.name);\r\n\t\t\t\t\t\t\telse if(a.suit!=b.suit) return lib.suit.indexOf(a)-lib.suit.indexOf(b);\r\n\t\t\t\t\t\t\telse return a.number-b.number;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.dialog=ui.create.dialog('你的选将框与底牌',[event.map[game.me.playerid],'character'],game.me.$.doudizhu_cardPile);\r\n\t\t\t\t\tevent.start=game.players.randomGet();\r\n\t\t\t\t\tevent.current=event.start;\r\n\t\t\t\t\tgame.delay(7);\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(event.current==game.me) event.dialog.content.firstChild.innerHTML='是否叫地主？';\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.dialog.content.firstChild.innerHTML='请等待其他玩家叫地主';\r\n\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.current.chooseControl(event.controls).set('ai',function(){\r\n\t\t\t\t\t\treturn _status.event.getParent().controls.randomGet();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tevent.current._control=result.control;\r\n\t\t\t\t\tevent.current.chat(result.control);\r\n\t\t\t\t\tif(result.control=='三倍'){\r\n\t\t\t\t\t\tgame.bonusNum=3;\r\n\t\t\t\t\t\tgame.zhu=event.current;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(result.control!='不叫地主'){\r\n\t\t\t\t\t\tevent.controls.splice(1,event.controls.indexOf(result.control));\r\n\t\t\t\t\t\tevent.tempDizhu=event.current;\r\n\t\t\t\t\t\tif(result.control=='二倍') game.bonusNum=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.current=event.current.next;\r\n\t\t\t\t\tif(event.current==event.start&&(event.start==event.tempDizhu||event.start._control=='不叫地主')){\r\n\t\t\t\t\t\tgame.zhu=event.tempDizhu||event.start.previous;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.current==event.start.next&&event.current._control){\r\n\t\t\t\t\t\tgame.zhu=event.tempDizhu;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.goto(2);\r\n\t\t\t\t\tif(event.current==event.start.previous&&!event.tempDizhu) event.controls.remove('不叫地主');\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tgame.updateRoundNumber();\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tplayer.identity=player==game.zhu?'zhu':'fan';\r\n\t\t\t\t\t\tplayer.showIdentity();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.dialog.content.firstChild.innerHTML='请选择'+get.cnNumber(game.me==game.zhu?2:1)+'张武将牌';\r\n\t\t\t\t\tgame.me.chooseButton(event.dialog,true,game.me==game.zhu?2:1).set('filterButton',function(button){\r\n\t\t\t\t\t\treturn typeof button.link=='string';\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 5\"\r\n\t\t\t\t\tgame.me.init(result.links[0],result.links[1]);\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tif(player!=game.me){\r\n\t\t\t\t\t\t\tif(player==game.zhu){\r\n\t\t\t\t\t\t\t\tvar list=event.map[player.playerid].randomGets(2);\r\n\t\t\t\t\t\t\t\tplayer.init(list[0],list[1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse player.init(event.map[player.playerid].randomGet());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.markSkill('doudizhu_cardPile');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.zhu.hp=4;\r\n\t\t\t\t\tgame.zhu.maxHp=4;\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterBinglin:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tgame.no_continue_game=true;\r\n\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tgame.zhuSkill='zhuSkill_'+['xiangyang','jiangling','fancheng'].randomGet();\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tevent.map={};\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tevent.map[player.playerid]=event.list.randomRemove(4);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.controls=['不叫地主','一倍','两倍','三倍'];\r\n\t\t\t\t\tevent.dialog=ui.create.dialog('本局城池：'+get.translation(game.zhuSkill),[event.map[game.me.playerid],'character']);\r\n\t\t\t\t\tevent.start=game.players.randomGet();\r\n\t\t\t\t\tevent.current=event.start;\r\n\t\t\t\t\tgame.delay(8);\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tevent.current.classList.add('glow_phase');\r\n\t\t\t\t\tif(event.current==game.me) event.dialog.content.firstChild.innerHTML='是否叫地主？';\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.dialog.content.firstChild.innerHTML='请等待其他玩家叫地主';\r\n\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.current.chooseControl(event.controls).set('ai',function(){\r\n\t\t\t\t\t\treturn _status.event.getParent().controls.randomGet();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tevent.current.classList.remove('glow_phase');\r\n\t\t\t\t\tevent.current._control=result.control;\r\n\t\t\t\t\tevent.current.chat(result.control);\r\n\t\t\t\t\tif(result.control=='三倍'){\r\n\t\t\t\t\t\tgame.bonusNum=3;\r\n\t\t\t\t\t\tgame.zhu=event.current;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(result.control!='不叫地主'){\r\n\t\t\t\t\t\tevent.controls.splice(1,event.controls.indexOf(result.control));\r\n\t\t\t\t\t\tevent.tempDizhu=event.current;\r\n\t\t\t\t\t\tif(result.control=='二倍') game.bonusNum=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.current=event.current.next;\r\n\t\t\t\t\tif(event.current==event.start){\r\n\t\t\t\t\t\tgame.zhu=event.tempDizhu||event.start.previous;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.goto(2);\r\n\t\t\t\t\tif(event.current==event.start.previous&&!event.tempDizhu) event.controls.remove('不叫地主');\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tplayer.identity=player==game.zhu?'zhu':'fan';\r\n\t\t\t\t\t\tplayer.showIdentity();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\tevent.map[game.zhu.playerid].addArray(event.list.randomRemove(3));\r\n\t\t\t\t\t\"step 5\"\r\n\t\t\t\t\tvar list=['请选择你的武将',[event.map[game.me.playerid],'character']];\r\n\t\t\t\t\tif(game.me.identity=='fan'){\r\n\t\t\t\t\t\tvar friend=game.findPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current!=game.me&&current.identity=='fan';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tlist.push('<div class=\"text center\">队友的选将框</div>');\r\n\t\t\t\t\t\tlist.push([event.map[friend.playerid],'character']);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButton(list,true).set('list',event.map[game.me.playerid]).set('filterButton',function(button){\r\n\t\t\t\t\t\treturn _status.event.list.contains(button.link);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 6\"\r\n\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tif(player!=game.me) player.init(event.map[player.playerid].randomGet());\r\n\t\t\t\t\t\tif(player==game.zhu){\r\n\t\t\t\t\t\t\tplayer.addSkill(game.zhuSkill);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse player.addSkill(['binglin_shaxue','binglin_neihong']);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.zhu.hp++;\r\n\t\t\t\t\tgame.zhu.maxHp++;\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterHuanle:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tgame.no_continue_game=true;\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tevent.list2=[];\r\n\t\t\t\t\tvar list4=[];\r\n\t\t\t\t\tif(!event.map) event.map={};\r\n\t\t\t\t\tfor(i in lib.characterReplace){\r\n\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\tif(lib.filter.characterDisabled(ix[j])) ix.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(ix.length){\r\n\t\t\t\t\t\t\tvar name=ix.randomGet();\r\n\t\t\t\t\t\t\tevent.list.push(name);\r\n\t\t\t\t\t\t\tif(game.recommendDizhu.contains(name)) event.list2.push(name);\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(list4.contains(i)||lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\tif(game.recommendDizhu.contains(i)) event.list2.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\tevent.controls=['不叫','叫地主'];\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tvar id=player.playerid;\r\n\t\t\t\t\t\tif(!event.map[id]) event.map[id]=[];\r\n\t\t\t\t\t\tevent.map[id].addArray(event.list2.randomRemove(1));\r\n\t\t\t\t\t\tevent.list.removeArray(event.map[id]);\r\n\t\t\t\t\t\tevent.map[id].addArray(event.list.randomRemove(4-event.map[id].length));\r\n\t\t\t\t\t\tevent.list2.removeArray(event.map[id]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.dialog=ui.create.dialog('你的选将框',[event.map[game.me.playerid],'character']);\r\n\t\t\t\t\tevent.start=game.players.randomGet();\r\n\t\t\t\t\tevent.current=event.start;\r\n\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\tgame.delay(2.5);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tevent.current.chooseControl(event.controls).set('ai',function(){\r\n\t\t\t\t\t\treturn Math.random()>0.5?'不叫':'叫地主';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(event.current==game.me){\r\n\t\t\t\t\t\tevent.dialog.content.childNodes[0].innerHTML='是否抢地主？';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tevent.current.chat(result.control);\r\n\t\t\t\t\tif(result.control=='叫地主'||event.current==event.start.next){\r\n\t\t\t\t\t\tgame.zhu=result.control=='叫地主'?event.current:event.current.next;\r\n\t\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\t\tplayer.identity=player==game.zhu?'zhu':'fan';\r\n\t\t\t\t\t\t\tplayer.showIdentity();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\tevent.map[game.zhu.playerid].addArray(event.list.randomRemove(3));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.current=event.current.next;\r\n\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t\tgame.delay(1.5);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tgame.me.chooseButton(['请选择你的武将',[event.map[game.me.playerid],'character']],true);\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tif(player!=game.me) player.init(event.map[player.playerid].randomGet());\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.zhu.hp++;\r\n\t\t\t\t\tgame.zhu.maxHp++;\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tchooseCharacterKaihei:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tgame.no_continue_game=true;\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar identityList=['zhu','fan','fan'];\r\n\t\t\t\t\tgame.saveConfig('continue_name');\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tvar list4=[];\r\n\t\t\t\t\tidentityList.randomSort();\r\n\t\t\t\t\tfor(i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].identity=identityList[i];\r\n\t\t\t\t\t\tgame.players[i].showIdentity();\r\n\t\t\t\t\t\tif(identityList[i]=='zhu'){\r\n\t\t\t\t\t\t\tgame.zhu=game.players[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(!game.zhu) game.zhu=game.me;\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.zhu.setIdentity();\r\n\t\t\t\t\t\tgame.zhu.identityShown=true;\r\n\t\t\t\t\t\tgame.zhu.isZhu=(game.zhu.identity=='zhu');\r\n\t\t\t\t\t\tgame.zhu.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\t\tgame.me.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor(i in lib.characterReplace){\r\n\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\tif(lib.filter.characterDisabled(ix[j])) ix.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(ix.length){\r\n\t\t\t\t\t\t\tevent.list.push(ix.randomGet());\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(list4.contains(i)||lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tplayer._characterChoice=event.list.randomRemove(player.identity=='zhu'?5:3);\r\n\t\t\t\t\t\tif(player.identity=='fan') player._friend=(player.next.identity=='fan'?player.next:player.previous);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar createDialog=['选择武将'];\r\n\t\t\t\t\tcreateDialog.push([game.me._characterChoice,'character']);\r\n\t\t\t\t\tif(game.me._friend){\r\n\t\t\t\t\t\tcreateDialog.push('队友的武将');\r\n\t\t\t\t\t\tcreateDialog.push([game.me._friend._characterChoice,'character']);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButton(createDialog,true).set('onfree',true).set('filterButton',function(button){\r\n\t\t\t\t\t\treturn _status.event.player._characterChoice.contains(button.link);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i]!=game.me) game.players[i].init(game.players[i]._characterChoice.randomGet());\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t\tif(game.players[i]==game.zhu){\r\n\t\t\t\t\t\t\tgame.players[i].hp++;\r\n\t\t\t\t\t\t\tgame.players[i].maxHp++;\r\n\t\t\t\t\t\t\tgame.players[i].update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacter:function(){\r\n\t\t\t\tif(_status.mode=='kaihei'){\r\n\t\t\t\t\tgame.chooseCharacterKaihei();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(_status.mode=='huanle'){\r\n\t\t\t\t\tgame.chooseCharacterHuanle();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(_status.mode=='online'){\r\n\t\t\t\t\tgame.chooseCharacterZhidou();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(_status.mode=='binglin'){\r\n\t\t\t\t\tgame.chooseCharacterBinglin();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.addPlayer=function(player){\r\n\t\t\t\t\tvar list=lib.config.mode_config.identity.identity[game.players.length-3].slice(0);\r\n\t\t\t\t\tvar list2=lib.config.mode_config.identity.identity[game.players.length-2].slice(0);\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++) list2.remove(list[i]);\r\n\t\t\t\t\tplayer.identity=list2[0];\r\n\t\t\t\t\tplayer.setIdentity('cai');\r\n\t\t\t\t};\r\n\t\t\t\tnext.removePlayer=function(){\r\n\t\t\t\t\treturn game.players.randomGet(game.me,game.zhu);\r\n\t\t\t\t};\r\n\t\t\t\tnext.ai=function(player,list,list2,back){\r\n\t\t\t\t\tvar listc=list.slice(0,2);\r\n\t\t\t\t\tfor(var i=0;i<listc.length;i++){\r\n\t\t\t\t\t\tvar listx=lib.characterReplace[listc[i]];\r\n\t\t\t\t\t\tif(listx&&listx.length) listc[i]=listx.randomGet();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(get.config('double_character')){\r\n\t\t\t\t\t\tplayer.init(listc[0],listc[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.init(listc[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(player==game.zhu){\r\n\t\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(back){\r\n\t\t\t\t\t\tlist.remove(get.sourceCharacter(player.name1));\r\n\t\t\t\t\t\tlist.remove(get.sourceCharacter(player.name2));\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tback.push(list[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(typeof lib.config.test_game=='string'&&player==game.me.next){\r\n\t\t\t\t\t\tplayer.init(lib.config.test_game);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.node.name.dataset.nature=get.groupnature(player.group);\r\n\t\t\t\t}\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar list;\r\n\t\t\t\t\tvar list4=[];\r\n\t\t\t\t\tvar identityList=['zhu','fan','fan'];\r\n\t\t\t\t\tvar chosen=lib.config.continue_name||[];\r\n\t\t\t\t\tgame.saveConfig('continue_name');\r\n\t\t\t\t\tevent.chosen=chosen;\r\n\r\n\t\t\t\t\tvar addSetting=function(dialog){\r\n\t\t\t\t\t\tdialog.add('选择身份').classList.add('add-setting');\r\n\t\t\t\t\t\tvar table=document.createElement('div');\r\n\t\t\t\t\t\ttable.classList.add('add-setting');\r\n\t\t\t\t\t\ttable.style.margin='0';\r\n\t\t\t\t\t\ttable.style.width='100%';\r\n\t\t\t\t\t\ttable.style.position='relative';\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar listi=['random','zhu','fan'];\r\n\t\t\t\t\t\tfor(var i=0;i<listi.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.link=listi[i];\r\n\t\t\t\t\t\t\tif(td.link===game.me.identity){\r\n\t\t\t\t\t\t\t\ttd.classList.add('bluebg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.appendChild(td);\r\n\t\t\t\t\t\t\ttd.innerHTML='<span>'+get.translation(listi[i]+'2')+'</span>';\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\t_status.tempNoButton=true;\r\n\t\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\t_status.tempNoButton=false;\r\n\t\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t\t\tvar link=this.link;\r\n\t\t\t\t\t\t\t\tif(game.zhu.name){\r\n\t\t\t\t\t\t\t\t\tif(link!='random'){\r\n\t\t\t\t\t\t\t\t\t\t_status.event.parent.fixedseat=get.distance(game.me,game.zhu,'absolute');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tgame.zhu.uninit();\r\n\t\t\t\t\t\t\t\t\tdelete game.zhu.isZhu;\r\n\t\t\t\t\t\t\t\t\tdelete game.zhu.identityShown;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar current=this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcurrent=seats.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(link=='random'){\r\n\t\t\t\t\t\t\t\t\tlink=['zhu','fan'].randomGet();\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<this.parentNode.childElementCount;i++){\r\n\t\t\t\t\t\t\t\t\t\tif(this.parentNode.childNodes[i].link==link){\r\n\t\t\t\t\t\t\t\t\t\t\tthis.parentNode.childNodes[i].classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tnum=get.config('choice_'+link);\r\n\t\t\t\t\t\t\t\t_status.event.parent.swapnodialog=function(dialog,list){\r\n\t\t\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\t\t\tvar node=dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t\t\tdialog.buttons=ui.create.buttons(list,'characterx',buttons);\r\n\t\t\t\t\t\t\t\t\tdialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<seats.childElementCount;i++){\r\n\t\t\t\t\t\t\t\t\t\tif(get.distance(game.zhu,game.me,'absolute')===seats.childNodes[i].link){\r\n\t\t\t\t\t\t\t\t\t\t\tseats.childNodes[i].classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t_status.event=_status.event.parent;\r\n\t\t\t\t\t\t\t\t_status.event.step=0;\r\n\t\t\t\t\t\t\t\t_status.event.identity=link;\r\n\t\t\t\t\t\t\t\tif(link!=(event.zhongmode?'mingzhong':'zhu')){\r\n\t\t\t\t\t\t\t\t\tseats.previousSibling.style.display='';\r\n\t\t\t\t\t\t\t\t\tseats.style.display='';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tseats.previousSibling.style.display='none';\r\n\t\t\t\t\t\t\t\t\tseats.style.display='none';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(table);\r\n\r\n\t\t\t\t\t\tdialog.add('选择座位').classList.add('add-setting');\r\n\t\t\t\t\t\tvar seats=document.createElement('div');\r\n\t\t\t\t\t\tseats.classList.add('add-setting');\r\n\t\t\t\t\t\tseats.style.margin='0';\r\n\t\t\t\t\t\tseats.style.width='100%';\r\n\t\t\t\t\t\tseats.style.position='relative';\r\n\t\t\t\t\t\tfor(var i=2;i<=game.players.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.innerHTML=get.cnNumber(i,true);\r\n\t\t\t\t\t\t\ttd.link=i-1;\r\n\t\t\t\t\t\t\tseats.appendChild(td);\r\n\t\t\t\t\t\t\tif(get.distance(game.zhu,game.me,'absolute')===i-1){\r\n\t\t\t\t\t\t\t\ttd.classList.add('bluebg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\tif(get.distance(game.zhu,game.me,'absolute')==this.link) return;\r\n\t\t\t\t\t\t\t\tvar current=this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(get.distance(game.players[i],game.me,'absolute')==this.link){\r\n\t\t\t\t\t\t\t\t\t\tgame.swapSeat(game.zhu,game.players[i],false);return;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(seats);\r\n\t\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\t\tseats.previousSibling.style.display='none';\r\n\t\t\t\t\t\t\tseats.style.display='none';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tif(get.is.phoneLayout()) dialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar removeSetting=function(){\r\n\t\t\t\t\t\tvar dialog=_status.event.dialog;\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tdialog.style.height='';\r\n\t\t\t\t\t\t\tdelete dialog._scrollset;\r\n\t\t\t\t\t\t\tvar list=Array.from(dialog.querySelectorAll('.add-setting'));\r\n\t\t\t\t\t\t\twhile(list.length){\r\n\t\t\t\t\t\t\t\tlist.shift().remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.addSetting=addSetting;\r\n\t\t\t\t\tevent.removeSetting=removeSetting;\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tidentityList.randomSort();\r\n\t\t\t\t\tif(event.identity){\r\n\t\t\t\t\t\tidentityList.remove(event.identity);\r\n\t\t\t\t\t\tidentityList.unshift(event.identity);\r\n\t\t\t\t\t\tif(event.fixedseat){\r\n\t\t\t\t\t\t\tvar zhuIdentity='zhu';\r\n\t\t\t\t\t\t\tif(zhuIdentity!=event.identity){\r\n\t\t\t\t\t\t\t\tidentityList.remove(zhuIdentity);\r\n\t\t\t\t\t\t\t\tidentityList.splice(event.fixedseat,0,zhuIdentity);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete event.fixedseat;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete event.identity;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tgame.players[i].identity=identityList[i];\r\n\t\t\t\t\t\t\tgame.players[i].showIdentity();\r\n\t\t\t\t\t\t\tif(identityList[i]=='zhu'){\r\n\t\t\t\t\t\t\t\tgame.zhu=game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(!game.zhu) game.zhu=game.me;\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.zhu.setIdentity();\r\n\t\t\t\t\t\tgame.zhu.identityShown=true;\r\n\t\t\t\t\t\tgame.zhu.isZhu=(game.zhu.identity=='zhu');\r\n\t\t\t\t\t\tgame.zhu.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\t\tgame.me.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//选将框分配\r\n\t\t\t\t\tfor(i in lib.characterReplace){\r\n\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\tif(chosen.contains(ix[j])||lib.filter.characterDisabled(ix[j])) ix.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(ix.length){\r\n\t\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(chosen.contains(i)||list4.contains(i)) continue;\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\tlist4.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t_status.characterlist=list4.slice(0);\r\n\t\t\t\t\tvar num=get.config('choice_'+game.me.identity);\r\n\t\t\t\t\tlist=event.list.slice(0,num);\r\n\t\t\t\t\tdelete event.swapnochoose;\r\n\t\t\t\t\tvar dialog;\r\n\t\t\t\t\tif(event.swapnodialog){\r\n\t\t\t\t\t\tdialog=ui.dialog;\r\n\t\t\t\t\t\tevent.swapnodialog(dialog,list);\r\n\t\t\t\t\t\tdelete event.swapnodialog;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar str='选择角色';\r\n\t\t\t\t\t\tif(_status.brawl&&_status.brawl.chooseCharacterStr){\r\n\t\t\t\t\t\t\tstr=_status.brawl.chooseCharacterStr;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog=ui.create.dialog(str,'hidden',[list,'characterx']);\r\n\t\t\t\t\t\tif(!_status.brawl||!_status.brawl.noAddSetting){\r\n\t\t\t\t\t\t\tif(get.config('change_identity')){\r\n\t\t\t\t\t\t\t\taddSetting(dialog);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdialog.setCaption('选择角色');\r\n\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(!event.chosen.length){\r\n\t\t\t\t\t\tgame.me.chooseButton(dialog,true).set('onfree',true).selectButton=function(){\r\n\t\t\t\t\t\t\treturn get.config('double_character')?2:1\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.create.cheat=function(){\r\n\t\t\t\t\t\t_status.createControl=ui.cheat2;\r\n\t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n\t\t\t\t\t\t\tif(ui.cheat2&&ui.cheat2.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\tlist=event.list.slice(0,num);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list,'characterx',buttons);\r\n\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\tlib.onfree.push(function(){\r\n\t\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n\t\t\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tui.create.cheat2=function(){\r\n\t\t\t\t\t\tui.cheat2=ui.create.control('自由选将',function(){\r\n\t\t\t\t\t\t\tif(this.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=this.backup;\r\n\t\t\t\t\t\t\t\tthis.backup.open();\r\n\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.backup=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=_status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\tthis.dialog=_status.event.dialog;\r\n\t\t\t\t\t\t\t\tthis.dialog.open();\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!_status.brawl||!_status.brawl.chooseCharacterFixed){\r\n\t\t\t\t\t\tif(!ui.cheat&&get.config('change_choice'))\r\n\t\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\t\tif(!ui.cheat2&&get.config('free_choose'))\r\n\t\t\t\t\t\tui.create.cheat2();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar chooseGroup=false;\r\n\t\t\t\t\tif(event.chosen.length){\r\n\t\t\t\t\t\tif(lib.character[event.chosen[0]][1]=='shen'){\r\n\t\t\t\t\t\t\tchooseGroup=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.modchosen){\r\n\t\t\t\t\t\tif(event.modchosen[0]=='random') event.modchosen[0]=result.buttons[0].link;\r\n\t\t\t\t\t\telse event.modchosen[1]=result.buttons[0].link;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(result.buttons.length==2){\r\n\t\t\t\t\t\tevent.choosed=[result.buttons[0].link,result.buttons[1].link];\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link,result.buttons[1].link);\r\n\t\t\t\t\t\tif(lib.character[event.choosed[0]][1]=='shen'){\r\n\t\t\t\t\t\t\tchooseGroup=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.choosed=[result.buttons[0].link];\r\n\t\t\t\t\t\tif(lib.character[event.choosed[0]][1]=='shen'){\r\n\t\t\t\t\t\t\tchooseGroup=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(event.chosen.length){\r\n\t\t\t\t\t\tgame.me.init(event.chosen[0],event.chosen[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.modchosen){\r\n\t\t\t\t\t\tgame.me.init(event.modchosen[0],event.modchosen[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.choosed.length==2){\r\n\t\t\t\t\t\tgame.me.init(event.choosed[0],event.choosed[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.me.init(event.choosed[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.remove(get.sourceCharacter(game.me.name1));\r\n\t\t\t\t\tevent.list.remove(get.sourceCharacter(game.me.name2));\r\n\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\tgame.me.hp++;\r\n\t\t\t\t\t\tgame.me.maxHp++;\r\n\t\t\t\t\t\tgame.me.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\tevent.ai(game.players[i],event.list.splice(0,get.config('choice_'+game.players[i].identity)),null,event.list)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(get.sourceCharacter(game.players[i].name1));\r\n\t\t\t\t\t\t_status.characterlist.remove(get.sourceCharacter(game.players[i].name2));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tchooseCharacterKaiheiOL:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar identityList=['fan','fan','fan'];\r\n\t\t\t\t\tvar aiList=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current!=game.me&&!current.isOnline();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(aiList.length==1){\r\n\t\t\t\t\t\tidentityList[game.players.indexOf(aiList[0])]='zhu';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tidentityList[0]='zhu';\r\n\t\t\t\t\t\tidentityList.randomSort();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].identity=identityList[i];\r\n\t\t\t\t\t\tgame.players[i].showIdentity();\r\n\t\t\t\t\t\tgame.players[i].identityShown=true;\r\n\t\t\t\t\t\tif(identityList[i]=='zhu') game.zhu=game.players[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tvar list4=[];\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar libCharacter={};\r\n\t\t\t\t\tfor(var i=0;i<lib.configOL.characterPack.length;i++){\r\n\t\t\t\t\t\tvar pack=lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor(var j in pack){\r\n\t\t\t\t\t\t\tif(j=='zuoci') continue;\r\n\t\t\t\t\t\t\tif(lib.character[j]) libCharacter[j]=pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.characterReplace){\r\n\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\tif(!libCharacter[ix[j]]||lib.filter.characterDisabled(ix[j],libCharacter)) ix.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(ix.length){\r\n\t\t\t\t\t\t\tevent.list.push(ix.randomGet());\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in libCharacter){\r\n\t\t\t\t\t\tif(list4.contains(i)||lib.filter.characterDisabled(i,libCharacter)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar map={};\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tplayer._characterChoice=event.list.randomRemove(player.identity=='zhu'?5:3);\r\n\t\t\t\t\t\tif(player.identity=='fan') player._friend=(player.next.identity=='fan'?player.next:player.previous);\r\n\t\t\t\t\t\tmap[player.playerid]=player._characterChoice;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function(map){\r\n\t\t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\t\tlib.playerOL[i]._characterChoice=map[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},map);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tvar dialog=['请选择武将',[game.players[i]._characterChoice,'character']];\r\n\t\t\t\t\t\tif(game.players[i]._friend){\r\n\t\t\t\t\t\t\tdialog.push('队友的武将');\r\n\t\t\t\t\t\t\tdialog.push([game.players[i]._friend._characterChoice,'character']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlist.push([game.players[i],dialog,true,function(){return Math.random()},function(button){\r\n\t\t\t\t\t\t\treturn _status.event.player._characterChoice.contains(button.link);\r\n\t\t\t\t\t\t}]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(list,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\t\tif(!result[i]||result[i]=='ai'||!result[i].links||!result[i].links.length){\r\n\t\t\t\t\t\t\tresult[i]=lib.playerOL[i]._characterChoice.randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tresult[i]=result[i].links[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.zhu.maxHp++;\r\n\t\t\t\t\tgame.zhu.hp++;\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.broadcast(function(result,zhu){\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.zhu=zhu;\r\n\t\t\t\t\t\tzhu.maxHp++;\r\n\t\t\t\t\t\tzhu.hp++;\r\n\t\t\t\t\t\tzhu.update();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},result,game.zhu);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterHuanleOL:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tevent.list2=[];\r\n\t\t\t\t\tvar list4=[];\r\n\t\t\t\t\tevent.controls=['不叫','叫地主'];\r\n\t\t\t\t\tif(!event.map) event.map={};\r\n\t\t\t\t\tvar libCharacter={};\r\n\t\t\t\t\tfor(var i=0;i<lib.configOL.characterPack.length;i++){\r\n\t\t\t\t\t\tvar pack=lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor(var j in pack){\r\n\t\t\t\t\t\t\tif(j=='zuoci') continue;\r\n\t\t\t\t\t\t\tif(lib.character[j]) libCharacter[j]=pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.characterReplace){\r\n\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\tif(!libCharacter[ix[j]]||lib.filter.characterDisabled(ix[j],libCharacter)) ix.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(ix.length){\r\n\t\t\t\t\t\t\tvar name=ix.randomGet();\r\n\t\t\t\t\t\t\tevent.list.push(name);\r\n\t\t\t\t\t\t\tif(game.recommendDizhu.contains(name)) event.list2.push(name);\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in libCharacter){\r\n\t\t\t\t\t\tif(list4.contains(i)||lib.filter.characterDisabled(i,libCharacter)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\tif(game.recommendDizhu.contains(i)) event.list2.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tvar id=player.playerid;\r\n\t\t\t\t\t\tif(!event.map[id]) event.map[id]=[];\r\n\t\t\t\t\t\tevent.map[id].addArray(event.list2.randomRemove(1));\r\n\t\t\t\t\t\tevent.list.removeArray(event.map[id]);\r\n\t\t\t\t\t\tevent.map[id].addArray(event.list.randomRemove(4-event.map[id].length));\r\n\t\t\t\t\t\tevent.list2.removeArray(event.map[id]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\tevent.videoId=lib.status.videoId++;\r\n\t\t\t\t\tgame.broadcastAll(function(map,id){\r\n\t\t\t\t\t\tui.create.dialog('你的选将框',[map[game.me.playerid],'character']).videoId=id;\r\n\t\t\t\t\t},event.map,event.videoId);\r\n\t\t\t\t\tevent.start=game.players.randomGet();\r\n\t\t\t\t\tevent.current=event.start;\r\n\t\t\t\t\tif(event.current!=game.me||!event.current.isOnline()) game.delay(3);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tevent.current.chooseControl(event.controls).set('ai',function(){\r\n\t\t\t\t\t\treturn Math.random()>0.5?'不叫':'叫地主';\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tevent.current.chat(result.control);\r\n\t\t\t\t\tif(result.control=='叫地主'||event.current==event.start.next){\r\n\t\t\t\t\t\tgame.zhu=result.control=='叫地主'?event.current:event.current.next;\r\n\t\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\t\tplayer.identity=player==game.zhu?'zhu':'fan';\r\n\t\t\t\t\t\t\tplayer.showIdentity();\r\n\t\t\t\t\t\t\tplayer.identityShown=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.broadcastAll('closeDialog',event.videoId)\r\n\t\t\t\t\t\tevent.map[game.zhu.playerid].addArray(event.list.randomRemove(3));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.current=event.current.next;\r\n\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tvar str='选择角色';\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tlist.push([game.players[i],[str,[event.map[game.players[i].playerid],'character']],true]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(list,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0],result.links[1]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]&&result[i].links){\r\n\t\t\t\t\t\t\tfor(var j=0;j<result[i].links.length;j++){\r\n\t\t\t\t\t\t\t\tevent.list2.remove(result[i].links[j]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]=='ai'){\r\n\t\t\t\t\t\t\tresult[i]=event.list2.randomRemove(lib.configOL.double_character?2:1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tresult[i]=result[i].links\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0],result[i][1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.zhu.maxHp++;\r\n\t\t\t\t\tgame.zhu.hp++;\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.broadcast(function(result,zhu){\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0],result[i][1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.zhu=zhu;\r\n\t\t\t\t\t\tzhu.maxHp++;\r\n\t\t\t\t\t\tzhu.hp++;\r\n\t\t\t\t\t\tzhu.update();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},result,game.zhu);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterBinglinOL:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar libCharacter={};\r\n\t\t\t\t\tfor(var i=0;i<lib.configOL.characterPack.length;i++){\r\n\t\t\t\t\t\tvar pack=lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor(var j in pack){\r\n\t\t\t\t\t\t\tif(j=='zuoci') continue;\r\n\t\t\t\t\t\t\tif(lib.character[j]) libCharacter[j]=pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tevent.map={};\r\n\t\t\t\t\tfor(i in libCharacter){\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i,libCharacter)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\tevent.controls=['不叫地主','一倍','两倍','三倍'];\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tvar id=player.playerid;\r\n\t\t\t\t\t\tevent.map[id]=event.list.randomRemove(4);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.start=game.players.randomGet();\r\n\t\t\t\t\tevent.current=event.start;\r\n\t\t\t\t\t\r\n\t\t\t\t\tevent.videoId=lib.status.videoId++;\r\n\t\t\t\t\tgame.zhuSkill='zhuSkill_'+['xiangyang','jiangling','fancheng'].randomGet();\r\n\t\t\t\t\tgame.broadcastAll(function(map,id,skill){\r\n\t\t\t\t\t\tui.create.dialog('本局城池：'+get.translation(skill),[map[game.me.playerid],'character']).videoId=id;\r\n\t\t\t\t\t},event.map,event.videoId,game.zhuSkill);\r\n\t\t\t\t\tgame.delay(6);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tgame.broadcastAll(function(id,current){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(game.me==current) dialog.content.firstChild.innerHTML='是否叫地主？';\r\n\t\t\t\t\t\t\telse dialog.content.firstChild.innerHTML='请等待其他玩家叫地主';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},event.videoId,event.current);\r\n\t\t\t\t\tif(event.current!=game.me&&!event.current.isOnline()) game.delay(2);\r\n\t\t\t\t\tevent.current.chooseControl(event.controls).set('ai',function(){\r\n\t\t\t\t\t\treturn _status.event.getParent().controls.randomGet();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tevent.current._control=result.control;\r\n\t\t\t\t\tevent.current.chat(result.control);\r\n\t\t\t\t\tif(result.control=='三倍'){\r\n\t\t\t\t\t\tgame.bonusNum=3;\r\n\t\t\t\t\t\tgame.zhu=event.current;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(result.control!='不叫地主'){\r\n\t\t\t\t\t\tevent.controls.splice(1,event.controls.indexOf(result.control));\r\n\t\t\t\t\t\tevent.tempDizhu=event.current;\r\n\t\t\t\t\t\tif(result.control=='二倍') game.bonusNum=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.current=event.current.next;\r\n\t\t\t\t\tif(event.current==event.start){\r\n\t\t\t\t\t\tgame.zhu=event.tempDizhu||event.start;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.goto(1);\r\n\t\t\t\t\tif(event.current==event.start.previous&&!event.tempDizhu) event.controls.remove('不叫地主');\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tplayer.identity=player==game.zhu?'zhu':'fan';\r\n\t\t\t\t\t\tplayer.showIdentity();\r\n\t\t\t\t\t\tplayer.identityShown=true;\r\n\t\t\t\t\t\tplayer._characterChoice=event.map[player.playerid];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.map[game.zhu.playerid].addArray(event.list.randomRemove(3));\r\n\t\t\t\t\tgame.broadcastAll(function(id,map){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog) dialog.close();\r\n\t\t\t\t\t\tgame.me._characterChoice=map[game.me.playerid];\r\n\t\t\t\t\t},event.videoId,event.map);\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tvar dialog=['请选择武将',[event.map[game.players[i].playerid],'character']];\r\n\t\t\t\t\t\tif(game.players[i].identity=='fan'){\r\n\t\t\t\t\t\t\tvar friend=game.findPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn current!=game.players[i]&&current.identity=='fan';\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tdialog.push('<div class=\"text center\">队友的选将框</div>');\r\n\t\t\t\t\t\t\tdialog.push([event.map[friend.playerid],'character']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlist.push([game.players[i],dialog,true,function(){return Math.random()},function(button){\r\n\t\t\t\t\t\t\treturn _status.event.player._characterChoice.contains(button.link);\r\n\t\t\t\t\t\t}]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(list,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\t\tif(!result[i]||result[i]=='ai'||!result[i].links||!result[i].links.length){\r\n\t\t\t\t\t\t\tresult[i]=event.map[i].randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tresult[i]=result[i].links[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.zhu.maxHp++;\r\n\t\t\t\t\tgame.zhu.hp++;\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.broadcast(function(result,zhu){\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.zhu=zhu;\r\n\t\t\t\t\t\tzhu.maxHp++;\r\n\t\t\t\t\t\tzhu.hp++;\r\n\t\t\t\t\t\tzhu.update();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},result,game.zhu);\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tif(player==game.zhu){\r\n\t\t\t\t\t\t\tplayer.addSkill(game.zhuSkill);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse player.addSkill(['binglin_shaxue','binglin_neihong']);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterZhidouOL:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar libCharacter={};\r\n\t\t\t\t\tfor(var i=0;i<lib.configOL.characterPack.length;i++){\r\n\t\t\t\t\t\tvar pack=lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor(var j in pack){\r\n\t\t\t\t\t\t\tif(j=='zuoci') continue;\r\n\t\t\t\t\t\t\tif(lib.character[j]) libCharacter[j]=pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar groups=[];\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tevent.map={};\r\n\t\t\t\t\tvar chara=(get.config('character_online')||lib.characterOnline);\r\n\t\t\t\t\tfor(i in chara){\r\n\t\t\t\t\t\tvar list=chara[i];\r\n\t\t\t\t\t\tfor(var j=0;j<list.length;j++){\r\n\t\t\t\t\t\t\tif(!lib.character[list[j]]||lib.connectBanned.contains(list[j])||(i=='key'&&lib.filter.characterDisabled(list[j],libCharacter))) list.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(list.length>=3){\r\n\t\t\t\t\t\t\tgroups.push(i);\r\n\t\t\t\t\t\t\tevent.list.addArray(list);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\tevent.controls=['不叫地主','一倍','两倍','三倍'];\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tvar id=player.playerid;\r\n\t\t\t\t\t\tplayer._group=groups.randomRemove(1)[0];\r\n\t\t\t\t\t\tevent.map[id]=chara[player._group].randomGets(3);\r\n\t\t\t\t\t\tplayer.$.doudizhu_cardPile=get.cards(20).sort(function(a,b){\r\n\t\t\t\t\t\t\tif(a.name!=b.name) return lib.sort.card(a.name,b.name);\r\n\t\t\t\t\t\t\telse if(a.suit!=b.suit) return lib.suit.indexOf(a)-lib.suit.indexOf(b);\r\n\t\t\t\t\t\t\telse return a.number-b.number;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tplayer.markSkill('doudizhu_cardPile');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.start=game.players.randomGet();\r\n\t\t\t\t\tevent.current=event.start;\r\n\t\t\t\t\t\r\n\t\t\t\t\tevent.videoId=lib.status.videoId++;\r\n\t\t\t\t\tgame.broadcastAll(function(map,id){\r\n\t\t\t\t\t\tui.create.dialog('你的选将框和底牌',[map[game.me.playerid],'character'],game.me.$.doudizhu_cardPile).videoId=id;\r\n\t\t\t\t\t},event.map,event.videoId);\r\n\t\t\t\t\tgame.delay(4);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tgame.broadcastAll(function(id,current){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(game.me==current) dialog.content.firstChild.innerHTML='是否叫地主？';\r\n\t\t\t\t\t\t\telse dialog.content.firstChild.innerHTML='请等待其他玩家叫地主';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},event.videoId,event.current);\r\n\t\t\t\t\tif(event.current!=game.me&&!event.current.isOnline()) game.delay(2);\r\n\t\t\t\t\tevent.current.chooseControl(event.controls).set('ai',function(){\r\n\t\t\t\t\t\treturn _status.event.getParent().controls.randomGet();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tevent.current._control=result.control;\r\n\t\t\t\t\tevent.current.chat(result.control);\r\n\t\t\t\t\tif(result.control=='三倍'){\r\n\t\t\t\t\t\tgame.bonusNum=3;\r\n\t\t\t\t\t\tgame.zhu=event.current;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(result.control!='不叫地主'){\r\n\t\t\t\t\t\tevent.controls.splice(1,event.controls.indexOf(result.control));\r\n\t\t\t\t\t\tevent.tempDizhu=event.current;\r\n\t\t\t\t\t\tif(result.control=='二倍') game.bonusNum=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.current=event.current.next;\r\n\t\t\t\t\tif(event.current==event.start&&(event.start==event.tempDizhu||event.start._control=='不叫地主')){\r\n\t\t\t\t\t\tgame.zhu=event.tempDizhu||event.start.previous;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.current==event.start.next&&event.current._control){\r\n\t\t\t\t\t\tgame.zhu=event.tempDizhu;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.goto(1);\r\n\t\t\t\t\tif(event.current==event.start.previous&&!event.tempDizhu) event.controls.remove('不叫地主');\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tfor(var player of game.players){\r\n\t\t\t\t\t\tplayer.identity=player==game.zhu?'zhu':'fan';\r\n\t\t\t\t\t\tplayer.showIdentity();\r\n\t\t\t\t\t\tplayer.identityShown=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll('closeDialog',event.videoId);\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tlist.push([game.players[i],['选择'+(game.players[i]==game.zhu?'两':'一')+'张武将牌',[event.map[game.players[i].playerid],'character']],true,game.players[i]==game.zhu?2:1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(list,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0],result.links[1]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]=='ai'){\r\n\t\t\t\t\t\t\tresult[i]=event.map[i].randomRemove(lib.playerOL[i]==game.zhu?2:1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tresult[i]=result[i].links;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0],result[i][1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.zhu.hp=4;\r\n\t\t\t\t\tgame.zhu.maxHp=4;\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.broadcast(function(result,zhu){\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0],result[i][1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.zhu=zhu;\r\n\t\t\t\t\t\tgame.zhu.hp=4;\r\n\t\t\t\t\t\tgame.zhu.maxHp=4;\r\n\t\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},result,game.zhu);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL:function(){\r\n\t\t\t\tif(_status.mode=='kaihei'){\r\n\t\t\t\t\tgame.chooseCharacterKaiheiOL();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='huanle'){\r\n\t\t\t\t\tgame.chooseCharacterHuanleOL();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='online'){\r\n\t\t\t\t\tgame.chooseCharacterZhidouOL();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='binglin'){\r\n\t\t\t\t\tgame.chooseCharacterBinglinOL();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar identityList=['zhu','fan','fan'];\r\n\t\t\t\t\tidentityList.randomSort();\r\n\t\t\t\t\tfor(i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].identity=identityList[i];\r\n\t\t\t\t\t\tgame.players[i].showIdentity();\r\n\t\t\t\t\t\tgame.players[i].identityShown=true;\r\n\t\t\t\t\t\tif(identityList[i]=='zhu') game.zhu=game.players[i];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar list;\r\n\t\t\t\t\tvar list4=[];\r\n\t\t\t\t\tevent.list=[];\r\n\r\n\t\t\t\t\tvar libCharacter={};\r\n\t\t\t\t\tfor(var i=0;i<lib.configOL.characterPack.length;i++){\r\n\t\t\t\t\t\tvar pack=lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor(var j in pack){\r\n\t\t\t\t\t\t\tif(j=='zuoci') continue;\r\n\t\t\t\t\t\t\tif(lib.character[j]) libCharacter[j]=pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.characterReplace){\r\n\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\tif(!libCharacter[ix[j]]||lib.filter.characterDisabled(ix[j],libCharacter)) ix.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(ix.length){\r\n\t\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function(list){\r\n\t\t\t\t\t\tfor(var i in lib.characterReplace){\r\n\t\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\t\tif(!list.contains(ix[j])) ix.splice(j--,1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},list4);\r\n\t\t\t\t\tfor(i in libCharacter){\r\n\t\t\t\t\t\tif(list4.contains(i)||lib.filter.characterDisabled(i,libCharacter)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\tlist4.push(i)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.characterlist=list4;\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tvar selectButton=(lib.configOL.double_character?2:1);\r\n\r\n\t\t\t\t\tvar num,num2=0;\r\n\t\t\t\t\tnum=Math.floor(event.list.length/game.players.length);\r\n\t\t\t\t\tnum2=event.list.length-num*game.players.length;\r\n\t\t\t\t\tif(num>5){\r\n\t\t\t\t\t\tnum=5;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(num2>2){\r\n\t\t\t\t\t\tnum2=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tvar num3=0;\r\n\t\t\t\t\t\t\tif(game.players[i]==game.zhu) num3=3;\r\n\t\t\t\t\t\t\tvar str='选择角色';\r\n\t\t\t\t\t\t\tlist.push([game.players[i],[str,[event.list.randomRemove(num+num3),'characterx']],selectButton,true]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(list,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0],result.links[1]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]&&result[i].links){\r\n\t\t\t\t\t\t\tfor(var j=0;j<result[i].links.length;j++){\r\n\t\t\t\t\t\t\t\tevent.list.remove(get.sourceCharacter(result[i].links[j]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]=='ai'){\r\n\t\t\t\t\t\t\tvar listc=event.list.randomRemove(lib.configOL.double_character?2:1);\r\n\t\t\t\t\t\t\tfor(var i=0;i<listc.length;i++){\r\n\t\t\t\t\t\t\t\tvar listx=lib.characterReplace[listc[i]];\r\n\t\t\t\t\t\t\t\tif(listx&&listx.length) listc[i]=listx.randomGet();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tresult[i]=listc;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tresult[i]=result[i].links\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0],result[i][1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.zhu.maxHp++;\r\n\t\t\t\t\tgame.zhu.hp++;\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\t\r\n\t\t\t\t\tgame.broadcast(function(result,zhu){\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0],result[i][1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.zhu=zhu;\r\n\t\t\t\t\t\tzhu.maxHp++;\r\n\t\t\t\t\t\tzhu.hp++;\r\n\t\t\t\t\t\tzhu.update();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},result,game.zhu);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t},\r\n\t\ttranslate:{\r\n\t\t\tzhu:\"主\",\r\n\t\t\tfan:\"反\",\r\n\t\t\tzhu2:\"地主\",\r\n\t\t\tfan2:\"农民\",\r\n\t\t\trandom2:\"随机\",\r\n\t\t\t_feiyang:\"飞扬\",\r\n\t\t\t_bahu:\"跋扈\",\r\n\t\t\t_feiyang_info:\"判定阶段开始时，若你的判定区有牌，则你可以弃置两张手牌，然后弃置你判定区的一张牌。每回合限一次。\",\r\n\t\t\t_bahu_info:\"锁定技，准备阶段开始时，你摸一张牌。出牌阶段，你可以多使用一张【杀】。\",\r\n\t\t\tkaihei:'强易',\r\n\t\t\tkaihei_info:'出牌阶段，你可以获得一名其他角色的至多两张牌，然后交给其等量的牌。每名角色每局游戏限一次。',\r\n\t\t\tdoudizhu_cardPile:'底牌',\r\n\t\t\t_gongshoujintui:'攻守进退',\r\n\t\t\tgongshoujianbei:'攻守兼备',\r\n\t\t\tgongshoujianbei_info:'出牌阶段，你可选择：①将此牌当做【万箭齐发】使用。②将此牌当做【桃园结义】使用。',\r\n\t\t\tjintuiziru:'进退自如',\r\n\t\t\tjintuiziru_info:'出牌阶段，你可选择：①将此牌当做【南蛮入侵】使用。②将此牌当做【五谷丰登】使用。',\r\n\t\t\tdiqi:'地契',\r\n\t\t\tdiqi_skill:'地契',\r\n\t\t\tdiqi_info:'当你受到伤害时，你可以弃置此牌，防止此伤害。当此牌离开你的装备区后，销毁之。',\r\n\t\t\t_juzhong:'聚众',\r\n\t\t\tjuzhong_jiu:'聚众',\r\n\t\t\tzhadan:'炸弹',\r\n\t\t\tzhadan_info:'当一张牌被使用时，对此牌使用。取消此牌的所有目标，且本局游戏的底价翻倍。',\r\n\t\t\tjiwangkailai:'继往开来',\r\n\t\t\tjiwangkailai_info:'出牌阶段，对包含你自己在内的一名角色使用。目标角色选择一项：①弃置所有手牌，然后摸等量的牌。②将所有手牌当做一张不为【继往开来】的普通锦囊牌使用。',\r\n\t\t\tzhuSkill_xiangyang:'襄阳',\r\n\t\t\tzhuSkill_xiangyang_info:'回合结束时，你可获得一个额外的出牌阶段或摸牌阶段。',\r\n\t\t\tzhuSkill_jiangling:'江陵',\r\n\t\t\tzhuSkill_jiangling_info:'当你使用【杀】或普通锦囊牌选择唯一目标时，你可为此牌增加一个目标。',\r\n\t\t\tzhuSkill_fancheng:'樊城',\r\n\t\t\tzhuSkill_fancheng2:'樊城',\r\n\t\t\tzhuSkill_fancheng_info:'限定技，出牌阶段，你可获得如下效果：每回合限两次，当你造成伤害时，此伤害+1。',\r\n\t\t\tbinglin_shaxue:'歃血',\r\n\t\t\tbinglin_shaxue_info:'锁定技，每局游戏限三次，当你受到队友造成的伤害时，你防止此伤害。',\r\n\t\t\tbinglin_neihong:'内讧',\r\n\t\t\tbinglin_neihong_info:'锁定技，当你杀死队友后，你所在的阵营视为游戏失败。',\r\n\t\t\tbaiyidujiang:'白衣渡江',\r\n\t\t\tbaiyidujiang_info:'出牌阶段，对地主使用。你选择一项：①令其将手牌数摸至全场最多。②令其将手牌数弃置至全场最少。',\r\n\t\t\tshuiyanqijuny:'水淹七军',\r\n\t\t\tshuiyanqijuny_info:'出牌阶段，对至多两名角色使用。目标角色受到1点雷属性伤害，然后若其：是第一个目标，其弃置一张牌；不是第一个目标，其摸一张牌。',\r\n\t\t\tluojingxiashi:'落井下石',\r\n\t\t\tluojingxiashi_info:'出牌阶段，对所有其他的已受伤角色使用。目标角色受到1点伤害。',\r\n\t\t\tbinglinchengxia:'兵临城下',\r\n\t\t\tbinglinchengxia_info:'出牌阶段，对一名其他角色使用。将此牌横置于目标角色的判定区内。目标角色于判定阶段进行判定，若判定结果不为♦，则其弃置装备区内的所有牌或受到1点伤害。',\r\n\t\t\ttoushiche:'投石车',\r\n\t\t\ttoushiche_skill:'投石车',\r\n\t\t\ttoushiche_info:'锁定技，结束阶段开始时，你令所有手牌数大于你的角色依次弃置一张手牌。',\r\n\t\t\t_binglin_bingjin:'兵尽',\r\n\t\t},\r\n\t\telement:{\r\n\t\t\tplayer:{\r\n\t\t\t\tgetTopCards:function(num){\r\n\t\t\t\t\tif(typeof num!='number') num=1;\r\n\t\t\t\t\tif(num==0) {card=true;num=1;}\r\n\t\t\t\t\tif(num<0) num=1;\r\n\t\t\t\t\tvar cards;\r\n\t\t\t\t\tvar player=this;\r\n\t\t\t\t\tif(player.$.doudizhu_cardPile&&player.$.doudizhu_cardPile.length){\r\n\t\t\t\t\t\tcards=player.$.doudizhu_cardPile.randomRemove(num);\r\n\t\t\t\t\t\tif(player.$.doudizhu_cardPile.length) player.markSkill('doudizhu_cardPile');\r\n\t\t\t\t\t\telse player.unmarkSkill('doudizhu_cardPile');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse cards=[];\r\n\t\t\t\t\tif(cards.length<num) cards.addArray(get.cards(num-cards.length));\r\n\t\t\t\t\telse game.updateRoundNumber();\r\n\t\t\t\t\treturn cards;\r\n\t\t\t\t},\r\n\t\t\t\thasZhuSkill:function(){return false;},\r\n\t\t\t\t$dieAfter:function(){\r\n\t\t\t\t\tif(_status.video) return;\r\n\t\t\t\t\tif(!this.node.dieidentity){\r\n\t\t\t\t\t\tvar str={zhu:'地主',fan:'农民'}[this.identity];\r\n\t\t\t\t\t\tvar node=ui.create.div('.damage.dieidentity',str,this);\r\n\t\t\t\t\t\tui.refresh(node);\r\n\t\t\t\t\t\tnode.style.opacity=1;\r\n\t\t\t\t\t\tthis.node.dieidentity=node;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar trans=this.style.transform;\r\n\t\t\t\t\tif(trans){\r\n\t\t\t\t\t\tif(trans.indexOf('rotateY')!=-1){\r\n\t\t\t\t\t\t\tthis.node.dieidentity.style.transform='rotateY(180deg)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(trans.indexOf('rotateX')!=-1){\r\n\t\t\t\t\t\t\tthis.node.dieidentity.style.transform='rotateX(180deg)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tthis.node.dieidentity.style.transform='';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tthis.node.dieidentity.style.transform='';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdieAfter:function(source){\r\n\t\t\t\t\tif(_status.mode=='binglin'&&source&&this!=source&&this.identity==source.identity&&source.hasSkill('binglin_neihong')){\r\n\t\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse game.checkResult();\r\n\t\t\t\t},\r\n\t\t\t\tlogAi:function(targets,card){},\r\n\t\t\t\tshowIdentity:function(){\r\n\t\t\t\t\tgame.broadcastAll(function(player,identity){\r\n\t\t\t\t\t\tplayer.identity=identity;\r\n\t\t\t\t\t\tplayer.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\tplayer.identityShown=true;\r\n\t\t\t\t\t\tplayer.ai.shown=1;\r\n\t\t\t\t\t\tplayer.setIdentity();\r\n\t\t\t\t\t\tif(player.identity=='zhu'){\r\n\t\t\t\t\t\t\tplayer.isZhu=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(_status.clickingidentity){\r\n\t\t\t\t\t\t\tfor(var i=0;i<_status.clickingidentity[1].length;i++){\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform='';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},this,this.identity);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tget:{\r\n\t\t\trawAttitude:function(from,to){\r\n\t\t\t\tif(from.identity==to.identity) return 10;\r\n\t\t\t\treturn -10;\r\n\t\t\t},\r\n\t\t},\r\n\t\tskill:{\r\n\t\t\t_binglin_bingjin:{\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\truleSkill:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn _status.mode=='binglin'&&game.roundNumber>14;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tzhuSkill_xiangyang:{\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseControl('摸牌阶段','出牌阶段','cancel2').set('prompt','襄阳：是否执行一个额外的阶段？');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.control!='cancel2'){\r\n\t\t\t\t\t\tplayer.logSkill(event.name);\r\n\t\t\t\t\t\tvar next=player[result.index?'phaseUse':'phaseDraw']();\r\n\t\t\t\t\t\tevent.next.remove(next);\r\n\t\t\t\t\t\ttrigger.next.push(next);\r\n\t\t\t\t\t}\t\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tzhuSkill_jiangling:{\r\n\t\t\t\ttrigger:{player:'useCard2'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.card.name!='sha'&&get.type(event.card)!='trick') return false;\r\n\t\t\t\t\tif(!event.targets||event.targets.length!=1) return false;\r\n\t\t\t\t\tvar info=get.info(event.card);\r\n\t\t\t\t\tif(info.allowMultiple==false) return false;\r\n\t\t\t\t\tif(event.targets&&!info.multitarget){\r\n\t\t\t\t\t\tif(game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\treturn !event.targets.contains(current)&&lib.filter.targetEnabled2(event.card,player,current)&&lib.filter.targetInRange(event.card,player,current);\r\n\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar prompt2='为'+get.translation(trigger.card)+'增加一个目标'\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('zhuSkill_jiangling'),function(card,player,target){\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tif(_status.event.targets.contains(target)) return false;\r\n\t\t\t\t\t\treturn lib.filter.targetEnabled2(_status.event.card,player,target)&&lib.filter.targetInRange(_status.event.card,player,target);\r\n\t\t\t\t\t}).set('prompt2',prompt2).set('ai',function(target){\r\n\t\t\t\t\t\tvar trigger=_status.event.getTrigger();\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\treturn get.effect(target,trigger.card,player,player)*(_status.event.targets.contains(target)?-1:1);\r\n\t\t\t\t\t}).set('targets',trigger.targets).set('card',trigger.card);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tif(!event.isMine()&&!event.isOnline()) game.delayx();\r\n\t\t\t\t\t\tevent.targets=result.targets;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(event.targets){\r\n\t\t\t\t\t\tplayer.logSkill('zhuSkill_jiangling',event.targets);\r\n\t\t\t\t\t\tif(trigger.targets.contains(event.targets[0])) trigger.targets.removeArray(event.targets);\r\n\t\t\t\t\t\telse trigger.targets.addArray(event.targets);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tzhuSkill_fancheng:{\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tlimited:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tskillAnimation:true,\r\n\t\t\t\tanimationColor:'gray',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.awakenSkill('zhuSkill_fancheng');\r\n\t\t\t\t\tplayer.addTempSkill('zhuSkill_fancheng2');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tzhuSkill_fancheng2:{\r\n\t\t\t\ttrigger:{source:'damageBegin2'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tusable:2,\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tbinglin_shaxue:{\r\n\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\tplayer.addMark(skill,3,false);\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{player:'damageBegin3'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.source&&player!=event.source&&player.identity==event.source.identity&&player.countMark('binglin_shaxue')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\tplayer.removeMark('binglin_shaxue',1,false);\r\n\t\t\t\t},\r\n\t\t\t\tintro:{content:'剩余次数：#'},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tviewHandcard:true,\r\n\t\t\t\t\tskillTagFilter:function(player,tag,arg){\r\n\t\t\t\t\t\treturn player!=arg&&arg.hasSkill('binglin_shaxue');\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tbinglin_neihong:{charlotte:true},\r\n\t\t\ttoushiche_skill:{\r\n\t\t\t\ttrigger:{player:'phaseJieshuBegin'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t return lib.skill.toushiche_skill.logTarget(null,player).length>0;\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:function(event,player){\r\n\t\t\t\t\tvar hs=player.countCards('h');\r\n\t\t\t\t\treturn game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current!=player&&current.countCards('h')>hs;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.targets=lib.skill.toushiche_skill.logTarget(null,player).sortBySeat();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar target=targets.shift();\r\n\t\t\t\t\tif(target.countCards('h')>0) target.chooseToDiscard('h',true);\r\n\t\t\t\t\tif(targets.length) event.redo();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_gongshoujintui:{\r\n\t\t\t\tenable:'chooseToUse',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar cards=player.getCards('hs');\r\n\t\t\t\t\tfor(var i of cards){\r\n\t\t\t\t\t\tvar name=get.name(i,player);\r\n\t\t\t\t\t\tif(name=='gongshoujianbei'){\r\n\t\t\t\t\t\t\tif(event.filterCard({\r\n\t\t\t\t\t\t\t\tname:'wanjian',\r\n\t\t\t\t\t\t\t\tisCard:true,\r\n\t\t\t\t\t\t\t\tcards:[i],\r\n\t\t\t\t\t\t\t},player,event)||event.filterCard({\r\n\t\t\t\t\t\t\t\tname:'taoyuan',\r\n\t\t\t\t\t\t\t\tisCard:true,\r\n\t\t\t\t\t\t\t\tcards:[i],\r\n\t\t\t\t\t\t\t},player,event)) return true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(name=='jintuiziru'){\r\n\t\t\t\t\t\t\tif(event.filterCard({\r\n\t\t\t\t\t\t\t\tname:'nanman',\r\n\t\t\t\t\t\t\t\tisCard:true,\r\n\t\t\t\t\t\t\t\tcards:[i],\r\n\t\t\t\t\t\t\t},player,event)||event.filterCard({\r\n\t\t\t\t\t\t\t\tname:'wugu',\r\n\t\t\t\t\t\t\t\tisCard:true,\r\n\t\t\t\t\t\t\t\tcards:[i],\r\n\t\t\t\t\t\t\t},player,event)) return true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tdialog:function(event,player){\r\n\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\tif(player.countCards('hs','gongshoujianbei')){\r\n\t\t\t\t\t\t\tlist.push(['锦囊','','wanjian']);\r\n\t\t\t\t\t\t\tlist.push(['锦囊','','taoyuan']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(player.countCards('hs','jintuiziru')){\r\n\t\t\t\t\t\t\tlist.push(['锦囊','','nanman']);\r\n\t\t\t\t\t\t\tlist.push(['锦囊','','wugu']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn ui.create.dialog('攻守兼备/进退自如',[list,'vcard'],'hidden');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter:function(button,player){\r\n\t\t\t\t\t\tvar name=button.link[2];\r\n\t\t\t\t\t\tvar rawname=((name=='wanjian'||name=='taoyuan')?'gongshoujianbei':'jintuiziru');\r\n\t\t\t\t\t\tvar cards=player.getCards('hs');\r\n\t\t\t\t\t\tvar evt=_status.event.getParent();\r\n\t\t\t\t\t\tfor(var i of cards){\r\n\t\t\t\t\t\t\tif(get.name(i,player)==rawname&&evt.filterCard({\r\n\t\t\t\t\t\t\t\tname:name,\r\n\t\t\t\t\t\t\t\tisCard:true,\r\n\t\t\t\t\t\t\t\tcards:[i],\r\n\t\t\t\t\t\t\t},player,evt)) return true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck:function(button){\r\n\t\t\t\t\t\treturn _status.event.player.getUseValue({name:button.link[2],isCard:true});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(links){\r\n\t\t\t\t\t\tvar name=links[0][2];\r\n\t\t\t\t\t\tvar rawname=((name=='wanjian'||name=='taoyuan')?'gongshoujianbei':'jintuiziru');\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tviewAs:{name:name,isCard:true},\r\n\t\t\t\t\t\t\tfilterCard:{name:rawname},\r\n\t\t\t\t\t\t\tai1:()=>1,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tprompt:function(links){\r\n\t\t\t\t\t\tvar name=links[0][2];\r\n\t\t\t\t\t\tvar rawname=((name=='wanjian'||name=='taoyuan')?'gongshoujianbei':'jintuiziru');\r\n\t\t\t\t\t\treturn '将一张'+get.translation(rawname)+'当做'+get.translation(name)+'使用';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:10,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tdoudizhu_cardPile:{\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'cardCount',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tkaihei:{\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player==game.zhu&&game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn lib.skill.kaihei.filterTarget(null,player,current);\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn player!=target&&!target.$.kaihei&&target.countGainableCards(player,'he')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.gainPlayerCard(target,[1,2],'he',true);\r\n\t\t\t\t\ttarget.$.kaihei=true;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(!result.bool||!result.cards.length){\r\n\t\t\t\t\t\tevent.finish();return;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar num=result.cards.length;\r\n\t\t\t\t\tvar hs=player.getCards('he');\r\n\t\t\t\t\tif(hs.length){\r\n\t\t\t\t\t\tif(hs.length<=num) event._result={bool:true,cards:hs};\r\n\t\t\t\t\t\telse player.chooseCard('he',true,num,'选择交给'+get.translation(target)+get.cnNumber(num)+'张牌');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.bool&&result.cards&&result.cards.length) target.gain(result.cards,player,'giveAuto');\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tviewHandcard:true,\r\n\t\t\t\t\tskillTagFilter:function(player,tag,target){\r\n\t\t\t\t\t\tif(player==target||player.identity!='fan'||target.identity!='fan') return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_feiyang:{\r\n\t\t\t\ttrigger:{player:'phaseJudgeBegin'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn _status.mode!='online'&&_status.mode!='binglin'&&player==game.zhu&&player.countCards('j')&&player.countCards('h')>1;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseToDiscard('h',2,'是否发动【飞扬】，弃置两张手牌并弃置自己判定区的一张牌？').set('logSkill','_feiyang').ai=function(card){\r\n\t\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.discardPlayerCard(player,'j',true);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_bahu:{\r\n\t\t\t\ttrigger:{player:'phaseZhunbeiBegin'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn _status.mode!='online'&&_status.mode!='binglin'&&player==game.zhu;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tcardUsable:function(card,player,num){\r\n\t\t\t\t\t\tif(_status.mode!='online'&&_status.mode!='binglin'&&player==game.zhu&&card.name=='sha') return num+1;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_dieAfterDraw:{\r\n\t\t\t\ttrigger:{global:'dieAfter'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn _status.mode!='online'&&_status.mode!='binglin'&&event.player.identity==player.identity;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.chooseDrawRecover(2);\r\n\t\t\t\t\tplayer.showGiveup();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tdiqi_skill:{\r\n\t\t\t\ttrigger:{player:'damageBegin2'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar card=player.getEquip('diqi');\r\n\t\t\t\t\treturn get.itemtype(card)=='card'&&lib.filter.cardDiscardable(card,player,'diqi_skill');\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn event.num>=Math.min(player.hp,2);\r\n\t\t\t\t},\r\n\t\t\t\tprompt2:function(event,player){\r\n\t\t\t\t\treturn '弃置'+get.translation(player.getEquip('diqi'))+'并防止即将受到的'+get.cnNumber(event.num)+'点伤害';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.discard(player.getEquip('diqi'));\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tfilterDamage:true,\r\n\t\t\t\t\tskillTagFilter:function(player,tag,arg){\r\n\t\t\t\t\t\tif(arg&&arg.player){\r\n\t\t\t\t\t\t\tif(arg.player.hasSkillTag('jueqing',false,player)) return false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_juzhong:{\r\n\t\t\t\ttrigger:{global:'useCard'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\truleSkill:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn _status.mode=='online'&&!event.all_excluded&&event.player.isFriendOf(player)&&event.player!=player&&lib.skill._juzhong.infos[event.card.name]&&player.countCards('h')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseToDiscard('是否响应【聚众】？',get.translation(trigger.player)+'使用了'+get.translation(trigger.card)+'。你可弃置一张名称相同的牌，令'+lib.skill._juzhong.infos[trigger.card.name][0],function(card,player){\r\n\t\t\t\t\t\treturn get.name(card,player)==_status.event.getTrigger().card.name;\r\n\t\t\t\t\t}).set('ai',lib.skill._juzhong.infos[trigger.card.name][2]).logSkill=['_juzhong',trigger.player];\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tlib.skill._juzhong.infos[trigger.card.name][1]();\r\n\t\t\t\t\t\tif(!event.goon) event.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\ttrigger.player.chooseTarget('你可选择一名角色，弃置其的一张牌',function(card,player,target){\r\n\t\t\t\t\t\treturn target.countDiscardableCards(player,'he')>0;\r\n\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tvar att=get.attitude(player,target);\r\n\t\t\t\t\t\tvar nh=target.countCards('h');\r\n\t\t\t\t\t\tif(att>0){\r\n\t\t\t\t\t\t\tif(target.getEquip('baiyin')&&target.isDamaged()&&\r\n\t\t\t\t\t\t\t\tget.recoverEffect(target,player,player)>0){\r\n\t\t\t\t\t\t\t\tif(target.hp==1&&!target.hujia) return 1.6*att;\r\n\t\t\t\t\t\t\t\tif(target.hp==2) return 0.01*att;\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar es=target.getCards('e');\r\n\t\t\t\t\t\tvar noe=(es.length==0||target.hasSkillTag('noe'));\r\n\t\t\t\t\t\tvar noe2=(es.filter(function(esx){\r\n\t\t\t\t\t\t\treturn get.value(esx,target)>0;\r\n\t\t\t\t\t\t}).length==0);\r\n\t\t\t\t\t\tvar noh=(nh==0||target.hasSkillTag('noh'));\r\n\t\t\t\t\t\tif(noh&&(noe||noe2)) return 0;\r\n\t\t\t\t\t\tif(att<=0&&!target.countCards('he')) return 1.5*att;\r\n\t\t\t\t\t\treturn -1.5*att;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar target=result.targets[0];\r\n\t\t\t\t\t\ttrigger.player.line(target,'green');\r\n\t\t\t\t\t\ttrigger.player.discardPlayerCard(target,true,'he');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinfos:{\r\n\t\t\t\t\tsha:['此【杀】的伤害值基数+1。',function(){\r\n\t\t\t\t\t\tvar evt=_status.event._trigger;\r\n\t\t\t\t\t\tif(!evt.baseDamage) evt.baseDamage=1;\r\n\t\t\t\t\t\tevt.baseDamage++;\r\n\t\t\t\t\t},function(card){\r\n\t\t\t\t\t\tvar evt=_status.event.getTrigger();\r\n\t\t\t\t\t\tif(!evt.targets.length) return 0;\r\n\t\t\t\t\t\tif(evt.targets[0].hasShan()||evt.targets[0].hasSkillTag('filterDamage',null,{\r\n\t\t\t\t\t\t\tplayer:evt.targets[0],\r\n\t\t\t\t\t\t\tcard:evt.card,\r\n\t\t\t\t\t\t})) return 0;\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tshan:['其可弃置一名角色的一张牌。',function(){\r\n\t\t\t\t\t\t_status.event.goon=true;\r\n\t\t\t\t\t},function(card){\r\n\t\t\t\t\t\tif(game.zhu.countCards('he',function(card){\r\n\t\t\t\t\t\t\treturn get.value(card,game.zhu)>=6;\r\n\t\t\t\t\t\t})) return 7-get.value(card);\r\n\t\t\t\t\t\tif(game.zhu.countCards('he',function(card){\r\n\t\t\t\t\t\t\treturn get.value(card,game.zhu)>0\r\n\t\t\t\t\t\t})) return 5-get.value(card);\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}],\r\n\t\t\t\t\ttao:['其摸两张牌。',function(){\r\n\t\t\t\t\t\t_status.event._trigger.player.draw(2);\r\n\t\t\t\t\t},function(card){\r\n\t\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tjiu:['其本回合的伤害值或回复值+1。',function(){\r\n\t\t\t\t\t\tvar player=_status.event._trigger.player;\r\n\t\t\t\t\t\tplayer.addTempSkill('juzhong_jiu');\r\n\t\t\t\t\t\tplayer.addMark('juzhong_jiu',1,false);\r\n\t\t\t\t\t},function(card){\r\n\t\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t\t}],\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tviewHandcard:true,\r\n\t\t\t\t\tskillTagFilter:function(player,tag,target){\r\n\t\t\t\t\t\tif(_status.mode!='online'||player==target||player.identity!=target.identity) return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tjuzhong_jiu:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'recoverBegin',\r\n\t\t\t\t\tsource:'damageBegin1',\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num+=player.countMark('juzhong_jiu');\r\n\t\t\t\t},\r\n\t\t\t\tonremove:true,\r\n\t\t\t\tintro:{content:'本回合的伤害值和回复值+#'},\r\n\t\t\t},\r\n\t\t\t_zhadan:{\r\n\t\t\t\ttrigger:{player:'useCard'},\r\n\t\t\t\tpriority:5,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.countCards('h','zhadan');\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tforceLoad:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.source=trigger.player;\r\n\t\t\t\t\tevent.card=trigger.card;\r\n\t\t\t\t\tevent.targets=trigger.targets;\r\n\t\t\t\t\tevent._global_waiting=true;\r\n\t\t\t\t\tevent.filterCard=function(card,player){\r\n\t\t\t\t\t\tif(get.name(card)!='zhadan'||get.itemtype(card)!='card') return false;\r\n\t\t\t\t\t\treturn lib.filter.cardEnabled(card,player,'forceEnable');\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.send=function(player,card,source,targets,id,id2,skillState){\r\n\t\t\t\t\t\tif(skillState){\r\n\t\t\t\t\t\t\tplayer.applySkills(skillState);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar str=get.translation(source);\r\n\t\t\t\t\t\tif(targets&&targets.length){\r\n\t\t\t\t\t\t\tstr+='对'+get.translation(targets);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstr+='使用了';\r\n\t\t\t\t\t\tstr+=get.translation(card);\r\n\t\t\t\t\t\tstr+='，是否对其使用【炸弹】？';\r\n\r\n\t\t\t\t\t\tvar next=player.chooseToUse({\r\n\t\t\t\t\t\t\tfilterCard:function(card,player){\r\n\t\t\t\t\t\t\t\tif(get.name(card)!='zhadan'||get.itemtype(card)!='card') return false;\r\n\t\t\t\t\t\t\t\treturn lib.filter.cardEnabled(card,player,'forceEnable');\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tprompt:str,\r\n\t\t\t\t\t\t\t_global_waiting:true,\r\n\t\t\t\t\t\t\tai1:function(card){\r\n\t\t\t\t\t\t\t\tvar evt=_status.event.getParent('_zhadan')._trigger,player=_status.event.player;\r\n\t\t\t\t\t\t\t\tif(!evt) return 0;\r\n\t\t\t\t\t\t\t\tif(get.attitude(player,evt.player)>0) return 0;\r\n\t\t\t\t\t\t\t\tvar eff=0;\r\n\t\t\t\t\t\t\t\tif(!targets.length) return Math.random()-0.5;\r\n\t\t\t\t\t\t\t\tfor(var i of targets) eff-=get.effect(i,evt.card,evt.player,player);\r\n\t\t\t\t\t\t\t\treturn eff-8;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsource:source,\r\n\t\t\t\t\t\t\tsource2:targets,\r\n\t\t\t\t\t\t\tid:id,\r\n\t\t\t\t\t\t\tid2:id2\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tnext.set('respondTo',[source,card]);\r\n\r\n\t\t\t\t\t\tif(game.online){\r\n\t\t\t\t\t\t\t_status.event._resultid=id;\r\n\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tnext.nouse=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.countCards('h',function(card){\r\n\t\t\t\t\t\t\tif(get.name(card)!='zhadan'||get.itemtype(card)!='card') return false;\r\n\t\t\t\t\t\t\treturn lib.filter.cardEnabled(card,player,'forceEnable');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tevent.list=list;\r\n\t\t\t\t\tevent.id=get.id();\r\n\t\t\t\t\tlist.sort(function(a,b){\r\n\t\t\t\t\t\treturn get.distance(event.source,a,'absolute')-get.distance(event.source,b,'absolute');\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(event.list.length==0){\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(_status.connectMode&&(event.list[0].isOnline()||event.list[0]==game.me)){\r\n\t\t\t\t\t\tevent.goto(4);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.current=event.list.shift();\r\n\t\t\t\t\t\tevent.send(event.current,event.card,event.source,event.targets,event.id,trigger.parent.id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.zhadanresult=event.current;\r\n\t\t\t\t\t\tevent.zhadanresult2=result;\r\n\t\t\t\t\t\tevent.goto(8);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.goto(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tvar id=event.id;\r\n\t\t\t\t\tvar sendback=function(result,player){\r\n\t\t\t\t\t\tif(result&&result.id==id&&!event.zhadanresult&&result.bool){\r\n\t\t\t\t\t\t\tevent.zhadanresult=player;\r\n\t\t\t\t\t\t\tevent.zhadanresult2=result;\r\n\t\t\t\t\t\t\tgame.broadcast('cancel',id);\r\n\t\t\t\t\t\t\tif(_status.event.id==id&&_status.event.name=='chooseToUse'&&_status.paused){\r\n\t\t\t\t\t\t\t\treturn (function(){\r\n\t\t\t\t\t\t\t\t\tevent.resultOL=_status.event.resultOL;\r\n\t\t\t\t\t\t\t\t\tui.click.cancel();\r\n\t\t\t\t\t\t\t\t\tif(ui.confirm) ui.confirm.close();\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(_status.event.id==id&&_status.event.name=='chooseToUse'&&_status.paused){\r\n\t\t\t\t\t\t\t\treturn (function(){\r\n\t\t\t\t\t\t\t\t\tevent.resultOL=_status.event.resultOL;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tvar withme=false;\r\n\t\t\t\t\tvar withol=false;\r\n\t\t\t\t\tvar list=event.list;\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(list[i].isOnline()){\r\n\t\t\t\t\t\t\twithol=true;\r\n\t\t\t\t\t\t\tlist[i].wait(sendback);\r\n\t\t\t\t\t\t\tlist[i].send(event.send,list[i],event.card,event.source,event.targets,event.id,trigger.parent.id,get.skillState(list[i]));\r\n\t\t\t\t\t\t\tlist.splice(i--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(list[i]==game.me){\r\n\t\t\t\t\t\t\twithme=true;\r\n\t\t\t\t\t\t\tevent.send(list[i],event.card,event.source,event.targets,event.id,trigger.parent.id);\r\n\t\t\t\t\t\t\tlist.splice(i--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!withme){\r\n\t\t\t\t\t\tevent.goto(6);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_status.connectMode){\r\n\t\t\t\t\t\tif(withme||withol){\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tgame.players[i].showTimer();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.withol=withol;\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tif(result&&result.bool&&!event.zhadanresult){\r\n\t\t\t\t\t\tgame.broadcast('cancel',event.id);\r\n\t\t\t\t\t\tevent.zhadanresult=game.me;\r\n\t\t\t\t\t\tevent.zhadanresult2=result;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tif(event.withol&&!event.resultOL){\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 7'\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].hideTimer();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 8'\r\n\t\t\t\t\tif(event.zhadanresult){\r\n\t\t\t\t\t\tevent.zhadanresult.$fullscreenpop('炸弹',get.groupnature(event.zhadanresult))\r\n\t\t\t\t\t\tvar next=event.zhadanresult.useResult(event.zhadanresult2);\r\n\t\t\t\t\t\tnext.respondTo=[trigger.player,trigger.card];\r\n\t\t\t\t\t\tgame.bonusNum*=2;\r\n\t\t\t\t\t\tgame.updateRoundNumber();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\tcard:{\r\n\t\t\tbaiyidujiang:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\tenable:true,\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target==game.zhu;\r\n\t\t\t\t},\r\n\t\t\t\tselectTarget:-1,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(!player.isIn()||!target.isIn()){\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar num1=0,num2=Infinity,str=get.translation(target);\r\n\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\tvar num=current.countCards('h');\r\n\t\t\t\t\t\tif(num>num1) num1=num;\r\n\t\t\t\t\t\tif(num<num2) num2=num;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar num=target.countCards('h'),choices=[];\r\n\t\t\t\t\tevent.addIndex=0;\r\n\t\t\t\t\tif(num<num1){\r\n\t\t\t\t\t\tchoices.push('令'+str+'将手牌摸至'+get.cnNumber(num1)+'张');\r\n\t\t\t\t\t\tevent.num1=num1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.addIndex++;\r\n\t\t\t\t\tif(num>num2){\r\n\t\t\t\t\t\tchoices.push('令'+str+'将手牌弃置至'+get.cnNumber(num2)+'张');\r\n\t\t\t\t\t\tevent.num2=num2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!choices.length) event.finish();\r\n\t\t\t\t\telse if(choices.length==1) event._result={index:0};\r\n\t\t\t\t\telse player.chooseControl().set('choiceList',choices).set('ai',function(){\r\n\t\t\t\t\t\tvar evt=_status.event.getParent();\r\n\t\t\t\t\t\treturn get.attitude(evt.player,evt.target)>0?0:1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.index+event.addIndex==0){\r\n\t\t\t\t\t\ttarget.drawTo(event.num1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse target.chooseToDiscard(true,'h',target.countCards('h')-event.num2);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:6,\r\n\t\t\t\t\tvalue:4,\r\n\t\t\t\t\tuseful:2,\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\tdraw:1,\r\n\t\t\t\t\t\tloseCard:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target,card,isLink){\r\n\t\t\t\t\t\t\tvar num1=0,num2=Infinity,str=get.translation(target);\r\n\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\tvar num=current.countCards('h',function(cardx){\r\n\t\t\t\t\t\t\t\t\t\tif(ui.selected.cards.contains(cardx)) return false;\r\n\t\t\t\t\t\t\t\t\t\tif(card.cards&&card.cards.contains(cardx)) return false;\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(num>num1) num1=num;\r\n\t\t\t\t\t\t\t\tif(num<num2) num2=num;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tvar num=target.countCards('h',function(cardx){\r\n\t\t\t\t\t\t\t\tif(ui.selected.cards.contains(cardx)) return false;\r\n\t\t\t\t\t\t\t\tif(card.cards&&card.cards.contains(cardx)) return false;\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(num1>num){\r\n\t\t\t\t\t\t\t\tif(get.attitude(player,target)>0) return (num1-num)/1.2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(num2<num){\r\n\t\t\t\t\t\t\t\tif(get.attitude(player,target)>0) return (num2-num)/1.2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshuiyanqijuny:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\tcardimage:'shuiyanqijunx',\r\n\t\t\t\tenable:true,\r\n\t\t\t\tfilterTarget:true,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t\tselectTarget:[1,2],\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttarget.damage('thunder');\r\n\t\t\t\t\tif(num>0) target.draw();\r\n\t\t\t\t\telse target.chooseToDiscard('he',true);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:6,\r\n\t\t\t\t\tvalue:4,\r\n\t\t\t\t\tuseful:2,\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\tdamage:1,\r\n\t\t\t\t\t\tthunderDamage:1,\r\n\t\t\t\t\t\tnatureDamage:1,\r\n\t\t\t\t\t\tloseCard:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(!ui.selected.targets.length) return -1.5;\r\n\t\t\t\t\t\t\treturn -0.5\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tluojingxiashi:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\tenable:true,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t\tselectTarget:-1,\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target!=player&&target.isDamaged();\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttarget.damage();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:3,\r\n\t\t\t\t\tvalue:4,\r\n\t\t\t\t\tuseful:2,\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\tloseCard:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:-1.5,\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbinglinchengxia:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:'delay',\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn (lib.filter.judge(card,player,target)&&player!=target);\r\n\t\t\t\t},\r\n\t\t\t\tjudge:function(card){\r\n\t\t\t\t\tif(get.suit(card)=='diamond') return 0;\r\n\t\t\t\t\treturn -3;\r\n\t\t\t\t},\r\n\t\t\t\teffect:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(result.bool==false){\r\n\t\t\t\t\t\tif(!player.countCards('e',function(card){\r\n\t\t\t\t\t\t\treturn lib.filter.cardDiscardable(card,player,'shuiyanqijuny');\r\n\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\tplayer.damage('nosource');\r\n\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse player.chooseControl('discard_card','take_damage',function(event,player){\r\n\t\t\t\t\t\t\tif(get.damageEffect(player,event.player,player)>=0){\r\n\t\t\t\t\t\t\t\treturn 'take_damage';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(player.hp>=3&&player.countCards('e')>=2){\r\n\t\t\t\t\t\t\t\treturn 'take_damage';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 'discard_card';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.control=='discard_card'){\r\n\t\t\t\t\t\tplayer.discard(player.getCards('e',function(card){\r\n\t\t\t\t\t\t\treturn lib.filter.cardDiscardable(card,player,'shuiyanqijuny');\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse player.damage('nosource');\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:1,\r\n\t\t\t\t\tvalue:3,\r\n\t\t\t\t\tuseful:2,\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\tdamage:1,\r\n\t\t\t\t\t\tloseCard:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target,card,isLink){\r\n\t\t\t\t\t\t\tvar es=target.getCards('e');\r\n\t\t\t\t\t\t\tif(!es.length) return -1.5;\r\n\t\t\t\t\t\t\tvar val=0;\r\n\t\t\t\t\t\t\tfor(var i of es) val+=get.value(i,target);\r\n\t\t\t\t\t\t\treturn -Math.min(1.5,val/5);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttoushiche:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:'equip',\r\n\t\t\t\tsubtype:'equip1',\r\n\t\t\t\tdistance:{attackFrom:-3},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\tequipValue:2.5\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tskills:['toushiche_skill']\r\n\t\t\t},\r\n\t\t\tgongshoujianbei:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t},\r\n\t\t\tjintuiziru:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t},\r\n\t\t\tdiqi:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:\"equip\",\r\n\t\t\t\tsubtype:\"equip2\",\r\n\t\t\t\tskills:['diqi_skill'],\r\n\t\t\t\tdestroy:'diqi_skill',\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\tequipValue:6\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tzhadan:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\tuseful:[6,4],\r\n\t\t\t\t\t\tvalue:[6,4],\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{player:1},\r\n\t\t\t\t},\r\n\t\t\t\tnotarget:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar evt=event.getParent(2)._trigger;\r\n\t\t\t\t\tevt.targets.length=0;\r\n\t\t\t\t\tevt.all_excluded=true;\r\n\t\t\t\t\tgame.log(evt.card,'的效果被炸弹抵消了');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tjiwangkailai:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t\tenable:function(card,player){\r\n\t\t\t\t\tvar hs=player.getCards('h',function(cardx){\r\n\t\t\t\t\t\treturn cardx!=card&&(!card.cards||!card.cards.contains(cardx));\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(!hs.length) return false;\r\n\t\t\t\t\tvar use=true,discard=true;\r\n\t\t\t\t\tfor(var i of hs){\r\n\t\t\t\t\t\tif(use&&!game.checkMod(i,player,'unchanged','cardEnabled2',player)) use=false;\r\n\t\t\t\t\t\tif(discard&&!lib.filter.cardDiscardable(i,player,'jiwangkailai')) discard=false;\r\n\t\t\t\t\t\tif(!use&&!discard) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tselectTarget:-1,\r\n\t\t\t\ttoself:true,\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target==player;\r\n\t\t\t\t},\r\n\t\t\t\tmodTarget:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar hs=player.getCards('h');\r\n\t\t\t\t\tif(hs.length){\r\n\t\t\t\t\t\tvar use=true,discard=true;\r\n\t\t\t\t\t\tfor(var i of hs){\r\n\t\t\t\t\t\t\tif(use&&!game.checkMod(i,player,'unchanged','cardEnabled2',player)) use=false;\r\n\t\t\t\t\t\t\tif(discard&&!lib.filter.cardDiscardable(i,player,'jiwangkailai')) discard=false;\r\n\t\t\t\t\t\t\tif(!use&&!discard) break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(use&&discard) player.chooseControl().set('prompt','继往开来：请选择一项').set('choiceList',[\r\n\t\t\t\t\t\t\t'弃置所有手牌，然后摸等量的牌',\r\n\t\t\t\t\t\t\t'将所有手牌当做一张普通锦囊牌使用',\r\n\t\t\t\t\t\t]).set('ai',function(){\r\n\t\t\t\t\t\t\tif(_status.event.player.countCards('h')>2) return 0;\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\telse if(use) event._result={index:1};\r\n\t\t\t\t\t\telse if(discard) event._result={index:0};\r\n\t\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar cards=player.getCards('h');\r\n\t\t\t\t\tif(result.index==0){\r\n\t\t\t\t\t\tplayer.discard(cards);\r\n\t\t\t\t\t\tplayer.draw(cards.length);\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\tfor(var i of lib.inpile){\r\n\t\t\t\t\t\t\tif(i!='jiwangkailai'&&get.type(i)=='trick'&&lib.filter.filterCard({name:i,cards:cards},player)) list.push(['锦囊','',i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\t\tplayer.chooseButton(['继往开来：选择要使用的牌',[list,'vcard']],true).set('ai',function(button){\r\n\t\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\t\treturn player.getUseValue({name:button.link[2],cards:player.getCards('h')});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.bool) player.chooseUseTarget({name:result.links[0][2]},player.getCards('h'),true);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\torder:0.5,\r\n\t\t\t\t\t\tuseful:3,\r\n\t\t\t\t\t\tvalue:5\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(target.needsToDiscard(1)||!target.countCards('h',function(card){\r\n\t\t\t\t\t\t\t\treturn get.value(card,player)>=5.5;\r\n\t\t\t\t\t\t\t})) return 1;\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\tdraw:2\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\tcharacterOnline:{\r\n\t\t\tnijisanji:[\r\n\t\t\t\t'MononobeAlice','ShizukaRin','UshimiIchigo','SisterClearie','LizeHelesta','SuzuharaLulu','KagamiHayato',\r\n\t\t\t\t'KenmochiDouya','YukishiroMahiro','OnomachiHaruka','SakuraRitsuki','re_AngeKatrina','AmamiyaKokoro','re_AibaUiha',\r\n\t\t\t\t'Azusa','Shaun',\r\n\t\t\t],\r\n\t\t\tholo:[\r\n\t\t\t\t'TokinoSora','NatsuiroMatsuri','RobokoSan','ShirakamiFubuki','AkiRosenthal','HoshimatiSuisei','NekomataOkayu',\r\n\t\t\t\t'SakuraMiko','MinatoAqua','UsadaPekora','ŌokamiMio','re_UruhaRushia','re_NakiriAyame','re_ŌzoraSubaru',\r\n\t\t\t\t'Civia','SpadeEcho','Artia','Doris','Yogiri',\r\n\t\t\t],\r\n\t\t\tvtuber:[\r\n\t\t\t\t'ShirayukiMishiro','KaguyaLuna','UmoriHinako','SuouPatra','TenkaiTsukasa','Yousa','MiraiAkari','Kaf','Rim',\r\n\t\t\t\t're_YuNi','re_TomariMari','re_Omesis','re_NijikawaRaki','re_KizunaAI',\r\n\t\t\t\t'Bella','Carol','Diana','EQueen',\r\n\t\t\t],\r\n\t\t\tclubs:[\r\n\t\t\t\t'KaguraMea','TakatsukiRitsu','MorinagaMiu','OtomeOto','HanazonoSerena','MashiroKanon',\r\n\t\t\t\t'Nekomasu','Eilene','Yomemi','ShizukuLulu','re_MinamiNami','KaguraNana','Menherachan','ShikaiYue',\r\n\t\t\t\t'Ciyana','Pudding','AyanaNana','AkiRinco',\r\n\t\t\t],\r\n\t\t},\r\n\t\tonline_cardPile:[\r\n\t\t\t['spade',1,'guding'],\r\n\t\t\t['spade',1,'zhadan'],\r\n\t\t\t['spade',2,'tengjia'],\r\n\t\t\t['spade',2,'cixiong'],\r\n\t\t\t['spade',3,'jiu'],\r\n\t\t\t['spade',3,'guohe'],\r\n\t\t\t['spade',4,'sha','thunder'],\r\n\t\t\t['spade',4,'guohe'],\r\n\t\t\t['spade',5,'sha','thunder'],\r\n\t\t\t['spade',5,'qinglong'],\r\n\t\t\t['spade',6,'sha','thunder'],\r\n\t\t\t['spade',6,'jiwangkailai'],\r\n\t\t\t['spade',7,'sha','thunder'],\r\n\t\t\t['spade',7,'jintuiziru'],\r\n\t\t\t['spade',8,'sha','thunder'],\r\n\t\t\t['spade',8,'sha'],\r\n\t\t\t['spade',9,'jiu'],\r\n\t\t\t['spade',9,'sha'],\r\n\t\t\t['spade',10,'gongshoujianbei'],\r\n\t\t\t['spade',10,'sha'],\r\n\t\t\t['spade',11,'tiesuo'],\r\n\t\t\t['spade',11,'shunshou'],\r\n\t\t\t['spade',12,'tiesuo'],\r\n\t\t\t['spade',12,'zhangba'],\r\n\t\t\t['spade',13,'wuxie'],\r\n\t\t\t['spade',13,'dawanma'],\r\n\t\t\t\r\n\t\t\t['club',1,'baiyin'],\r\n\t\t\t['club',1,'zhuge'],\r\n\t\t\t['club',2,'tengjia'],\r\n\t\t\t['club',2,'bagua'],\r\n\t\t\t['club',3,'jiu'],\r\n\t\t\t['club',3,'sha'],\r\n\t\t\t['club',4,'jintuiziru'],\r\n\t\t\t['club',4,'sha'],\r\n\t\t\t['club',5,'sha','thunder'],\r\n\t\t\t['club',5,'dilu'],\r\n\t\t\t['club',6,'sha','thunder'],\r\n\t\t\t['club',6,'sha'],\r\n\t\t\t['club',7,'sha','thunder'],\r\n\t\t\t['club',7,'sha'],\r\n\t\t\t['club',8,'sha','thunder'],\r\n\t\t\t['club',8,'sha'],\r\n\t\t\t['club',9,'jiu'],\r\n\t\t\t['club',9,'sha'],\r\n\t\t\t['club',10,'tiesuo'],\r\n\t\t\t['club',10,'sha'],\r\n\t\t\t['club',11,'tiesuo'],\r\n\t\t\t['club',11,'sha'],\r\n\t\t\t['club',12,'tiesuo'],\r\n\t\t\t['club',12,'wuxie'],\r\n\t\t\t['club',13,'tiesuo'],\r\n\t\t\t['club',13,'jiedao'],\r\n\t\t\t['club',13,'wuxie'],\r\n\t\t\t\r\n\t\t\t['heart',1,'wuxie'],\r\n\t\t\t['heart',1,'gongshoujianbei'],\r\n\t\t\t['heart',1,'zhadan'],\r\n\t\t\t['heart',2,'huogong'],\r\n\t\t\t['heart',2,'shan'],\r\n\t\t\t['heart',3,'huogong'],\r\n\t\t\t['heart',3,'wuzhong'],\r\n\t\t\t['heart',4,'sha','fire'],\r\n\t\t\t['heart',4,'tao'],\r\n\t\t\t['heart',5,'tao'],\r\n\t\t\t['heart',5,'chitu'],\r\n\t\t\t['heart',6,'tao'],\r\n\t\t\t['heart',6,'jiwangkailai'],\r\n\t\t\t['heart',7,'sha','fire'],\r\n\t\t\t['heart',7,'tao'],\r\n\t\t\t['heart',8,'shan'],\r\n\t\t\t['heart',8,'wuzhong'],\r\n\t\t\t['heart',9,'shan'],\r\n\t\t\t['heart',9,'tao'],\r\n\t\t\t['heart',10,'sha','fire'],\r\n\t\t\t['heart',10,'sha'],\r\n\t\t\t['heart',11,'shan'],\r\n\t\t\t['heart',11,'wuzhong'],\r\n\t\t\t['heart',12,'shan'],\r\n\t\t\t['heart',12,'guohe'],\r\n\t\t\t['heart',13,'wuxie'],\r\n\t\t\t['heart',13,'zhuahuang'],\r\n\t\t\t\r\n\t\t\t['diamond',1,'zhuque'],\r\n\t\t\t['diamond',1,'juedou'],\r\n\t\t\t['diamond',2,'tao'],\r\n\t\t\t['diamond',2,'shan'],\r\n\t\t\t['diamond',3,'tao'],\r\n\t\t\t['diamond',3,'shan'],\r\n\t\t\t['diamond',4,'sha','fire'],\r\n\t\t\t['diamond',4,'shunshou'],\r\n\t\t\t['diamond',5,'sha','fire'],\r\n\t\t\t['diamond',5,'guanshi'],\r\n\t\t\t['diamond',6,'shan'],\r\n\t\t\t['diamond',6,'sha'],\r\n\t\t\t['diamond',7,'shan'],\r\n\t\t\t['diamond',7,'shan'],\r\n\t\t\t['diamond',8,'shan'],\r\n\t\t\t['diamond',8,'shan'],\r\n\t\t\t['diamond',9,'jiu'],\r\n\t\t\t['diamond',9,'shan'],\r\n\t\t\t['diamond',10,'shan'],\r\n\t\t\t['diamond',10,'sha'],\r\n\t\t\t['diamond',11,'shan'],\r\n\t\t\t['diamond',11,'shan'],\r\n\t\t\t['diamond',12,'huogong'],\r\n\t\t\t['diamond',12,'tao'],\r\n\t\t\t['diamond',13,'xiliu'],\r\n\t\t\t['diamond',13,'sha'],\r\n\t\t\t['diamond',13,'wuxie']\r\n\t\t],\r\n\t\thelp:{\r\n\t\t\t'斗地主':'<div style=\"margin:10px\">游戏规则</div><ul style=\"margin-top:0\"><li>游戏人数<br>游戏人数为3人（地主x1 + 农民x2）。<li>胜利条件<br>农民：地主死亡。<br>地主：所有农民死亡且自己存活。'+\r\n\t\t\t'<li>死亡奖惩<br>当有农民死亡时，若另一名农民存活，则其可以选择摸两张牌或回复一点体力。<li>地主专属技能<br>地主可以使用专属技能【飞扬】和【跋扈】。<br>【飞扬】判定阶段开始时，若你的判定区有牌，则你可以弃置两张手牌，然后弃置你判定区的一张牌。每回合限一次。<br>【跋扈】锁定技，准备阶段开始时，你摸一张牌。出牌阶段，你可以多使用一张【杀】。</ul>',\r\n\t\t}\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/doudizhu.js?")},"./src/mode/guozhan.js":function(){eval("\r\ngame.import('mode',function(lib,game,ui,get,ai,_status){\r\n\treturn {\r\n\t\tname:'guozhan',\r\n\t\tstartBefore:function(){\r\n\t\t\tvar playback=localStorage.getItem(lib.configprefix+'playback');\r\n\t\t\tfor(var i in lib.characterPack.mode_guozhan){\r\n\t\t\t\tif(!get.config('onlyguozhan')&&!playback){\r\n\t\t\t\t\tif(lib.character[i.slice(3)]) continue;\r\n\t\t\t\t}\r\n\t\t\t\tlib.character[i]=lib.characterPack.mode_guozhan[i];\r\n\t\t\t\tif(!lib.character[i][4]){\r\n\t\t\t\t\tlib.character[i][4]=[];\r\n\t\t\t\t}\r\n\t\t\t\tif(!lib.translate[i]){\r\n\t\t\t\t\tlib.translate[i]=lib.translate[i.slice(3)];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(var i in lib.character){\r\n\t\t\t\tif(lib.character[i][1]=='shen'){\r\n\t\t\t\t\tif(lib.character[i][4]&&(lib.group.contains(lib.character[i][4][0])||lib.character[i][4][0]=='key')){\r\n\t\t\t\t\t\tlib.character[i][1]=lib.character[i][4][0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlib.character[i][1]='qun';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(lib.skill.sanchen) lib.skill.sanchen.derivation='pozhu';\r\n\t\t},\r\n\t\tonreinit:function(){\r\n\t\t\tvar pack=lib.characterPack.mode_guozhan;\r\n\t\t\tfor(var i in pack){\r\n\t\t\t\tlib.character[i]=pack[i];\r\n\t\t\t\tif(!lib.character[i][4]){\r\n\t\t\t\t\tlib.character[i][4]=[];\r\n\t\t\t\t}\r\n\t\t\t\tif(!lib.translate[i]){\r\n\t\t\t\t\tlib.translate[i]=lib.translate[i.slice(3)];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(var i in lib.character){\r\n\t\t\t\tif(lib.character[i][1]=='shen'){\r\n\t\t\t\t\tif(lib.character[i][4]&&(lib.group.contains(lib.character[i][4][0])||lib.character[i][4][0]=='key')){\r\n\t\t\t\t\t\tlib.character[i][1]=lib.character[i][4][0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlib.character[i][1]='qun';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tstart:function(){\r\n\t\t\t\"step 0\"\r\n\t\t\tvar playback=localStorage.getItem(lib.configprefix+'playback');\r\n\t\t\tif(playback){\r\n\t\t\t\tui.create.me();\r\n\t\t\t\tui.arena.style.display='none';\r\n\t\t\t\tui.system.style.display='none';\r\n\t\t\t\t_status.playback=playback;\r\n\t\t\t\tlocalStorage.removeItem(lib.configprefix+'playback');\r\n\t\t\t\tvar store=lib.db.transaction(['video'],'readwrite').objectStore('video');\r\n\t\t\t\tstore.get(parseInt(playback)).onsuccess=function(e){\r\n\t\t\t\t\tif(e.target.result){\r\n\t\t\t\t\t\tgame.playVideoContent(e.target.result.video);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\talert('播放失败：找不到录像');\r\n\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tevent.finish();\r\n\t\t\t}\r\n\t\t\telse if(_status.connectMode){\r\n\t\t\t\tgame.waitForPlayer();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\t_status.mode=get.config('guozhan_mode');\r\n\t\t\t\tif(!['normal','yingbian','old','free'].contains(_status.mode)) _status.mode='normal';\r\n\t\t\t\t//决定牌堆\r\n\t\t\t\tswitch(_status.mode){\r\n\t\t\t\t\tcase 'old':lib.card.list=lib.guozhanPile_old.slice(0);break;\r\n\t\t\t\t\tcase 'yingbian':\r\n\t\t\t\t\t\tlib.card.list=lib.guozhanPile_yingbian.slice(0);\r\n\t\t\t\t\t\tdelete lib.translate.shuiyanqijunx_info_guozhan;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'normal':lib.card.list=lib.guozhanPile.slice(0);break;\r\n\t\t\t\t}\r\n\t\t\t\tif(_status.mode!='free') game.fixedPile=true;\r\n\t\t\t\telse{\r\n\t\t\t\t\tdelete lib.translate.shuiyanqijunx_info_guozhan;\r\n\t\t\t\t}\r\n\t\t\t\tgame.prepareArena();\r\n\t\t\t\t// game.delay();\r\n\t\t\t\tgame.showChangeLog();\r\n\t\t\t}\r\n\t\t\tif(get.config('card_remark')){\r\n\t\t\t\tfor(var i=0;i<lib.card.list.length;i++){\r\n\t\t\t\t\tif(get.type(lib.card.list[i][2])=='equip'){\r\n\t\t\t\t\t\tlib.card.list[i][2]='rm_'+lib.card.list[i][2];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(!_status.connectMode){\r\n\t\t\t\t_status.mode=get.config('guozhan_mode');\r\n\t\t\t\tif(_status.brawl&&_status.brawl.submode){\r\n\t\t\t\t\t_status.mode=_status.brawl.submode;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\"step 1\"\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\t_status.mode=lib.configOL.guozhan_mode;\r\n\t\t\t\tif(!['normal','yingbian','old'].contains(_status.mode)) _status.mode='normal';\r\n\t\t\t\t//决定牌堆\r\n\t\t\t\tswitch(_status.mode){\r\n\t\t\t\t\tcase 'old':lib.card.list=lib.guozhanPile_old.slice(0);break;\r\n\t\t\t\t\tcase 'yingbian':lib.card.list=lib.guozhanPile_yingbian.slice(0);break;\r\n\t\t\t\t\tdefault:lib.card.list=lib.guozhanPile.slice(0);break;\r\n\t\t\t\t}\r\n\t\t\t\tgame.fixedPile=true;\r\n\t\t\t\tgame.broadcastAll(function(mode){\r\n\t\t\t\t\t_status.mode=mode;\r\n\t\t\t\t\tif(mode=='yingbian'){\r\n\t\t\t\t\t\tdelete lib.translate.shuiyanqijunx_info_guozhan;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].node.name.hide();\r\n\t\t\t\t\t\tgame.players[i].node.name2.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar pack=lib.characterPack.mode_guozhan;\r\n\t\t\t\t\tfor(var i in pack){\r\n\t\t\t\t\t\tlib.character[i]=pack[i];\r\n\t\t\t\t\t\tif(!lib.character[i][4]){\r\n\t\t\t\t\t\t\tlib.character[i][4]=[];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!lib.translate[i]){\r\n\t\t\t\t\t\t\tlib.translate[i]=lib.translate[i.slice(3)];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i in lib.character){\r\n\t\t\t\t\t\tif(lib.character[i][1]=='shen'){\r\n\t\t\t\t\t\t\tif(lib.character[i][4]&&(lib.group.contains(lib.character[i][4][0])||lib.character[i][4][0]=='key')){\r\n\t\t\t\t\t\t\t\tlib.character[i][1]=lib.character[i][4][0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tlib.character[i][1]='qun';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.characterReplace={};\r\n\t\t\t\t\tif(lib.skill.sanchen) lib.skill.sanchen.derivation='pozhu';\r\n\t\t\t\t},_status.mode);\r\n\t\t\t\tgame.randomMapOL();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tlib.characterReplace={};\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].node.name.hide();\r\n\t\t\t\t\tgame.players[i].node.name2.hide();\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t}\r\n\t\t\t\tif(_status.brawl&&_status.brawl.chooseCharacterBefore){\r\n\t\t\t\t\t_status.brawl.chooseCharacterBefore();\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacter();\r\n\t\t\t}\r\n\t\t\t\"step 2\"\r\n\t\t\t//game.broadcastAll(function(){\r\n\t\t\t//\tlib.inpile.removeArray(['gz_haolingtianxia','gz_kefuzhongyuan','gz_guguoanbang','gz_wenheluanwu']);\r\n\t\t\t//});\r\n\t\t\tif(ui.coin){\r\n\t\t\t\t_status.coinCoeff=get.coinCoeff([game.me.name1,game.me.name2]);\r\n\t\t\t}\r\n\t\t\tvar player;\r\n\t\t\tif(_status.cheat_seat){\r\n\t\t\t\tvar seat=_status.cheat_seat.link;\r\n\t\t\t\tif(seat==0){\r\n\t\t\t\t\tplayer=game.me;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tplayer=game.players[game.players.length-seat];\r\n\t\t\t\t}\r\n\t\t\t\tif(!player) player=game.me;\r\n\t\t\t\tdelete _status.cheat_seat;\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tplayer=game.players[Math.floor(Math.random()*game.players.length)];\r\n\t\t\t}\r\n\t\t\tevent.playerx=player;\r\n\t\t\tevent.trigger('gameStart');\r\n\r\n\t\t\t\"step 3\"\r\n\t\t\tgame.gameDraw(event.playerx);\r\n\t\t\tgame.broadcastAll(function(player){\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].name='unknown'+get.distance(player,game.players[i],'absolute');\r\n\t\t\t\t\tgame.players[i].node.name_seat=ui.create.div('.name.name_seat',get.verticalStr(lib.translate[game.players[i].name]),game.players[i]);\r\n\t\t\t\t\t// if(game.players[i]==game.me){\r\n\t\t\t\t\t// \tlib.translate[game.players[i].name]+='（你）';\r\n\t\t\t\t\t// }\r\n\t\t\t\t}\r\n\t\t\t},event.playerx);\r\n\r\n\t\t\tvar players=get.players(lib.sort.position);\r\n\t\t\tvar info=[];\r\n\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\tinfo.push({\r\n\t\t\t\t\tname:game.players[i].name,\r\n\t\t\t\t\ttranslate:lib.translate[game.players[i].name],\r\n\t\t\t\t\tname1:players[i].name1,\r\n\t\t\t\t\tname2:players[i].name2,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t_status.videoInited=true,\r\n\t\t\tgame.addVideo('init',null,info);\r\n\t\t\tif(_status.mode=='mingjiang'){\r\n\t\t\t\tgame.showIdentity(true);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].ai.shown=0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(_status.connectMode&&lib.configOL.change_card) game.replaceHandcards(game.players.slice(0));\r\n\t\t\t\"step 4\"\r\n\t\t\tevent.trigger('phaseLoopBefore');\r\n\t\t\t\"step 5\"\r\n\t\t\tgame.phaseLoop(event.playerx);\r\n\t\t},\r\n\t\tcard:{\r\n\t\t\tjunling1:{\r\n\t\t\t\ttype:'junling',\r\n\t\t\t\tvanish:true,\r\n\t\t\t\tderivation:'guozhan',\r\n\t\t\t},\r\n\t\t\tjunling2:{\r\n\t\t\t\ttype:'junling',\r\n\t\t\t\tvanish:true,\r\n\t\t\t\tderivation:'guozhan',\r\n\t\t\t},\r\n\t\t\tjunling3:{\r\n\t\t\t\ttype:'junling',\r\n\t\t\t\tvanish:true,\r\n\t\t\t\tderivation:'guozhan',\r\n\t\t\t},\r\n\t\t\tjunling4:{\r\n\t\t\t\ttype:'junling',\r\n\t\t\t\tvanish:true,\r\n\t\t\t\tderivation:'guozhan',\r\n\t\t\t},\r\n\t\t\tjunling5:{\r\n\t\t\t\ttype:'junling',\r\n\t\t\t\tvanish:true,\r\n\t\t\t\tderivation:'guozhan',\r\n\t\t\t},\r\n\t\t\tjunling6:{\r\n\t\t\t\ttype:'junling',\r\n\t\t\t\tvanish:true,\r\n\t\t\t\tderivation:'guozhan',\r\n\t\t\t},\r\n\t\t\tzhulian_card:{\r\n\t\t\t\tcardimage:'wuzhong',\r\n\t\t\t},\r\n\t\t},\r\n\t\taozhanRank:{\r\n\t\t\t'8':['gz_panjun'],\r\n\t\t\t'7':[],\r\n\t\t\t'6':[],\r\n\t\t\t'5':[\r\n\t\t\t\t'gz_lukang','gz_caoren','gz_lvfan',\r\n\t\t\t\t'gz_machao','gz_ganfuren','gz_madai',\r\n\t\t\t\t'gz_jiling','gz_pangde','gz_huangzu',\r\n\t\t\t],\r\n\t\t\t'4':[\r\n\t\t\t\t'gz_re_lidian','gz_yuejin','gz_huangzhong',\r\n\t\t\t\t'gz_menghuo','gz_sunshangxiang','gz_lvmeng',\r\n\t\t\t\t'gz_lvbu','gz_xiahouba',\r\n\t\t\t],\r\n\t\t\t'3':[\r\n\t\t\t\t'gz_simayi','gz_luxun','gz_wuguotai',\r\n\t\t\t\t'gz_caiwenji','gz_shibao','gz_xuyou',\r\n\t\t\t\t'gz_zhugeke',\r\n\t\t\t],\r\n\t\t\t'2':[\r\n\t\t\t\t'gz_re_lusu','gz_zhangzhang',\r\n\t\t\t\t'gz_jin_simashi','gz_jin_zhangchunhua',\r\n\t\t\t],\r\n\t\t\t'1':[\r\n\t\t\t\t'gz_caocao','gz_guojia','gz_xiahoudun',\r\n\t\t\t\t'gz_xunyu','gz_caopi','gz_liubei',\r\n\t\t\t\t'gz_fazheng','gz_dongzhuo','gz_yuji',\r\n\t\t\t\t'gz_liqueguosi','gz_huanggai','gz_re_xushu',\r\n\t\t\t\t'gz_panjun',\r\n\t\t\t],\r\n\t\t},\r\n\t\tguozhanRank:{\r\n\t\t\t'8':[\r\n\t\t\t\t'gz_xunyou','gz_re_lidian','gz_caopi',\r\n\t\t\t\t'gz_shamoke','gz_lifeng','gz_wangping',\r\n\t\t\t\t'gz_xiaoqiao','gz_zhoutai','gz_lvfan',\r\n\t\t\t\t'gz_beimihu','gz_mateng','gz_jiaxu',\r\n\t\t\t\t'gz_jin_wangyuanji','gz_huaxin','gz_duyu',\r\n\t\t\t\t'gz_zhonghui','gz_xuyou','gz_simazhao',\r\n\t\t\t],\r\n\t\t\t'7':[\r\n\t\t\t\t'gz_zhanghe','gz_jianggan','gz_simayi',\r\n\t\t\t\t'gz_weiyan','gz_huangyueying','gz_zhugeliang',\r\n\t\t\t\t'gz_lingtong','gz_sunshangxiang','gz_sunce',\r\n\t\t\t\t'gz_re_yuanshao','gz_yuanshu','gz_hetaihou',\r\n\t\t\t\t'gz_jin_simashi','gz_sp_duyu','gz_shibao',\r\n\t\t\t\t'gz_gongsunyuan','gz_panjun',\r\n\t\t\t],\r\n\t\t\t'6':[\r\n\t\t\t\t'gz_zhenji','gz_guojia','gz_yujin',\r\n\t\t\t\t'gz_jiangwei','gz_zhangfei','gz_sp_zhugeliang',\r\n\t\t\t\t'gz_zhouyu','gz_lingcao','gz_daqiao','gz_dingfeng',\r\n\t\t\t\t'gz_yuji','gz_caiwenji','gz_diaochan','gz_zuoci',\r\n\t\t\t\t'gz_key_ushio','gz_jin_simazhao','gz_dongzhao',\r\n\t\t\t\t'gz_liuba',\r\n\t\t\t],\r\n\t\t\t'5':[\r\n\t\t\t\t'gz_zhangliao','gz_caocao','gz_xuhuang',\r\n\t\t\t\t'gz_liushan','gz_pangtong','gz_zhaoyun',\r\n\t\t\t\t'gz_re_lusu','gz_sunquan','gz_ganning',\r\n\t\t\t\t'gz_zhangxiu','gz_liqueguosi','gz_huatuo',\r\n\t\t\t\t'gz_zhanghuyuechen','gz_re_xushu','gz_mifangfushiren',\r\n\t\t\t\t'gz_huangzu','gz_weiguan','gz_miheng',\r\n\t\t\t],\r\n\t\t\t'4':[\r\n\t\t\t\t'gz_dianwei','gz_dengai','gz_xunyu',\r\n\t\t\t\t'gz_madai','gz_liubei','gz_mifuren',\r\n\t\t\t\t'gz_wuguotai','gz_luxun','gz_taishici',\r\n\t\t\t\t'gz_zhangjiao','gz_pangde','gz_liuqi',\r\n\t\t\t\t'gz_jin_zhangchunhua','gz_zongyu','gz_shixie',\r\n\t\t\t\t'gz_jin_yanghuiyu','gz_tangzi','gz_yanbaihu',\r\n\t\t\t\t'gz_wujing','gz_zhugeke','gz_wenqin',\r\n\t\t\t],\r\n\t\t\t'3':[\r\n\t\t\t\t'gz_xiahoudun','gz_yuejin','gz_caoren',\r\n\t\t\t\t'gz_machao','gz_masu','gz_fazheng',\r\n\t\t\t\t'gz_zhangzhang','gz_lvmeng','gz_huanggai',\r\n\t\t\t\t'gz_jiling','gz_lvbu','gz_dongzhuo',\r\n\t\t\t\t'gz_jin_xiahouhui','gz_simazhou','gz_zhanglu',\r\n\t\t\t],\r\n\t\t\t'2':[\r\n\t\t\t\t'gz_cuimao','gz_xiahouyuan','gz_caohong',\r\n\t\t\t\t'gz_zhurong','gz_zhurong','gz_jiangfei',\r\n\t\t\t\t'gz_xusheng','gz_luyusheng','gz_sunjian',\r\n\t\t\t\t'gz_zhangren','gz_kongrong','gz_yanwen',\r\n\t\t\t\t'gz_jin_simayi','gz_mengda','gz_xiahouba',\r\n\t\t\t],\r\n\t\t\t'1':[\r\n\t\t\t\t'gz_zangba','gz_bianfuren','gz_xuzhu',\r\n\t\t\t\t'gz_menghuo','gz_ganfuren','gz_guanyu',\r\n\t\t\t\t'gz_lukang','gz_jiangqing','gz_chendong',\r\n\t\t\t\t'gz_zoushi','gz_panfeng','gz_tianfeng',\r\n\t\t\t\t'gz_sufei',\r\n\t\t\t],\r\n\t\t},\r\n\t\tcharacterSort:{\r\n\t\t\tmode_guozhan:{\r\n\t\t\t\tguozhan_default:[\"gz_caocao\",\"gz_simayi\",\"gz_xiahoudun\",\"gz_zhangliao\",\"gz_xuzhu\",\"gz_guojia\",\"gz_zhenji\",\"gz_xiahouyuan\",\"gz_zhanghe\",\"gz_xuhuang\",\"gz_caoren\",\"gz_dianwei\",\"gz_xunyu\",\"gz_caopi\",\"gz_yuejin\",\"gz_liubei\",\"gz_guanyu\",\"gz_zhangfei\",\"gz_zhugeliang\",\"gz_zhaoyun\",\"gz_machao\",\"gz_huangyueying\",\"gz_huangzhong\",\"gz_weiyan\",\"gz_pangtong\",\"gz_sp_zhugeliang\",\"gz_liushan\",\"gz_menghuo\",\"gz_zhurong\",\"gz_ganfuren\",\"gz_sunquan\",\"gz_ganning\",\"gz_lvmeng\",\"gz_huanggai\",\"gz_zhouyu\",\"gz_daqiao\",\"gz_luxun\",\"gz_sunshangxiang\",\"gz_sunjian\",\"gz_xiaoqiao\",\"gz_taishici\",\"gz_zhoutai\",\"gz_re_lusu\",\"gz_zhangzhang\",\"gz_dingfeng\",\"gz_huatuo\",\"gz_lvbu\",\"gz_diaochan\",\"gz_re_yuanshao\",\"gz_yanwen\",\"gz_jiaxu\",\"gz_pangde\",\"gz_zhangjiao\",\"gz_caiwenji\",\"gz_mateng\",\"gz_kongrong\",\"gz_jiling\",\"gz_tianfeng\",\"gz_panfeng\",\"gz_zoushi\",],\r\n\t\t\t\tguozhan_zhen:[\"gz_dengai\",\"gz_caohong\",\"gz_jiangfei\",\"gz_jiangwei\",\"gz_xusheng\",\"gz_jiangqing\",\"gz_hetaihou\",\"gz_yuji\"],\r\n\t\t\t\tguozhan_shi:[,\"gz_re_lidian\",\"gz_zangba\",\"gz_madai\",\"gz_mifuren\",\"gz_sunce\",\"gz_chendong\",\"gz_sp_dongzhuo\",\"gz_zhangren\"],\r\n\t\t\t\tguozhan_bian:[\"gz_liqueguosi\",\"gz_zuoci\",\"gz_bianfuren\",\"gz_xunyou\",\"gz_lingtong\",\"gz_lvfan\",\"gz_masu\",\"gz_shamoke\",],\r\n\t\t\t\tguozhan_quan:[\"gz_cuimao\",\"gz_yujin\",\"gz_wangping\",\"gz_fazheng\",\"gz_wuguotai\",\"gz_lukang\",\"gz_yuanshu\",\"gz_zhangxiu\"],\r\n\t\t\t\tguozhan_jun:[\"gz_jun_caocao\",\"gz_jun_sunquan\",\"gz_jun_liubei\",\"gz_jun_zhangjiao\"],\r\n\t\t\t\tguozhan_jin:['gz_jin_simayi','gz_jin_simazhao','gz_jin_simashi','gz_jin_zhangchunhua','gz_jin_wangyuanji','gz_jin_xiahouhui','gz_duyu','gz_zhanghuyuechen','gz_jin_yanghuiyu','gz_simazhou','gz_shibao','gz_weiguan','gz_zhongyan'],\r\n\t\t\t\tguozhan_single:['gz_re_xushu','gz_yanbaihu','gz_wujing','gz_dongzhao','gz_huangzu','gz_zhugeke','gz_liuba','gz_zhuling'],\r\n\t\t\t\tguozhan_double:['gz_tangzi','gz_liuqi','gz_mengda','gz_mifangfushiren','gz_zhanglu','gz_shixie','gz_xuyou','gz_xiahouba','gz_panjun','gz_xf_sufei','gz_wenqin','gz_pengyang'],\r\n\t\t\t\tguozhan_yexinjia:['gz_zhonghui','gz_simazhao','gz_gongsunyuan'],\r\n\t\t\t\tguozhan_zongheng:['gz_huaxin','gz_luyusheng','gz_zongyu','gz_miheng','gz_fengxi','gz_dengzhi'],\r\n\t\t\t\tguozhan_others:[\"gz_lingcao\",\"gz_lifeng\",\"gz_beimihu\",\"gz_jianggan\",\"gz_key_ushio\",\"gz_sp_duyu\"],\r\n\r\n\t\t\t\tguozhan_guangjie:[\"gz_HoshimatiSuisei\",\"gz_NatsuiroMatsuri\",\"gz_SpadeEcho\",\"gz_ShigureUi\",\r\n\t\t\t\t\"gz_Yousa\",\"gz_AZKi\",\"gz_NekomiyaHinata\",\"gz_InuyamaTamaki\",\"gz_TenkaiTsukasa\",\"gz_Fairys\"],\r\n\t\t\t}\r\n\t\t},\r\n\t\tperfectPair:{\r\n\t\t\tTokinoSora:['AZKi'],\r\n\t\t\tSakuraMiko:['UsadaPekora'],\r\n\t\t\tYozoraMel:['AkiRosenthal'],\r\n\t\t\tShirakamiFubuki:['ŌokamiMio'],\r\n\t\t\tNatsuiroMatsuri:['ShirakamiFubuki','MurasakiShion'],\r\n\t\t\tMinatoAqua:['NakiriAyame','MurasakiShion','KaguraMea'],\r\n\t\t\tŌzoraSubaru:['ShigureUi'],\r\n\t\t\tMitoTsukino:['HiguchiKaede','ShizukaRin'],\r\n\t\t\tMononobeAlice:['UshimiIchigo'],\r\n\t\t\tLizeHelesta:['SuzuharaLulu','AngeKatrina'],\r\n\t\t\tHonmaHimawari:['SuzuharaLulu'],\r\n\t\t\tSukoyaKana:['ShirayukiTomoe'],\r\n\t\t\tSasakiSaku:['DoumyoujiHaruto'],\r\n\t\t\tSuzuharaLulu:['SephiraSu'],\r\n\t\t\tKizunaAI:['KaguyaLuna'],\r\n\t\t\tSiro:['Bacharu'],\r\n\t\t\tDiana:['Ava'],\r\n\t\t\tInabaHaneru:['YuNi'],\r\n\t\t\tNekomasu:['Noracat','KaguyaLuna'],\r\n\t\t\tzhangjinghua:['bingtang','Paryi','CierraRunis'],\r\n\t\t\tParyi:['bingtang'],\r\n\t\t\tKano:['HanamaruHareru'],\r\n\t\t\tKaguraNana:['SpadeEcho'],\r\n\t\t\tTenkaiTsukasa:['Fairys'],\r\n\t\t\t\r\n\t\t\tKaguraMea:['InuyamaTamaki','InabaHaneru','MononobeAlice'],\r\n\t\t},\r\n\t\tcharacterPack:{\r\n\t\t\tmode_guozhan:{\r\n\t\t\t\t/**时乃空 */\r\n\t\t\t\tgz_TokinoSora:['female','holo',4,['re_taiyangzhiyin'],['gzskin']],\r\n\t\t\t\t/**萝卜子 */\r\n\t\t\t\tgz_RobokoSan:['female','holo',3,['re_zhanxie','re_chongdian'],['gzskin']],\r\n\t\t\t\t/**白上吹雪 */\r\n\t\t\t\tgz_ShirakamiFubuki:['female','holo',3,['gz_yuanlv','re_jinyuan']],\r\n\t\t\t\t/**星街慧星 */\r\n\t\t\t\tgz_HoshimatiSuisei:['female','holo',4,['cansha'],['doublegroup:holo:clubs:vtuber']],\r\n\t\t\t\t/**夜空梅露 */\r\n\t\t\t\tgz_YozoraMel:['female','holo',3,['fuyi', 'xihun']],\r\n\t\t\t\t/**aki */\r\n\t\t\t\tgz_AkiRosenthal: ['female', 'holo', 3,['meiwu', 're_huichu']],\r\n\t\t\t\t/**樱巫女 */\r\n\t\t\t\tgz_SakuraMiko: ['female', 'holo', 3, ['huangyou','qidao'],['gzskin']],\r\n\t\t\t\t /**夏色祭 */\r\n\t\t\t\tgz_NatsuiroMatsuri:['female','holo',3,['gz_huxi'],['doublegroup:holo:nijisanji']],\r\n\t\t\t\t/**湊阿库娅 */\r\n\t\t\t\tgz_MinatoAqua:['female','holo',3,['gz_kuali','youyi'],['gzskin']],\r\n\t\t\t\t/**兔田佩克拉 */\r\n\t\t\t\tgz_UsadaPekora:['female','holo',4,['qiangyun','tuquan'],['gzskin']],\r\n\t\t\t\t/**润羽露西娅 */\r\n\t\t\t\tgz_UruhaRushia:['female','holo',3,['juebi','zhanhou'],['gzskin']],\r\n\t\t\t\t/**大神澪 */\r\n\t\t\t\tgz_ŌokamiMio:['female','holo',4,['re_yuzhan','re_bizuo']],\r\n\t\t\t\t/**百鬼绫目 */\r\n\t\t\t\tgz_NakiriAyame:['female','holo',4,['gz_guiren'],['gzskin']],\r\n\t\t\t\t/**角卷绵芽 */\r\n\t\t\t\tgz_TsunomakiWatame:['female','holo',4,['disui','dengyan'],['gzskin']],\r\n\t\t\t\t/**雪花菈米 */\r\n\t\t\t\tgz_YukihanaLamy:['female','holo',4,['hanling'],['gzskin']],\r\n\t\t\t\t/**大空昴 */\r\n\t\t\t\tgz_ŌzoraSubaru:['female','holo',4,['cejing'],['gzskin']],\r\n\t\t\t\t/**时雨羽衣 */\r\n\t\t\t\tgz_ShigureUi:['female', 'holo', 3, ['uijieyuan', 'huixiang'],['gzskin','doublegroup:holo:nijisanji:clubs']],\r\n\t\t\t\t/**紫咲诗音 */\r\n\t\t\t\tgz_MurasakiShion:['female','holo',3,['anshu','xingchi'],['gzskin']],\r\n\t\t\t\t/**桃子 */\r\n\t\t\t\tgz_SpadeEcho:['female','holo',3,['qinglve','yingshi'],['doublegroup:holo:clubs','guoV']],\r\n\r\n\t\t\t\t/**月之美兔 */\r\n\t\t\t\tgz_MitoTsukino:['female','nijisanji',3,['gz_bingdielei'],['gzskin']],\r\n\t\t\t\t/**樋口枫 */\r\n\t\t\t\tgz_HiguchiKaede: ['female', 'nijisanji', 4, ['re_zhenyin'],['gzskin']],\r\n\t\t\t\t/**静凛 */\r\n\t\t\t\tgz_ShizukaRin:['female','nijisanji',4,['re_mozhaotuji'],['gzskin']],\r\n\t\t\t\t/**物述有栖 */\r\n\t\t\t\tgz_MononobeAlice:['female','nijisanji',3,['tinenghuifu1','re_dianmingguzhen']],\r\n\t\t\t\t/**宇志海莓 */\r\n\t\t\t\tgz_UshimiIchigo: ['female', 'nijisanji', 3, ['gz_kuangbaoshuangren', 'guangsuxiabo']],\r\n\t\t\t\t/**修女克蕾雅 */\r\n\t\t\t\tgz_SisterClearie:['female','nijisanji',3,['gz_zhenxin','sczhuwei']],\r\n\t\t\t\t/**gz莉泽 */\r\n\t\t\t\tgz_LizeHelesta:['female','nijisanji',3,['tongchen','wangxuan'],['gzskin']],\r\n\t\t\t\t/**gz安洁 */\r\n\t\t\t\tgz_AngeKatrina:['female','nijisanji',4,['gz_lianjin'],['gzskin']],\r\n\t\t\t\t/**铃原露露 */\r\n\t\t\t\tgz_SuzuharaLulu:['female','nijisanji',5,['tunshi']],\r\n\t\t\t\t/**铃鹿诗子 */\r\n\t\t\t\t//gz_SuzukaUtako: ['female', 'nijisanji', 3, ['re_meici', 're_danlian']],\r\n\t\t\t\t/**本间向日葵 */\r\n\t\t\t\tgz_HonmaHimawari:['female','nijisanji',4,['mark_tianqing','kuiquan'],['gzskin']],\r\n\t\t\t\t/**相羽初叶 */\r\n\t\t\t\tgz_AibaUiha:['female','nijisanji',4,['kangding','longshe'],['gzskin']],\r\n\t\t\t\t/**熊猫人 */\r\n\t\t\t\tgz_SasakiSaku:['female','nijisanji',4,['tiaolian','gz_jiaku']],\r\n\t\t\t\t/**健屋花那 */\r\n\t\t\t\tgz_SukoyaKana:['female','nijisanji',3,['re_huawen','re_liaohu']],\r\n\t\t\t\t/**白雪巴 */\r\n\t\t\t\tgz_ShirayukiTomoe:['female','nijisanji',4,['re_gonggan','yejing']],\r\n\t\t\t\t/**语部纺 */\r\n\t\t\t\tgz_KataribeTsumugu:['female','nijisanji',3,['lingli','chengfo'],['gzskin']],\r\n\r\n\t\t\t\t/**绊爱 */\r\n\t\t\t\tgz_KizunaAI:['female','vtuber',4,['re_ailian']],\r\n\t\t\t\t/**YuNi */\r\n\t\t\t\tgz_YuNi:['female','vtuber',4,['gz_shengcai'],['gzskin']],\r\n\t\t\t\t/**未来明 */\r\n\t\t\t\tgz_MiraiAkari: ['female', 'vtuber', 4, ['gz_duanli','gz_qingyi']],\r\n\t\t\t\t/**辉夜月 */\r\n\t\t\t\tgz_KaguyaLuna:['female','vtuber',3,['jiajiupaidui','kuangzuiluanwu']],\r\n\t\t\t\t/**小白 */\r\n\t\t\t\tgz_Siro:['female', 'vtuber', 4, ['liexing']],\r\n\t\t\t\t/**巴恰鲁 */\r\n\t\t\t\tgz_Bacharu:['male', 'vtuber', 4, ['gz_zuodun','gz_baidao']],\r\n\t\t\t\t/**姬雏 */\r\n\t\t\t\tgz_HIMEHINA:['female','vtuber',3,['jichu','mingshizhige']],\r\n\t\t\t\t/**塞菲拉·苏 */\r\n\t\t\t\tgz_SephiraSu:['female','vtuber',3,['mishu','xingchen']],\r\n\t\t\t\t/**嘉然 */\r\n\t\t\t\tgz_Diana: ['female','vtuber',4,['quanyu'],['gzskin','guoV']],\r\n\t\t\t\t/**向晚 */\r\n\t\t\t\tgz_Ava: ['female','vtuber',4,['baitai','gz_yiqu'],['gzskin','guoV']],\r\n\t\t\t\t/**泠鸢 */\r\n\t\t\t\tgz_Yousa:['female','vtuber',3,['gz_niaoji','ysxiangxing'],['doublegroup:vtuber:nijisanji']],\r\n\t\t\t\t/**道明寺晴翔 */\r\n\t\t\t\tgz_DoumyoujiHaruto:['male', 'vtuber', 3, ['shengfu', 'wanbi'],['gzskin']],\r\n\t\t\t\t/**小希小桃 */\r\n\t\t\t\tgz_XiaoxiXiaotao:['female','vtuber',3,['re_doupeng','gz_xuyan'],['guoV']],\r\n\t\t\t\t/**心萪 */\r\n\t\t\t\tgz_xinke:['female','vtuber',3,['zuigao','xinhuochuancheng'],['gzskin','guoV']],\r\n\t\t\t\t/**白神遥 */\r\n\t\t\t\tgz_ShirakamiHaruka:['female','vtuber',3,['zhenbao','heimo'],['guoV']],\r\n\t\t\t\t/**兔妈妈 */\r\n\t\t\t\tgz_InabaHaneru:['female','vtuber',3,['gz_jiance','yingqi'],['gzskin','doublegroup:vtuber:holo:nijisanji']],\r\n\t\t\t\t/**AZKi */\r\n\t\t\t\tgz_AZKi:['female','vtuber',4,['WHiTE','BLacK'],['gzskin','doublegroup:vtuber:holo']],\r\n\t\t\t\t/**猫宫 */\r\n\t\t\t\tgz_NekomiyaHinata: ['female', 'vtuber', 4, ['gz_yingdan','tianzhuo'],['doublegroup:vtuber:clubs']],\r\n\r\n\t\t\t\t/**狗妈 */\r\n\t\t\t\tgz_KaguraNana: ['female', 'clubs', 3, ['zhanni']],\r\n\t\t\t\t/**狐叔 */\r\n\t\t\t\tgz_Nekomasu: ['female', 'clubs', 3, ['milijianying', 're_dianyin']],\r\n\t\t\t\t/**Noracat */\r\n\t\t\t\tgz_Noracat: ['female', 'clubs', 5, ['kouhu'],['gzskin']],\r\n\t\t\t\t// /**Yomemi */\r\n\t\t\t\t// gz_Yomemi:['female','clubs',3,['mokuai','yaoji']],\r\n\t\t\t\t/**团长 */\r\n\t\t\t\tgz_HisekiErio:['female','clubs',4,['re_huange']],\r\n\t\t\t\t/**花园猫 */\r\n\t\t\t\tgz_HanazonoSerena: ['female', 'clubs', 3, ['re_jiumao', 're_enfan']],\r\n\t\t\t\t/**美波 */\r\n\t\t\t\tgz_MinamiNami: ['female','clubs',4,['gz_longdan'],['gzskin']],\r\n\t\t\t\t/**下地 */\r\n\t\t\t\tgz_XiaDi: ['male', 'clubs', 4, ['re_yinliu', 'dunzou']],\r\n\t\t\t\t/**雫るる */\r\n\t\t\t\tgz_ShizukuLulu:['female','clubs',3,['duixian','gutai']],\r\n\t\t\t\t/**帕里 */\r\n\t\t\t\tgz_Paryi:['male','clubs',4,['gz_tiantang']],\r\n\t\t\t\t/**张京华 */\r\n\t\t\t\tgz_zhangjinghua: ['male', 'clubs', 3, ['gz_xiemen', 'jiai']],\r\n\t\t\t\t/**谢拉 */\r\n\t\t\t\tgz_CierraRunis:['female','clubs',3,['minghuahongxiao']],\r\n\t\t\t\t/**进击的冰糖 */\r\n\t\t\t\tgz_bingtang: ['female', 'clubs', 4, ['xiou'],['guoV']],\r\n\t\t\t\t/**OTO */\r\n\t\t\t\tgz_OtomeOto: ['female', 'clubs', 3, ['gz_yuxia', 'gz_lianjue']],\r\n\t\t\t\t/**鹿乃 */\r\n\t\t\t\tgz_Kano: ['female','clubs',4,['shiguang'],['gzskin']],\r\n\t\t\t\t/**花丸 */\r\n\t\t\t\tgz_HanamaruHareru: ['female','clubs',3,['rangran','jiazhao'],['gzskin']],\r\n\t\t\t\t/**Fairys */\r\n\t\t\t\tgz_Fairys:['male', 'clubs', 4, ['ywshuangxing', 'yinni'],['gzskin','doublegroup:clubs:nijisanji']],\r\n\t\t\t\t/**天开司 */\r\n\t\t\t\tgz_TenkaiTsukasa: ['male','clubs',4,['re_pojie','re_dazhen'],['gzskin','doublegroup:clubs:nijisanji:vtuber']],\r\n\t\t\t\t/**犬山 */\r\n\t\t\t\tgz_InuyamaTamaki:['male','clubs',3,['rongyaochengyuan','re_hundunliandong'],['doublegroup:clubs:vtuber:nijisanji:holo']],\r\n\r\n\t\t\t\t//神乐\r\n\t\t\t\tgz_KaguraMea: ['female', 'ye', 4, ['gz_luecai', 're_xiaoyan']],\r\n\r\n\r\n\t\t\t\tgz_shibing1wei:['male','wei',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2wei:['female','wei',0,[],['unseen']],\r\n\t\t\t\tgz_shibing1shu:['male','shu',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2shu:['female','shu',0,[],['unseen']],\r\n\t\t\t\tgz_shibing1wu:['male','wu',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2wu:['female','wu',0,[],['unseen']],\r\n\t\t\t\tgz_shibing1qun:['male','qun',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2qun:['female','qun',0,[],['unseen']],\r\n\t\t\t\tgz_shibing1jin:['male','jin',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2jin:['female','jin',0,[],['unseen']],\r\n\t\t\t\tgz_shibing1ye:['male','ye',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2ye:['female','ye',0,[],['unseen']],\r\n\t\t\t\tgz_shibing1key:['male','key',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2key:['female','key',0,[],['unseen']],\r\n\r\n\t\t\t\tgz_shibing1holo:['male','holo',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2holo:['female','holo',0,[],['unseen']],\r\n\t\t\t\tgz_shibing1nijisanji:['male','nijisanji',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2nijisanji:['female','nijisanji',0,[],['unseen']],\r\n\t\t\t\tgz_shibing1vtuber:['male','vtuber',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2vtuber:['female','vtuber',0,[],['unseen']],\r\n\t\t\t\tgz_shibing1clubs:['male','clubs',0,[],['unseen']],\r\n\t\t\t\tgz_shibing2clubs:['female','clubs',0,[],['unseen']],\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t},\r\n\t\tskill:{\r\n\t\t\t//gz狐狸\r\n\t\t\tgz_yuanlv:{\r\n\t\t\t\taudio:'yuanlv',\r\n\t\t\t\ttrigger:{player:['damageAfter','useCardAfter']},\r\n\t\t\t\tpriority:2,\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.name=='damage'||(event.name=='useCard'&&get.type(event.card,'trick')=='trick')){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\tplayer.chooseCard(1,'he','选择放置到牌堆顶部的牌',true);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool&&result.cards&&result.cards.length) event.linkcards=result.cards.slice(0);\r\n\t\t\t\t\telse\tevent.finish();\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar cards=event.linkcards;\r\n\t\t\t\t\tplayer.lose(cards,ui.special);\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar cards=event.linkcards;\r\n\t\t\t\t\twhile(cards.length>0){\r\n\t\t\t\t\t\tvar card=cards.pop();\r\n\t\t\t\t\t\tcard.fix();\r\n\t\t\t\t\t\tui.cardPile.insertBefore(card,ui.cardPile.firstChild);\r\n\t\t\t\t\t\tgame.updateRoundNumber();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:0.6,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//gz夏色祭\r\n\t\t\tgz_huxi:{\r\n\t\t\t\taudio:'huxi1',\r\n\t\t\t\ttrigger:{player:'phaseUseBegin',source:'damageSource'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.hasPlayer(function(cur){\r\n\t\t\t\t\t\tif(player.$.gz_huxiGroup==null) return true;\r\n\t\t\t\t\t\treturn !player.$.gz_huxiGroup.contains(cur)&&cur!=player;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar next = player.chooseCardTarget('请选择呼吸的对象与交换的牌',true).set('type','compare');\r\n\t\t\t\t\tnext.set('filterTarget',function(card,player,target){\r\n\t\t\t\t\t\t\tif(player.$.gz_huxiGroup&&player.$.gz_huxiGroup.contains(target))\treturn false;\r\n\t\t\t\t\t\t\treturn target!=player&&player.countCards('h')&&target.countCards('h');\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.target=result.targets[0];\r\n\t\t\t\t\t\tgame.log(player,'想要呼吸',event.target);\r\n\t\t\t\t\t\tevent.card1=result.cards[0];\r\n\t\t\t\t\t\tevent.target.chooseCard('请选择交换的牌',true).set('type','compare');\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tevent.card2=result.cards[0];\r\n\t\t\t\t\tif(!event.resultOL&&event.ol){\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tplayer.lose(event.card1,ui.ordering);\r\n\t\t\t\t\tevent.target.lose(event.card2,ui.ordering);\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tgame.broadcast(function(){\r\n\t\t\t\t\t\tui.arena.classList.add('thrownhighlight');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tui.arena.classList.add('thrownhighlight');\r\n\t\t\t\t\tgame.addVideo('thrownhighlight1');\r\n\t\t\t\t\tplayer.$compare(event.card1,event.target,event.card2);\r\n\t\t\t\t\tgame.log(player,'的交换牌为',event.card1);\r\n\t\t\t\t\tgame.log(event.target,'的交换牌为',event.card2);\r\n\t\t\t\t\tevent.num1=event.card1.number;\r\n\t\t\t\t\tevent.num2=event.card2.number;\r\n\t\t\t\t\tevent.trigger('compare');\r\n\t\t\t\t\tgame.delay(0,1500);\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tevent.result={\r\n\t\t\t\t\t\tgetC:event.card2,\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar str;\r\n\t\t\t\t\tstr=get.translation(player.name)+'想要呼吸'+get.translation(event.target.name);\r\n\t\t\t\t\tgame.broadcastAll(function(str){\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog(str);\r\n\t\t\t\t\t\tdialog.classList.add('center');\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tdialog.close();\r\n\t\t\t\t\t\t},1000);\r\n\t\t\t\t\t},str);\r\n\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tif(typeof event.target.ai.shown=='number'&&event.target.ai.shown<=0.85&&event.addToAI){\r\n\t\t\t\t\t\tevent.target.ai.shown+=0.1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.gain(event.card2,'visible');\r\n\t\t\t\t\tplayer.$gain2(event.card2);\r\n\t\t\t\t\tgame.delay(1);\r\n\t\t\t\t\ttarget.gain(event.card1,'visible');\r\n\t\t\t\t\ttarget.$gain2(event.card1);\r\n\t\t\t\t\tgame.broadcastAll(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('thrownhighlight');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.addVideo('thrownhighlight2');\r\n\t\t\t\t\tif(event.clear!==false){\r\n\t\t\t\t\t\tgame.broadcastAll(ui.clear);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(typeof event.preserve=='function'){\r\n\t\t\t\t\t\tevent.preserve=event.preserve(event.result);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 7'\r\n\t\t\t\t\tevent.card = event.result.getC;\r\n\t\t\t\t\tif(get.color(event.card)=='red'){\r\n\t\t\t\t\t\tplayer.draw(1);\r\n\t\t\t\t\t\tif(!player.hasSkill('gz_huxi2')){\r\n\t\t\t\t\t\t\tplayer.addTempSkill('gz_huxi2');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(player.$.gz_huxiGroup==null) player.$.gz_huxiGroup=[];\r\n\t\t\t\t\tplayer.$.gz_huxiGroup.add(target);\r\n\t\t\t\t\tswitch(player.group){\r\n\t\t\t\t\t\tcase 'holo':{\r\n\t\t\t\t\t\t\tif(get.name(event.card)=='sha')\t\tplayer.$.gz_huxi_clear.add(event.card);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 'nijisanji':{\r\n\t\t\t\t\t\t\tif(get.type(event.card)=='equip')\tevent.goto(9);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 8'\r\n\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t'step 9'\r\n\t\t\t\t\tevent.effect = ['equip'];\r\n\t\t\t\t\tif(get.color(event.card)=='red'){\r\n\t\t\t\t\t\tevent.effect.add('lebu');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(get.color(event.card)=='black'){\r\n\t\t\t\t\t\tevent.effect.add('bingliang');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.chooseTarget('###'+get.prompt('gz_huxi')+'###将'+get.translation(event.card)+'置于一名角色的区域内').set('ai',function(target){\r\n\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\tvar effect = _status.event.effect;\r\n\t\t\t\t\t\tvar card = _status.event.card;\r\n\t\t\t\t\t\tvar gain = 0\r\n\t\t\t\t\t\tif(effect.contains('lebu')&&target.canAddJudge('lebu'))\t\t\tgain+=get.effect(target,{name:'lebu'},player,player);\r\n\t\t\t\t\t\tif(effect.contains('bingliang')&&target.canAddJudge('bingliang'))\tgain+=get.effect(target,{name:'bingliang'},player,player);\r\n\t\t\t\t\t\treturn gain*(-get.attitude(player,target)-2)+get.value(card)*(get.attitude(player,target)+2)/4;\r\n\t\t\t\t\t}).set('effect',event.effect).set('card',event.card)\r\n\t\t\t\t\t'step 10'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.target = result.targets[0]\r\n\t\t\t\t\t\tevent.target.classList.add('glow');\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 11'\r\n\t\t\t\t\tvar controls=['判定区','装备区','取消选择'];\r\n\t\t\t\t\tif(event.effect.contains('lebu')&&!event.target.canAddJudge('lebu')||event.effect.contains('bingliang')&&!event.target.canAddJudge('bingliang'))\tcontrols.shift();\r\n\t\t\t\t\tplayer.chooseControl(controls).set('ai',function(){\r\n\t\t\t\t\t\treturn _status.event.index;\r\n\t\t\t\t\t}).set('att',get.attitude(player,event.target));\r\n\t\t\t\t\t'step 12'\r\n\t\t\t\t\tevent.target.classList.remove('glow');\r\n\t\t\t\t\tswitch(result.index){\r\n\t\t\t\t\t\tcase 0:{\r\n\t\t\t\t\t\t\tplayer.$give(event.card,event.target,false);\r\n\t\t\t\t\t\t\tif(event.effect.contains('lebu')&&event.target.canAddJudge('lebu'))\t\tevent.target.addJudge({name:'lebu'},[event.card]);\r\n\t\t\t\t\t\t\telse if(event.effect.contains('bingliang')&&event.target.canAddJudge('bingliang'))\tevent.target.addJudge({name:'bingliang'},[event.card]);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 1:{\r\n\t\t\t\t\t\t\tplayer.$give(event.card,event.target,false);\r\n\t\t\t\t\t\t\tevent.target.equip(event.card);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 2:{\r\n\t\t\t\t\t\t\tevent.goto(9);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\ttargetInRange:function(card,player,target){\r\n\t\t\t\t\t\tif(player.$.gz_huxi_clear&&player.$.gz_huxi_clear.contains(card)) return true;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tgroup:'gz_huxi_clear',\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tclear:{\r\n\t\t\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\t\t\tif(!player.storage[skill])\tplayer.storage[skill] = [];\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfirstDo:true,\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:['phaseAfter']\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.gz_huxi_clear = [];\r\n\t\t\t\t\t\t\tdelete player.$.gz_huxiGroup;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgz_huxi2:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'useCard'\r\n\t\t\t\t},\r\n\t\t\t\tfirstDo:true,\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn get.name(event.card)=='sha';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(trigger.addCount!==false){\r\n\t\t\t\t\t\ttrigger.addCount=false;\r\n\t\t\t\t\t\tvar stat=player.getStat();\r\n\t\t\t\t\t\tif(stat&&stat.card&&stat.card[trigger.card.name]) stat.card[trigger.card.name]--;\r\n\t\t\t\t\t\tif(player.hasSkill('gz_huxi2')){\r\n\t\t\t\t\t\t\tplayer.removeSkill('gz_huxi2');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//夸\r\n\t\t\tgz_kuali:{\r\n\t\t\t\taudio:'kuali',\r\n\t\t\t\ttrigger:{player:'phaseDrawBegin1'},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn game.countPlayer(function(cur){\r\n\t\t\t\t\t\treturn cur.hp%player.hp==0&&cur!=player;\r\n\t\t\t\t\t})>2;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn !event.numFixed&&game.countPlayer(function(cur){\r\n\t\t\t\t\t\treturn cur.hp%player.hp==0&&cur!=player;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar num = game.countPlayer(function(cur){\r\n\t\t\t\t\t\treturn cur.hp%player.hp==0&&cur!=player;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tplayer.draw(num);\r\n\t\t\t\t\ttrigger.changeToZero();\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tmaxHandcard:function(player,num){\r\n\t\t\t\t\t\treturn num+=game.countPlayer(function(cur){\r\n\t\t\t\t\t\t\treturn cur.hp%player.hp==0&&cur!=player;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gz狗狗\r\n\t\t\tgz_guiren:{\r\n\t\t\t\taudio:'guiren',\r\n\t\t\t\tenable:['chooseToUse'],\r\n\t\t\t\tviewAs:{name:'sha'},\r\n\t\t\t\tselectCard:2,\r\n\t\t\t\tcomplexCard:true,\r\n\t\t\t\tposition:'he',\r\n\t\t\t\tfilterCard:function(card){\r\n\t\t\t\t\tif(ui.selected.cards.length) return get.color(card)==get.color(ui.selected.cards[0]);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\tif(ui.selected.cards.length&&get.type(card,'trick')!=get.type(ui.selected.cards[0],'trick')) return 10-get.value(card);\r\n\t\t\t\t\treturn 4-get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tprecontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar cards = event.result.cards.slice(0);\r\n\t\t\t\t\tvar types = [];\r\n\t\t\t\t\tfor(var i=0;i<cards.length;i++){\r\n\t\t\t\t\t\ttypes.add(get.type(cards[i],'trick'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.types = types;\r\n\t\t\t\t\tevent.cards = cards;\r\n\t\t\t\t\tevent.targets = event.result.targets.slice(0);\r\n\t\t\t\t\t// event.getParent().addCount=false;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(event.types.contains('basic')){\r\n\t\t\t\t\t\tvar cards = event.cards;\r\n\t\t\t\t\t\tif(get.color(cards[0])=='red'&&get.color(cards[1])=='red'){\r\n\t\t\t\t\t\t\tevent.result.card.nature='fire';\r\n\t\t\t\t\t\t\tplayer.popup('fire');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(get.color(cards[0])=='black'&&get.color(cards[1])=='black'){\r\n\t\t\t\t\t\t\tevent.result.card.nature='thunder';\r\n\t\t\t\t\t\t\tplayer.popup('thunder');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 'step 2'\r\n\t\t\t\t\t// if(event.types.contains('trick')){\r\n\t\t\t\t\t// \tvar target=event.targets.shift();\r\n\t\t\t\t\t// \tif(target.countGainableCards(player,'he')>0) player.gainPlayerCard(target,'he');\r\n\t\t\t\t\t// \tif(event.targets.length) event.redo();\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t// 'step 3'\r\n\t\t\t\t\t// if(event.types.contains('equip')){\r\n\t\t\t\t\t// \tconsole.log(event.getParent());\r\n\t\t\t\t\t// \tevent.getParent().directHit.addArray(event.result.targets);\r\n\t\t\t\t\t// }\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['gz_guiren_directHit','gz_guiren_gainBy','gz_guiren_redraw'],//\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\t// drawBy:{\r\n\t\t\t\t\t// \ttrigger:{source:'damageSource'},\r\n\t\t\t\t\t// \tforced:\ttrue,\r\n\t\t\t\t\t// \tfilter:function(event,player){\r\n\t\t\t\t\t// \t\tvar evt = event.getParent('useCard');\r\n\t\t\t\t\t// \t\treturn evt&&evt.skill=='guiren'&&['sha'].contains(evt.card.name)&&evt.cards&&evt.cards.filter(function(card){\r\n\t\t\t\t\t// \t\t\treturn get.type(card)=='trick';\r\n\t\t\t\t\t// \t\t}).length;\r\n\t\t\t\t\t// \t},\r\n\t\t\t\t\t// \tlogTarget:'player',\r\n\t\t\t\t\t// \tcontent:function(){\r\n\t\t\t\t\t// \t\tplayer.gainPlayerCard(trigger.player,'he');\r\n\t\t\t\t\t// \t},\r\n\t\t\t\t\t// },\r\n\t\t\t\t\tdirectHit:{\r\n\t\t\t\t\t\ttrigger:{player:'shaBegin'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.skill=='guiren'&&['sha'].contains(event.card.name)&&event.cards&&event.cards.filter(function(card){\r\n\t\t\t\t\t\t\t\treturn get.type(card)=='equip';\r\n\t\t\t\t\t\t\t}).length;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\ttrigger.directHit = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tgainBy:{\r\n\t\t\t\t\t\ttrigger:{source:'damageSource'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(!event.card||!event.getParent()||!event.getParent('sha'))\t\treturn false;\r\n\t\t\t\t\t\t\tvar evt = event.getParent('sha')\r\n\t\t\t\t\t\t\treturn evt.skill=='gz_guiren'&&evt.cards&&evt.cards.filter(function(card){\r\n\t\t\t\t\t\t\t\treturn get.type(card,'trick')=='trick';\r\n\t\t\t\t\t\t\t}).length&&event.player.countCards('he')>0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\ttrigger.player.chooseCard('『鬼刃』：需要交给'+get.translation(player)+'一张牌',true,'he').set('ai',function(card){\r\n\t\t\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\t\t\treturn 7-get.value(card,player);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\ttrigger.player.give(result.cards,player,'giveAuto');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tredraw:{\r\n\t\t\t\t\t\ttrigger:{player:'shaMiss'},\r\n\t\t\t\t\t\tprompt:function(event,player){\r\n\t\t\t\t\t\t\treturn '你可以收回'+get.translation(event.cards)+'并结束此阶段';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.skill=='gz_guiren'&&['sha'].contains(event.card.name)&&event.cards&&event.cards.length;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.gain(trigger.cards);\r\n\t\t\t\t\t\t\tvar evt=_status.event.getParent('phaseUse')||_status.event.getParent('phaseJieshu');\r\n\t\t\t\t\t\t\tif(evt&&['phaseJieshu','phaseUse'].contains(evt.name)){\r\n\t\t\t\t\t\t\t\tevt.skipped=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//gzWTM\r\n\t\t\tdisui:{\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar list=['equip1','equip2','equip3','equip4','equip5'];\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(!player.isDisabled(list[i])) return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list=['equip1','equip2','equip3','equip4','equip5'];\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(player.isDisabled(list[i])) list.splice(i--,1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.chooseControl(list).set('prompt','请选择废除一个装备栏').ai=function(){\r\n\t\t\t\t\t\tif(list.contains('equip1')&&player.isEmpty('equip1')&&player.countCards('h',function(card){\r\n\t\t\t\t\t\t\treturn card.name=='sha'&&player.getUseValue(card)>0\r\n\t\t\t\t\t\t})) return 'equip1';\r\n\t\t\t\t\t\tif(list.contains('equip3')&&player.isEmpty('equip3')) return 'equip3';\r\n\t\t\t\t\t\tif(list.contains('equip4')&&player.isEmpty('equip4')) return 'equip4';\r\n\t\t\t\t\t\tif(list.contains('equip5')&&player.isEmpty('equip5')) return 'equip5';\r\n\t\t\t\t\t\tif(list.contains('equip2')&&player.isEmpty('equip2')) return 'equip2';\r\n\t\t\t\t\t\treturn list.randomGet();\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.pos = result.control;\r\n\t\t\t\t\tvar cards = player.getCards('e',function(card){\r\n\t\t\t\t\t\tvar subtype=get.subtype(card);\r\n\t\t\t\t\t\tif(subtype==event.pos) return true;\r\n\t\t\t\t\t\tif(subtype=='equip6'&&['equip3','equip4'].contains(event.pos)) return true;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(cards.length)\tplayer.addTempSkill('disui_hideC');\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tplayer.disableEquip(event.pos);\r\n\t\t\t\t\tplayer.addMark('disui_mark',1);\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['disui_disableEquip','disui_mark'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tmark:{\r\n\t\t\t\t\t\tmod:{\r\n\t\t\t\t\t\t\tattackFrom:function(from,to,distance){\r\n\t\t\t\t\t\t\t\treturn distance-from.countMark('disui_mark');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmarktext:'🐏',\r\n\t\t\t\t\t\tintro:{\r\n\t\t\t\t\t\t\tname:'抵碎',\r\n\t\t\t\t\t\t\tcontent:'攻击范围+$',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdisableEquip:{\r\n\t\t\t\t\t\ttrigger:{player:'useCard2'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(!event.targets||event.targets.length!=1||!player.countMark('disui_mark'))\treturn false;\r\n\t\t\t\t\t\t\tvar list=['equip1','equip2','equip3','equip4','equip5'];\r\n\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\tif(player.isDisabled(list[i])&&!event.targets[0].isDisabled(list[i])) return true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\t\t\treturn get.attitude(player,event.targets[0])<0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tevent.target = trigger.targets[0];\r\n\t\t\t\t\t\t\tvar list=['equip1','equip2','equip3','equip4','equip5'];\r\n\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\tif(!player.isDisabled(list[i])||event.target.isDisabled(list[i])) list.splice(i--,1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.chooseControl(list).set('prompt','选择废除'+get.translation(event.target)+'一个装备栏').ai=function(){\r\n\t\t\t\t\t\t\t\tvar target=_status.event.getParent().target;\r\n\t\t\t\t\t\t\t\tif(list.contains('equip6')&&target.getEquip('equip3')&&target.getEquip('equip4')) return 'equip6';\r\n\t\t\t\t\t\t\t\tif(list.contains('equip2')&&target.getEquip(2)&&get.value(target.getEquip(2),target)>0) return 'equip2';\r\n\t\t\t\t\t\t\t\tif(list.contains('equip5')&&target.getEquip(5)&&get.value(target.getEquip(5),target)>0) return 'equip5';\r\n\t\t\t\t\t\t\t\treturn list.randomGet();\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tevent.target.disableEquip(result.control);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\thideC:{\r\n\t\t\t\t\t\ttrigger:{player:'useCard2'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.targets.filter(function(target){\r\n\t\t\t\t\t\t\t\treturn !target.isUnseen();\r\n\t\t\t\t\t\t\t}).length>0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tlogTarget:'targets',\r\n\t\t\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\t\t\treturn event.targets.filter(function(target){\r\n\t\t\t\t\t\t\t\treturn !target.isUnseen()&&get.attitude(player,target)<=1;\r\n\t\t\t\t\t\t\t}).length>0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tevent.targets = trigger.targets.filter(function(target){\r\n\t\t\t\t\t\t\t\treturn !target.isUnseen();\r\n\t\t\t\t\t\t\t}).slice(0);\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tlist = ['是否暗置'+get.translation(event.targets)+'之中的一张武将牌？'];\r\n\t\t\t\t\t\t\tevent.map = {}\r\n\t\t\t\t\t\t\tfor(var i=0;i<event.targets.length;i++){\r\n\t\t\t\t\t\t\t\tvar players = [event.targets[i].name1,event.targets[i].name2];\r\n\t\t\t\t\t\t\t\tlist.push('<div class=\"text center\">'+get.translation(event.targets[i])+'的武将牌</div>');\r\n\t\t\t\t\t\t\t\tlist.push([players,'character']);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.chooseButton(list);\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tfor(i of event.targets){\r\n\t\t\t\t\t\t\t\t\tif([i.name1,i.name2].contains(result.links[0]))\t i.hideCharacter(i.name1==result.links[0]?0:1);;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdengyan:{\r\n\t\t\t\tlocked:true,\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(player.name1=='gz_TsunomakiWatame') return player.isUnseen(0);\r\n\t\t\t\t\treturn player.isUnseen(1);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(player.name1=='gz_TsunomakiWatame') player.showCharacter(0);\r\n\t\t\t\t\telse player.showCharacter(1);\r\n\t\t\t\t},\r\n\t\t\t\tglobal:'dengyan_mingzhi',\r\n\t\t\t\tgroup:'dengyan_drawBy',\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tdrawBy:{\r\n\t\t\t\t\t\ttrigger:{global:'showCharacterAfter'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tusable:1,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.player!=player;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tif(trigger.name=='showCharacter'){\r\n\t\t\t\t\t\t\t\tplayer.draw(1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdengyan_mingzhi:{\r\n\t\t\t\tai:{\r\n\t\t\t\t\tnomingzhi:true,\r\n\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\tif(_status.currentPhase&&_status.currentPhase!=player&&_status.currentPhase.hasSkill('dengyan')){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//gz兔头\r\n\t\t\tgz_bingdielei:{\r\n\t\t\t\taudio:'bingdielei',\r\n\t\t\t\ttrigger:{global:'phaseEnd'},\r\n\t\t\t\tround:1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.getHistory('damage').length||player.getHistory('sourceDamage').length;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.insertPhase();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gz海牛\r\n\t\t\tgz_kuangbaoshuangren:{\r\n\t\t\t\tlocked:true,\r\n\t\t\t\taudio:'kuangbaoshuangren',\r\n\t\t\t\tgroup: ['gz_kuangbaoshuangren_red', 'gz_kuangbaoshuangren_black'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tred: {\r\n\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\ttargetInRange:function(card,player){\r\n\t\t\t\t\t\t\t\tif(_status.currentPhase==player && get.name(card)=='sha' && get.color(card) == 'red') return true;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcardUsable:function(card,player,num){\r\n\t\t\t\t\t\t\t\tif(card.name=='sha' && get.color(card) == 'red') return Infinity;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tblack: {\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tplayer: 'useCard2',\r\n\t\t\t\t\t\t\t// player: 'useCardToPlayered'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tfilter:function(event,player) {\r\n\t\t\t\t\t\t\t// if (event.getParent().triggeredTargets3.length > 1) return false;\r\n\t\t\t\t\t\t\tif (!event.card || !(event.card.name == 'sha') \r\n\t\t\t\t\t\t\t\t|| !(get.color(event.card) == 'black')) {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn game.hasPlayer(function(cur) {\r\n\t\t\t\t\t\t\t\treturn lib.filter.targetEnabled2(event.card, player, cur)\r\n\t\t\t\t\t\t\t\t\t&& player.inRange(cur)\r\n\t\t\t\t\t\t\t\t\t&& !event.targets.contains(cur)\r\n\t\t\t\t\t\t\t\t\t&& player.canUse(event.card,cur);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tplayer.$.blackTargets=trigger.targets;\r\n\t\t\t\t\t\t\tplayer.$.card=trigger.card;\r\n\t\t\t\t\t\t\tplayer.chooseTarget(true, '额外指定一名'+get.translation(trigger.card)+'的目标',function(card,player,target){\r\n\t\t\t\t\t\t\t\tif (player.$.blackTargets.contains(target)) return false;\r\n\t\t\t\t\t\t\t\treturn lib.filter.targetEnabled2(player.$.card, player, target)\r\n\t\t\t\t\t\t\t\t\t&& player.inRange(target);\r\n\t\t\t\t\t\t\t}).set('targets',trigger.targets).set('card',trigger.card).set('ai',function(target){\r\n\t\t\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\t\t\treturn get.effect(target,_status.event.card,player,player);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tdelete player.$.card;\r\n\t\t\t\t\t\t\tdelete player.$.blackTargets;\r\n\t\t\t\t\t\t\tif(result.bool && result.targets.length){\r\n\t\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\t\tplayer.logSkill('gz_kuangbaoshuangren', result.targets);\r\n\t\t\t\t\t\t\t\ttrigger.targets.unshift(result.targets[0]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//gz修女\r\n\t\t\tgz_zhenxin:{\r\n\t\t\t\tlocked:true,\r\n\t\t\t\ttrigger:{player: 'damageBefore' },\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpriority:24,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(!event.source)\t\treturn false;\r\n\t\t\t\t\treturn event.source.isUnseen(2);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num--;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gz熊猫\r\n\t\t\tgz_jiaku:{\r\n\t\t\t\ttrigger:{player:['chooseToCompareAfter','compareMultipleAfter'],target:['chooseToCompareAfter','compareMultipleAfter']},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn !event.iwhile&&(player==event.player&&event.num1>event.num2\r\n\t\t\t\t\t\t||player!=event.player&&event.num2>event.num1\r\n\t\t\t\t\t\t||player.countCards('he'));\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(player==trigger.player&&trigger.num1>trigger.num2||player!=trigger.player&&trigger.num2>trigger.num1){\r\n\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.chooseCard('###『生笹』###重铸一张牌',true,'he').set('ai',function(card){\r\n\t\t\t\t\t\t\treturn 7-get.value(card);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool&&result.cards){\r\n\t\t\t\t\t\tplayer.lose(result.cards, ui.discardPile).set('visible', true);\r\n\t\t\t\t\t\tplayer.$throw(result.cards);\r\n\t\t\t\t\t\tgame.log(player, '将', result.cards, '置入了弃牌堆');\r\n\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gz小明\r\n\t\t\tgz_duanli:{\r\n\t\t\t\taudio:'shiyilijia',\r\n\t\t\t\tgroup: ['gz_duanli_damage','gz_duanli_draw'],\r\n\t\t\t\tenable: 'phaseUse',\r\n\t\t\t\tusable: 1,\r\n\t\t\t\tinit: function(player) {\r\n\t\t\t\t\tif(player.$.gz_duanli==undefined) {\r\n\t\t\t\t\t\tplayer.$.gz_duanli = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function(event, player) {\r\n\t\t\t\t\treturn player.countDiscardableCards(player,'h');\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.$.gz_duanli += player.countDiscardableCards(player,'h');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar cards=player.getDiscardableCards(player,'h');\r\n\t\t\t\t\tplayer.discard(cards);\r\n\t\t\t\t},\r\n\t\t\t\tai:{order:2,result:{player:1}},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\taiOrder:function(player,card,num){\r\n\t\t\t\t\t\tif(typeof card=='object'&&player==_status.currentPhase&&get.name(card)=='tao'){\r\n\t\t\t\t\t\t\tvar damage = (player.maxHp-player.hp)*2;\r\n\t\t\t\t\t\t\treturn num+damage;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tdamage:{\r\n\t\t\t\t\t\ttrigger:{player:'damagEnd'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.countDiscardableCards(player,'h');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\t\t\treturn (player.hp>=2||_status.currentPhase.isFriendOf(player))&&player.countDiscardableCards(player,'h',function(i){\r\n\t\t\t\t\t\t\t\treturn 6-get.value(i,player,'raw');\r\n\t\t\t\t\t\t\t})>=(player.countDiscardableCards(player,'h')/2);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tplayer.$.gz_duanli += player.countDiscardableCards(player,'h');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tvar cards=player.getDiscardableCards(player,'h');\r\n\t\t\t\t\t\t\tplayer.discard(cards);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdraw: {\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tplayer: 'phaseEnd'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.$.gz_duanli;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tplayer.draw(player.$.gz_duanli);\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tplayer.$.gz_duanli = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgz_qingyi:{\r\n\t\t\t\taudio:'seqinghuashen',\r\n\t\t\t\ttrigger: {global:'useCardAfter'},\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.card.name=='tao'\r\n\t\t\t\t\t\t&&event.player!=player\r\n\t\t\t\t\t\t&&get.itemtype(event.cards)=='cards'\r\n\t\t\t\t\t\t&&get.position(event.cards[0],true)=='o';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\ttrigger.player.draw(player);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar target = trigger.player;\r\n\t\t\t\t\tif (target.countGainableCards(player, 'he')) {\r\n\t\t\t\t\t\tplayer.gainPlayerCard('he',target,true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//reYuNi\r\n\t\t\tgz_shengcai:{\r\n\t\t\t\taudio:'re_shengcai',\r\n\t\t\t\ttrigger:{player:['useCardAfter','damageAfter']},\r\n\t\t\t\tpriority:123,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countDiscardableCards(player,'he');\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseToDiscard(get.prompt2('gz_shengcai'),'he').set('ai',function(card){\r\n\t\t\t\t\t\tvar list=[get.color(card)];\r\n\t\t\t\t\t\tvar stats = 0;\r\n\t\t\t\t\t\tgame.getGlobalHistory('cardMove',function(evt){\r\n\t\t\t\t\t\t\tif(evt==event||(evt.name!='lose'&&evt.name!='cardsDiscard')) return false;\r\n\t\t\t\t\t\t\tif(evt.name=='lose'&&evt.position!=ui.discardPile) return false;\r\n\t\t\t\t\t\t\tfor(var i=0;i<evt.cards.length;i++){\r\n\t\t\t\t\t\t\t\tvar card0=evt.cards[i];\r\n\t\t\t\t\t\t\t\tlist.remove(get.color(card0));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tgame.hasPlayer(function(cur){\r\n\t\t\t\t\t\t\tcur.getHistory('useCard',function(evt){\r\n\t\t\t\t\t\t\t\tif(get.color(evt.card,cur)!=get.color(card,player)){\r\n\t\t\t\t\t\t\t\t\tstats ++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(list.length)\treturn stats*2+2-get.value(card);\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool&&result.cards[0]){\r\n\t\t\t\t\t\tevent.card = result.cards[0];\r\n\t\t\t\t\t\tvar list=[get.color(event.card)];\r\n\t\t\t\t\t\tvar stats = 0;\r\n\t\t\t\t\t\tgame.getGlobalHistory('cardMove',function(evt){\r\n\t\t\t\t\t\t\tif(evt==event||(evt.name!='lose'&&evt.name!='cardsDiscard')) return false;\r\n\t\t\t\t\t\t\tif(evt.name=='lose'&&evt.position!=ui.discardPile) return false;\r\n\t\t\t\t\t\t\tfor(var i=0;i<evt.cards.length;i++){\r\n\t\t\t\t\t\t\t\tvar card=evt.cards[i];\r\n\t\t\t\t\t\t\t\tif(event.card!=card) list.remove(get.color(card));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tgame.hasPlayer(function(cur){\r\n\t\t\t\t\t\t\tcur.getHistory('useCard',function(evt){\r\n\t\t\t\t\t\t\t\tif(get.color(evt.card,cur)!=get.color(event.card,player)){\r\n\t\t\t\t\t\t\t\t\tstats ++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\t\tplayer.logSkill('gz_shengcai');\r\n\t\t\t\t\t\t\tplayer.draw(stats);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gz冷鸟\r\n\t\t\tgz_niaoji:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\ttrigger:{source:'damageEnd',player:'damageEnd'},\r\n\t\t\t\tpriority:99,\r\n\t\t\t\tlastDo:true,\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\tif(event.source&&event.source == player)\treturn get.attitude(player,event.player)<1;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tprompt:function(event,player){\r\n\t\t\t\t\tif(event.source&&event.source == player)\treturn '对'+get.translation(event.player)+'造成伤害，'+get.prompt('gz_niaoji');\r\n\t\t\t\t\treturn '受到来自'+get.translation(event.source)+'的伤害，'+get.prompt('gz_niaoji');\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.source;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar func=function(result){\r\n\t\t\t\t\t\tif(get.suit(result)=='spade') return 2;\r\n\t\t\t\t\t\tif(get.suit(result)=='heart') return 2;\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.target = (player==trigger.source)?trigger.player:trigger.source;\r\n\t\t\t\t\tif(!event.target||!event.target.isIn()||event.target.countCards('he')<=0){\r\n\t\t\t\t\t\tfunc=function(result){\r\n\t\t\t\t\t\t\tif(get.suit(result)=='spade') return 0;\r\n\t\t\t\t\t\t\tif(get.suit(result)=='heart') return 2;\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.judge(func);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.num = (player.getDamagedHp())||1;\r\n\t\t\t\t\t\tif(result.suit=='spade'){\r\n\t\t\t\t\t\t\tif([player.name,player.name1].contains('Yousa')) game.playAudio('skill','niaoji_spade'+Math.ceil(3*Math.random()));\r\n\t\t\t\t\t\t\tplayer.discardPlayerCard('###『鸟肌』###弃置'+get.translation(event.target)+get.cnNumber(event.num)+'张牌',event.target,event.num,true,'he');\r\n\t\t\t\t\t\t}else if(result.suit=='heart'){\r\n\t\t\t\t\t\t\tif([player.name,player.name1].contains('Yousa')) game.playAudio('skill','niaoji_heart'+Math.ceil(3*Math.random()));\r\n\t\t\t\t\t\t\tplayer.draw(event.num);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gz希桃\r\n\t\t\tgz_xuyan:{\r\n\t\t\t\ttrigger:{player:'phaseJieshuBegin'},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseTarget(1,'选择观察目标',function(card,player,target){\r\n\t\t\t\t\t\treturn player!=target;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tresult.targets[0].addSkill('gz_xuyan_mark');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['gz_xuyan_phaseStart','gz_xuyan_damage','gz_xuyan_die'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tmark:{\r\n\t\t\t\t\t\tmark:true,\r\n\t\t\t\t\t\tintro:{\r\n\t\t\t\t\t\t\tcontent:'造成伤害，杀死玩家与死亡都被列入了观察项目'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tphaseStart:{\r\n\t\t\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.hasSkill('gz_xuyan_damaged')||player.hasSkill('gz_xuyan_dead')||game.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(current.hasSkill('gz_xuyan_mark')){\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}).length>0\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tgame.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(current.hasSkill('gz_xuyan_mark')){\r\n\t\t\t\t\t\t\t\t\tcurrent.removeSkill('gz_xuyan_mark');\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(!player.hasSkill('gz_xuyan_damaged')&&!player.hasSkill('gz_xuyan_dead')){\r\n\t\t\t\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t\t\t\t\tgame.filterPlayer(function(cur){\r\n\t\t\t\t\t\t\t\t\tif(cur.hasSkill('gz_xuyan_mark')){\r\n\t\t\t\t\t\t\t\t\t\tcur.loseHp();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(player.hasSkill('gz_xuyan_damaged')){\r\n\t\t\t\t\t\t\t\tplayer.removeSkill('gz_xuyan_damaged');\r\n\t\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tif(player.hasSkill('gz_xuyan_dead')){\r\n\t\t\t\t\t\t\t\tplayer.removeSkill('gz_xuyan_dead');\r\n\t\t\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdamage:{\r\n\t\t\t\t\t\ttrigger:{global:'damageAfter'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(event.source){\r\n\t\t\t\t\t\t\t\treturn event.source.hasSkill('gz_xuyan_mark');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\treturn event.player.hasSkill('gz_xuyan_mark');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.addSkill('gz_xuyan_damaged');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdie:{\r\n\t\t\t\t\t\ttrigger:{global:'dieBefore'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(event.source){\r\n\t\t\t\t\t\t\t\treturn event.source.hasSkill('gz_xuyan_mark')||event.player.hasSkill('gz_xuyan_mark');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\treturn event.player.hasSkill('gz_xuyan_mark');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.addSkill('gz_xuyan_dead');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdamaged:{\r\n\t\t\t\t\t\tmark:true,\r\n\t\t\t\t\t\tmarktext:'伤',\r\n\t\t\t\t\t\tintro:{\r\n\t\t\t\t\t\t\tcontent:'观察目标造成或受到了伤害'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdead:{\r\n\t\t\t\t\t\tmark:true,\r\n\t\t\t\t\t\tmarktext:'亡',\r\n\t\t\t\t\t\tintro:{\r\n\t\t\t\t\t\t\tcontent:'观察目标死亡或杀死过角色'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//gz猫宫\r\n\t\t\tgz_yingdan:{\r\n\t\t\t\thiddenCard:function(player,name){\r\n\t\t\t\t\tif(['wuxie','shan'].contains(name)&&player.countCards('h',{name:'sha'})) return true;\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\taiValue:function(player,card,num){\r\n\t\t\t\t\t\tif(player.countCards('h',{name:'sha'})){\r\n\t\t\t\t\t\t\tif(card.name=='shan'||card.name=='tao') return num/10;\r\n\t\t\t\t\t\t\tif(card.name=='sha') return num*3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['gz_yingdan_shan','gz_yingdan_wuxie'],//,'gz_yingdan_directHit'\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tsha:{},\r\n\t\t\t\t\tshan:{\r\n\t\t\t\t\t\taudio:'songzang',\r\n\t\t\t\t\t\t//技能发动时机\r\n\t\t\t\t\t\tenable:['chooseToUse'],\r\n\t\t\t\t\t\tprompt:'使用一张【杀】，视为使用了一张【闪】',\r\n\t\t\t\t\t\t//动态的viewAs\r\n\t\t\t\t\t\tviewAs:{name:'shan'},\r\n\t\t\t\t\t\t//AI选牌思路\r\n\t\t\t\t\t\tcheck:function(card){\r\n\t\t\t\t\t\t\treturn get.order(card);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilterCard:function(card,player,event){\r\n\t\t\t\t\t\t\treturn get.name(card,player)=='sha';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\t\t\tif(!player.hasUseTarget({name:'sha',isCard:true})||!player.countCards('h',{name:'sha'})) return false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprecontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tevent.card = event.result.cards[0];\r\n\t\t\t\t\t\t\tplayer.$throw(event.cards);\r\n\t\t\t\t\t\t\tevent.result.card.cards=[];\r\n\t\t\t\t\t\t\tevent.result.cards=[];\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tplayer.chooseUseTarget(event.card,true,false,event.cards);\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tif(!player.getHistory('sourceDamage',function(evt){\r\n\t\t\t\t\t\t\t\treturn event.card==evt.card;\r\n\t\t\t\t\t\t\t}).length) player.draw();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\trespondShan:true,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\twuxie:{\r\n\t\t\t\t\t\taudio:'songzang',\r\n\t\t\t\t\t\t//技能发动时机\r\n\t\t\t\t\t\tenable:['chooseToUse'],\r\n\t\t\t\t\t\tprompt:'使用一张【杀】，视为使用了一张【无懈可击】',\r\n\t\t\t\t\t\t//动态的viewAs\r\n\t\t\t\t\t\tviewAs:{name:'wuxie'},\r\n\t\t\t\t\t\t//AI选牌思路\r\n\t\t\t\t\t\tcheck:function(card){\r\n\t\t\t\t\t\t\treturn get.order(card);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilterCard:function(card,player,event){\r\n\t\t\t\t\t\t\treturn get.name(card,player)=='sha';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\t\t\tif(!player.hasUseTarget({name:'sha',isCard:true})||!player.countCards('h',{name:'sha'})) return false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprecontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tevent.card = event.result.cards[0];\r\n\t\t\t\t\t\t\tplayer.$throw(event.cards);\r\n\t\t\t\t\t\t\tevent.result.card.cards=[];\r\n\t\t\t\t\t\t\tevent.result.cards=[];\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tplayer.chooseUseTarget(event.card,true,false,event.cards);\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tif(!player.getHistory('sourceDamage',function(evt){\r\n\t\t\t\t\t\t\t\treturn event.card==evt.card;\r\n\t\t\t\t\t\t\t}).length) player.draw();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gz小白\r\n\t\t\tliexing:{\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer:'useCard2'\r\n\t\t\t\t},\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn !player.hasSkill('liexing_used')&&get.number(event.card)&&event.targets&&event.targets.length;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\tvar effect=0;\r\n\t\t\t\t\tif(event.targets&&event.targets.length){\r\n\t\t\t\t\t\tfor(var i=0;i<event.targets.length;i++){\r\n\t\t\t\t\t\t\teffect+=get.effect(event.targets[i],event.card,event.player,player);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn get.number(event.card)+effect<7;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt2('liexing'),function(card,player,target){\r\n\t\t\t\t\t\treturn !_status.event.targets.contains(target) && target.countDiscardableCards('he',target);\r\n\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\treturn 2-get.attitude(_status.event.player,target);\r\n\t\t\t\t\t}).set('targets',trigger.targets);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool&&result.targets[0]){\r\n\t\t\t\t\t\tplayer.addTempSkill('liexing_used');\r\n\t\t\t\t\t\tvar num = get.number(trigger.card);\r\n\t\t\t\t\t\tevent.target = result.targets[0];\r\n\t\t\t\t\t\tevent.target.chooseToDiscard(true, 'he','列星：弃置一张牌').set('ai',function(card){\r\n\t\t\t\t\t\t\tvar source = _status.event.source;\r\n\t\t\t\t\t\t\tvar num = _status.event.num;\r\n\t\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\t\tvar effect = 6-get.value(card);\r\n\t\t\t\t\t\t\tif(get.number(card)+num==12){\r\n\t\t\t\t\t\t\t\teffect+=get.recoverEffect(player,source,player);\r\n\t\t\t\t\t\t\t\teffect+=get.recoverEffect(source,source,player);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(get.number(card)+num>=12){\r\n\t\t\t\t\t\t\t\teffect+=get.effect(player,{name:'shunshou'},source,player);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).set('source',player).set('num',num);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.bool&&result.cards.length){\r\n\t\t\t\t\t\tevent.card = result.cards[0];\r\n\t\t\t\t\t\tvar num = get.number(event.card) + get.number(trigger.card);\r\n\t\t\t\t\t\tif(num==12){\r\n\t\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t\t\tevent.target.recover();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(num>=12){\r\n\t\t\t\t\t\t\tplayer.gain(result.cards,'giveAuto');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tused:{},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//gz马叔\r\n\t\t\tgz_zuodun:{\r\n\t\t\t\taudio:'zuodun',\r\n\t\t\t\ttrigger:{global:'damageBegin3'},\r\n\t\t\t\tusable:1,\r\n\t\t\t\tpriority:1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player!=player&&event.num;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn (player.hp-event.player.hp)>0&&get.attitude(player,event.player)>(6-player.hp);\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.player = player;\r\n\t\t\t\t\tif(!player.hasSkill('liexing')){\r\n\t\t\t\t\t\tplayer.addTempSkill('liexing',{player:'phaseAfter'});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tderivation:'liexing',\r\n\t\t\t},\r\n\t\t\tgz_baidao:{\r\n\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\tif(!player.storage[skill])\tplayer.storage[skill] = [];\r\n\t\t\t\t},\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('h',{number:[1,13]})>0;\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard:function(card,player){\r\n\t\t\t\t\tif(player.getStorage('gz_baidao').contains(card))\treturn false;\r\n\t\t\t\t\treturn [1,13].contains(get.number(card));\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\tif(get.number(ui.selected.cards)!=13)\treturn 8-get.value(card);\r\n\t\t\t\t\treturn 8-get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tselectCard:1,\r\n\t\t\t\tcomplexTarget:true,\r\n\t\t\t\tselectTarget:function(){\r\n\t\t\t\t\tif(!ui.selected.cards.length||get.number(ui.selected.cards[0])!=13) return -1;\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t},\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\tif(!ui.selected.cards.length||get.number(ui.selected.cards[0])!=13) return false;\r\n\t\t\t\t\treturn target!=player;\r\n\t\t\t\t},\r\n\t\t\t\tposition:'h',\r\n\t\t\t\tdiscard:false,\r\n\t\t\t\tlose:false,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(get.number(cards[0])==13){\r\n\t\t\t\t\t\tplayer.give(cards,targets[0]);\r\n\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tplayer.showCards(cards);\r\n\t\t\t\t\t\tif(!player.$.gz_baidao)\tplayer.$.gz_baidao = [];\r\n\t\t\t\t\t\tplayer.$.gz_baidao.addArray(cards);\r\n\t\t\t\t\t\tplayer.$.gz_baidao_times++;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:10,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player,target){\r\n\t\t\t\t\t\t\tif(player.countCards('h',function(card){\r\n\t\t\t\t\t\t\t\treturn get.number(card)==13;\r\n\t\t\t\t\t\t\t}))\treturn get.recoverEffect(player,player,player);\r\n\t\t\t\t\t\t\telse return 0.2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['gz_baidao_times','gz_baidao_clear'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\ttimes:{\r\n\t\t\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\t\t\tif(!player.storage[skill])\tplayer.storage[skill]=0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttrigger:{player:'useCard2'},\r\n\t\t\t\t\t\tfirstDo:true,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tconsole.log(player.$.gz_baidao_times)\r\n\t\t\t\t\t\t\treturn player.$.gz_baidao_times>0&&player.hasSkill('liexing_used');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.gz_baidao_times--;\r\n\t\t\t\t\t\t\tplayer.removeSkill('liexing_used');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tclear:{\r\n\t\t\t\t\t\ttrigger:{player:'phaseAfter'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.$.gz_baidao;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.gz_baidao.length = 0;\r\n\t\t\t\t\t\t\tplayer.$.gz_baidao_times = 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//gz狗妈\r\n\t\t\tzhanni:{\r\n\t\t\t\t// audio:false,\r\n\t\t\t\t// trigger: {\r\n\t\t\t\t// \tplayer:'useCard2'\r\n\t\t\t\t// },\r\n\t\t\t\t// filter:function(event,player){\r\n\t\t\t\t// \treturn event.targets.length;\r\n\t\t\t\t// },\r\n\t\t\t\t// check:function(event, player){\r\n\t\t\t\t// \treturn true;\r\n\t\t\t\t// },\r\n\t\t\t\tdirect:false,\r\n\t\t\t\tinherit:'DDzhanshou',\r\n\t\t\t},\r\n\t\t\t//gz373\r\n\t\t\tgz_longdan:{\r\n\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\tif(!player.storage[skill]) player.storage[skill] = true;\r\n\t\t\t\t},\r\n\t\t\t\thiddenCard:function(player,name){\r\n\t\t\t\t\tif(player.$.gz_longdan==true&&name=='sha'&&lib.inpile.contains(name))\treturn player.countCards('h',{type:'basic'})>player.countCards('h',{name:'sha'});\r\n\t\t\t\t\tif(player.$.gz_longdan==false&&get.type(name)=='basic'&&lib.inpile.contains(name)) return player.countCards('h',{name:'sha'});\r\n\t\t\t\t},\r\n\t\t\t\tenable:['chooseToUse','chooseToRespond'],\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.$.gz_longdan==true&&player.countCards('h',{type:'basic'})>player.countCards('h',{name:'sha'})||player.$.gz_longdan==false&&player.countCards('h',{name:'sha'});\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tdialog:function(event,player){\r\n\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\tfor(var i=0;i<lib.inpile.length;i++){\r\n\t\t\t\t\t\t\tvar name=lib.inpile[i];\r\n\t\t\t\t\t\t\tif(player.$.gz_longdan==true&&name=='sha'){\r\n\t\t\t\t\t\t\t\tlist.push(['基本','','sha']);\r\n\t\t\t\t\t\t\t\tlist.push(['基本','','sha','fire']);\r\n\t\t\t\t\t\t\t\tlist.push(['基本','','sha','thunder']);\r\n\t\t\t\t\t\t\t\tlist.push(['基本','','sha','ice']);\r\n\t\t\t\t\t\t\t\tlist.push(['基本','','sha','ocean']);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(player.$.gz_longdan==false&&get.type(name)=='basic'&&name!='sha') list.push(['基本','',name]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn ui.create.dialog(get.translation('gz_longdan'),[list,'vcard']);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter:function(button,player){\r\n\t\t\t\t\t\treturn _status.event.getParent().filterCard({name:button.link[2]},player,_status.event.getParent());\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck:function(button){\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tif(player.countCards('h',button.link[2])>0) return 0;\r\n\t\t\t\t\t\tvar effect=player.getUseValue(button.link[2]);\r\n\t\t\t\t\t\tif(effect>0) return effect;\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(links,player){\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tfilterCard:function(card,player){\r\n\t\t\t\t\t\t\t\tif(player.$.gz_longdan==false) return get.name(card)=='sha';\r\n\t\t\t\t\t\t\t\treturn get.type(card)=='basic'&&get.name(card)!='sha';\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tselectCard:1,\r\n\t\t\t\t\t\t\tpopname:true,\r\n\t\t\t\t\t\t\tcheck:function(card){\r\n\t\t\t\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tposition:'he',\r\n\t\t\t\t\t\t\tviewAs:{name:links[0][2],nature:links[0][3],isCard:true},\r\n\t\t\t\t\t\t\tonrespond:function(){return this.onuse.apply(this,arguments)},\r\n\t\t\t\t\t\t\tonuse:function(result,player){\r\n\t\t\t\t\t\t\t\tplayer.$.gz_longdan = !player.$.gz_longdan;\r\n\t\t\t\t\t\t\t\tplayer.updateMarks('gz_longdan')\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tprompt:function(links,player){\r\n\t\t\t\t\t\treturn '将一张基本牌当作'+(get.translation(links[0][3])||'')+get.translation(links[0][2])+'使用或打出';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\ttargetInRange:function(card,player,target){\r\n\t\t\t\t\t\tif(_status.event.skill=='gz_longdan_backup' && get.number(card)>7) return true;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcardUsable:function(card,player,num){\r\n\t\t\t\t\t\tif(_status.event.skill=='gz_longdan_backup' && get.number(card)>7) return Infinity;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tuseSha:1,\r\n\t\t\t\t\tskillTagFilter:function(player,tag){\r\n\t\t\t\t\t\tswitch(tag){\r\n\t\t\t\t\t\t\tcase 'respondSha':{\r\n\t\t\t\t\t\t\t\tif(player.$.gz_longdan!=true||!player.countCards('h',{type:'basic'})>player.countCards('h',{name:'sha'})) return false;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'respondShan':{\r\n\t\t\t\t\t\t\t\tif(player.$.gz_longdan!=false||!player.countCards('h',{name:'sha'})) return false;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase 'save':{\r\n\t\t\t\t\t\t\t\tif(player.$.gz_longdan!=false||!player.countCards('h',{name:'sha'})) return false;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{player:1},\r\n\t\t\t\t\trespondSha:true,\r\n\t\t\t\t\trespondShan:true,\r\n\t\t\t\t\tsave:true,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gz帕里\r\n\t\t\tgz_tiantang:{\r\n\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\tif(!player.storage[skill])\tplayer.storage[skill] = 0;\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{global: 'phaseBegin'},\r\n\t\t\t\tpriority:81,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(player.countCards('he')<(player.$.gz_tiantang||1))\treturn false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\tif(event.player.needsToDiscard()&&!event.player.hasJudge('lebu')&&get.attitude(player,event.player)<-0.5)\treturn true;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar num = player.$.gz_tiantang||1;\r\n\t\t\t\t\tplayer.chooseToDiscard(num,'he').set('ai',function(card){\r\n\t\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tif(!player.$.gz_tiantang)\tplayer.$.gz_tiantang = 1;\r\n\t\t\t\t\t\telse\tplayer.$.gz_tiantang++;\r\n\t\t\t\t\t\tevent.videoId = lib.status.videoId++;\r\n\t\t\t\t\t\tvar suitlist = [\r\n\t\t\t\t\t\t\t['heart', '', 'heart', 'heart'],\r\n\t\t\t\t\t\t\t['diamond', '', 'diamond', 'diamond'],\r\n\t\t\t\t\t\t\t['club', '', 'club', 'club'],\r\n\t\t\t\t\t\t\t['spade', '', 'spade', 'spade']\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t\tgame.broadcastAll(function(id, suitlist){\r\n\t\t\t\t\t\t\tvar dialog=ui.create.dialog('『天扉』声明');\r\n\t\t\t\t\t\t\tdialog.addText('花色');\r\n\t\t\t\t\t\t\tdialog.add([suitlist, 'vcard']);\r\n\t\t\t\t\t\t\tdialog.videoId = id;\r\n\t\t\t\t\t\t}, event.videoId, suitlist);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\tevent.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar next = player.chooseButton(1 ,true);\r\n\t\t\t\t\tnext.set('dialog',event.videoId);\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tgame.broadcastAll('closeDialog', event.videoId);\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.gz_tiantang = result.links[0][2];\r\n\t\t\t\t\t\tgame.log('帕里声明了'+get.translation(event.gz_tiantang));\r\n\t\t\t\t\t\tvar target = trigger.player;\r\n\t\t\t\t\t\tvar list= [['观看并弃置声明花色牌'],['摸两张牌']];;\r\n\t\t\t\t\t\tif(!target.countDiscardableCards(player,'he'))\tlist.shift();\r\n\t\t\t\t\t\tevent.videoId = lib.status.videoId++;\r\n\t\t\t\t\t\tgame.broadcastAll(function(id, choicelist){\r\n\t\t\t\t\t\t\tvar dialog=ui.create.dialog('选择一项');\r\n\t\t\t\t\t\t\tchoicelist.forEach(element=>{\r\n\t\t\t\t\t\t\t\tdialog.add([element,'vcard']);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tdialog.videoId = id;\r\n\t\t\t\t\t\t}, event.videoId, list);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\tevent.finish();\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tplayer.chooseButton().set('dialog',event.videoId).set('prompt',get.prompt('gz_tiantang')).set('ai',function(button){\r\n\t\t\t\t\t\treturn button.link[2]=='摸两张牌';\r\n\t\t\t\t\t})\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tgame.broadcastAll('closeDialog', event.videoId);\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t\tplayer.logSkill('gz_tiantang', trigger.player);\r\n\t\t\t\t\t\tresult.links.forEach(element => {\r\n\t\t\t\t\t\t\tif(element[2]=='观看并弃置声明花色牌'){\t\r\n\t\t\t\t\t\t\t\tif(trigger.player.countCards('h')==1&&trigger.player.countCards('e')==0&&get.suit(trigger.player.getCards('h')[0])==event.gz_tiantang){\r\n\t\t\t\t\t\t\t\t\tplayer.viewCards('观看其手牌',trigger.player.getCards('h'));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar next=player.discardPlayerCard(\"弃置一张声明花色的牌\", trigger.player, 'he').set('visible', true);\r\n\t\t\t\t\t\t\t\tnext.set('suit',event.gz_tiantang)\r\n\t\t\t\t\t\t\t\tnext.set('filterButton',function(button){\r\n\t\t\t\t\t\t\t\t\treturn get.suit(button.link)==_status.event.suit;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tvar fC=0;\r\n\t\t\t\t\t\t\t\ttrigger.player.getCards('he').forEach(function(tB){\r\n\t\t\t\t\t\t\t\t\tif(get.suit(tB)==event.gz_tiantang)\tfC++;\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tif(fC){\r\n\t\t\t\t\t\t\t\t\tnext.set('forced',true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\ttrigger.player.phaseUse();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(element[2]=='摸两张牌'){\r\n\t\t\t\t\t\t\t\ttrigger.player.draw(2,player);\r\n\t\t\t\t\t\t\t\ttrigger.player.addTempSkill('gz_tiantangzhifei_xianzhi','phaseEnd');\r\n\t\t\t\t\t\t\t\ttrigger.player.$.gz_tiantangzhifei_xianzhi = event.gz_tiantang;\r\n\t\t\t\t\t\t\t\ttrigger.player.syncStorage('gz_tiantangzhifei_xianzhi');\r\n\t\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup:'gz_tiantang_clear',\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tclear:{\r\n\t\t\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\t\t\tfirstDo:true,\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.gz_tiantang = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgz_tiantangzhifei_xianzhi:{\r\n\t\t\t\tmarktext:\"断\",\r\n\t\t\t\tlocked:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tname:'断臂',\r\n\t\t\t\t\tcontent:function(storage,player,skill){\r\n\t\t\t\t\t\treturn '只能使用花色为'+get.translation(storage)+'的牌';\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tonremove:true,\r\n\t\t\t\tmark:true,\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tcardEnabled:function(card,player,now){\r\n\t\t\t\t\t\tif(player.$.gz_tiantangzhifei_xianzhi)\treturn get.suit(card)==player.$.gz_tiantangzhifei_xianzhi;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gzMEA\r\n\t\t\tgz_luecai: {\r\n\t\t\t\taudio:'luecai',\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer:'useCard2'\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.targets&&event.targets.length==1&&event.targets[0].countCards('h')>player.countCards('h');\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'targets',\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn event.targets[0].countCards('h')-player.countCards('h')>=2&&get.attitude(player,event.targets[0]);\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.target = trigger.targets[0];\r\n\t\t\t\t\tplayer.gainPlayerCard(event.target,'he',true);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(event.target.countCards('h')<player.countCards('h')){\r\n\t\t\t\t\t\tplayer.disableSkill('gz_luecai','gz_luecai');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:4,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\treturn lib.card.shunshou.ai.result.target.apply(this,arguments);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tused:{}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//gz张京华\r\n\t\t\tgz_xiemen:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer: ['useCardBegin'], //你使用或打出牌时\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.targets&&event.targets.length>event.targets.filter(function(cur){\r\n\t\t\t\t\t\treturn\tcur==player;\r\n\t\t\t\t\t}).length;\r\n\t\t\t\t},\r\n\t\t\t\tfrequent: true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar players = game.players.slice(0);//遍历角色\r\n\t\t\t\t\tfor(var i=0;i<players.length;++i){\r\n\t\t\t\t\t\tvar p = players[i];\r\n\t\t\t\t\t\t//跳过自己\r\n\t\t\t\t\t\tif(p == player) continue;\r\n\t\t\t\t\t\t//随机获得角色p的一张手牌\r\n\t\t\t\t\t\tvar card = p.getCards('h').randomGet();\r\n\t\t\t\t\t\tif(!card) continue;//没有手牌则跳过\r\n\t\t\t\t\t\tif(!p.$.gz_xiemen_reset)p.$.gz_xiemen_reset=[];\r\n\t\t\t\t\t\tp.$.gz_xiemen_reset.push(card);\r\n\t\t\t\t\t\tp.lose(card, ui.special, 'toStorage');\r\n\r\n\t\t\t\t\t\t//角色p添加临时技能gz_xiemen_reset，用于在回合结束时重新获得被移除的手牌\r\n\t\t\t\t\t\tif(!p.hasSkill('gz_xiemen_reset')) p.addSkill('gz_xiemen_reset');\r\n\t\t\t\t\t\t// p.markAuto('gz_xiemen_reset', card);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\treset:{\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tglobal: 'phaseEnd'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect: true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tif(player.$.gz_xiemen_reset&&player.$.gz_xiemen_reset.length){\r\n\t\t\t\t\t\t\t\tplayer.gain(player.$.gz_xiemen_reset, 'fromStorage');\r\n                                delete player.$.gz_xiemen_reset;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tplayer.removeSkill('gz_xiemen_reset');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\t//gzOto\r\n\t\t\tgz_yuxia:{\r\n\t\t\t\taudio:'yuxia',\r\n\t\t\t\thiddenCard:function(player,name){\r\n\t\t\t\t\tif(!lib.skill.gz_yuxia.filter(false,player)||player.getStat('skill').gz_yuxia)\treturn false;\r\n\t\t\t\t\tvar list = get.inpile('trick');\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(list[i]==name) return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tusable:1,\r\n\t\t\t\tenable:'chooseToUse',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('he')>=3&&!player.getStat('skill').gz_yuxia;\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tdialog:function(event,player){\r\n\t\t\t\t\t\tvar list = get.inpile('trick');\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tlist[i]=['锦囊','',list[i]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn ui.create.dialog('『玉箱』',[list,'vcard']);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter:function(button,player){\r\n\t\t\t\t\t\treturn _status.event.getParent().filterCard({name:button.link[2],nature:button.link[3]},player,_status.event.getParent());\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck:function(button){\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tif(player.countCards('h',button.link[2])>0) return 0;\r\n\t\t\t\t\t\tif(['wugu','jingluo'].contains(button.link[2])) return 0;\r\n\t\t\t\t\t\tvar effect=player.getUseValue(button.link[2]);\r\n\t\t\t\t\t\tif(effect>0) return effect;\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(links,player){\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\taudio:'yuxia',\r\n\t\t\t\t\t\t\tfilterCard:function(card){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tselectCard:function(){\r\n\t\t\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\t\t\tif(player.$.gz_lianjue)\treturn [1,Infinity];\r\n\t\t\t\t\t\t\t\treturn 3;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tforceAuto:function(){\r\n\t\t\t\t\t\t\t\treturn ui.selected.buttons.length==3;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tpopname:true,\r\n\t\t\t\t\t\t\tcheck:function(card){\r\n\t\t\t\t\t\t\t\tif(player.$.gz_lianjue&&ui.selected.cards)\t\r\n\t\t\t\t\t\t\t\treturn 5-get.value(card);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tposition:'he',\r\n\t\t\t\t\t\t\tcomplexCard:true,\r\n\t\t\t\t\t\t\tviewAs:{name:links[0][2],nature:links[0][3]},\r\n\t\t\t\t\t\t\tprecontent:function(){\r\n\t\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\t\tevent.cards = event.result.cards.slice(0);\r\n\t\t\t\t\t\t\t\tgame.broadcastAll(function(player,cards){\r\n\t\t\t\t\t\t\t\t\tlet cardxs = []\r\n\t\t\t\t\t\t\t\t\tfor(let v of cards){\r\n\t\t\t\t\t\t\t\t\t\tlet cardx=ui.create.card();\r\n\t\t\t\t\t\t\t\t\t\tcardx.classList.add('infohidden');\r\n\t\t\t\t\t\t\t\t\t\tcardx.classList.add('infoflip');\r\n\t\t\t\t\t\t\t\t\t\tcardxs.push(cardx)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tplayer.$throw(cardxs,500,'nobroadcast');\r\n\t\t\t\t\t\t\t\t},player,Evt.cards);\r\n\t\t\t\t\t\t\t\tplayer.lose(event.cards,ui.ordering);\r\n\t\t\t\t\t\t\t\tevent.result.card.cards=[];\r\n\t\t\t\t\t\t\t\tevent.result.cards=[];\r\n\t\t\t\t\t\t\t\tdelete event.result.card.number;\r\n\t\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\t\tplayer.chooseCardButton(event.cards.length,true,cards,'『玉匣』：可以按顺序将卡牌置于牌堆顶（先选择的在上）').set('ai',function(button){\r\n\t\t\t\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\t\t\t\tvar now = _status.currentPhase;\r\n\t\t\t\t\t\t\t\t\tvar next = now.getNext();\r\n\t\t\t\t\t\t\t\t\tvar att = get.attitude(player,next);\r\n\t\t\t\t\t\t\t\t\tvar card = button.link;\r\n\t\t\t\t\t\t\t\t\tvar judge = next.getCards('j')[ui.selected.buttons.length];\r\n\t\t\t\t\t\t\t\t\tif(judge){\r\n\t\t\t\t\t\t\t\t\t\treturn get.judge(judge)(card)*att;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn next.getUseValue(card)*att;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\t\tevent.cards = result.links.slice(0);\r\n\t\t\t\t\t\t\t\tgame.broadcast(function(){\r\n\t\t\t\t\t\t\t\t\tui.arena.classList.add('thrownhighlight');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tui.arena.classList.add('thrownhighlight');\r\n\t\t\t\t\t\t\t\tgame.addVideo('thrownhighlight1');\r\n\t\t\t\t\t\t\t\twhile(event.cards.length>0){\r\n\t\t\t\t\t\t\t\t\tvar card=event.cards.pop();\r\n\t\t\t\t\t\t\t\t\tcard.fix();\r\n\t\t\t\t\t\t\t\t\tui.cardPile.insertBefore(card,ui.cardPile.firstChild);\r\n\t\t\t\t\t\t\t\t\tgame.updateRoundNumber();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\t\tgame.broadcastAll(function(){\r\n\t\t\t\t\t\t\t\t\tui.arena.classList.remove('thrownhighlight');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tgame.addVideo('thrownhighlight2');\r\n\t\t\t\t\t\t\t\tif(event.clear!==false){\r\n\t\t\t\t\t\t\t\t\tgame.broadcastAll(ui.clear);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(player.$.gz_lianjue)\t\tplayer.$.gz_lianjue = false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tprompt:function(links,player){\r\n\t\t\t\t\t\tif(player.$.gz_lianjue)\treturn '###『龙箱』###将任意张牌当做【'+(get.translation(links[0][3])||'')+get.translation(links[0][2])+'】使用';\r\n\t\t\t\t\t\treturn '###『龙箱』###将三张牌当做【'+(get.translation(links[0][3])||'')+get.translation(links[0][2])+'】使用';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:6,\r\n\t\t\t\t\tresult:{player:1},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgz_lianjue:{\r\n\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\tplayer.storage[skill] = false;\r\n\t\t\t\t},\r\n\t\t\t\tmarktext: '崛',\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: 'cards',\r\n\t\t\t\t\tname:'以『连崛』使用过的锦囊牌',\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tpriority:66,\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tprompt2: '你可以选择一项：令至多三名角色各摸一张牌；将下一次发动『玉箱』条件改为“任意张牌”。',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn (Math.abs(player.$.gz_lianjue_start-player.countCards('h'))%3==0);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseControlList(['令至多三名角色各摸一张牌','将下一次发动『玉箱』条件改为“任意张牌”'],function(){\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tswitch(result.index){\r\n\t\t\t\t\t\tcase 0: {\r\n\t\t\t\t\t\t\tplayer.chooseTarget([1,3],'令至多三名角色各摸一张牌').set('ai',function(target){\r\n\t\t\t\t\t\t\t\tvar att=get.attitude(_status.event.player,target);\r\n\t\t\t\t\t\t\t\tif(att>1){\r\n\t\t\t\t\t\t\t\t\treturn att;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.goto(2);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 1: {\r\n\t\t\t\t\t\t\tplayer.chat('将下一次发动『玉箱』条件改为“任意张牌”');\r\n\t\t\t\t\t\t\tplayer.$.gz_lianjue = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.targets&&result.targets.length){\r\n\t\t\t\t\t\tgame.asyncDraw(result.targets);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['gz_lianjue_start'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tstart:{\r\n\t\t\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\t\t\tif(!player.storage[skill]) player.storage[skill] = 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttrigger:{player:'phaseBefore'},\r\n\t\t\t\t\t\tfirstDo:true,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\tpriority:66,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.gz_lianjue_start = player.countCards('h');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\taiOrder:function(player,card,num){\r\n\t\t\t\t\t\tif(typeof card=='object'&&player==_status.currentPhase&&!player.needsToDiscard()&&Math.abs(player.$.gz_lianjue_start-player.countCards('h'))%3==0){\r\n\t\t\t\t\t\t\treturn num-10;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzbushi:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'damageEnd'},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.count=trigger.num;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.count--;\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(event.count>0){\r\n\t\t\t\t\t\tplayer.chooseBool(get.prompt2('gzbushi')).set('frequentSkill','gzbushi');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(result.bool) event.goto(1);\r\n\t\t\t\t},\r\n\t\t\t\tgroup:'gzbushi_draw',\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tdraw:{\r\n\t\t\t\t\t\ttrigger:{source:'damageSource'},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tnoHidden:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.player.isEnemyOf(player)&&event.player.isIn();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\ttrigger.player.chooseBool('是否对'+get.translation(player)+'发动【布施】？','你摸一张牌，然后其摸一张牌');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('gzbushi',trigger.player);\r\n\t\t\t\t\t\t\t\tgame.asyncDraw([trigger.player,player]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzbushi_old:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'damageEnd',\r\n\t\t\t\t\tsource:'damageSource',\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player,name){\r\n\t\t\t\t\tif(name=='damageSource'&&player==event.player) return false;\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isFriendOf(event.player);\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn player.isFriendOf(event.player);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.count=trigger.num;\r\n\t\t\t\t\tif(event.triggername=='damageSource') event.count=1;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.count--;\r\n\t\t\t\t\tvar target=trigger.player;\r\n\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isFriendOf(target);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\tif(list.length==1) event._result={bool:true,targets:list};\r\n\t\t\t\t\t\telse player.chooseTarget('布施：令一名与'+(player==target?'你':get.translation(target))+'势力相同的角色摸一张牌',true,function(card,player,target){\r\n\t\t\t\t\t\t\treturn target.isFriendOf(_status.event.target)\r\n\t\t\t\t\t\t}).set('target',target);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar target=result.targets[0];\r\n\t\t\t\t\t\tplayer.line(target,'green');\r\n\t\t\t\t\t\ttarget.draw();\r\n\t\t\t\t\t\tif(event.count) event.goto(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzmidao:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{global:'useCardToPlayered'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\t//noHidden:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar target=event.player;\r\n\t\t\t\t\treturn event.isFirstTarget&&target.isFriendOf(player)&&\r\n\t\t\t\t\ttarget.isPhaseUsing()&&(target==player||player.hasSkill('gzmidao'))&&\r\n\t\t\t\t\t(['basic','trick'].contains(get.type(event.card))&&get.tag(event.card,'damage')>0)&&\r\n\t\t\t\t\tevent.cards&&event.cards.length&&!target.hasSkill('gzmidao2');\r\n\t\t\t\t},\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar next=trigger.player.chooseBool('是否对'+get.translation(player)+'发动【米道】？','令该角色修改'+get.translation(trigger.card)+'的花色和伤害属性');\r\n\t\t\t\t\tif(player==next.player) next.setHiddenSkill(event.name);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('gzmidao');\r\n\t\t\t\t\t\ttrigger.player.addTempSkill('gzmidao2');\r\n\t\t\t\t\t\tif(player!=trigger.player){\r\n\t\t\t\t\t\t\ttrigger.player.line(player,'green');\r\n\t\t\t\t\t\t\t//player.gain(result.cards,trigger.player,'giveAuto');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(player.isUnderControl()){\r\n\t\t\t\t\t\tgame.swapPlayerAuto(player);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar switchToAuto=function(){\r\n\t\t\t\t\t\t_status.imchoosing=false;\r\n\t\t\t\t\t\tvar listn=['普通','fire','thunder'];\r\n\t\t\t\t\t\tif(_status.mode=='yingbian') listn.add('ice');\r\n\t\t\t\t\t\tevent._result={\r\n\t\t\t\t\t\t\tbool:true,\r\n\t\t\t\t\t\t\tsuit:lib.suit.randomGet(),\r\n\t\t\t\t\t\t\tnature:listn.randomGet(),\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif(event.dialog) event.dialog.close();\r\n\t\t\t\t\t\tif(event.control) event.control.close();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar chooseButton=function(player,card){\r\n\t\t\t\t\t\tvar event=_status.event;\r\n\t\t\t\t\t\tplayer=player||event.player;\r\n\t\t\t\t\t\tif(!event._result) event._result={};\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('米道：请修改'+card+'的花色和属性','forcebutton','hidden');\r\n\t\t\t\t\t\tevent.dialog=dialog;\r\n\t\t\t\t\t\tdialog.addText('花色');\r\n\t\t\t\t\t\tvar table=document.createElement('div');\r\n\t\t\t\t\t\ttable.classList.add('add-setting');\r\n\t\t\t\t\t\ttable.style.margin='0';\r\n\t\t\t\t\t\ttable.style.width='100%';\r\n\t\t\t\t\t\ttable.style.position='relative';\r\n\t\t\t\t\t\tvar listi=['spade','heart','club','diamond'];\r\n\t\t\t\t\t\tfor(var i=0;i<listi.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.link=listi[i];\r\n\t\t\t\t\t\t\ttable.appendChild(td);\r\n\t\t\t\t\t\t\ttd.innerHTML='<span>'+get.translation(listi[i])+'</span>';\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\t_status.tempNoButton=true;\r\n\t\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\t_status.tempNoButton=false;\r\n\t\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t\t\tvar link=this.link;\r\n\t\t\t\t\t\t\t\tvar current=this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\tevent._result.suit=link;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(table);\r\n\t\t\t\t\t\tdialog.addText('属性');\r\n\t\t\t\t\t\tvar table2=document.createElement('div');\r\n\t\t\t\t\t\ttable2.classList.add('add-setting');\r\n\t\t\t\t\t\ttable2.style.margin='0';\r\n\t\t\t\t\t\ttable2.style.width='100%';\r\n\t\t\t\t\t\ttable2.style.position='relative';\r\n\t\t\t\t\t\tvar listn=['普通','fire','thunder'];\r\n\t\t\t\t\t\tif(_status.mode=='yingbian') listn.add('ice');\r\n\t\t\t\t\t\tfor(var i=0;i<listn.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\tvar nature=listn[i];\r\n\t\t\t\t\t\t\ttd.link=nature;\r\n\t\t\t\t\t\t\ttable2.appendChild(td);\r\n\t\t\t\t\t\t\ttd.innerHTML='<span>'+get.translation(nature)+'</span>';\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\t_status.tempNoButton=true;\r\n\t\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\t_status.tempNoButton=false;\r\n\t\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t\t\tvar link=this.link;\r\n\t\t\t\t\t\t\t\tvar current=this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\tevent._result.nature=link;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(table2);\r\n\t\t\t\t\t\tdialog.add('　　');\r\n\t\t\t\t\t\tevent.dialog.open();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tevent.switchToAuto=function(){\r\n\t\t\t\t\t\t\tevent._result={\r\n\t\t\t\t\t\t\t\tbool:true,\r\n\t\t\t\t\t\t\t\tnature:listn.randomGet(),\r\n\t\t\t\t\t\t\t\tsuit:listi.randomGet(),\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\t\tevent.control.close();\r\n\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t_status.imchoosing=false;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tevent.control=ui.create.control('ok','cancel2',function(link){\r\n\t\t\t\t\t\t\tvar result=event._result;\r\n\t\t\t\t\t\t\tif(link=='cancel2') result.bool=false;\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(!result.nature||!result.suit) return;\r\n\t\t\t\t\t\t\t\tresult.bool=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\t\tevent.control.close();\r\n\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t_status.imchoosing=false;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tfor(var i=0;i<event.dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\tevent.dialog.buttons[i].classList.add('selectable');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t\tgame.countChoose();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(event.isMine()){\r\n\t\t\t\t\t\tchooseButton(player,get.translation(trigger.card));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.isOnline()){\r\n\t\t\t\t\t\tevent.player.send(chooseButton,event.player,get.translation(trigger.card));\r\n\t\t\t\t\t\tevent.player.wait();\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tswitchToAuto();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar map=event.result||result;\r\n\t\t\t\t\tif(map.bool){\r\n\t\t\t\t\t\tgame.log(player,'将',trigger.card,'的花色属性修改为了','#g'+get.translation(map.suit+2),'#y'+get.translation(map.nature));\r\n\t\t\t\t\t\ttrigger.card.suit=map.suit;\r\n\t\t\t\t\t\tif(map.nature=='普通') delete trigger.card.nature;\r\n\t\t\t\t\t\telse trigger.card.nature=map.nature;\r\n\t\t\t\t\t\ttrigger.player.$.gzmidao2=[trigger.card,map.nature];\r\n\t\t\t\t\t\tplayer.popup(get.translation(map.suit+2)+get.translation(map.nature),'thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzmidao2:{\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\ttrigger:{global:'damageBefore'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfirstDo:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tonremove:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.$.gzmidao2&&event.card==player.$.gzmidao2[0];\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar nature=player.$.gzmidao2[1];\r\n\t\t\t\t\tif(nature=='普通') delete trigger.nature;\r\n\t\t\t\t\telse trigger.nature=nature;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzbiluan:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tglobalTo:function(from,to,distance){\r\n\t\t\t\t\t\treturn distance+Math.max(1,to.countCards('e'));\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzlixia:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{global:'phaseZhunbeiBegin'},\r\n\t\t\t\tnoHidden:true,\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player!=event.player&&!event.player.isFriendOf(player)&&player.countDiscardableCards(event.player,'e')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\ttrigger.player.chooseBool('是否对'+get.translation(player)+'发动【礼下】？','弃置其装备区内的一张牌，然后选择一项：①弃置两张牌。②失去1点体力。③令其摸两张牌。').set('ai',function(){\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tvar target=_status.event.getParent().player;\r\n\t\t\t\t\t\tif(get.attitude(player,target)>0) return target.countCards('e',function(card){\r\n\t\t\t\t\t\t\treturn get.value(card,target)<3;\r\n\t\t\t\t\t\t})>0;\r\n\t\t\t\t\t\tif(target.countCards('e',function(card){\r\n\t\t\t\t\t\t\treturn get.value(card,target)>=7;\r\n\t\t\t\t\t\t})) return true;\r\n\t\t\t\t\t\tvar dist=get.distance(player,target,'attack');\r\n\t\t\t\t\t\tif(dist>1&&dist-target.countCards('e')<=1) return true;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar target=trigger.player;\r\n\t\t\t\t\t\tevent.target=target;\r\n\t\t\t\t\t\tplayer.logSkill('gzlixia');\r\n\t\t\t\t\t\ttarget.line(player,'green');\r\n\t\t\t\t\t\ttarget.discardPlayerCard(player,'e',true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar list=['失去一点体力','令'+get.translation(player)+'摸两张牌'];\r\n\t\t\t\t\tevent.addIndex=0;\r\n\t\t\t\t\tif(target.countCards('h',function(card){\r\n\t\t\t\t\t\treturn lib.filter.cardDiscardable(card,target,'gzlixia');\r\n\t\t\t\t\t})>1) list.unshift('弃置两张牌');\r\n\t\t\t\t\telse event.addIndex++;\r\n\t\t\t\t\ttarget.chooseControl().set('choiceList',list).set('ai',function(){\r\n\t\t\t\t\t\tvar num=2;\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tvar target=_status.event.getParent().player;\r\n\t\t\t\t\t\tif(get.attitude(player,target)>=0) num=2;\r\n\t\t\t\t\t\telse if(player.countCards('he',function(card){\r\n\t\t\t\t\t\t\treturn lib.filter.cardDiscardable(card,player,'gzlixia')&&get.value(card,player)<5;\r\n\t\t\t\t\t\t})>1) num=0;\r\n\t\t\t\t\t\telse if(player.hp+player.countCards('h','tao')>3&&!player.hasJudge('lebu')) num=1;\r\n\t\t\t\t\t\treturn num-_status.event.getParent().addIndex;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tswitch(result.index+event.addIndex){\r\n\t\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\t\ttarget.chooseToDiscard(2,'h',true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\ttarget.loseHp();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\r\n\t\t\tyigui:{\r\n\t\t\t\thiddenCard:function(player,name){\r\n\t\t\t\t\tvar storage=player.$.yigui;\r\n\t\t\t\t\tif(name=='shan'||name=='wuxie'||!storage||!storage.character.length||storage.used.contains(name)||!lib.inpile.contains(name)) return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\tif(!player.$.skill) player.storage[skill]={\r\n\t\t\t\t\t\tcharacter:[],\r\n\t\t\t\t\t\tused:[],\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tenable:\"chooseToUse\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.type=='wuxie'||event.type=='respondShan') return false;\r\n\t\t\t\t\tvar storage=player.$.yigui;\r\n\t\t\t\t\tif(!storage||!storage.character.length) return false;\r\n\t\t\t\t\tif(event.type=='dying'){\r\n\t\t\t\t\t\tif((!event.filterCard({name:'tao'},player,event)||storage.used.contains('tao'))&&\r\n\t\t\t\t\t\t(!event.filterCard({name:'jiu'},player,event)||storage.used.contains('jiu'))) return false;\r\n\t\t\t\t\t\tvar target=event.dying;\r\n\t\t\t\t\t\tif(target.identity=='unknown'||target.identity=='ye') return true;\r\n\t\t\t\t\t\tfor(var i=0;i<storage.character.length;i++){\r\n\t\t\t\t\t\t\tvar group=lib.character[storage.character[i]][1];\r\n\t\t\t\t\t\t\tif(group=='ye'||target.identity==group) return true;\r\n\t\t\t\t\t\t\tvar double=get.is.double(storage.character[i],true);\r\n\t\t\t\t\t\t\tif(double&&double.contains(target.identity)) return true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse return true;\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tselect:2,\r\n\t\t\t\t\tdialog:function(event,player){\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('役鬼','hidden');\r\n\t\t\t\t\t\tdialog.add([player.$.yigui.character,'character']);\r\n\t\t\t\t\t\tvar list=lib.inpile;\r\n\t\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tvar name=list[i];\r\n\t\t\t\t\t\t\tif(name=='shan'||name=='wuxie') continue;\r\n\t\t\t\t\t\t\tvar type=get.type(name);\r\n\t\t\t\t\t\t\tif(name=='sha'){\r\n\t\t\t\t\t\t\t\tlist2.push(['基本','','sha']);\r\n\t\t\t\t\t\t\t\tlist2.push(['基本','','sha','fire']);\r\n\t\t\t\t\t\t\t\tlist2.push(['基本','','sha','thunder']);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(type=='basic'){\r\n\t\t\t\t\t\t\t\tlist2.push(['基本','',list[i]]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(type=='trick'){\r\n\t\t\t\t\t\t\t\tlist2.push(['锦囊','',list[i]]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.add([list2,'vcard']);\r\n\t\t\t\t\t\treturn dialog;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck:function(button){\r\n\t\t\t\t\t\tif(ui.selected.buttons.length){\r\n\t\t\t\t\t\t\tvar evt=_status.event.getParent('chooseToUse');\r\n\t\t\t\t\t\t\tvar name=button.link[2];\r\n\t\t\t\t\t\t\tvar group=lib.character[ui.selected.buttons[0].link][1];\r\n\t\t\t\t\t\t\tvar double=get.is.double(ui.selected.buttons[0].link,true);\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\tif(evt.type=='dying'){\r\n\t\t\t\t\t\t\t\tif(evt.dying!=player&&get.effect(evt.dying,{name:name},player,player)<=0) return 0;\r\n\t\t\t\t\t\t\t\tif(name=='jiu') return 2.1;\r\n\t\t\t\t\t\t\t\treturn 2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!['tao','juedou','guohe','shunshou','wuzhong','xietianzi','yuanjiao','taoyuan','wugu','wanjian','nanman','huoshaolianying'].contains(name)) return 0;\r\n\t\t\t\t\t\t\tif(['taoyuan','wugu','wanjian','nanman','huoshaolianying'].contains(name)){\r\n\t\t\t\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\treturn (group=='ye'||current.identity=='unknown'||current.identity=='ye'||current.identity==group||(double&&double.contains(current.identity)))&&player.canUse({name:name},current);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tvar num=0;\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\tnum+=get.effect(list[i],{name:name},player,player);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(num<=0) return 0;\r\n\t\t\t\t\t\t\t\tif(list.length>1) return (1.7+Math.random())*Math.max(num,1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 1+Math.random();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter:function(button,player){\r\n\t\t\t\t\t\tvar evt=_status.event.getParent('chooseToUse');\r\n\t\t\t\t\t\tif(!ui.selected.buttons.length){\r\n\t\t\t\t\t\t\tif(typeof button.link!='string') return false;\r\n\t\t\t\t\t\t\tif(evt.type=='dying'){\r\n\t\t\t\t\t\t\t\tif(evt.dying.identity=='unknown'||evt.dying.identity=='ye') return true;\r\n\t\t\t\t\t\t\t\tvar double=get.is.double(button.link,true);\r\n\t\t\t\t\t\t\t\treturn evt.dying.identity==lib.character[button.link][1]||lib.character[button.link][1]=='ye'||(double&&double.contains(evt.dying.identity));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(typeof ui.selected.buttons[0].link!='string') return false;\r\n\t\t\t\t\t\t\tif(typeof button.link!='object') return false;\r\n\t\t\t\t\t\t\tvar name=button.link[2];\r\n\t\t\t\t\t\t\tif(player.$.yigui.used.contains(name)) return false;\r\n\t\t\t\t\t\t\tvar card={name:name};\r\n\t\t\t\t\t\t\tif(button.link[3]) card.nature=button.link[3];\r\n\t\t\t\t\t\t\tvar info=get.info(card);\r\n\t\t\t\t\t\t\tvar group=lib.character[ui.selected.buttons[0].link][1];\r\n\t\t\t\t\t\t\tvar double=get.is.double(ui.selected.buttons[0].link,true);\r\n\t\t\t\t\t\t\tif(evt.type=='dying'){\r\n\t\t\t\t\t\t\t\treturn evt.filterCard(card,player,evt);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!lib.filter.filterCard(card,player,evt)) return false;\r\n\t\t\t\t\t\t\telse if(evt.filterCard&&!evt.filterCard(card,player,evt)) return false;\r\n\t\t\t\t\t\t\tif(info.changeTarget){\r\n\t\t\t\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\treturn player.canUse(card,current);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\tvar giveup=false;\r\n\t\t\t\t\t\t\t\t\tvar targets=[list[i]];\r\n\t\t\t\t\t\t\t\t\tinfo.changeTarget(player,targets);\r\n\t\t\t\t\t\t\t\t\tfor(var j=0;j<targets.length;j++){\r\n\t\t\t\t\t\t\t\t\t\tif(group!='ye'&&targets[j].identity!='unknown'&&targets[j].identity!='ye'&&targets[j].identity!=group&&(!double||!double.contains(targets[j].identity))){\r\n\t\t\t\t\t\t\t\t\t\t\tgiveup=true;\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif(giveup) continue;\r\n\t\t\t\t\t\t\t\t\tif(giveup==false) return true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse return game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn evt.filterTarget(card,player,current)&&(group=='ye'||current.identity=='unknown'||current.identity=='ye'||current.identity==group||(double&&double.contains(current.identity)));\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(links,player){\r\n\t\t\t\t\t\tvar name=links[1][2];\r\n\t\t\t\t\t\tvar nature=links[1][3]||null;\r\n\t\t\t\t\t\tvar character=links[0];\r\n\t\t\t\t\t\tvar group=lib.character[character][1];\r\n\t\t\t\t\t\tvar next={\r\n\t\t\t\t\t\t\tcharacter:character,\r\n\t\t\t\t\t\t\tgroup:group,\r\n\t\t\t\t\t\t\tfilterCard:function(){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tselectCard:-1,\r\n\t\t\t\t\t\t\tcomplexCard:true,\r\n\t\t\t\t\t\t\tcheck:function(){return 1},\r\n\t\t\t\t\t\t\tpopname:true,\r\n\t\t\t\t\t\t\taudio:\"huashen1\",\r\n\t\t\t\t\t\t\tviewAs:{\r\n\t\t\t\t\t\t\t\tname:name,\r\n\t\t\t\t\t\t\t\tnature:nature,\r\n\t\t\t\t\t\t\t\tisCard:true,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\t\t\t\tvar xx=lib.skill.yigui_backup;\r\n\t\t\t\t\t\t\t\tvar evt=_status.event;\r\n\t\t\t\t\t\t\t\tvar group=xx.group;\r\n\t\t\t\t\t\t\t\tvar double=get.is.double(xx.character,true);\r\n\t\t\t\t\t\t\t\tvar info=get.info(card);\r\n\t\t\t\t\t\t\t\tif((!(info.singleCard&&ui.selected.targets.length))&&group!='ye'&&target.identity!='unknown'&&target.identity!='ye'&&target.identity!=group&&(!double||!double.contains(target.identity))) return false;\r\n\t\t\t\t\t\t\t\tif(info.changeTarget){\r\n\t\t\t\t\t\t\t\t\tvar targets=[target];\r\n\t\t\t\t\t\t\t\t\tinfo.changeTarget(player,targets);\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<targets.length;i++){\r\n\t\t\t\t\t\t\t\t\t\tif(group!='ye'&&targets[i].identity!='unknown'&&targets[i].identity!='ye'&&targets[i].identity!=group&&(!double||!double.contains(targets[i].identity))) return false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t//if(evt.type=='dying') return target==evt.dying;\r\n\t\t\t\t\t\t\t\tif(evt._backup&&evt._backup.filterTarget) return evt._backup.filterTarget(card,player,target);\r\n\t\t\t\t\t\t\t\treturn lib.filter.filterTarget(card,player,target);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tonuse:function(result,player){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('yigui');\r\n\t\t\t\t\t\t\t\tvar character=lib.skill.yigui_backup.character;\r\n\t\t\t\t\t\t\t\tplayer.flashAvatar('yigui',character);\r\n\t\t\t\t\t\t\t\tplayer.$.yigui.character.remove(character);\r\n\t\t\t\t\t\t\t\t_status.characterlist.add(character);\r\n\t\t\t\t\t\t\t\tgame.log(player,'从「魂」中移除了','#g'+get.translation(character));\r\n\t\t\t\t\t\t\t\tplayer.syncStorage('yigui');\r\n\t\t\t\t\t\t\t\tplayer.updateMarks('yigui');\r\n\t\t\t\t\t\t\t\tplayer.$.yigui.used.add(result.card.name);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treturn next;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tprompt:function(links,player){\r\n\t\t\t\t\t\tvar name=links[1][2];\r\n\t\t\t\t\t\tvar character=links[0];\r\n\t\t\t\t\t\tvar nature=links[1][3];\r\n\t\t\t\t\t\treturn '移除「'+get.translation(character)+'」并视为使用'+(get.translation(nature)||'')+get.translation(name);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tgroup:[\"yigui_init\",\"yigui_refrain\"],\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:function(){\r\n\t\t\t\t\t\treturn 1+10*Math.random();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tmarktext:'魂',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tonunmark:function(storage,player){\r\n\t\t\t\t\t\t_status.characterlist.addArray(storage.character);\r\n\t\t\t\t\t\tstorage.character=[];\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmark:function(dialog,storage,player){\r\n\t\t\t\t\t\tif(storage&&storage.character.length){\r\n\t\t\t\t\t\t\tif(player.isUnderControl(true)){\r\n\t\t\t\t\t\t\t\tdialog.addSmall([storage.character,'character']);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\treturn '共有'+get.cnNumber(storage.character.length)+'张“魂”'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\treturn '没有魂';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcontent:function(storage,player){\r\n\t\t\t\t\t\t\treturn '共有'+get.cnNumber(storage.character.length)+'张“魂”'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmarkcount:function(storage,player){\r\n\t\t\t\t\t\tif(storage&&storage.character) return storage.character.length;\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"yigui_init\":{\r\n\t\t\t\taudio:\"huashen\",\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'showCharacterAfter',\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.toShow.contains('gz_zuoci')&&!player.$.yigui_init;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.$.yigui_init=true;\r\n\t\t\t\t\tvar list=_status.characterlist.randomGets(2);\r\n\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\t_status.characterlist.removeArray(list);\r\n\t\t\t\t\t\tplayer.$.yigui.character.addArray(list);\r\n\t\t\t\t\t\tlib.skill.gzhuashen.drawCharacter(player,list);\r\n\t\t\t\t\t\tplayer.syncStorage('yigui');\r\n\t\t\t\t\t\tplayer.updateMarks('yigui');\r\n\t\t\t\t\t\tgame.log(player,'获得了'+get.cnNumber(list.length)+'张「魂」');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"yigui_refrain\":{\r\n\t\t\t\ttrigger:{global:'phaseBefore'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.$.yigui.used=[];\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tyigui_shan:{\r\n\t\t\t\tenable:\"chooseToUse\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.type!='respondShan') return false;\r\n\t\t\t\t\tvar storage=player.$.yigui;\r\n\t\t\t\t\tif(!storage||!storage.character.length||storage.used.contains('shan')) return false;\r\n\t\t\t\t\treturn event.filterCard({name:'shan'},player,event);\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tdialog:function(event,player){\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('役鬼','hidden');\r\n\t\t\t\t\t\tdialog.add([player.$.yigui.character,'character']);\r\n\t\t\t\t\t\treturn dialog;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck:function(button){\r\n\t\t\t\t\t\treturn 1/(1+game.countPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current.identity==button.link;\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(links,player){\r\n\t\t\t\t\t\tvar character=links[0];\r\n\t\t\t\t\t\tvar next={\r\n\t\t\t\t\t\t\tcharacter:character,\r\n\t\t\t\t\t\t\tfilterCard:function(){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tselectCard:-1,\r\n\t\t\t\t\t\t\tcomplexCard:true,\r\n\t\t\t\t\t\t\tcheck:function(){return 1},\r\n\t\t\t\t\t\t\tpopname:true,\r\n\t\t\t\t\t\t\taudio:\"huashen1\",\r\n\t\t\t\t\t\t\tviewAs:{\r\n\t\t\t\t\t\t\t\tname:'shan',\r\n\t\t\t\t\t\t\t\tisCard:true,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tonuse:function(result,player){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('yigui');\r\n\t\t\t\t\t\t\t\tvar character=lib.skill.yigui_shan_backup.character;\r\n\t\t\t\t\t\t\t\tplayer.flashAvatar('yigui',character);\r\n\t\t\t\t\t\t\t\tplayer.$.yigui.character.remove(character);\r\n\t\t\t\t\t\t\t\t_status.characterlist.add(character);\r\n\t\t\t\t\t\t\t\tgame.log(player,'从「魂」中移除了','#g'+get.translation(character));\r\n\t\t\t\t\t\t\t\tplayer.syncStorage('yigui');\r\n\t\t\t\t\t\t\t\tplayer.updateMarks('yigui');\r\n\t\t\t\t\t\t\t\tplayer.$.yigui.used.add(result.card.name);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treturn next;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\trespondShan:true,\r\n\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\tvar storage=player.$.yigui;\r\n\t\t\t\t\t\tif(!storage||!storage.character.length||storage.used.contains('shan')) return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\torder:0.1,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tyigui_wuxie:{\r\n\t\t\t\tenable:\"chooseToUse\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.type!='wuxie') return false;\r\n\t\t\t\t\tvar storage=player.$.yigui;\r\n\t\t\t\t\tif(!storage||!storage.character.length||storage.used.contains('wuxie')) return false;\r\n\t\t\t\t\treturn event.filterCard({name:'wuxie'},player,event);\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tdialog:function(event,player){\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('役鬼','hidden');\r\n\t\t\t\t\t\tdialog.add([player.$.yigui.character,'character']);\r\n\t\t\t\t\t\treturn dialog;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck:function(button){\r\n\t\t\t\t\t\treturn 1/(1+game.countPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current.identity==button.link;\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(links,player){\r\n\t\t\t\t\t\tvar character=links[0];\r\n\t\t\t\t\t\tvar next={\r\n\t\t\t\t\t\t\tcharacter:character,\r\n\t\t\t\t\t\t\tfilterCard:function(){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tselectCard:-1,\r\n\t\t\t\t\t\t\tcomplexCard:true,\r\n\t\t\t\t\t\t\tcheck:function(){return 1},\r\n\t\t\t\t\t\t\tpopname:true,\r\n\t\t\t\t\t\t\taudio:\"huashen1\",\r\n\t\t\t\t\t\t\tviewAs:{\r\n\t\t\t\t\t\t\t\tname:'wuxie',\r\n\t\t\t\t\t\t\t\tisCard:true,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tonuse:function(result,player){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('yigui');\r\n\t\t\t\t\t\t\t\tvar character=lib.skill.yigui_wuxie_backup.character;\r\n\t\t\t\t\t\t\t\tplayer.flashAvatar('yigui',character);\r\n\t\t\t\t\t\t\t\tplayer.$.yigui.character.remove(character);\r\n\t\t\t\t\t\t\t\t_status.characterlist.add(character);\r\n\t\t\t\t\t\t\t\tgame.log(player,'从「魂」中移除了','#g'+get.translation(character));\r\n\t\t\t\t\t\t\t\tplayer.syncStorage('yigui');\r\n\t\t\t\t\t\t\t\tplayer.updateMarks('yigui');\r\n\t\t\t\t\t\t\t\tplayer.$.yigui.used.add(result.card.name);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treturn next;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:0.1,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tjihun:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'damageEnd',\r\n\t\t\t\t\tglobal:'dyingAfter',\r\n\t\t\t\t},\r\n\t\t\t\taudio:\"xinsheng\",\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.name=='damage'||(event.player.isAlive()&&!event.player.isFriendOf(player))\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar list=_status.characterlist.randomGets(1);\r\n\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\t_status.characterlist.removeArray(list);\r\n\t\t\t\t\t\tplayer.$.yigui.character.addArray(list);\r\n\t\t\t\t\t\tlib.skill.gzhuashen.drawCharacter(player,list);\r\n\t\t\t\t\t\tplayer.syncStorage('yigui');\r\n\t\t\t\t\t\tplayer.updateMarks('yigui');\r\n\t\t\t\t\t\tgame.log(player,'获得了'+get.cnNumber(list.length)+'张「魂」');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\txindiaodu:{\r\n\t\t\t\taudio:\"diaodu\",\r\n\t\t\t\tgroup:'xindiaodu_use',\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\ttemp:{},\r\n\t\t\t\t\tuse:{\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tglobal:\"useCard\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn get.type(event.card)=='equip'&&event.player.isAlive()&&\r\n\t\t\t\t\t\t\tevent.player.isFriendOf(player)&&(player==event.player||player.hasSkill('xindiaodu'))&&!event.player.hasSkill('xindiaodu_temp');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar next=trigger.player.chooseBool('是否发动【调度】摸一张牌？');\r\n\t\t\t\t\t\t\tif(player.hasSkill('xindiaodu')) next.set('frequentSkill','xindiaodu');\r\n\t\t\t\t\t\t\tif(player==trigger.player) next.setHiddenSkill('xindiaodu');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('xindiaodu',trigger.player);\r\n\t\t\t\t\t\t\t\ttrigger.player.draw('nodelay');\r\n\t\t\t\t\t\t\t\ttrigger.player.addTempSkill('xindiaodu_temp');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"phaseUseBegin\",\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isFriendOf(player)&&current.countGainableCards(player,'e')>0;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt2('xindiaodu'),function(card,player,current){\r\n\t\t\t\t\t\treturn current.isFriendOf(player)&&current.countGainableCards(player,'e')>0;\r\n\t\t\t\t\t}).setHiddenSkill(event.name).ai=function(target){\r\n\t\t\t\t\t\tvar num=1;\r\n\t\t\t\t\t\tif(target.hasSkill('gzxiaoji')) num+=2.5;\r\n\t\t\t\t\t\tif(target.isDamaged()&&target.getEquip('baiyin')) num+=2.5;\r\n\t\t\t\t\t\tif(target.hasSkill('xuanlve')) num+=2;\r\n\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.target1=result.targets[0];\r\n\t\t\t\t\t\tplayer.logSkill('xindiaodu',event.target1);\r\n\t\t\t\t\t\tplayer.line(event.target1,'xindiaodu');\r\n\t\t\t\t\t\tplayer.gainPlayerCard(event.target1,'e',true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.bool&&player.getCards('h').contains(result.cards[0])){\r\n\t\t\t\t\t\tevent.card=result.cards[0];\r\n\t\t\t\t\t\tplayer.chooseTarget('是否将'+get.translation(event.card)+'交给一名其他角色？',function(card,player,current){\r\n\t\t\t\t\t\t\treturn current!=player&&current!=_status.event.target1&&current.isFriendOf(player);\r\n\t\t\t\t\t\t}).set('target1',event.target1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar target=result.targets[0];\r\n\t\t\t\t\t\tplayer.line(target,'green');\r\n\t\t\t\t\t\ttarget.gain(card,player,'give');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzbuyi:{\r\n\t\t\t\ttrigger:{global:'dyingAfter'},\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(!(event.player&&event.player.isAlive()&&event.source&&event.source.isAlive())) return false;\r\n\t\t\t\t\treturn event.player.isFriendOf(player)&&event.reason&&event.reason.name=='damage';\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){return get.attitude(player,event.player)>0},\r\n\t\t\t\tlogTarget:'source',\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseJunlingFor(trigger.source);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.junling=result.junling;\r\n\t\t\t\t\tevent.targets=result.targets;\r\n\t\t\t\t\tvar choiceList=[];\r\n\t\t\t\t\tchoiceList.push('执行该军令');\r\n\t\t\t\t\tchoiceList.push('令'+get.translation(trigger.player)+(trigger.player==trigger.source?'（你）':'')+'回复一点体力');\r\n\t\t\t\t\ttrigger.source.chooseJunlingControl(player,result.junling,result.targets).set('prompt','补益').set('choiceList',choiceList).set('ai',function(){\r\n\t\t\t\t\t\tif(get.recoverEffect(trigger.player,player,_status.event.player)>0) return 1;\r\n\t\t\t\t\t\treturn (get.attitude(trigger.source,trigger.player)<0&&get.junlingEffect(player,result.junling,trigger.source,result.targets,trigger.source)>=-2)?1:0;\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.index==0) trigger.source.carryOutJunling(player,event.junling,targets);\r\n\t\t\t\t\telse trigger.player.recover(player);\r\n\t\t\t\t},\r\n\t\t\t\taudio:['buyi',2],\r\n\t\t\t},\r\n\t\t\tkeshou:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'damageBegin3'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.num>0;\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar check=(player.countCards('h',{color:'red'})>1||player.countCards('h',{color:'black'})>1);\r\n\t\t\t\t\tplayer.chooseCard(get.prompt('keshou'),'弃置两张颜色相同的牌，令即将受到的伤害-1','he',2,function(card){\r\n\t\t\t\t\t\tif(ui.selected.cards.length) return get.color(card)==get.color(ui.selected.cards[0]);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}).set('complexCard',true).set('ai',function(card){\r\n\t\t\t\t\t\tif(!_status.event.check) return 0;\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tif(player.hp==1){\r\n\t\t\t\t\t\t\tif(!player.countCards('h',function(card){return get.tag(card,'save')})&&!player.hasSkillTag('save',true)) return 10-get.value(card);\r\n\t\t\t\t\t\t\treturn 7-get.value(card);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t\t}).set('check',check).setHiddenSkill(event.name);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar logged=false;\r\n\t\t\t\t\tif(result.cards){\r\n\t\t\t\t\t\tlogged=true;\r\n\t\t\t\t\t\tplayer.logSkill('keshou');\r\n\t\t\t\t\t\tplayer.discard(result.cards);\r\n\t\t\t\t\t\ttrigger.num--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!player.isUnseen()&&!game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current!=player&&current.isFriendOf(player);\r\n\t\t\t\t\t})){\r\n\t\t\t\t\t\tif(!logged) player.logSkill('keshou');\r\n\t\t\t\t\t\tplayer.judge(function(card){\r\n\t\t\t\t\t\t\tif(get.color(card)=='red') return 1;\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.judge>0) player.draw();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tzhuwei:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'judgeEnd'},\r\n\t\t\t\tfilter:function(event){\r\n\t\t\t\t\tif(get.owner(event.result.card)) return false;\r\n\t\t\t\t\tif(event.nogain&&event.nogain(event.result.card)) return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t\t//return event.result.card.name=='sha'||event.result.card.name=='juedou';\r\n\t\t\t\t},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.gain(trigger.result.card,'gain2');\r\n\t\t\t\t\tplayer.chooseBool('是否令'+get.translation(_status.currentPhase)+'本回合的手牌上限和使用【杀】的次数上限+1？').ai=function(){\r\n\t\t\t\t\t\treturn get.attitude(player,_status.currentPhase)>0;\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar target=_status.currentPhase;\r\n\t\t\t\t\t\tif(!target.hasSkill('zhuwei_eff')){\r\n\t\t\t\t\t\t\ttarget.addTempSkill('zhuwei_eff');\r\n\t\t\t\t\t\t\ttarget.$.zhuwei_eff=1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse target.$.zhuwei_eff++;\r\n\t\t\t\t\t\ttarget.updateMarks();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\teff:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\tmod:{\r\n\t\t\t\t\t\t\tcardUsable:function(card,player,num){\r\n\t\t\t\t\t\t\t\tif(card.name=='sha') return num+player.$.zhuwei_eff;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tmaxHandcard:function(player,num){return num+player.$.zhuwei_eff}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmark:true,\r\n\t\t\t\t\t\tintro:{\r\n\t\t\t\t\t\t\tcontent:function(storage){if(storage) return '使用【杀】的次数上限+'+storage+'，手牌上限+'+storage}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzweidi:{\r\n\t\t\t\tinit:function(player){player.$.gzweidi=[]},\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.$.gzweidi.length>0\r\n\t\t\t\t},\r\n\t\t\t\tfilterTarget:function(card,player,target){return target!=player&&player.$.gzweidi.contains(target)},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseJunlingFor(target);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.junling=result.junling;\r\n\t\t\t\t\tevent.targets=result.targets;\r\n\t\t\t\t\tvar choiceList=['执行该军令'];\r\n\t\t\t\t\tif(target!=player) choiceList.push('令'+get.translation(player)+'获得你所有手牌，然后交给你等量的牌');\r\n\t\t\t\t\telse choiceList.push('不执行该军令');\r\n\t\t\t\t\ttarget.chooseJunlingControl(player,result.junling,result.targets).set('prompt','伪帝').set('choiceList',choiceList).set('ai',function(){\r\n\t\t\t\t\t\tif(get.attitude(target,player)>=0) return get.junlingEffect(player,result.junling,target,result.targets,target)>=0?0:1;\r\n\t\t\t\t\t\treturn get.junlingEffect(player,result.junling,target,result.targets,target)>=-1?0:1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.index==0) target.carryOutJunling(player,event.junling,targets);\r\n\t\t\t\t\telse if(target!=player&&target.countCards('h')) {\r\n\t\t\t\t\t\tevent.num=target.countCards('h');\r\n\t\t\t\t\t\tplayer.gain(target.getCards('h'),target,'giveAuto');\r\n\t\t\t\t\t\tplayer.chooseCard('交给'+get.translation(target)+get.cnNumber(event.num)+'张牌','he',event.num,true).set('ai',function(card){\r\n\t\t\t\t\t\t\treturn -get.value(card);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(result.cards){\r\n\t\t\t\t\t\ttarget.gain(result.cards,player,'giveAuto');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['gzweidi_ft','gzweidi_ftc'],\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:3,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1,\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tft:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\ttrigger:{global:'gainBefore'},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player==event.player||player.$.gzweidi.contains(event.player)||_status.currentPhase!=player) return false;\r\n\t\t\t\t\t\t\tif(event.cards.length){\r\n\t\t\t\t\t\t\t\tif(event.getParent().name=='draw') return true;\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<event.cards.length;i++) if(get.position(event.cards[i])=='c'||(!get.position(event.cards[i])&&event.cards[i].original=='c')) return true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){player.$.gzweidi.push(trigger.player)}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tftc:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\ttrigger:{global:'phaseAfter'},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(event,player){return event.player==player},\r\n\t\t\t\t\t\tcontent:function(){player.$.gzweidi=[]},\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\taudio:['weidi',2]\r\n\t\t\t},\r\n\t\t\tgzyongsi:{\r\n\t\t\t\tgroup:['gzyongsi_eff1','gzyongsi_eff2','gzyongsi_eff3'],\r\n\t\t\t\tpreHidden:['gzyongsi_eff3'],\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:function(player,target){\r\n\t\t\t\t\t\tif(game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current!=target&&current.getEquip('yuxi');\r\n\t\t\t\t\t\t})) return 0.5;\r\n\t\t\t\t\t\treturn 2;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tforceMajor:true,\r\n\t\t\t\t\tskillTagFilter:function(){\r\n\t\t\t\t\t\treturn !game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current.getEquip('yuxi');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\teff1:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\tequipSkill:true,\r\n\t\t\t\t\t\tnoHidden:true,\r\n\t\t\t\t\t\ttrigger:{player:'phaseDrawBegin2'},\r\n\t\t\t\t\t\t//priority:8,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(event.numFixed||player.isDisabled(5)) return false;\r\n\t\t\t\t\t\t\treturn !game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn current.getEquip('yuxi');\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){trigger.num++},\r\n\t\t\t\t\t\taudio:['yongsi',2]\r\n\t\t\t\t\t},\r\n\t\t\t\t\teff2:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\ttrigger:{player:'phaseUseBegin'},\r\n\t\t\t\t\t\t//priority:8,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tnoHidden:true,\r\n\t\t\t\t\t\tequipSkill:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.isDisabled(5)) return false;\r\n\t\t\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn player.canUse('zhibi',current);\r\n\t\t\t\t\t\t\t})&&!game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn current.getEquip('yuxi');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.chooseUseTarget('玉玺（庸肆）：选择知己知彼的目标',{name:'zhibi'});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\taudio:['yongsi',2]\r\n\t\t\t\t\t},\r\n\t\t\t\t\teff3:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\ttrigger:{global:'useCardToTargeted'},\r\n\t\t\t\t\t\t//priority:16,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.target&&event.target==player&&event.card&&event.card.name=='zhibi'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcheck:function(){return false},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.showHandcards();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzfudi:{\r\n\t\t\t\ttrigger:{global:'damageEnd'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\taudio:2,\r\n\t\t\t\tfilter:function(event,player){return event.source&&event.source.isAlive()&&event.source!=player&&event.player==player&&player.countCards('h')&&event.num>0},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar players=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isFriendOf(trigger.source)&&current.hp>=player.hp&&!game.hasPlayer(function(current2){\r\n\t\t\t\t\t\t\treturn current2.hp>current.hp&&current2.isFriendOf(trigger.source);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar check=true;\r\n\t\t\t\t\tif(!players.length) check=false;\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(get.attitude(player,trigger.source)>=0) check=false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.chooseCard(get.prompt('gzfudi',trigger.source),'交给其一张手牌，然后对其势力中体力值最大且不小于你的一名角色造成1点伤害').set('aicheck',check).set('ai',function(card){\r\n\t\t\t\t\t\tif(!_status.event.aicheck) return 0;\r\n\t\t\t\t\t\treturn 9-get.value(card);\r\n\t\t\t\t\t}).setHiddenSkill(event.name);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('gzfudi',trigger.source);\r\n\t\t\t\t\t\ttrigger.source.gain(result.cards,player,'giveAuto');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.hp>=player.hp&&current.isFriendOf(trigger.source)&&!game.hasPlayer(function(current2){\r\n\t\t\t\t\t\t\treturn current2.hp>current.hp&&current2.isFriendOf(trigger.source);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\tif(list.length==1) event._result={bool:true,targets:list};\r\n\t\t\t\t\t\telse player.chooseTarget(true,'对'+get.translation(trigger.source)+'势力中体力值最大的一名角色造成1点伤害',function(card,player,target){\r\n\t\t\t\t\t\t\treturn _status.event.list.contains(target);\r\n\t\t\t\t\t\t}).set('list',list).set('ai',function(target){return get.damageEffect(target,player,player)});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(result.bool&&result.targets.length){\r\n\t\t\t\t\t\tplayer.line(result.targets[0]);\r\n\t\t\t\t\t\tresult.targets[0].damage();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tmaixie:true,\r\n\t\t\t\t\tmaixie_defend:true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(get.tag(card,'damage')&&target.hp>1){\r\n\t\t\t\t\t\t\t\tif(player.hasSkillTag('jueqing',false,target)) return [1,-2];\r\n\t\t\t\t\t\t\t\tif(!target.countCards('h')) return [1,-1];\r\n\t\t\t\t\t\t\t\tif(game.countPlayer(function(current){return current.isFriendOf(player)&&current.hp>=target.hp-1})) return [1,0,0,-2];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcongjian:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'damageBegin3',\r\n\t\t\t\t\tsource:'damageBegin1',\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\taudio:'drlt_congjian',\r\n\t\t\t\tfilter:function(event,player,name){\r\n\t\t\t\t\tif(event.num<=0) return false;\r\n\t\t\t\t\tif(name=='damageBegin1'&&_status.currentPhase!=player) return true;\r\n\t\t\t\t\tif(name=='damageBegin3'&&_status.currentPhase==player) return true;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn _status.currentPhase!=player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){trigger.num++},\r\n\t\t\t},\r\n\t\t\tjianan:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tgroup:'wuziliangjiangdao',\r\n\t\t\t\tderivation:'wuziliangjiangdao',\r\n\t\t\t\tglobal:'g_jianan',\r\n\t\t\t},\r\n\t\t\tg_jianan:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:['phaseZhunbeiBegin','phaseBefore','dieBegin'],\r\n\t\t\t\t},\r\n\t\t\t\taudio:'jianan',\r\n\t\t\t\tforceaudio:true,\r\n\t\t\t\tfilter:function(event,player,name){\r\n\t\t\t\t\tif(name!='phaseZhunbeiBegin') return get.is.jun(player)&&player.identity=='wei';\r\n\t\t\t\t\treturn this.filter2.apply(this,arguments);\r\n\t\t\t\t},\r\n\t\t\t\tfilter2:function(event,player){\r\n\t\t\t\t\tif(!get.zhu(player,'jianan')) return false;\r\n\t\t\t\t\tif(!player.countCards('he')) return false;\r\n\t\t\t\t\treturn !player.isUnseen();\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(event.triggername!='phaseZhunbeiBegin'){\r\n\t\t\t\t\t\tevent.trigger('jiananUpdate');\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar skills=['new_retuxi','qiaobian','gzxiaoguo','gzjieyue','new_duanliang'];\r\n\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\tif(current==player) return;\r\n\t\t\t\t\t\t\tif(current.hasSkill('new_retuxi')) skills.remove('new_retuxi');\r\n\t\t\t\t\t\t\tif(current.hasSkill('qiaobian')) skills.remove('qiaobian');\r\n\t\t\t\t\t\t\tif(current.hasSkill('gzxiaoguo')) skills.remove('gzxiaoguo');\r\n\t\t\t\t\t\t\tif(current.hasSkill('gzjieyue')) skills.remove('gzjieyue');\r\n\t\t\t\t\t\t\tif(current.hasSkill('new_duanliang')) skills.remove('new_duanliang');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(!skills.length) event.finish();\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.skills=skills;\r\n\t\t\t\t\t\tvar next=player.chooseToDiscard('he');\r\n\t\t\t\t\t\tvar str='';\r\n\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\tstr+='、【';\r\n\t\t\t\t\t\t\tstr+=get.translation(skills[i]);\r\n\t\t\t\t\t\t\tstr+='】';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnext.set('prompt','是否发动【五子良将纛】？')\r\n\t\t\t\t\t\tnext.set('prompt2',get.translation('弃置一张牌并暗置一张武将牌，获得以下技能中的一个直到下回合开始：'+str.slice(1)));\r\n\t\t\t\t\t\tnext.logSkill='g_jianan';\r\n\t\t\t\t\t\tnext.skills=skills;\r\n\t\t\t\t\t\tnext.ai=function(card){\r\n\t\t\t\t\t\t\tvar skills=_status.event.skills;\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\tvar rank=0;\r\n\t\t\t\t\t\t\tif(skills.contains('new_retuxi')&&game.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn get.attitude(player,current)<0&&current.countGainableCards(player,'h')\r\n\t\t\t\t\t\t\t})>1) rank=4;\r\n\t\t\t\t\t\t\tif(skills.contains('gzjieyue')&&player.countCards('h',function(card){\r\n\t\t\t\t\t\t\t\treturn get.value(card)<7;\r\n\t\t\t\t\t\t\t})>1) rank=5;\r\n\t\t\t\t\t\t\tif(skills.contains('qiaobian')&&player.countCards('h')>4) rank=6;\r\n\t\t\t\t\t\t\tif((get.guozhanRank(player.name1,player)<rank&&!player.isUnseen(0))||(get.guozhanRank(player.name2,player)<rank&&!player.isUnseen(1))) return rank+1-get.value(card);\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(!result.bool) event.finish();\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar list=[\"主将\",\"副将\"];\r\n\t\t\t\t\t\tif(player.isUnseen(0)||get.is.jun(player)) list.remove(\"主将\");\r\n\t\t\t\t\t\tif(player.isUnseen(1)) list.remove(\"副将\");\r\n\t\t\t\t\t\tif(!list.length) event.goto(3);\r\n\t\t\t\t\t\telse if(list.length<2) event._result={control:list[0]};\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tplayer.chooseControl(list).set('ai',function(){\r\n\t\t\t\t\t\t\t\treturn get.guozhanRank(player.name1,player)<get.guozhanRank(player.name2,player)?'主将':'副将';\r\n\t\t\t\t\t\t\t}).prompt=\"请选择暗置一张武将牌\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(!result.control) event.finish();\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar num=result.control=='主将'?0:1;\r\n\t\t\t\t\t\tplayer.hideCharacter(num);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tplayer.chooseControl(event.skills).set('ai',function(){\r\n\t\t\t\t\t\tvar skills=event.skills;\r\n\t\t\t\t\t\tif(skills.contains('qiaobian')&&player.countCards('h')>3) return 'qiaobian';\r\n\t\t\t\t\t\tif(skills.contains('gzjieyue')&&player.countCards('h',function(card){\r\n\t\t\t\t\t\t\treturn get.value(card)<7;\r\n\t\t\t\t\t\t})) return 'gzjieyue';\r\n\t\t\t\t\t\tif(skills.contains('new_retuxi')) return 'new_retuxi';\r\n\t\t\t\t\t\treturn skills.randomGet();\r\n\t\t\t\t\t}).set(\"prompt\",\"选择获得其中的一个技能直到君主的回合开始\");\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tvar link=result.control;\r\n\t\t\t\t\tplayer.addTempSkill(link,\"jiananUpdate\");\r\n\t\t\t\t\tplayer.addTempSkill(\"jianan_eff\",\"jiananUpdate\");\r\n\t\t\t\t\tgame.log(player,\"获得了技能\",\"#g【\"+get.translation(result.control)+\"】\");\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tjianan_eff:{\r\n\t\t\t\tai:{nomingzhi:true}\r\n\t\t\t},\r\n\t\t\thuibian:{\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\taudio:2,\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.countPlayer(function(current){\r\n\t\t\t\t\t\treturn current.identity=='wei';\r\n\t\t\t\t\t})>1&&game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isDamaged()&&current.identity=='wei';\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\tif(ui.selected.targets.length) return target.isDamaged()&&target.identity=='wei';\r\n\t\t\t\t\treturn target.identity=='wei';\r\n\t\t\t\t},\r\n\t\t\t\tselectTarget:2,\r\n\t\t\t\tmultitarget:true,\r\n\t\t\t\ttargetprompt:['受到伤害</br>然后摸牌','回复体力'],\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\ttargets[0].damage(player);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(targets[0].isAlive()) targets[0].draw(2);\r\n\t\t\t\t\ttargets[1].recover();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.2,\r\n\t\t\t\t\torder:9,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(ui.selected.targets.length) return 1;\r\n\t\t\t\t\t\t\tif(get.damageEffect(target,player,player)>0) return 2;\r\n\t\t\t\t\t\t\tif(target.hp>2) return 1;\r\n\t\t\t\t\t\t\tif(target.hp==1) return -1;\r\n\t\t\t\t\t\t\treturn 0.1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzzongyu:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tgroup:['gzzongyu_others','gzzongyu_player'],\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.2,\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tothers:{\r\n\t\t\t\t\t\ttrigger:{global:'equipAfter'},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(event.player==player||!player.countCards('e',{subtype:['equip3','equip4']})) return false;\r\n\t\t\t\t\t\t\treturn event.card.name=='liulongcanjia';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\t\t\tif(get.attitude(player,target)<=0) return player.countCards('e',{subtype:['equip4','equip4']})<2;\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tplayer.chooseBool('是否发动【总御】，与'+get.translation(trigger.player)+'交换装备区内坐骑牌？');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('gzzongyu',trigger.player);\r\n\t\t\t\t\t\t\t\tevent.cards=[player.getCards('e',{subtype:['equip3','equip4']}),trigger.player.getCards('e',{name:'liulongcanjia'})];\r\n\t\t\t\t\t\t\t\tplayer.lose(event.cards[0],ui.special);\r\n\t\t\t\t\t\t\t\ttrigger.player.lose(event.cards[1],ui.special);\r\n\t\t\t\t\t\t\t\tif(event.cards[0].length) player.$give(event.cards[0],trigger.player);\r\n\t\t\t\t\t\t\t\tif(event.cards[1].length) trigger.player.$give(event.cards[1],player);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tfor(var i=0;i<event.cards[1].length;i++) player.equip(event.cards[1][i]);\r\n\t\t\t\t\t\t\tfor(var i=0;i<event.cards[0].length;i++) trigger.player.equip(event.cards[0][i]);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tplayer:{\r\n\t\t\t\t\t\taudio:'gzzongyu',\r\n\t\t\t\t\t\ttrigger:{player:'equipAfter'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(!['equip3','equip4'].contains(get.subtype(event.card))) return false;\r\n\t\t\t\t\t\t\tfor(var i=0;i<ui.discardPile.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tif(ui.discardPile.childNodes[i].name=='liulongcanjia') return true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn current!=player&&current.countCards('ej','liulongcanjia');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\tfor(var i=0;i<ui.discardPile.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tif(ui.discardPile.childNodes[i].name=='liulongcanjia'){\r\n\t\t\t\t\t\t\t\t\tlist.add(ui.discardPile.childNodes[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(current!=player){\r\n\t\t\t\t\t\t\t\t\tvar ej=current.getCards('ej','liulongcanjia');\r\n\t\t\t\t\t\t\t\t\tif(ej.length){\r\n\t\t\t\t\t\t\t\t\t\tlist.addArray(ej);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\t\t\tvar card=list.randomGet();\r\n\t\t\t\t\t\t\t\tvar owner=get.owner(card);\r\n\t\t\t\t\t\t\t\tif(owner){\r\n\t\t\t\t\t\t\t\t\tplayer.line(owner,'green');\r\n\t\t\t\t\t\t\t\t\towner.lose(card,ui.special);\r\n\t\t\t\t\t\t\t\t\towner.$give(card,player);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse player.$gain(card,'log');\r\n\t\t\t\t\t\t\t\tplayer.equip(card);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\twuziliangjiangdao:{\r\n\t\t\t\tnopop:true,\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tmark:true,\r\n\t\t\t\tintro:{content:function(){return get.translation('wuziliangjiangdao_info')}},\r\n\t\t\t},\r\n\t\t\t\t\t\r\n\t\t\tgzzhengbi:{\r\n\t\t\t\taudio:'zhengbi',\r\n\t\t\t\ttrigger:{player:'phaseUseBegin'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t//if(event.player!=player) return false;\r\n\t\t\t\t\treturn game.hasPlayer(function(current){return current!=player&&current.identity=='unknown'})||player.countCards('h',{type:'basic'});\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\tif(player.countCards('h',function(card){return get.value(card)<7})){\r\n\t\t\t\t\t\tif(player.isUnseen()) return Math.random()>0.7;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar choices=[];\r\n\t\t\t\t\tif(game.hasPlayer(function(current){return current.isUnseen()})) choices.push('选择一名未确定势力的角色');\r\n\t\t\t\t\tif(game.hasPlayer(function(current){return current!=player&&!current.isUnseen()})&&player.countCards('h',{type:'basic'})) choices.push('将一张基本牌交给一名已确定势力的角色');\r\n\t\t\t\t\tif(choices.length==1){\r\n\t\t\t\t\t\tevent._result={index:choices[0]=='选择一名未确定势力的角色'?0:1};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse player.chooseControl().set('ai',function(){\r\n\t\t\t\t\t\tif(choices.length>1){\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\tif(!game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn !current.isUnseen()&&current.getEquip('yuxi')||current.hasSkill('gzyongsi')&&!game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\treturn current.getEquip('yuxi');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t})&&game.hasPlayer(function(current){return current!=player&&current.isUnseen()})){\r\n\t\t\t\t\t\t\t\tvar identity;\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<game.players;i++){\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].isMajor()){identity=game.players[i].identity;break;}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!player.isUnseen()&&player.identity!=identity&&get.population(player.identity)+1>=get.population(identity)) return 0;\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}).set('prompt','征辟：请选择一项').set('choiceList',choices);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.index==0) player.chooseTarget('请选择一名未确定势力的角色',function(card,player,target){\r\n\t\t\t\t\t\treturn target!=player&&target.identity=='unknown'\r\n\t\t\t\t\t},true);\r\n\t\t\t\t\telse player.chooseCardTarget({\r\n\t\t\t\t\t\tprompt:'请将一张基本牌交给一名已确定势力的其他角色',\r\n\t\t\t\t\t\tposition:'h',\r\n\t\t\t\t\t\tfilterCard:function(card){return get.type(card)=='basic'},\r\n\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\t\t\treturn target!=player&&target.identity!='unknown';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai1:function(card){return 5-get.value(card)},\r\n\t\t\t\t\t\tai2:function(target){\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\tvar att=get.attitude(player,target);\r\n\t\t\t\t\t\t\tif(att>0) return 0;\r\n\t\t\t\t\t\t\treturn -(att-1)/target.countCards('h');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).set('forced',true);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tevent.target=result.targets[0];\r\n\t\t\t\t\tplayer.line(result.targets,'green');\r\n\t\t\t\t\tif(result.cards.length){\r\n\t\t\t\t\t\tevent.cards=result.cards;\r\n\t\t\t\t\t\tresult.targets[0].gain(result.cards,player,'give');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.$.gzzhengbi_eff1=result.targets[0];\r\n\t\t\t\t\t\tplayer.addTempSkill('gzzhengbi_eff1','phaseUseAfter');\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar choices=[];\r\n\t\t\t\t\tif(target.countCards('he',{type:['trick','delay','equip']})) choices.push('一张非基本牌');\r\n\t\t\t\t\tif(target.countCards('h',{type:'basic'})>1) choices.push('两张基本牌');\r\n\t\t\t\t\tif(choices.length) target.chooseControl(choices).set('ai',function(event,player){\r\n\t\t\t\t\t\tif(choices.length>1){\r\n\t\t\t\t\t\t\tif(player.countCards('he',{type:['trick','delay','equip']},function(card){return get.value(card)<7})) return 0;\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}).set('prompt','征辟：交给'+get.translation(player)+'…</div>');\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(target.countCards('h')){\r\n\t\t\t\t\t\t\tvar cards=target.getCards('h');\r\n\t\t\t\t\t\t\tplayer.gain(cards,target,'giveAuto');\r\n\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tvar check=(result.control=='一张非基本牌');\r\n\t\t\t\t\ttarget.chooseCard('he',(check?1:2),{type:(check?['trick','delay','equip']:'basic')},true);\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tif(result.cards){\r\n\t\t\t\t\t\tplayer.gain(result.cards,target,'giveAuto');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\teff1:{\r\n\t\t\t\t\t\taudio:'zhengbi',\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\tonremove:true,\r\n\t\t\t\t\t\ttrigger:{player:'phaseUseEnd'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tcharlotte:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tvar target=player.$.gzzhengbi_eff1;\r\n\t\t\t\t\t\t\treturn target&&!target.isUnseen()&&target.countGainableCards(player,'he')>0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tlogTarget:function(event,player){\r\n\t\t\t\t\t\t\treturn player.$.gzzhengbi_eff1;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tvar num=0;\r\n\t\t\t\t\t\t\tvar target=player.$.gzzhengbi_eff1;\r\n\t\t\t\t\t\t\tif(target.countGainableCards(player,'h')) num++;\r\n\t\t\t\t\t\t\tif(target.countGainableCards(player,'e')) num++;\r\n\t\t\t\t\t\t\tif(num){\r\n\t\t\t\t\t\t\t\tplayer.gainPlayerCard(target,num,'he',true).set('filterButton',function(button){\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<ui.selected.buttons.length;i++){\r\n\t\t\t\t\t\t\t\t\t\tif(get.position(button.link)==get.position(ui.selected.buttons[i].link)) return false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzfengying:{\r\n\t\t\t\taudio:'fengying',\r\n\t\t\t\tlimited:true,\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tposition:'h',\r\n\t\t\t\tfilterCard:true,\r\n\t\t\t\tselectCard:-1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn !player.$.gzfengying&&player.countCards('h')>0;\r\n\t\t\t\t},\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target==player;\r\n\t\t\t\t},\r\n\t\t\t\tselectTarget:-1,\r\n\t\t\t\tdiscard:false,\r\n\t\t\t\tlose:false,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.awakenSkill('gzfengying');\r\n\t\t\t\t\tplayer.$.gzfengying=true;\r\n\t\t\t\t\tplayer.useCard({name:'xietianzi'},cards,target);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isFriendOf(player)&&current.countCards('h')<current.maxHp;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlist.sort(lib.sort.seat);\r\n\t\t\t\t\tplayer.line(list,'thunder');\r\n\t\t\t\t\tgame.asyncDraw(list,function(current){\r\n\t\t\t\t\t\treturn current.maxHp-current.countCards('h');\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tskillAnimation:'epic',\r\n\t\t\t\tanimationColor:'gray',\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:0.1,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player){\r\n\t\t\t\t\t\t\tvar value=0;\r\n\t\t\t\t\t\t\tvar cards=player.getCards('h');\r\n\t\t\t\t\t\t\tif(cards.length>=4) return 0;\r\n\t\t\t\t\t\t\tfor(var i=0;i<cards.length;i++){\r\n\t\t\t\t\t\t\t\tvalue+=Math.max(0,get.value(cards[i],player,'raw'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar targets=game.filterPlayer(function(current){return current.isFriendOf(player)&&current!=player});\r\n\t\t\t\t\t\t\tvar eff=0;\r\n\t\t\t\t\t\t\tfor(var i=0;i<targets.length;i++){\r\n\t\t\t\t\t\t\t\tvar num=targets[i].countCards('h')<targets[i].maxHp;\r\n\t\t\t\t\t\t\t\tif(num<=0) continue;\r\n\t\t\t\t\t\t\t\teff+=num;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 5*eff-value\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tjunling4_eff:{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tcardEnabled2:function(card){\r\n\t\t\t\t\t\tif(get.position(card)=='h') return false\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tmarktext:'令',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'不能使用或打出手牌'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjunling5_eff:{\r\n\t\t\t\ttrigger:{player:\"recoverBefore\"},\r\n\t\t\t\tpriority:44,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tcontent:function(){trigger.cancel()},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tmarktext:'令',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'不能回复体力'\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(get.tag(card,'recover')) return 'zeroplayertarget';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tgzjieyue:{\r\n\t\t\t\ttrigger:{player:'phaseZhunbeiBegin'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('h')&&game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current!=player&&current.identity!='wei';\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseCardTarget({\r\n\t\t\t\t\t\tprompt:get.prompt2('gzjieyue'),\r\n\t\t\t\t\t\tposition:'h',\r\n\t\t\t\t\t\tfilterCard:true,\r\n\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\t\t\treturn target.identity!='wei'&&target!=player;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai1:function(card,player,target){\r\n\t\t\t\t\t\t\tif(get.attitude(player,target)>0) return 11-get.value(card);\r\n\t\t\t\t\t\t\treturn 7-get.value(card);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai2:function(card,player,target){\r\n\t\t\t\t\t\t\tvar att=get.attitude(player,target);\r\n\t\t\t\t\t\t\tif(att<0) return -att;\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).setHiddenSkill('gzjieyue');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.target=result.targets[0];\r\n\t\t\t\t\t\tplayer.logSkill('gzjieyue',result.targets);\r\n\t\t\t\t\t\tresult.targets[0].gain(result.cards[0],player,'giveAuto');\r\n\t\t\t\t\t\tplayer.chooseJunlingFor(result.targets[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tevent.junling=result.junling;\r\n\t\t\t\t\tevent.targets=result.targets;\r\n\t\t\t\t\tvar choiceList=[];\r\n\t\t\t\t\tchoiceList.push('执行该军令，然后'+get.translation(player)+'摸一张牌');\r\n\t\t\t\t\tchoiceList.push('令'+get.translation(player)+'摸牌阶段额外摸三张牌');\r\n\t\t\t\t\ttarget.chooseJunlingControl(player,result.junling,result.targets).set('prompt','节钺').set('choiceList',choiceList).set('ai',function(){\r\n\t\t\t\t\t\tif(get.attitude(target,player)>0) return get.junlingEffect(player,result.junling,target,result.targets,target)>1?0:1;\r\n\t\t\t\t\t\treturn get.junlingEffect(player,result.junling,target,result.targets,target)>=-1?0:1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(result.index==0){\r\n\t\t\t\t\t\ttarget.carryOutJunling(player,event.junling,targets);\r\n\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse player.addTempSkill('gzjieyue_eff');\r\n\t\t\t\t},\r\n\t\t\t\tai:{threaten:2},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\teff:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\ttrigger:{player:'phaseDrawBegin2'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn !event.numFixed;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\ttrigger.num+=3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\taudio:['jieyue',2],\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tjianglue:{\r\n\t\t\t\tlimited:true,\r\n\t\t\t\taudio:2,\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tprepare:function(cards,player){\r\n\t\t\t\t\tvar targets=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isFriendOf(player)||current.isUnseen();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tplayer.line(targets,'fire');\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.awakenSkill('jianglue');\r\n\t\t\t\t\tplayer.addTempSkill('jianglue_count');\r\n\t\t\t\t\tplayer.chooseJunlingFor(player).set('prompt','选择一张军令牌，令与你势力相同的其他角色选择是否执行');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.junling=result.junling;\r\n\t\t\t\t\tevent.targets=result.targets;\r\n\t\t\t\t\tevent.players=game.filterPlayer(function(current){\r\n\t\t\t\t\t\tif(current==player) return false;\r\n\t\t\t\t\t\treturn current.isFriendOf(player)||current.isUnseen();\r\n\t\t\t\t\t}).sort(lib.sort.seat);\r\n\t\t\t\t\tevent.num=0;\r\n\t\t\t\t\tevent.filterName=function(name){\r\n\t\t\t\t\t\treturn lib.character[name][1]==player.identity&&!get.is.double(name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(num<event.players.length) event.current=event.players[num];\r\n\t\t\t\t\tif(event.current&&event.current.isAlive()){\r\n\t\t\t\t\t\tevent.showCharacter=false;\r\n\t\t\t\t\t\tvar choiceList=['执行该军令，增加一点体力上限，然后回复一点体力','不执行该军令'];\r\n\t\t\t\t\t\tif(event.current.isFriendOf(player)) event.current.chooseJunlingControl(player,event.junling,targets).set('prompt','将略').set('choiceList',choiceList).set('ai',function(){return 0});\r\n\t\t\t\t\t\telse if((event.filterName(event.current.name1)||event.filterName(event.current.name2))&&event.current.wontYe(player.identity)){\r\n\t\t\t\t\t\t\tevent.showCharacter=true;\r\n\t\t\t\t\t\t\tchoiceList[0]='明置一张武将牌以'+choiceList[0];\r\n\t\t\t\t\t\t\tchoiceList[1]='不明置武将牌且'+choiceList[1];\r\n\t\t\t\t\t\t\tevent.current.chooseJunlingControl(player,event.junling,targets).set('prompt','将略').set('choiceList',choiceList).set('ai',function(){return 0});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse event.current.chooseJunlingControl(player,event.junling,targets).set('prompt','将略').set('controls',['ok']);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.goto(4);\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tevent.carry=false;\r\n\t\t\t\t\tif(result.index==0&&result.control!='ok'){\r\n\t\t\t\t\t\tevent.carry=true;\r\n\t\t\t\t\t\tif(event.showCharacter){\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\tif(event.filterName(event.current.name1)) list.push('主将');\r\n\t\t\t\t\t\t\tif(event.filterName(event.current.name2)) list.push('副将');\r\n\t\t\t\t\t\t\tif(list.length>1) event.current.chooseControl(['主将','副将']).set('ai',function(){\r\n\t\t\t\t\t\t\t\tif(player.name1=='gz_fazheng') return 0;\r\n\t\t\t\t\t\t\t\tif(player.name2=='gz_fazheng') return 1;\r\n\t\t\t\t\t\t\t\treturn Math.random()>0.5?0:1;\r\n\t\t\t\t\t\t\t}).prompt='选择并展示一张武将牌，然后执行军令';\r\n\t\t\t\t\t\t\telse event._result={index:list[0]=='主将'?0:1};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tif(!event.list) event.list=[player];\r\n\t\t\t\t\tif(event.carry){\r\n\t\t\t\t\t\tif(event.showCharacter) event.current.showCharacter(result.index);\r\n\t\t\t\t\t\tevent.current.carryOutJunling(player,event.junling,targets);\r\n\t\t\t\t\t\tevent.list.push(event.current);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.num++;\r\n\t\t\t\t\tif(event.num<event.players.length) event.goto(2);\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tevent.num=0;\r\n\t\t\t\t\tplayer.$.jianglue_count=0;\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tif(event.list[num].isAlive()){\r\n\t\t\t\t\t\tevent.list[num].gainMaxHp(true);\r\n\t\t\t\t\t\tevent.list[num].recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.num++;\r\n\t\t\t\t\t'step 7'\r\n\t\t\t\t\tif(event.num<event.list.length) event.goto(6);\r\n\t\t\t\t\telse if(player.$.jianglue_count>0) player.draw(player.$.jianglue_count);\r\n\t\t\t\t},\r\n\t\t\t\tmarktext:'略',\r\n\t\t\t\tskillAnimation:'epic',\r\n\t\t\t\tanimationColor:'soil',\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:4,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player){\r\n\t\t\t\t\t\t\tif(player.isUnseen()&&player.wontYe()){\r\n\t\t\t\t\t\t\t\tif(get.population(player._group)>=game.players.length/4) return 1;\r\n\t\t\t\t\t\t\t\treturn Math.random()>0.7?1:0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse return 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tcount:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\ttrigger:{global:'recoverAfter'},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(event){return event.getParent('jianglue')},\r\n\t\t\t\t\t\tcontent:function(){player.$.jianglue_count++}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzxuanhuo:{\r\n\t\t\t\tglobal:'gzxuanhuo_others',\r\n\t\t\t\tderivation:['fz_wusheng','fz_gzpaoxiao','fz_new_longdan','fz_new_tieji','fz_liegong','fz_xinkuanggu'],\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:function(player,target){\r\n\t\t\t\t\t\tif(game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current!=target&&current.isFriendOf(target);\r\n\t\t\t\t\t\t})) return 1.5;\r\n\t\t\t\t\t\treturn 0.5;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tothers:{\r\n\t\t\t\t\t\tenable:'phaseUse',\r\n\t\t\t\t\t\tusable:1,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn (!player.isUnseen())&&player.countCards('h')>0&&game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn current!=player&&current.hasSkill('gzxuanhuo')&&player.isFriendOf(current);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprompt:'弃置一张手牌，然后获得以下技能中的一个：〖武圣〗〖咆哮〗〖龙胆〗〖铁骑〗〖烈弓〗〖狂骨〗',\r\n\t\t\t\t\t\tposition:'h',\r\n\t\t\t\t\t\tfilterCard:true,\r\n\t\t\t\t\t\tcheck:function(card){\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\tif(player.hasSkill('gzpaoxiao',true)||player.getEquip('zhuge')) return 0;\r\n\t\t\t\t\t\t\tif(player.countCards('h',function(cardx){\r\n\t\t\t\t\t\t\t\treturn cardx!=card&&cardx.name=='sha'&&player.hasUseTarget(cardx);\r\n\t\t\t\t\t\t\t})<(player.getCardUsable('sha')+1)) return 0;\r\n\t\t\t\t\t\t\treturn 7-get.value(card);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=['wusheng','gzpaoxiao','new_longdan','new_tieji','liegong','xinkuanggu'];\r\n\t\t\t\t\t\t\tplayer.chooseControl(list).set('ai',function(){\r\n\t\t\t\t\t\t\t\tif(list.contains('gzpaoxiao')) return 'gzpaoxiao';\r\n\t\t\t\t\t\t\t\treturn list.randomGet();\r\n\t\t\t\t\t\t\t}).set('prompt','选择并获得一项技能直到回合结束');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tplayer.popup(result.control);\r\n\t\t\t\t\t\t\tplayer.addTempSkill('fz_'+result.control);\r\n\t\t\t\t\t\t\tgame.log(player,'获得了技能','#g【'+get.translation(result.control)+'】');\r\n\t\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforceaudio:true,\r\n\t\t\t\t\t\taudio:['xuanhuo',2],\r\n\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\torder:8,\r\n\t\t\t\t\t\t\tresult:{player:1},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\t//used:{},\r\n\t\t\t\t},\r\n\t\t\t\taudio:['xuanhuo',2],\r\n\t\t\t},\r\n\t\t\tfz_gzpaoxiao:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\tinherit:'gzpaoxiao',\r\n\t\t\t},\r\n\t\t\tfz_new_tieji:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\tinherit:'new_tieji',\r\n\t\t\t},\r\n\t\t\tfz_wusheng:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\tinherit:'wusheng',\r\n\t\t\t},\r\n\t\t\tfz_liegong:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\tinherit:'liegong',\r\n\t\t\t},\r\n\t\t\tfz_xinkuanggu:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\tinherit:'xinkuanggu',\r\n\t\t\t},\r\n\t\t\tfz_new_longdan:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\tgroup:[\"fz_new_longdan_sha\",\"fz_new_longdan_shan\",\"fz_new_longdan_draw\",\"fz_new_longdan_shamiss\",\"fz_new_longdan_shanafter\"],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tshanafter:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\taudio:\"fz_new_longdan\",\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:\"useCard\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t//priority:1,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.skill=='fz_new_longdan_shan'&&event.getParent(2).name=='sha';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\t\t\tplayer.chooseTarget(\"是否发动【龙胆】令一名其他角色回复1点体力？\",function(card,player,target){\r\n\t\t\t\t\t\t\t\treturn target!=_status.event.source&&target!=player&&target.isDamaged();\r\n\t\t\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\t\t\treturn get.attitude(_status.event.player,target);\r\n\t\t\t\t\t\t\t}).set('source',trigger.getParent(2).player);\r\n\t\t\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t\t\tif(result.bool&&result.targets&&result.targets.length){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('fz_new_longdan',result.targets[0]);\r\n\t\t\t\t\t\t\t\tresult.targets[0].recover();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tshamiss:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\taudio:\"fz_new_longdan\",\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:\"shaMiss\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.skill=='fz_new_longdan_sha';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\t\t\tplayer.chooseTarget(\"是否发动【龙胆】对一名其他角色造成1点伤害？\",function(card,player,target){\r\n\t\t\t\t\t\t\t\treturn target!=_status.event.target&&target!=player;\r\n\t\t\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\t\t\treturn -get.attitude(_status.event.player,target);\r\n\t\t\t\t\t\t\t}).set('target',trigger.target);\r\n\t\t\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t\t\tif(result.bool&&result.targets&&result.targets.length){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('fz_new_longdan',result.targets[0]);\r\n\t\t\t\t\t\t\t\tresult.targets[0].damage();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdraw:{\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:[\"useCard\",\"respond\"],\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\taudio:\"fz_new_longdan\",\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tlocked:false,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(!get.zhu(player,'shouyue')) return false;\r\n\t\t\t\t\t\t\treturn event.skill=='fz_new_longdan_sha'||event.skill=='fz_new_longdan_shan';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t\t//player.$.fanghun2++;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsha:{\r\n\t\t\t\t\t\taudio:\"fz_new_longdan\",\r\n\t\t\t\t\t\tenable:[\"chooseToUse\",\"chooseToRespond\"],\r\n\t\t\t\t\t\tfilterCard:{\r\n\t\t\t\t\t\t\tname:\"shan\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tviewAs:{\r\n\t\t\t\t\t\t\tname:\"sha\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\t\t\tif(!player.countCards('hs','shan')) return false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprompt:\"将一张闪当杀使用或打出\",\r\n\t\t\t\t\t\tposition:'hs',\r\n\t\t\t\t\t\tcheck:function(){return 1},\r\n\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\teffect:{\r\n\t\t\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\t\t\tif(get.tag(card,'respondSha')&&current<0) return 0.6\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\trespondSha:true,\r\n\t\t\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\t\t\tif(!player.countCards('hs','shan')) return false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\torder:function(){\r\n\t\t\t\t\t\t\t\treturn get.order({name:'sha'})+0.1;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tshan:{\r\n\t\t\t\t\t\taudio:\"fz_new_longdan\",\r\n\t\t\t\t\t\tenable:['chooseToRespond','chooseToUse'],\r\n\t\t\t\t\t\tfilterCard:{\r\n\t\t\t\t\t\t\tname:\"sha\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tviewAs:{\r\n\t\t\t\t\t\t\tname:\"shan\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tposition:'hs',\r\n\t\t\t\t\t\tprompt:\"将一张杀当闪使用或打出\",\r\n\t\t\t\t\t\tcheck:function(){return 1},\r\n\t\t\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\t\t\tif(!player.countCards('hs','sha')) return false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\trespondShan:true,\r\n\t\t\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\t\t\tif(!player.countCards('hs','sha')) return false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\teffect:{\r\n\t\t\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\t\t\tif(get.tag(card,'respondShan')&&current<0) return 0.6\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzenyuan:{\r\n\t\t\t\tlocked:true,\r\n\t\t\t\taudio:['enyuan',2],\r\n\t\t\t\tgroup:['gzenyuan_gain','gzenyuan_damage'],\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tai:{\r\n\t\t\t\t\tmaixie_defend:true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(player.hasSkillTag('jueqing',false,target)) return [1,-1.5];\r\n\t\t\t\t\t\t\tif(!target.hasFriend()) return;\r\n\t\t\t\t\t\t\tif(get.tag(card,'damage')) return [1,0,0,-0.7];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tgain:{\r\n\t\t\t\t\t\ttrigger:{target:'useCardToTargeted'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.card.name=='tao'&&event.player!=player;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tlogTarget:'player',\r\n\t\t\t\t\t\tcontent:function(){trigger.player.draw()},\r\n\t\t\t\t\t\taudio:'enyuan1',\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdamage:{\r\n\t\t\t\t\t\ttrigger:{player:'damageEnd'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.source&&event.source!=player&&event.num>0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tplayer.logSkill('enyuan_damage',trigger.source);\r\n\t\t\t\t\t\t\ttrigger.source.chooseCard('交给'+get.translation(player)+'一张手牌，或失去一点体力','h').set('ai',function(card){\r\n\t\t\t\t\t\t\t\tif(get.attitude(_status.event.player,_status.event.getParent().player)>0) return 11-get.value(card);\r\n\t\t\t\t\t\t\t\treturn 7-get.value(card);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tplayer.gain(result.cards[0],trigger.source,'giveAuto');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse trigger.source.loseHp();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\taudio:'enyuan2',\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\t\t\r\n\t\t\tgzjushou:{\r\n\t\t\t\taudio:\"xinjushou\",\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"phaseJieshuBegin\",\r\n\t\t\t\t},\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.num=game.countGroup();\r\n\t\t\t\t\tplayer.draw(event.num);\r\n\t\t\t\t\tif(event.num>2) player.turnOver();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.chooseCard('h',true,'弃置一张手牌，若以此法弃置的是装备牌，则你改为使用之').set('ai',function(card){\r\n\t\t\t\t\t\tif(get.type(card)=='equip'){\r\n\t\t\t\t\t\t\treturn 5-get.value(card);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn -get.value(card);\r\n\t\t\t\t\t}).set('filterCard',lib.filter.cardDiscardable);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.bool&&result.cards.length){\r\n\t\t\t\t\t\tif(get.type(result.cards[0])=='equip'&&player.hasUseTarget(result.cards[0])){\r\n\t\t\t\t\t\t\tplayer.chooseUseTarget(result.cards[0],true,'nopopup');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tplayer.discard(result.cards[0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(card.name=='guiyoujie') return [0,1];\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"new_duanliang\":{\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\toff:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\ttargetInRange:function(card,player,target){\r\n\t\t\t\t\t\tif(card.name=='bingliang'){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\taudio:\"duanliang1\",\r\n\t\t\t\tenable:\"chooseToUse\",\r\n\t\t\t\tfilterCard:function(card){\r\n\t\t\t\t\tif(get.type(card)!='basic'&&get.type(card)!='equip') return false;\r\n\t\t\t\t\treturn get.color(card)=='black';\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(player.hasSkill('new_duanliang_off')) return false;\r\n\t\t\t\t\treturn player.countCards('hes',{type:['basic','equip'],color:'black'})\r\n\t\t\t\t},\r\n\t\t\t\tposition:\"hes\",\r\n\t\t\t\tviewAs:{\r\n\t\t\t\t\tname:\"bingliang\",\r\n\t\t\t\t},\r\n\t\t\t\tonuse:function(result,player){\r\n\t\t\t\t\tif(get.distance(player,result.targets[0])>2) player.addTempSkill('new_duanliang_off');\r\n\t\t\t\t},\r\n\t\t\t\tprompt:\"将一黑色的基本牌或装备牌当兵粮寸断使用\",\r\n\t\t\t\tcheck:function(card){return 6-get.value(card)},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:9,\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\torder:1,\r\n\t\t\t\t\t\tuseful:1,\r\n\t\t\t\t\t\tvalue:4,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(target.hasJudge('caomu')) return 0;\r\n\t\t\t\t\t\t\treturn -1.5/Math.sqrt(target.countCards('h')+1);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\tskip:\"phaseDraw\",\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tnew_shushen:{\r\n\t\t\t\taudio:\"shushen\",\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"recoverAfter\",\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.num=trigger.num||1;\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt2('new_shushen'),function(card,player,target){\r\n\t\t\t\t\t\treturn target!=player;\r\n\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\treturn get.attitude(_status.event.player,target);\r\n\t\t\t\t\t}).setHiddenSkill('new_shushen');\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('new_shushen',result.targets);\r\n\t\t\t\t\t\tresult.targets[0].draw();\r\n\t\t\t\t\t\tif(event.num>1){\r\n\t\t\t\t\t\t\tevent.num--;\r\n\t\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:0.8,\r\n\t\t\t\t\texpose:0.1,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"new_luanji\":{\r\n\t\t\t\taudio:\"luanji\",\r\n\t\t\t\tenable:\"phaseUse\",\r\n\t\t\t\tviewAs:{\r\n\t\t\t\t\tname:\"wanjian\",\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard:function(card,player){\r\n\t\t\t\t\tif(!player.$.new_luanji) return true;\r\n\t\t\t\t\treturn !player.$.new_luanji.contains(get.suit(card));\r\n\t\t\t\t},\r\n\t\t\t\tselectCard:2,\r\n\t\t\t\tposition:'hs',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('hs',function(card){\r\n\t\t\t\t\t\treturn !player.$.new_luanji||!player.$.new_luanji.contains(get.suit(card));\r\n\t\t\t\t\t})>1;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\tvar targets=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn player.canUse('wanjian',current);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar num=0;\r\n\t\t\t\t\tfor(var i=0;i<targets.length;i++){\r\n\t\t\t\t\t\tvar eff=get.sgn(get.effect(targets[i],{name:'wanjian'},player,player));\r\n\t\t\t\t\t\tif(targets[i].hp==1){\r\n\t\t\t\t\t\t\teff*=1.5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnum+=eff;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!player.needsToDiscard(-1)){\r\n\t\t\t\t\t\tif(targets.length>=7){\r\n\t\t\t\t\t\t\tif(num<2) return 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(targets.length>=5){\r\n\t\t\t\t\t\t\tif(num<1.5) return 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tgroup:[\"new_luanji_count\",\"new_luanji_reset\",\"new_luanji_respond\"],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\treset:{\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:\"phaseAfter\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.$.new_luanji?true:false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tdelete player.$.new_luanji;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcount:{\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:\"useCard\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(event){\r\n\t\t\t\t\t\t\treturn event.skill=='new_luanji';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tif(!player.$.new_luanji){\r\n\t\t\t\t\t\t\t\tplayer.$.new_luanji=[];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<trigger.cards.length;i++){\r\n\t\t\t\t\t\t\t\tplayer.$.new_luanji.add(get.suit(trigger.cards[i]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t},\r\n\t\t\t\t\trespond:{\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tglobal:\"respond\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(event){\r\n\t\t\t\t\t\t\tif(event.player.isUnseen()) return false;\r\n\t\t\t\t\t\t\treturn event.getParent(2).skill=='new_luanji'&&event.player.sameIdentityAs(_status.currentPhase);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\ttrigger.player.draw();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"new_qingcheng\":{\r\n\t\t\t\taudio:'qingcheng',\r\n\t\t\t\tenable:\"phaseUse\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('he',{color:'black'})&&game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current!=player&&!current.isUnseen(2);\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard:{\r\n\t\t\t\t\tcolor:\"black\",\r\n\t\t\t\t},\r\n\t\t\t\tposition:\"he\",\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn !target.isUnseen(2);\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\treturn 6-get.value(card,_status.event.player);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.target=target;\r\n\t\t\t\t\tevent.done=false;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(get.is.jun(event.target)){\r\n\t\t\t\t\t\tevent._result={control:'副将'};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar choice='主将';\r\n\t\t\t\t\t\tvar skills=lib.character[event.target.name2][3];\r\n\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\tvar info=get.info(skills[i]);\r\n\t\t\t\t\t\t\tif(info&&info.ai&&info.ai.maixie){\r\n\t\t\t\t\t\t\t\tchoice='副将';break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(event.target.name=='gz_zhoutai'){\r\n\t\t\t\t\t\t\tchoice='主将';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(event.target.name2=='gz_zhoutai'){\r\n\t\t\t\t\t\t\tchoice='副将';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.chooseControl('主将','副将',function(){\r\n\t\t\t\t\t\t\treturn _status.event.choice;\r\n\t\t\t\t\t\t}).set('prompt','暗置'+get.translation(event.target)+'的一张武将牌').set('choice',choice);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.control=='主将'){\r\n\t\t\t\t\t\tevent.target.hideCharacter(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.target.hideCharacter(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.target.addTempSkill('qingcheng_ai');\r\n\t\t\t\t\tif(get.type(cards[0])=='equip'&&!event.done){\r\n\t\t\t\t\tplayer.chooseTarget('是否暗置一名武将牌均为暗置的角色的一张武将牌？',function(card,player,target){\r\n\t\t\t\t\t\treturn target!=player&&!target.isUnseen(2);\r\n\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\treturn -get.attitude(_status.event.player,target);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(result.bool&&result.targets&&result.targets.length){\r\n\t\t\t\t\t\tplayer.line(result.targets[0],'green');\r\n\t\t\t\t\t\tevent.done=true;\r\n\t\t\t\t\t\tevent.target=result.targets[0];\r\n\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:8,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(target.hp<=0) return -5;\r\n\t\t\t\t\t\t\tif(player.getStat().skill.new_qingcheng) return 0;\r\n\t\t\t\t\t\t\tif(!target.hasSkillTag('maixie')) return 0;\r\n\t\t\t\t\t\t\tif(get.attitude(player,target)>=0) return 0;\r\n\t\t\t\t\t\t\tif(player.hasCard(function(card){\r\n\t\t\t\t\t\t\t\treturn get.tag(card,'damage')&&player.canUse(card,target,true,true);\r\n\t\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\t\tif(target.maxHp>3) return -0.5;\r\n\t\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"new_kongcheng\":{\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tif(player.$.new_kongcheng==undefined) player.$.new_kongcheng=[];\r\n\t\t\t\t},\r\n\t\t\t\tfixedGain:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(cards){\r\n\t\t\t\t\t\tvar owner=event.source||get.owner(cards[0]);\r\n\t\t\t\t\t\tif(owner){\r\n\t\t\t\t\t\t\tvar next=owner.lose(cards,ui.special,'toStorage').set('type','gain').set('forceDie',true);\r\n\t\t\t\t\t\t\tif(event.animate=='give'||event.visible==true) next.visible=true;\r\n\t\t\t\t\t\t\tevent.relatedLose=next;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.$.new_kongcheng.addArray(cards);\r\n\t\t\t\t\t\tplayer.markSkill('new_kongcheng');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(event.animate=='draw'){\r\n\t\t\t\t\t\tplayer.$draw(cards.length);\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t},get.delayx(500,500));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.animate=='gain'){\r\n\t\t\t\t\t\tplayer.$gain(cards);\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t},get.delayx(700,700));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.animate=='gain2'||event.animate=='draw2'){\r\n\t\t\t\t\t\tvar gain2t=300;\r\n\t\t\t\t\t\tif(player.$gain2(cards)&&player==game.me){\r\n\t\t\t\t\t\t\tgain2t=500;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t},get.delayx(gain2t,gain2t));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.source&&(event.animate=='give'||event.animate=='giveAuto')){\r\n\t\t\t\t\t\tif(event.animate=='give') event.source['$'+event.animate](cards,player);\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tvar givemap={hs:[],ots:[]};\r\n\t\t\t\t\t\t\tfor(var i=0;i<cards.length;i++){\r\n\t\t\t\t\t\t\t\tgivemap[cards[i].original=='h'?'hs':'ots'].push(cards[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(givemap.hs.length) event.source.$giveAuto(givemap.hs,player);\r\n\t\t\t\t\t\t\tif(givemap.ots.length) event.source.$give(givemap.ots,player);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t},get.delayx(500,500));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup:[\"new_kongcheng_gain\",\"new_kongcheng_got\"],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tgain:{\r\n\t\t\t\t\t\taudio:\"kongcheng\",\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:\"gainBegin\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.source&&event.source!=player&&player!=_status.currentPhase&&!event.bySelf&&player.countCards('h')==0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\ttrigger.setContent(lib.skill.new_kongcheng.fixedGain);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tgot:{\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:\"phaseDrawBegin1\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.$.new_kongcheng.length>0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.gain(player.$.new_kongcheng,'draw','fromStorage');\r\n\t\t\t\t\t\t\tplayer.$.new_kongcheng=[];\r\n\t\t\t\t\t\t\tgame.addVideo('storage',player,['new_kongcheng',get.cardsInfo(player.$.new_kongcheng),'cards']);\r\n\t\t\t\t\t\t\tplayer.unmarkSkill('new_kongcheng');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\taudio:\"kongcheng\",\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\ttarget:\"useCardToTarget\",\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn get.effect(event.target,event.card,event.player,player)<0;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('h')==0&&(event.card.name=='sha'||event.card.name=='juedou');\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.getParent().targets.remove(player);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(target.countCards('h')==0&&(card.name=='sha'||card.name=='juedou')) return 'zeroplayertarget';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tonunmark:function(storage,player){\r\n\t\t\t\t\t\tif(storage&&storage.length){\r\n\t\t\t\t\t\t\tplayer.$throw(storage,1000);\r\n\t\t\t\t\t\t\tgame.cardsDiscard(storage);\r\n\t\t\t\t\t\t\tgame.log(storage,'被置入了弃牌堆');\r\n\t\t\t\t\t\t\tstorage.length=0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmark:function(dialog,content,player){\r\n\t\t\t\t\t\tif(content&&content.length){\r\n\t\t\t\t\t\t\tif(player==game.me||player.isUnderControl()){\r\n\t\t\t\t\t\t\t\tdialog.addAuto(content);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\treturn '共有'+get.cnNumber(content.length)+'张牌';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcontent:function(content,player){\r\n\t\t\t\t\t\tif(content&&content.length){\r\n\t\t\t\t\t\t\tif(player==game.me||player.isUnderControl()){\r\n\t\t\t\t\t\t\t\treturn get.translation(content);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn '共有'+get.cnNumber(content.length)+'张牌';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"new_keji\":{\r\n\t\t\t\taudio:\"keji\",\r\n\t\t\t\tforced:true,\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"phaseDiscardBegin\",\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tplayer.getHistory('useCard',function(evt){\r\n\t\t\t\t\t\tif(evt.isPhaseUsing(player)){\r\n\t\t\t\t\t\t\tvar color=get.color(evt.card);\r\n\t\t\t\t\t\t\tif(color!='nocolor') list.add(color);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn list.length<=1;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.addTempSkill('keji_add','phaseAfter');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"keji_add\":{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tmaxHandcard:function(player,num){\r\n\t\t\t\t\t\treturn num+4;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"new_mouduan\":{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"phaseJieshuBegin\",\r\n\t\t\t\t},\r\n\t\t\t\t//priority:2,\r\n\t\t\t\taudio:\"botu\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar history=player.getHistory('useCard');\r\n\t\t\t\t\tvar suits=[];\r\n\t\t\t\t\tvar types=[];\r\n\t\t\t\t\tfor(var i=0;i<history.length;i++){\r\n\t\t\t\t\t\tvar suit=get.suit(history[i].card);\r\n\t\t\t\t\t\tif(suit) suits.add(suit);\r\n\t\t\t\t\t\ttypes.add(get.type(history[i].card))\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn suits.length>=4||types.length>=3;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn player.canMoveCard(true);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.moveCard();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"new_longdan\":{\r\n\t\t\t\tgroup:[\"new_longdan_sha\",\"new_longdan_shan\",\"new_longdan_draw\",\"new_longdan_shamiss\",\"new_longdan_shanafter\"],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tshanafter:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\taudio:\"longdan_sha\",\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:\"useCard\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t//priority:1,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.skill=='new_longdan_shan'&&event.getParent(2).name=='sha';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\t\t\tplayer.chooseTarget(\"是否发动【龙胆】令一名其他角色回复1点体力？\",function(card,player,target){\r\n\t\t\t\t\t\t\t\treturn target!=_status.event.source&&target!=player&&target.isDamaged();\r\n\t\t\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\t\t\treturn get.attitude(_status.event.player,target);\r\n\t\t\t\t\t\t\t}).set('source',trigger.getParent(2).player);\r\n\t\t\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t\t\tif(result.bool&&result.targets&&result.targets.length){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('new_longdan',result.targets[0]);\r\n\t\t\t\t\t\t\t\tresult.targets[0].recover();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tshamiss:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\taudio:\"longdan_sha\",\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:\"shaMiss\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.skill=='new_longdan_sha';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\t\t\tplayer.chooseTarget(\"是否发动【龙胆】对一名其他角色造成1点伤害？\",function(card,player,target){\r\n\t\t\t\t\t\t\t\treturn target!=_status.event.target&&target!=player;\r\n\t\t\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\t\t\treturn -get.attitude(_status.event.player,target);\r\n\t\t\t\t\t\t\t}).set('target',trigger.target);\r\n\t\t\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t\t\tif(result.bool&&result.targets&&result.targets.length){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('new_longdan',result.targets[0]);\r\n\t\t\t\t\t\t\t\tresult.targets[0].damage();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdraw:{\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:[\"useCard\",\"respond\"],\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\taudio:\"longdan_sha\",\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tlocked:false,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(!get.zhu(player,'shouyue')) return false;\r\n\t\t\t\t\t\t\treturn event.skill=='new_longdan_sha'||event.skill=='new_longdan_shan';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t\t//player.$.fanghun2++;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsha:{\r\n\t\t\t\t\t\taudio:\"longdan_sha\",\r\n\t\t\t\t\t\tenable:[\"chooseToUse\",\"chooseToRespond\"],\r\n\t\t\t\t\t\tfilterCard:{\r\n\t\t\t\t\t\t\tname:\"shan\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tviewAs:{\r\n\t\t\t\t\t\t\tname:\"sha\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tposition:'hs',\r\n\t\t\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\t\t\tif(!player.countCards('hs','shan')) return false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprompt:\"将一张闪当杀使用或打出\",\r\n\t\t\t\t\t\tcheck:function(){return 1},\r\n\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\teffect:{\r\n\t\t\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\t\t\tif(get.tag(card,'respondSha')&&current<0) return 0.6\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\trespondSha:true,\r\n\t\t\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\t\t\tif(!player.countCards('hs','shan')) return false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\torder:function(){\r\n\t\t\t\t\t\t\t\treturn get.order({name:'sha'})+0.1;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tshan:{\r\n\t\t\t\t\t\taudio:\"longdan_sha\",\r\n\t\t\t\t\t\tenable:['chooseToRespond','chooseToUse'],\r\n\t\t\t\t\t\tfilterCard:{\r\n\t\t\t\t\t\t\tname:\"sha\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tviewAs:{\r\n\t\t\t\t\t\t\tname:\"shan\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tposition:'hs',\r\n\t\t\t\t\t\tprompt:\"将一张杀当闪使用或打出\",\r\n\t\t\t\t\t\tcheck:function(){return 1},\r\n\t\t\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\t\t\tif(!player.countCards('hs','sha')) return false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai:{\r\n\t\t\t\t\t\t\trespondShan:true,\r\n\t\t\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\t\t\tif(!player.countCards('hs','sha')) return false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\teffect:{\r\n\t\t\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\t\t\tif(get.tag(card,'respondShan')&&current<0) return 0.6\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzpaoxiao:{\r\n\t\t\t\taudio:\"paoxiao\",\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"useCard\",\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(_status.currentPhase!=player) return false;\r\n\t\t\t\t\tif(event.card.name!='sha') return false;\r\n\t\t\t\t\tvar history=player.getHistory('useCard',function(evt){\r\n\t\t\t\t\t\treturn evt.card.name=='sha';\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn history&&history.indexOf(event)==1;\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tcardUsable:function(card,player,num){\r\n\t\t\t\t\t\tif(card.name=='sha') return Infinity;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tunequip:true,\r\n\t\t\t\t\tskillTagFilter:function(player,tag,arg){\r\n\t\t\t\t\t\tif(!get.zhu(player,'shouyue')) return false;\r\n\t\t\t\t\t\tif(arg&&arg.name=='sha') return true;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"new_kurou\":{\r\n\t\t\t\taudio:\"rekurou\",\r\n\t\t\t\tenable:\"phaseUse\",\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilterCard:true,\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\treturn 8-get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tposition:\"he\",\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t\tplayer.draw(3);\r\n\t\t\t\t\tplayer.addTempSkill('kurou_effect','phaseAfter');\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:8,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player){\r\n\t\t\t\t\t\t\tif(player.hp<=2) return player.countCards('h')==0?1:0;\r\n\t\t\t\t\t\t\tif(player.countCards('h',{name:'sha',color:'red'})) return 1;\r\n\t\t\t\t\t\t\treturn player.countCards('h')<=player.hp?1:0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"kurou_effect\":{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tcardUsable:function(card,player,num){\r\n\t\t\t\t\t\tif(card.name=='sha') return num+1;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"new_chuli\":{\r\n\t\t\t\taudio:\"chulao\",\r\n\t\t\t\tenable:\"phaseUse\",\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\tif(player==target) return false;\r\n\t\t\t\t\tfor(var i=0;i<ui.selected.targets.length;i++){\r\n\t\t\t\t\t\tif(ui.selected.targets[i].isFriendOf(target)) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn target.countCards('he')>0;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('he')>0;\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard:true,\r\n\t\t\t\tposition:\"he\",\r\n\t\t\t\tselectTarget:[1,3],\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\tif(get.suit(card)=='spade') return 8-get.value(card);\r\n\t\t\t\t\treturn 5-get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tcontentBefore:function(){\r\n\t\t\t\t\tvar evt=event.getParent();\r\n\t\t\t\t\tevt.draw=[];\r\n\t\t\t\t\tif(get.suit(cards[0])=='spade') evt.draw.push(player);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.discardPlayerCard(target,'he',true);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tif(get.suit(result.cards[0])=='spade') event.getParent().draw.push(target);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcontentAfter:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list=event.getParent().draw;\r\n\t\t\t\t\tif(!list.length) event.finish();\r\n\t\t\t\t\telse game.asyncDraw(list);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:-1,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten:1.2,\r\n\t\t\t\t\torder:3,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"baka_hunshang\":{\r\n\t\t\t\tskillAnimation:true,\r\n\t\t\t\tanimationColor:'wood',\r\n\t\t\t\taudio:\"hunzi\",\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tderivation:[\"baka_yingzi\",\"baka_yinghun\"],\r\n\t\t\t\tviceSkill:true,\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tif(player.checkViceSkill('baka_hunshang')&&!player.viceChanged){\r\n\t\t\t\t\t\tplayer.removeMaxHp();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"phaseZhunbeiBegin\",\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.hp<=1;\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\t//priority:3,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.addTempSkill('baka_yingzi','phaseAfter');\r\n\t\t\t\t\tplayer.addTempSkill('baka_yinghun','phaseAfter');\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:function(player,target){\r\n\t\t\t\t\t\tif(target.hp==1) return 2;\r\n\t\t\t\t\t\treturn 0.5;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmaixie:true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(!target.hasFriend()) return;\r\n\t\t\t\t\t\t\tif(get.tag(card,'damage')==1&&target.hp==2&&!target.isTurnedOver()&&\r\n\t\t\t\t\t\t\t_status.currentPhase!=target&&get.distance(_status.currentPhase,target,'absolute')<=3) return [0.5,1];\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"baka_yinghun\":{\r\n\t\t\t\tinherit:\"gzyinghun\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.isDamaged();\r\n\t\t\t\t},\r\n\t\t\t\taudio:'yinghun_sunce',\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"phaseZhunbeiBegin\",\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt2('gzyinghun'),function(card,player,target){\r\n\t\t\t\t\t\treturn player!=target;\r\n\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tif(player.maxHp-player.hp==1&&target.countCards('he')==0){\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(get.attitude(_status.event.player,target)>0){\r\n\t\t\t\t\t\t\treturn 10+get.attitude(_status.event.player,target);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(player.maxHp-player.hp==1){\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.num=player.maxHp-player.hp;\r\n\t\t\t\t\t\tplayer.logSkill(event.name,result.targets);\r\n\t\t\t\t\t\tevent.target=result.targets[0];\r\n\t\t\t\t\t\tif(event.num==1){\r\n\t\t\t\t\t\t\tevent.directcontrol=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tvar str1='摸'+get.cnNumber(event.num,true)+'弃一';\r\n\t\t\t\t\t\t\tvar str2='摸一弃'+get.cnNumber(event.num,true);\r\n\t\t\t\t\t\t\tplayer.chooseControl(str1,str2,function(event,player){\r\n\t\t\t\t\t\t\t\treturn _status.event.choice;\r\n\t\t\t\t\t\t\t}).set('choice',get.attitude(player,event.target)>0?str1:str2);\r\n\t\t\t\t\t\t\tevent.str=str1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(event.directcontrol||result.control==event.str){\r\n\t\t\t\t\t\tevent.target.draw(event.num);\r\n\t\t\t\t\t\tevent.target.chooseToDiscard(true,'he');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.target.draw();\r\n\t\t\t\t\t\tevent.target.chooseToDiscard(event.num,true,'he');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:function(player,target){\r\n\t\t\t\t\t\tif(target.hp==target.maxHp) return 0.5;\r\n\t\t\t\t\t\tif(target.hp==1) return 2;\r\n\t\t\t\t\t\tif(target.hp==2) return 1.5;\r\n\t\t\t\t\t\treturn 0.5;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmaixie:true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(target.maxHp<=3) return;\r\n\t\t\t\t\t\t\tif(get.tag(card,'damage')){\r\n\t\t\t\t\t\t\t\tif(target.hp==target.maxHp) return [0,1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(get.tag(card,'recover')&&player.hp>=player.maxHp-1) return [0,0];\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"baka_yingzi\":{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tmaxHandcardBase:function(player,num){\r\n\t\t\t\t\t\treturn player.maxHp;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\taudio:'reyingzi_sunce',\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"phaseDrawBegin2\",\r\n\t\t\t\t},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tfilter:function(event){return !event.numFixed},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.3,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzyiji:{\r\n\t\t\t\taudio:\"yiji\",\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"damageEnd\",\r\n\t\t\t\t},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event){\r\n\t\t\t\t\treturn (event.num>0)\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.cards=game.cardsGotoOrdering(get.cards(2)).cards;\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(event.cards.length>1){\r\n\t\t\t\t\t\tplayer.chooseCardButton('将“遗计”牌分配给任意角色',true,event.cards,[1,event.cards.length]).set('ai',function(button){\r\n\t\t\t\t\t\t\tif(ui.selected.buttons.length==0) return 1;\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.cards.length==1){\r\n\t\t\t\t\t\tevent._result={links:event.cards.slice(0),bool:true};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tfor(var i=0;i<result.links.length;i++){\r\n\t\t\t\t\t\t\tevent.cards.remove(result.links[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.togive=result.links.slice(0);\r\n\t\t\t\t\t\tplayer.chooseTarget('将'+get.translation(result.links)+'交给一名角色',true).set('ai',function(target){\r\n\t\t\t\t\t\t\tvar att=get.attitude(_status.event.player,target);\r\n\t\t\t\t\t\t\tif(_status.event.enemy){\r\n\t\t\t\t\t\t\t\treturn -att;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(att>0){\r\n\t\t\t\t\t\t\t\treturn att/(1+target.countCards('h'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\treturn att/100;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).set('enemy',get.value(event.togive[0])<0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tif(result.targets.length){\r\n\t\t\t\t\t\tresult.targets[0].gain(event.togive,'draw');\r\n\t\t\t\t\t\tplayer.line(result.targets[0],'green');\r\n\t\t\t\t\t\tgame.log(result.targets[0],'获得了'+get.cnNumber(event.togive.length)+'张牌');\r\n\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tmaixie:true,\r\n\t\t\t\t\t\"maixie_hp\":true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(get.tag(card,'damage')){\r\n\t\t\t\t\t\t\t\tif(player.hasSkillTag('jueqing',false,target)) return [1,-2];\r\n\t\t\t\t\t\t\t\tif(!target.hasFriend()) return;\r\n\t\t\t\t\t\t\t\tvar num=1;\r\n\t\t\t\t\t\t\t\tif(get.attitude(player,target)>0){\r\n\t\t\t\t\t\t\t\t\tif(player.needsToDiscard()){\r\n\t\t\t\t\t\t\t\t\t\tnum=0.7;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tnum=0.5;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(target.hp>=4) return [1,num*2];\r\n\t\t\t\t\t\t\t\tif(target.hp==3) return [1,num*1.5];\r\n\t\t\t\t\t\t\t\tif(target.hp==2) return [1,num*0.5];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzjieming:{\r\n\t\t\t\taudio:\"jieming\",\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"damageEnd\",\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('gzjieming'),'令一名角色将手牌补至X张（X为其体力上限且至多为5）',function(card,player,target){\r\n\t\t\t\t\t\treturn target.countCards('h')<Math.min(target.maxHp,5);\r\n\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\tvar att=get.attitude(_status.event.player,target);\r\n\t\t\t\t\t\tif(att>2){\r\n\t\t\t\t\t\t\treturn Math.min(5,target.maxHp)-target.countCards('h');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn att/3;\r\n\t\t\t\t\t}).setHiddenSkill('gzjieming');\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('gzjieming',result.targets);\r\n\t\t\t\t\t\tfor(var i=0;i<result.targets.length;i++){\r\n\t\t\t\t\t\t\tresult.targets[i].draw(Math.min(5,result.targets[i].maxHp)-result.targets[i].countCards('h'));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tmaixie:true,\r\n\t\t\t\t\t\"maixie_hp\":true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(get.tag(card,'damage')&&target.hp>1){\r\n\t\t\t\t\t\t\t\tif(player.hasSkillTag('jueqing',false,target)) return [1,-2];\r\n\t\t\t\t\t\t\t\tvar max=0;\r\n\t\t\t\t\t\t\t\tvar players=game.filterPlayer();\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(get.attitude(target,players[i])>0){\r\n\t\t\t\t\t\t\t\t\t\tmax=Math.max(Math.min(5,players[i].hp)-players[i].countCards('h'),max);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tswitch(max){\r\n\t\t\t\t\t\t\t\t\tcase 0:return 2;\r\n\t\t\t\t\t\t\t\t\tcase 1:return 1.5;\r\n\t\t\t\t\t\t\t\t\tcase 2:return [1,2];\r\n\t\t\t\t\t\t\t\t\tdefault:return [0,max];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif((card.name=='tao'||card.name=='caoyao')&&\r\n\t\t\t\t\t\t\t\ttarget.hp>1&&target.countCards('h')<=target.hp) return [0,0];\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzfangzhu:{\r\n\t\t\t\taudio:\"fangzhu\",\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"damageEnd\",\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt2('gzfangzhu'),function(card,player,target){\r\n\t\t\t\t\t\treturn player!=target\r\n\t\t\t\t\t}).setHiddenSkill('gzfangzhu').ai=function(target){\r\n\t\t\t\t\t\tif(target.hasSkillTag('noturn')) return 0;\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tif(get.attitude(_status.event.player,target)==0) return 0;\r\n\t\t\t\t\t\tif(get.attitude(_status.event.player,target)>0){\r\n\t\t\t\t\t\t\tif(target.classList.contains('turnedover')) return 1000-target.countCards('h');\r\n\t\t\t\t\t\t\tif(player.getDamagedHp()<3) return -1;\r\n\t\t\t\t\t\t\treturn 100-target.countCards('h');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(target.classList.contains('turnedover')) return -1;\r\n\t\t\t\t\t\t\tif(player.getDamagedHp()>=3) return -1;\r\n\t\t\t\t\t\t\treturn 1+target.countCards('h');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('gzfangzhu',result.targets);\r\n\t\t\t\t\t\tevent.target=result.targets[0]\r\n\t\t\t\t\t\tevent.target.chooseToDiscard('he').set('ai',function(card){\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\tif(player.isTurnedOver()) return -1;\r\n\t\t\t\t\t\t\treturn (player.hp*player.hp)-Math.max(1,get.value(card));\r\n\t\t\t\t\t\t}).set('prompt','弃置一张牌并失去一点体力；或选择不弃置，将武将牌翻面并摸'+(player.getDamagedHp())+'张牌。');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.target.loseHp();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.target.draw(player.getDamagedHp());\r\n\t\t\t\t\t\tevent.target.turnOver();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tmaixie:true,\r\n\t\t\t\t\t\"maixie_hp\":true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(get.tag(card,'damage')){\r\n\t\t\t\t\t\t\t\tif(player.hasSkillTag('jueqing',false,target)) return [1,-2];\r\n\t\t\t\t\t\t\t\tif(target.hp<=1) return;\r\n\t\t\t\t\t\t\t\tif(!target.hasFriend()) return;\r\n\t\t\t\t\t\t\t\tvar hastarget=false;\r\n\t\t\t\t\t\t\t\tvar turnfriend=false;\r\n\t\t\t\t\t\t\t\tvar players=game.filterPlayer();\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(get.attitude(target,players[i])<0&&!players[i].isTurnedOver()){\r\n\t\t\t\t\t\t\t\t\t\thastarget=true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif(get.attitude(target,players[i])>0&&players[i].isTurnedOver()){\r\n\t\t\t\t\t\t\t\t\t\thastarget=true;\r\n\t\t\t\t\t\t\t\t\t\tturnfriend=true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(get.attitude(player,target)>0&&!hastarget) return;\r\n\t\t\t\t\t\t\t\tif(turnfriend||target.hp==target.maxHp) return [0.5,1];\r\n\t\t\t\t\t\t\t\tif(target.hp>1) return [1,0.5];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tfengyin_main:{\r\n\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\tplayer.addSkillBlocker(skill);\r\n\t\t\t\t},\r\n\t\t\t\tonremove:function(player,skill){\r\n\t\t\t\t\tplayer.removeSkillBlocker(skill);\r\n\t\t\t\t},\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tskillBlocker:function(skill,player){\r\n\t\t\t\t\treturn lib.character[player.name1][3].contains(skill)&&!lib.skill[skill].charlotte&&!get.is.locked(skill,player);\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tmarktext:'主',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:function(storage,player,skill){\r\n\t\t\t\t\t\tvar list=player.getSkills(null,null,false).filter(function(i){\r\n\t\t\t\t\t\t\treturn lib.skill.fengyin_main.skillBlocker(i,player);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(list.length) return '失效技能：'+get.translation(list);\r\n\t\t\t\t\t\treturn '无失效技能';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfengyin_vice:{\r\n\t\t\t\tinit:function(player,skill){\r\n\t\t\t\t\tplayer.addSkillBlocker(skill);\r\n\t\t\t\t},\r\n\t\t\t\tonremove:function(player,skill){\r\n\t\t\t\t\tplayer.removeSkillBlocker(skill);\r\n\t\t\t\t},\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tskillBlocker:function(skill,player){\r\n\t\t\t\t\treturn lib.character[player.name2][3].contains(skill)&&!lib.skill[skill].charlotte&&!get.is.locked(skill,player);\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tmarktext:'主',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:function(storage,player,skill){\r\n\t\t\t\t\t\tvar list=player.getSkills(null,null,false).filter(function(i){\r\n\t\t\t\t\t\t\treturn lib.skill.fengyin_vice.skillBlocker(i,player);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(list.length) return '失效技能：'+get.translation(list);\r\n\t\t\t\t\t\treturn '无失效技能';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\"new_tieji\":{\r\n\t\t\t\taudio:\"retieji\",\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"useCardToPlayered\",\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn get.attitude(player,event.target)<0;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event){\r\n\t\t\t\t\treturn event.card.name=='sha';\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:\"target\",\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\" \r\n\t\t\t\t\tvar target=trigger.target;\r\n\t\t\t\t\tvar controls=[];\r\n\t\t\t\t\tif(get.zhu(player,'shouyue')){\r\n\t\t\t\t\t\tif(!target.isUnseen(0)) target.addTempSkill('fengyin_main');\r\n\t\t\t\t\t\tif(!target.isUnseen(1)) target.addTempSkill('fengyin_vice');\r\n\t\t\t\t\t\tevent.goto(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!target.isUnseen(0)&&!target.hasSkill('fengyin_main')) controls.push(\"主将\");\r\n\t\t\t\t\tif(!target.isUnseen(1)&&!target.hasSkill('fengyin_vice')) controls.push(\"副将\");\r\n\t\t\t\t\tif(controls.length>0){\r\n\t\t\t\t\tif(controls.length==1) event._result={control:controls[0]};\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.chooseControl(controls).set('ai',function(){\r\n\t\t\t\t\t\t\tvar choice='主将';\r\n\t\t\t\t\t\t\tvar skills=lib.character[target.name2][3];\r\n\t\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\t\tvar info=get.info(skills[i]);\r\n\t\t\t\t\t\t\t\tif(info&&info.ai&&info.ai.maixie){\r\n\t\t\t\t\t\t\t\t\tchoice='副将';break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn choice;\r\n\t\t\t\t\t\t}).set('prompt','请选择一个武将牌，令'+get.translation(target)+'该武将牌上的非锁定技全部失效。');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.goto(2);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.control){\r\n\t\t\t\t\t\tplayer.popup(result.control,'fire');\r\n\t\t\t\t\t\tvar target=trigger.target;\r\n\t\t\t\t\t\tif(result.control==\"主将\") target.addTempSkill(\"fengyin_main\");\r\n\t\t\t\t\t\telse target.addTempSkill(\"fengyin_vice\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tplayer.judge(function(){return 0});\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tvar suit=get.suit(result.card);\r\n\t\t\t\t\tvar target=trigger.target;\r\n\t\t\t\t\tvar num=target.countCards('h','shan');\r\n\t\t\t\t\ttarget.chooseToDiscard('请弃置一张'+get.translation(suit)+'牌，否则不能使用闪抵消此杀','he',function(card){\r\n\t\t\t\t\t\treturn get.suit(card)==_status.event.suit;\r\n\t\t\t\t\t}).set('ai',function(card){\r\n\t\t\t\t\t\tvar num=_status.event.num;\r\n\t\t\t\t\t\tif(num==0) return 0;\r\n\t\t\t\t\t\tif(card.name=='shan') return num>1?2:0;\r\n\t\t\t\t\t\treturn 8-get.value(card);\r\n\t\t\t\t\t}).set('num',num).set('suit',suit);\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tif(!result.bool){\r\n\t\t\t\t\t\ttrigger.getParent().directHit.add(trigger.target);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\thmkyuanyu:{\r\n\t\t\t\taudio:'zongkui',\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"damageBegin4\",\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.num<=0||!event.source) return false;\r\n\t\t\t\t\tvar n1=player.getNext();\r\n\t\t\t\t\tvar p1=player.getPrevious();\r\n\t\t\t\t\tif(event.source!=n1&&event.source!=p1) return true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(player.hasSkillTag('jueqing',false,target)) return;\r\n\t\t\t\t\t\t\tif(player==target.getNext()||player==target.getPrevious()) return;\r\n\t\t\t\t\t\t\tvar num=get.tag(card,'damage');\r\n\t\t\t\t\t\t\tif(num){\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\thmkguishu:{\r\n\t\t\t\taudio:'bmcanshi',\r\n\t\t\t\tenable:\"phaseUse\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('hs',{suit:'spade'})>0;\r\n\t\t\t\t},\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tif(!player.$.hmkguishu) player.$.hmkguishu=0;\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tdialog:function(event,player){\r\n\t\t\t\t\t\tvar list=['yuanjiao','zhibi'];\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\tlist[i]=['锦囊','',list[i]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn ui.create.dialog('鬼术',[list,'vcard']);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter:function(button,player){\r\n\t\t\t\t\t\tvar name=button.link[2];\r\n\t\t\t\t\t\tif(player.$.hmkguishu==1&&name=='yuanjiao') return false;\r\n\t\t\t\t\t\tif(player.$.hmkguishu==2&&name=='zhibi') return false;\r\n\t\t\t\t\t\treturn lib.filter.filterCard({name:name},player,_status.event.getParent());\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck:function(button){\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tif(button.link=='yuanjiao'){\r\n\t\t\t\t\t\t\treturn 3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(button.link=='zhibi'){\r\n\t\t\t\t\t\t\tif(player.countCards('hs',{suit:'spade'})>2) return 1;\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(links,player){\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\taudio:'bmcanshi',\r\n\t\t\t\t\t\t\tfilterCard:function(card,player){\r\n\t\t\t\t\t\t\t\treturn get.suit(card)=='spade';\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tposition:\"hs\",\r\n\t\t\t\t\t\t\tselectCard:1,\r\n\t\t\t\t\t\t\tpopname:true,\r\n\t\t\t\t\t\t\tai:function(card){\r\n\t\t\t\t\t\t\t\treturn 6-ai.get.value(card);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tviewAs:{name:links[0][2]},\r\n\t\t\t\t\t\t\tonuse:function(result,player){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('hmkguishu');\r\n\t\t\t\t\t\t\t\tif(result.card.name=='yuanjiao') player.$.hmkguishu=1;\r\n\t\t\t\t\t\t\t\telse player.$.hmkguishu=2;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tprompt:function(links,player){\r\n\t\t\t\t\t\treturn '将一张手牌当作'+get.translation(links[0][2])+'使用';\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:4,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player){\r\n\t\t\t\t\t\t\treturn 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten:1.6,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"_mingzhisuodingji\":{\r\n\t\t\t\tmode:[\"guozhan\"],\r\n\t\t\t\tenable:\"phaseUse\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(player.hasSkillTag('nomingzhi',false,null,true)) return false;\r\n\t\t\t\t\tvar bool=false;\r\n\t\t\t\t\tvar skillm=lib.character[player.name1][3];\r\n\t\t\t\t\tvar skillv=lib.character[player.name2][3];\r\n\t\t\t\t\tif(player.isUnseen(0)){\r\n\t\t\t\t\t\tfor(var i=0;i<skillm.length;i++){\r\n\t\t\t\t\t\t\tif(get.is.locked(skillm[i])){\r\n\t\t\t\t\t\t\t\tbool=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(player.isUnseen(1)){\r\n\t\t\t\t\t\tfor(var i=0;i<skillv.length;i++){\r\n\t\t\t\t\t\t\tif(get.is.locked(skillv[i])){\r\n\t\t\t\t\t\t\t\tbool=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn bool;\r\n\t\t\t\t},\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar choice=[];\r\n\t\t\t\t\tvar skillm=lib.character[player.name1][3];\r\n\t\t\t\t\tvar skillv=lib.character[player.name2][3];\r\n\t\t\t\t\tif(player.isUnseen(0)){\r\n\t\t\t\t\t\tfor(var i=0;i<skillm.length;i++){\r\n\t\t\t\t\t\t\tif(get.is.locked(skillm[i])&&!choice.contains('明置主将')){\r\n\t\t\t\t\t\t\t\tchoice.push(\"明置主将\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(player.isUnseen(1)){\r\n\t\t\t\t\t\tfor(var i=0;i<skillv.length;i++){\r\n\t\t\t\t\t\t\tif(get.is.locked(skillv[i])&&!choice.contains('明置副将')){\r\n\t\t\t\t\t\t\t\tchoice.push(\"明置副将\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(choice.length==2) choice.push('全部明置')\r\n\t\t\t\t\tplayer.chooseControl(choice);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.control){\r\n\t\t\t\t\t\tswitch(result.control){\r\n\t\t\t\t\t\t\tcase \"取消\":break;\r\n\t\t\t\t\t\t\tcase \"明置主将\":player.showCharacter(0);break;\r\n\t\t\t\t\t\t\tcase \"明置副将\":player.showCharacter(1);break;\r\n\t\t\t\t\t\t\tcase \"全部明置\":player.showCharacter(2);break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:11,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:-99,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t/*----分界线----*/\r\n\t\t\t_viewnext:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tglobal:\"gameDrawBefore\",\r\n\t\t\t\t},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(){\r\n\t\t\t\t\tif(_status.connectMode&&!lib.configOL.viewnext) return false;\r\n\t\t\t\t\telse if(!_status.connectMode&&!get.config('viewnext')) return false;\r\n\t\t\t\t\treturn game.players.length>1;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar target=player.getNext();\r\n\t\t\t\t\tplayer.viewCharacter(target,1);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_aozhan_judge:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"phaseBefore\",\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpriority:22,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(get.mode()!='guozhan') return false;\r\n\t\t\t\t\tif(_status.connectMode&&!lib.configOL.aozhan) return false;\r\n\t\t\t\t\telse if(!_status.connectMode&&!get.config('aozhan')) return false;\r\n\t\t\t\t\tif(_status._aozhan) return false;\r\n\t\t\t\t\tif(game.players.length>4) return false;\r\n\t\t\t\t\tif(game.players.length>3&&game.players.length+game.dead.length<=7) return false;\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tfor(var j=i+1;j<game.players.length;j++){\r\n\t\t\t\t\t\t\tif(game.players[i].isFriendOf(game.players[j])) return false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar color=get.groupnature(player.group,\"raw\");\r\n\t\t\t\t\tif(player.isUnseen()) color='fire';\r\n\t\t\t\t\tplayer.$fullscreenpop('鏖战模式',color); \r\n\t\t\t\t\tgame.broadcastAll(function(){\r\n\t\t\t\t\t_status._aozhan=true;\r\n\t\t\t\t\tui.aozhan=ui.create.div('.touchinfo.left',ui.window);\r\n\t\t\t\t\tui.aozhan.innerHTML='鏖战模式';\r\n\t\t\t\t\tif(ui.time3) ui.time3.style.display='none';\r\n\t\t\t\t\tui.aozhanInfo=ui.create.system('鏖战模式',null,true);\r\n\t\t\t\t\tlib.setPopped(ui.aozhanInfo,function(){\r\n\t\t\t\t\t\tvar uiintro=ui.create.dialog('hidden');\r\n\t\t\t\t\t\tuiintro.add('鏖战模式');\r\n\t\t\t\t\t\tvar list=[\r\n\t\t\t\t\t\t\t'当游戏中仅剩四名或更少角色时（七人以下游戏时改为三名或更少），若此时全场没有超过一名势力相同的角色，则从一个新的回合开始，游戏进入鏖战模式直至游戏结束。',\r\n\t\t\t\t\t\t\t'在鏖战模式下，任何角色均不是非转化的【桃】的合法目标。【桃】可以被当做【杀】或【闪】使用或打出。',\r\n\t\t\t\t\t\t\t'进入鏖战模式后，即使之后有两名或者更多势力相同的角色出现，仍然不会取消鏖战模式。'\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t\tvar intro='<ul style=\"text-align:left;margin-top:0;width:450px\">';\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tintro+='<li>'+list[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tintro+='</ul>'\r\n\t\t\t\t\t\tuiintro.add('<div class=\"text center\">'+intro+'</div>');\r\n\t\t\t\t\t\tvar ul=uiintro.querySelector('ul');\r\n\t\t\t\t\t\tif(ul){\r\n\t\t\t\t\t\t\tul.style.width='180px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tuiintro.add(ui.create.div('.placeholder'));\r\n\t\t\t\t\t\treturn uiintro;\r\n\t\t\t\t\t},250);\r\n\t\t\t\t\tgame.playBackgroundMusic();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.countPlayer(function(current){current.addSkill('aozhan')});\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_guozhan_marks:{\r\n\t\t\t\truleSkill:true,\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.hasMark('yexinjia_mark')||player.hasMark('xianqu_mark')||player.hasMark('yinyang_mark')||player.hasMark('zhulianbihe_mark');\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tdialog:function(event,player){\r\n\t\t\t\t\t\treturn ui.create.dialog('###国战标记###弃置一枚对应的标记，发动其对应的效果');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tchooseControl:function(event,player){\r\n\t\t\t\t\t\tvar list=[],bool=player.hasMark('yexinjia_mark');\r\n\t\t\t\t\t\tif(bool||player.hasMark('xianqu_mark')) list.push('先驱');\r\n\t\t\t\t\t\tif(bool||player.hasMark('zhulianbihe_mark')){\r\n\t\t\t\t\t\t\tlist.push('珠联(摸牌)');\r\n\t\t\t\t\t\t\tif(event.filterCard({name:'tao',isCard:true},player,event)) list.push('珠联(桃)');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(bool||player.hasMark('yinyang_mark')) list.push('阴阳鱼');\r\n\t\t\t\t\t\tlist.push('cancel2');\r\n\t\t\t\t\t\treturn list;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck:function(){\r\n\t\t\t\t\t\tvar player=_status.event.player,bool=player.hasMark('yexinjia_mark');\r\n\t\t\t\t\t\tif((bool||player.hasMark('xianqu_mark'))&&(4-player.countCards('h'))>1) return '先驱';\r\n\t\t\t\t\t\tif(bool||player.hasMark('zhulianbihe_mark')){\r\n\t\t\t\t\t\t\tif(_status.event.getParent().filterCard({name:'tao',isCard:true},player,event)&&get.effect_use(player,{name:'tao'},player)>0) return '珠联(桃)';\r\n\t\t\t\t\t\t\tif(player.getHandcardLimit()-player.countCards('h')>1&&!game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn current!=player&&current.isFriendOf(player)&&current.hp+current.countCards('h','shan')<=2;\r\n\t\t\t\t\t\t\t})) return '珠联(摸牌)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(player.hasMark('yinyang_mark')&&player.getHandcardLimit()-player.countCards('h')>0) return '阴阳鱼';\r\n\t\t\t\t\t\treturn 'cancel2';\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(result,player){\r\n\t\t\t\t\t\tswitch(result.control){\r\n\t\t\t\t\t\t\tcase '珠联(桃)': return get.copy(lib.skill._zhulianbihe_mark_tao);\r\n\t\t\t\t\t\t\tcase '珠联(摸牌)': return {\r\n\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t player.draw(2);\r\n\t\t\t\t\t\t\t\t player.removeMark(player.hasMark('zhulianbihe_mark')?'zhulianbihe_mark':'yexinjia_mark',1);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tcase '阴阳鱼': return {\r\n\t\t\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t\t\t\tplayer.removeMark(player.hasMark('yinyang_mark')?'yinyang_mark':'yexinjia_mark',1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tcase '先驱': return {content:lib.skill.xianqu_mark.content};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:1,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\txianqu_mark:{\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:\"◇出牌阶段，你可以弃置此标记，然后将手牌摸至四张并观看一名其他角色的一张武将牌。\",\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.removeMark(player.hasMark('xianqu_mark')?'xianqu_mark':'yexinjia_mark',1);\r\n\t\t\t\t\tvar num=4-player.countCards('h');\r\n\t\t\t\t\tif(num) player.draw(num);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current!=player&&current.isUnseen(2);\r\n\t\t\t\t\t})) player.chooseTarget('是否观看一名其他角色的一张暗置武将牌？',function(card,player,target){\r\n\t\t\t\t\t\treturn target!=player&&target.isUnseen(2);\r\n\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\tif(target.isUnseen()){\r\n\t\t\t\t\t\t\tvar next=_status.event.player.getNext();\r\n\t\t\t\t\t\t\tif (target!=next) return 10;\r\n\t\t\t\t\t\t\treturn 9;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn -get.attitude(_status.event.player,target);\r\n\t\t\t\t\t});\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.target=result.targets[0];\r\n\t\t\t\t\t\tplayer.line(event.target,'green');\r\n\t\t\t\t\t\tvar controls=[];\r\n\t\t\t\t\t\tif(event.target.isUnseen(0)) controls.push('主将');\r\n\t\t\t\t\t\tif(event.target.isUnseen(1)) controls.push('副将');\r\n\t\t\t\t\t\tif(controls.length>1){\r\n\t\t\t\t\t\t\tplayer.chooseControl(controls);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(controls.length==0) event.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.removeSkill('xianqu_mark');\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tif(result.control){\r\n\t\t\t\t\t\tif(result.control=='主将'){\r\n\t\t\t\t\t\t\tplayer.viewCharacter(event.target,0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tplayer.viewCharacter(event.target,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(target.isUnseen(0)){\r\n\t\t\t\t\t\tplayer.viewCharacter(event.target,0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.viewCharacter(event.target,1);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tzhulianbihe_mark:{\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:\"◇出牌阶段，你可以弃置此标记 然后摸两张牌。<br>◇你可以将此标记当做【桃】使用。\",\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tyinyang_mark:{\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:\"◇出牌阶段，你可以弃置此标记，然后摸一张牌。<br>◇弃牌阶段，你可以弃置此标记，然后本回合手牌上限+2。\",\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_zhulianbihe_mark_tao:{\r\n\t\t\t\truleSkill:true,\r\n\t\t\t\tenable:\"chooseToUse\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.type!='phase'&&(player.hasMark('zhulianbihe_mark')||player.hasMark('yexinjia_mark'));\r\n\t\t\t\t},\r\n\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\treturn player.hasMark('zhulianbihe_mark')||player.hasMark('yexinjia_mark');\r\n\t\t\t\t},\r\n\t\t\t\tviewAs:{\r\n\t\t\t\t\tname:\"tao\",\r\n\t\t\t\t\tisCard:true,\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard:function(){return false},\r\n\t\t\t\tselectCard:-1,\r\n\t\t\t\tprecontent:function(){\r\n\t\t\t\t\tplayer.removeMark(player.hasMark('zhulianbihe_mark')?'zhulianbihe_mark':'yexinjia_mark',1);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_yinyang_mark_add:{\r\n\t\t\t\truleSkill:true,\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:\"phaseDiscardBegin\",\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn (player.hasMark('yinyang_mark')||player.hasMark('yexinjia_mark'))&&player.needsToDiscard();\r\n\t\t\t\t},\r\n\t\t\t\tprompt:function(event,player){\r\n\t\t\t\t\treturn '是否弃置一枚【'+(player.hasMark('yinyang_mark')?'阴阳鱼':'野心家')+'】标记，使本回合的手牌上限+2？';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.addTempSkill('yinyang_add','phaseAfter');\r\n\t\t\t\t\tplayer.removeMark(player.hasMark('yinyang_mark')?'yinyang_mark':'yexinjia_mark',1);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tyinyang_add:{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tmaxHandcard:function(player,num){\r\n\t\t\t\t\t\treturn num+2;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tyexinjia_mark:{\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'◇你可以弃置此标记，并发动【先驱】标记或【珠联璧合】标记或【阴阳鱼】标记的效果。',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tyexinjia_friend:{\r\n\t\t\t\tmarktext:'盟',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tname:'结盟',\r\n\t\t\t\t\tcontent:'已经与$结成联盟',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t/*----分界线----*/\r\n\t\t\t_lianheng:{\r\n\t\t\t\tmode:['guozhan'],\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tusable:1,\r\n\t\t\t\tprompt:'将至多三张可合纵的牌交给一名与你势力不同的角色，或未确定势力的角色，若你交给与你势力不同的角色，则你摸等量的牌',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn (player.getCards('h',function(card){\r\n\t\t\t\t\t\treturn card.hasTag('lianheng');\r\n\t\t\t\t\t}).length);\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard:function(card){\r\n\t\t\t\t\treturn card.hasTag('lianheng');\r\n\t\t\t\t},\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\tif(target==player) return false;\r\n\t\t\t\t\tif(player.isUnseen()) return target.isUnseen();\r\n\t\t\t\t\tif(player.identity=='ye') return true;\r\n\t\t\t\t\treturn target.identity!=player.identity;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\tif(card.name=='tao') return 0;\r\n\t\t\t\t\treturn 5-get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tselectCard:[1,3],\r\n\t\t\t\tprepare:'give',\r\n\t\t\t\tdiscard:false,\r\n\t\t\t\t// delay:0.5,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\ttarget.gain(cards,player);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(!target.isUnseen()){\r\n\t\t\t\t\t\tplayer.draw(cards.length);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\torder:2\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player,target){\r\n\t\t\t\t\t\t\tvar huoshao=false;\r\n\t\t\t\t\t\t\tfor(var i=0;i<ui.selected.cards.length;i++){\r\n\t\t\t\t\t\t\t\tif(ui.selected.cards[i].name=='huoshaolianying'){huoshao=true;break}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(huoshao&&player.inline(target.getNext())) return -3;\r\n\t\t\t\t\t\t\tif(target.isUnseen()) return 0;\r\n\t\t\t\t\t\t\tif(player.isMajor()) return 0;\r\n\t\t\t\t\t\t\treturn 0.5;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(target.isUnseen()) return 0;\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tqianhuan:{\r\n\t\t\t\tgroup:['qianhuan_add','qianhuan_use'],\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tif(!player.$.qianhuan) player.$.qianhuan=[];\r\n\t\t\t\t},\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'cards',\r\n\t\t\t\t\tonunmark:function(storage,player){\r\n\t\t\t\t\t\tif(storage&&storage.length){\r\n\t\t\t\t\t\t\tplayer.$throw(storage,1000);\r\n\t\t\t\t\t\t\tgame.cardsDiscard(storage);\r\n\t\t\t\t\t\t\tgame.log(storage,'被置入了弃牌堆');\r\n\t\t\t\t\t\t\tstorage.length=0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.8\r\n\t\t\t\t},\r\n\t\t\t\taudio:2,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tadd:{\r\n\t\t\t\t\t\ttrigger:{global:'damageEnd'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tvar suits=[];\r\n\t\t\t\t\t\t\tfor(var i=0;i<player.$.qianhuan.length;i++){\r\n\t\t\t\t\t\t\t\tsuits.add(get.suit(player.$.qianhuan[i]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn player.isFriendOf(event.player)&&player.countCards('he',function(card){\r\n\t\t\t\t\t\t\t\treturn !suits.contains(get.suit(card));\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar suits=[];\r\n\t\t\t\t\t\t\tfor(var i=0;i<player.$.qianhuan.length;i++){\r\n\t\t\t\t\t\t\t\tsuits.add(get.suit(player.$.qianhuan[i]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.chooseCard('he',get.prompt2('qianhuan'),function(card){\r\n\t\t\t\t\t\t\t\treturn !_status.event.suits.contains(get.suit(card));\r\n\t\t\t\t\t\t\t}).set('ai',function(card){\r\n\t\t\t\t\t\t\t\treturn 9-get.value(card);\r\n\t\t\t\t\t\t\t}).set('suits',suits).setHiddenSkill('qianhuan');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tvar card=result.cards[0]\r\n\t\t\t\t\t\t\t\tplayer.$.qianhuan.add(card);\r\n\t\t\t\t\t\t\t\tplayer.lose(card,ui.special,'toStorage');\r\n\t\t\t\t\t\t\t\tplayer.$give(card,player,false);\r\n\t\t\t\t\t\t\t\tplayer.markSkill('qianhuan',true);\r\n\t\t\t\t\t\t\t\tplayer.logSkill('qianhuan');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tuse:{\r\n\t\t\t\t\t\ttrigger:{global:'useCardToTarget'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(!['basic','trick'].contains(get.type(event.card,'trick'))) return false;\r\n\t\t\t\t\t\t\treturn event.target&&player.sameIdentityAs(event.target)&&event.targets.length==1&&player.$.qianhuan.length;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar goon=get.effect(trigger.target,trigger.card,trigger.player,player)<0;\r\n\t\t\t\t\t\t\tif(goon){\r\n\t\t\t\t\t\t\t\tif(['tiesuo','diaohulishan','lianjunshengyan','zhibi','chiling','lulitongxin'].contains(trigger.card.name)){\r\n\t\t\t\t\t\t\t\t\tgoon=false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(trigger.card.name=='sha'){\r\n\t\t\t\t\t\t\t\t\tif(trigger.target.mayHaveShan()||trigger.target.hp>=3){\r\n\t\t\t\t\t\t\t\t\t\tgoon=false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(trigger.card.name=='guohe'){\r\n\t\t\t\t\t\t\t\t\tif(trigger.target.countCards('he')>=3||!trigger.target.countCards('h')){\r\n\t\t\t\t\t\t\t\t\t\tgoon=false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(trigger.card.name=='shuiyanqijunx'){\r\n\t\t\t\t\t\t\t\t\tif(trigger.target.countCards('e')<=1||trigger.target.hp>=3){\r\n\t\t\t\t\t\t\t\t\t\tgoon=false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(get.tag(trigger.card,'damage')&&trigger.target.hp>=3){\r\n\t\t\t\t\t\t\t\t\tgoon=false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.chooseButton().set('goon',goon).set('ai',function(button){\r\n\t\t\t\t\t\t\t\tif(_status.event.goon) return 1;\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t}).set('createDialog',[get.prompt('qianhuan'),'<div class=\"text center\">移去一张“千幻”牌令'+\r\n\t\t\t\t\t\t\tget.translation(trigger.player)+'对'+get.translation(trigger.target)+'的'+get.translation(trigger.card)+'失效</div>',player.$.qianhuan]);\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tvar card=result.links[0];\r\n\t\t\t\t\t\t\t\tplayer.$.qianhuan.remove(card);\r\n\t\t\t\t\t\t\t\tif(player.$.qianhuan.length){\r\n\t\t\t\t\t\t\t\t\tplayer.updateMarks('qianhuan');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tplayer.unmarkSkill('qianhuan');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.cardsDiscard(card);\r\n\t\t\t\t\t\t\t\tplayer.$throw(card);\r\n\t\t\t\t\t\t\t\tplayer.logSkill('qianhuan',trigger.player);\r\n\t\t\t\t\t\t\t\ttrigger.getParent().targets.remove(trigger.target);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzzhiman:{\r\n\t\t\t\taudio:'zhiman',\r\n\t\t\t\tinherit:'zhiman',\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(trigger.player.countGainableCards(player,'ej')){\r\n\t\t\t\t\t\tplayer.gainPlayerCard(trigger.player,'ej',true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(player.sameIdentityAs(trigger.player)){\r\n\t\t\t\t\t\ttrigger.player.mayChangeVice();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzdiancai:{\r\n\t\t\t\taudio:'diancai',\r\n\t\t\t\ttrigger:{global:'phaseUseEnd'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(_status.currentPhase==player) return false;\r\n\t\t\t\t\tvar num=0;\r\n\t\t\t\t\tplayer.getHistory('lose',function(evt){\r\n\t\t\t\t\t\tif(evt.cards2&&evt.getParent('phaseUse')==event) num+=evt.cards2.length;\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn num>=player.hp;\r\n\t\t\t\t},\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar num=player.maxHp-player.countCards('h');\r\n\t\t\t\t\tif(num>0){\r\n\t\t\t\t\t\tplayer.draw(num);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.mayChangeVice();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\txuanlve:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'loseAfter',\r\n\t\t\t\t\tsource:'gainAfter',\r\n\t\t\t\t\tglobal:['equipAfter','addJudgeAfter'],\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar evt=event.getl(player);\r\n\t\t\t\t\treturn evt&&evt.es&&evt.es.length>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('xuanlve'),'弃置一名其他角色的一张牌',function(card,player,target){\r\n\t\t\t\t\t\treturn target!=player&&target.countDiscardableCards(player,'he');\r\n\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\treturn -get.attitude(_status.event.player,target);\r\n\t\t\t\t\t}).setHiddenSkill(event.name);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('xuanlve',result.targets);\r\n\t\t\t\t\t\tplayer.discardPlayerCard(result.targets[0],'he',true);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tnoe:true,\r\n\t\t\t\t\treverseEquip:true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(get.type(card)=='equip') return [1,1];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlianzi:{\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tusable:1,\r\n\t\t\t\taudio:2,\r\n\t\t\t\tfilterCard:true,\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\tif(get.type(card)=='equip') return 0;\r\n\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\tvar num=game.countPlayer(function(current){\r\n\t\t\t\t\t\tif(current.identity=='wu'){\r\n\t\t\t\t\t\t\treturn current.countCards('e');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})+player.$.yuanjiangfenghuotu.length;\r\n\t\t\t\t\tif(num>=5){\r\n\t\t\t\t\t\treturn 8-get.value(card);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(num>=3){\r\n\t\t\t\t\t\treturn 7-get.value(card);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(num>=2){\r\n\t\t\t\t\t\treturn 3-get.value(card);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar num=game.countPlayer(function(current){\r\n\t\t\t\t\t\tif(current.identity=='wu'){\r\n\t\t\t\t\t\t\treturn current.countCards('e');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})+player.$.yuanjiangfenghuotu.length;\r\n\t\t\t\t\tif(num){\r\n\t\t\t\t\t\tevent.shown=get.cards(num);\r\n\t\t\t\t\t\tplayer.showCards(event.shown,get.translation('lianzi'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tvar discards=[];\r\n\t\t\t\t\tvar type=get.type(cards[0],'trick');\r\n\t\t\t\t\tfor(var i=0;i<event.shown.length;i++){\r\n\t\t\t\t\t\tif(get.type(event.shown[i],'trick')==type){\r\n\t\t\t\t\t\t\tlist.push(event.shown[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tdiscards.push(event.shown[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.cardsDiscard(discards);\r\n\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\tplayer.gain(list,'gain2');\r\n\t\t\t\t\t\tif(list.length>=3&&player.hasStockSkill('lianzi')){\r\n\t\t\t\t\t\t\tplayer.removeSkill('lianzi');\r\n\t\t\t\t\t\t\tplayer.addSkill('gzzhiheng');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:7,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjubao:{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tcanBeGained:function(card,source,player){\r\n\t\t\t\t\t\tif(source!=player&&get.position(card)=='e'&&get.subtype(card)=='equip5') return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{player:'phaseJieshuBegin'},\r\n\t\t\t\taudio:2,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tunique:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.countCards('ej',function(card){\r\n\t\t\t\t\t\t\treturn card.name=='dinglanyemingzhu';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<ui.discardPile.childElementCount;i++){\r\n\t\t\t\t\t\tif(ui.discardPile.childNodes[i].name=='dinglanyemingzhu'){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar target=game.findPlayer(function(current){\r\n\t\t\t\t\t\treturn current!=player&&current.countCards('e','dinglanyemingzhu');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(target&&target.countGainableCards(player,'he')){\r\n\t\t\t\t\t\tplayer.line(target,'green');\r\n\t\t\t\t\t\tplayer.gainPlayerCard(target,true);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.5\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjiahe:{\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\taudio:2,\r\n\t\t\t\tderivation:'yuanjiangfenghuotu',\r\n\t\t\t\tmark:true,\r\n\t\t\t\tglobal:['jiahe_put','jiahe_skill'],\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tif(!player.$.yuanjiangfenghuotu) player.$.yuanjiangfenghuotu=[];\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:2\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{player:'damageEnd'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.card&&(event.card.name=='sha'||get.type(event.card,'trick')=='trick')&&player.$.yuanjiangfenghuotu.length>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseCardButton('将一张“烽火”置入弃牌堆',player.$.yuanjiangfenghuotu,true);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar card=result.links[0];\r\n\t\t\t\t\t\tplayer.$throw(card);\r\n\t\t\t\t\t\tgame.cardsDiscard(card);\r\n\t\t\t\t\t\tplayer.$.yuanjiangfenghuotu.remove(card);\r\n\t\t\t\t\t\tplayer.syncStorage('yuanjiangfenghuotu');\r\n\t\t\t\t\t\tplayer.updateMarks('yuanjiangfenghuotu');\r\n\t\t\t\t\t\tgame.log(player,'将',card,'置入了弃牌堆');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjiahe_put:{\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\taudio:2,\r\n\t\t\t\tforceaudio:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar zhu=get.zhu(player,'jiahe');\r\n\t\t\t\t\tif(zhu&&zhu.$.yuanjiangfenghuotu){\r\n\t\t\t\t\t\treturn player.countCards('he',{type:'equip'})>0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard:{type:'equip'},\r\n\t\t\t\tposition:'he',\r\n\t\t\t\tusable:1,\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\tvar zhu=get.zhu(_status.event.player,'jiahe');\r\n\t\t\t\t\tif(!zhu) return 0;\r\n\t\t\t\t\tvar num=7-get.value(card);\r\n\t\t\t\t\tif(get.position(card)=='h'){\r\n\t\t\t\t\t\tif(zhu.$.yuanjiangfenghuotu.length>=5){\r\n\t\t\t\t\t\t\treturn num-3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn num+3;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\tvar zhu=get.zhu(player,'jiahe');\r\n\t\t\t\t\t\tvar sub=get.subtype(card)\r\n\t\t\t\t\t\tif(player.countCards('h',function(card){\r\n\t\t\t\t\t\t\treturn get.type(card)=='equip'&&get.subtype(card)=='sub'&&player.hasValueTarget(card);\r\n\t\t\t\t\t\t})) return num+4;\r\n\t\t\t\t\t\tif(zhu.$.yuanjiangfenghuotu.length>=5&&!player.hasSkillTag('noe')){\r\n\t\t\t\t\t\t\treturn num-5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn num;\r\n\t\t\t\t},\r\n\t\t\t\tdiscard:false,\r\n\t\t\t\tlose:true,\r\n\t\t\t\ttoStorage:true,\r\n\t\t\t\tprepare:function(cards,player){\r\n\t\t\t\t\tvar zhu=get.zhu(player,'jiahe');\r\n\t\t\t\t\tplayer.$give(cards,zhu,false);\r\n\t\t\t\t\tplayer.line(zhu);\r\n\t\t\t\t\tgame.log(player,'放置了',cards[0]);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar zhu=get.zhu(player,'jiahe');\r\n\t\t\t\t\tzhu.$.yuanjiangfenghuotu.add(cards[0]);\r\n\t\t\t\t\tzhu.syncStorage('yuanjiangfenghuotu');\r\n\t\t\t\t\tzhu.updateMarks('yuanjiangfenghuotu');\r\n\t\t\t\t\t//event.trigger('addCardToStorage');\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:function(item,player){\r\n\t\t\t\t\t\tif(player.hasSkillTag('noe')||!player.countCards('h',function(card){\r\n\t\t\t\t\t\t\treturn get.type(card)=='equip'&&player.getEquip(get.subtype(card))&&player.hasValueTarget(card);\r\n\t\t\t\t\t\t})) return 1;\r\n\t\t\t\t\t\treturn 10;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjiahe_skill:{\r\n\t\t\t\ttrigger:{player:'phaseZhunbeiBegin'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\taudio:\"jiahe_put\",\r\n\t\t\t\tforceaudio:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar zhu=get.zhu(player,'jiahe');\r\n\t\t\t\t\tif(zhu&&zhu.$.yuanjiangfenghuotu&&zhu.$.yuanjiangfenghuotu.length){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar zhu=get.zhu(player,'jiahe');\r\n\t\t\t\t\tevent.num=zhu.$.yuanjiangfenghuotu.length;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tif(event.num>=1&&!player.hasSkill('reyingzi')) list.push('reyingzi');\r\n\t\t\t\t\tif(event.num>=2&&!player.hasSkill('haoshi')) list.push('haoshi');\r\n\t\t\t\t\tif(event.num>=3&&!player.hasSkill('shelie')) list.push('shelie');\r\n\t\t\t\t\tif(event.num>=4&&!player.hasSkill('duoshi')) list.push('duoshi');\r\n\t\t\t\t\tif(!list.length){\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar prompt2='你可以获得下列一项技能直到回合结束';\r\n\t\t\t\t\tif(list.length>=5){\r\n\t\t\t\t\t\tif(event.done){\r\n\t\t\t\t\t\t\tprompt2+=' (2/2)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tprompt2+=' (1/2)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.push('cancel2');\r\n\t\t\t\t\tplayer.chooseControl(list).set('prompt',get.translation('yuanjiangfenghuotu')).\r\n\t\t\t\t\tset('prompt2',prompt2).set('centerprompt2',true).set('ai',function(evt,player){\r\n\t\t\t\t\t\tvar controls=_status.event.controls;\r\n\t\t\t\t\t\tif(controls.contains('haoshi')){\r\n\t\t\t\t\t\t\tvar nh=player.countCards('h');\r\n\t\t\t\t\t\t\tif(player.hasSkill('reyingzi')){\r\n\t\t\t\t\t\t\t\tif(nh==0) return 'haoshi';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(nh<=1) return 'haoshi';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(controls.contains('shelie')){\r\n\t\t\t\t\t\t\treturn 'shelie';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(controls.contains('reyingzi')){\r\n\t\t\t\t\t\t\treturn 'reyingzi';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(controls.contains('duoshi')){\r\n\t\t\t\t\t\t\treturn 'duoshi';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn controls.randomGet();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.control!='cancel2'){\r\n\t\t\t\t\t\tplayer.addTempSkill(result.control);\r\n\t\t\t\t\t\tif(!event.done) player.logSkill('jiahe_put');\r\n\t\t\t\t\t\tgame.log(player,'获得了技能','【'+get.translation(result.control)+'】');\r\n\t\t\t\t\t\tif(event.num>=5&&!event.done){\r\n\t\t\t\t\t\t\tevent.done=true;\r\n\t\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyuanjiangfenghuotu:{\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tnopop:true,\r\n\t\t\t\tmark:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'cards',\r\n\t\t\t\t\tonunmark:function(storage,player){\r\n\t\t\t\t\t\tif(storage&&storage.length){\r\n\t\t\t\t\t\t\tplayer.$throw(storage,1000);\r\n\t\t\t\t\t\t\tgame.cardsDiscard(storage);\r\n\t\t\t\t\t\t\tgame.log(storage,'被置入了弃牌堆');\r\n\t\t\t\t\t\t\tstorage.length=0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmark:function(dialog,content,player){\r\n\t\t\t\t\t\tif(content&&content.length){\r\n\t\t\t\t\t\t\tdialog.addSmall(content);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.addText('<ul style=\"margin-top:5px;padding-left:22px;\"><li>每名吴势力角色的出牌阶段限一次，该角色可以将一张装备牌置于“缘江烽火图”上，称之为“烽火”。<li>根据“烽火”的数量，所有吴势力角色可于其准备阶段开始时选择并获得其中一个技能直到回合结束：一张以上~英姿；两张以上~好施；三张以上~涉猎；四张以上~度势；五张以上~可额外选择一项。<li>锁定技，当你受到【杀】或锦囊牌造成的伤害后，你将一张“烽火”置入弃牌堆。',false)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzqice:{\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tusable:1,\r\n\t\t\t\taudio:\"qice_backup\",\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('h')>0\r\n\t\t\t\t},\r\n\t\t\t\tgroup:'gzqice_change',\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tchange:{\r\n\t\t\t\t\t\ttrigger:{player:'useCardAfter'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.skill=='gzqice_backup';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.mayChangeVice();\r\n\t\t\t\t\t\t\tevent.skill='gzqice';\r\n\t\t\t\t\t\t\tevent.trigger('skillAfter');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tdialog:function(){\r\n\t\t\t\t\t\tvar list=lib.inpile;\r\n\t\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tif(list[i]!='wuxie'&&get.type(list[i])=='trick') list2.push(['锦囊','',list[i]]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn ui.create.dialog(get.translation('gzqice'),[list2,'vcard']);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter:function(button,player){\r\n\t\t\t\t\t\tvar card={name:button.link[2]};\r\n\t\t\t\t\t\tvar info=get.info(card);\r\n\t\t\t\t\t\tvar num=player.countCards('h');\r\n\t\t\t\t\t\t//if(get.tag(card,'multitarget')&&get.select(info.selectTarget)[1]==-1){\r\n\t\t\t\t\t\tif(get.select(info.selectTarget)[1]==-1){\r\n\t\t\t\t\t\t\tif(game.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn player.canUse(card,current)\r\n\t\t\t\t\t\t\t})>num){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(info.changeTarget){\r\n\t\t\t\t\t\t\tvar giveup=true;\r\n\t\t\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn player.canUse(card,current);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\tvar targets=[list[i]];\r\n\t\t\t\t\t\t\t\tinfo.changeTarget(player,targets);\r\n\t\t\t\t\t\t\t\tif(targets.length<=num){\r\n\t\t\t\t\t\t\t\t\tgiveup=false;break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(giveup){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn lib.filter.filterCard(card,player,_status.event.getParent());\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck:function(button){\r\n\t\t\t\t\t\tif(['chiling','xietianzi','tiesuo','lulitongxin','diaohulishan','jiedao'].contains(button.link[2])) return 0;\r\n\t\t\t\t\t\treturn _status.event.player.getUseValue(button.link[2]);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(links,player){\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tfilterCard:true,\r\n\t\t\t\t\t\t\taudio:\"qice\",\r\n\t\t\t\t\t\t\tselectCard:-1,\r\n\t\t\t\t\t\t\tposition:'h',\r\n\t\t\t\t\t\t\tselectTarget:function(){\r\n\t\t\t\t\t\t\t\tvar select=get.select(get.info(get.card()).selectTarget);\r\n\t\t\t\t\t\t\t\tvar nh=_status.event.player.countCards('h');\r\n\t\t\t\t\t\t\t\tif(select[1]>nh){\r\n\t\t\t\t\t\t\t\t\tselect[1]=nh;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn select;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\t\t\t\tvar info=get.info(card);\r\n\t\t\t\t\t\t\t\tif(info.changeTarget){\r\n\t\t\t\t\t\t\t\t\tvar targets=[target];\r\n\t\t\t\t\t\t\t\t\tinfo.changeTarget(player,targets);\r\n\t\t\t\t\t\t\t\t\tif(targets.length>player.countCards('h')){\r\n\t\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn lib.filter.filterTarget(card,player,target);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\taudio:'qice_backup',\r\n\t\t\t\t\t\t\tpopname:true,\r\n\t\t\t\t\t\t\tviewAs:{name:links[0][2]},\r\n\t\t\t\t\t\t\tai1:function(){\r\n\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tprompt:function(links,player){\r\n\t\t\t\t\t\treturn '将全部手牌当作'+get.translation(links[0][2])+'使用';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:1,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player){\r\n\t\t\t\t\t\t\tvar num=0;\r\n\t\t\t\t\t\t\tvar cards=player.getCards('h');\r\n\t\t\t\t\t\t\tif(cards.length>=3&&player.hp>=3) return 0;\r\n\t\t\t\t\t\t\tfor(var i=0;i<cards.length;i++){\r\n\t\t\t\t\t\t\t\tnum+=Math.max(0,get.value(cards[i],player,'raw'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 16-num;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten:1.6,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzyuejian:{\r\n\t\t\t\ttrigger:{global:'phaseDiscardBegin'},\r\n\t\t\t\taudio:'yuejian',\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(player.sameIdentityAs(event.player)){\r\n\t\t\t\t\t\treturn event.player.getHistory('useCard',function(evt){\r\n\t\t\t\t\t\t\tif(evt.targets){\r\n\t\t\t\t\t\t\t\tvar targets=evt.targets.slice(0);\r\n\t\t\t\t\t\t\t\twhile(targets.contains(event.player)) targets.remove(event.player);\r\n\t\t\t\t\t\t\t\treturn targets.length!=0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t})==0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.player.addTempSkill('gzyuejian_num');\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tforced:true,\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tnum:{\r\n\t\t\t\t\t\tmod:{\r\n\t\t\t\t\t\t\tmaxHandcardBase:function(player,num){\r\n\t\t\t\t\t\t\t\treturn player.maxHp;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzxinsheng:{\r\n\t\t\t\ttrigger:{player:'damageEnd'},\r\n\t\t\t\t// frequent:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tgame.log(player,'获得了一张','#g化身');\r\n\t\t\t\t\tlib.skill.gzhuashen.addCharacter(player,_status.characterlist.randomGet(),true);\r\n\t\t\t\t\tgame.delayx();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzhuashen:{\r\n\t\t\t\tunique:true,\r\n\t\t\t\tgroup:['gzhuashen_add','gzhuashen_swap','gzhuashen_remove','gzhuashen_disallow','gzhuashen_flash'],\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.$.gzhuashen=[];\r\n\t\t\t\t\tplayer.$.gzhuashen_removing=[];\r\n\t\t\t\t\tplayer.$.gzhuashen_trigger=[];\r\n\t\t\t\t\tplayer.$.gzhuashen_map={};\r\n\t\t\t\t},\r\n\t\t\t\tonremove:function(player){\r\n\t\t\t\t\tdelete player.$.gzhuashen;\r\n\t\t\t\t\tdelete player.$.gzhuashen_removing;\r\n\t\t\t\t\tdelete player.$.gzhuashen_trigger;\r\n\t\t\t\t\tdelete player.$.gzhuashen_map;\r\n\t\t\t\t},\r\n\t\t\t\tondisable:true,\r\n\t\t\t\tmark:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tmark:function(dialog,storage,player){\r\n\t\t\t\t\t\tif(storage&&storage.length){\r\n\t\t\t\t\t\t\tif(player.isUnderControl(true)){\r\n\t\t\t\t\t\t\t\tdialog.addSmall([storage,'character']);\r\n\t\t\t\t\t\t\t\tvar skills=[];\r\n\t\t\t\t\t\t\t\tfor(var i in player.$.gzhuashen_map){\r\n\t\t\t\t\t\t\t\t\tskills.addArray(player.$.gzhuashen_map[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tdialog.addText('可用技能：'+(skills.length?get.translation(skills):'无'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\treturn '共有'+get.cnNumber(storage.length)+'张“化身”'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\treturn '没有化身';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcontent:function(storage,player){\r\n\t\t\t\t\t\tif(player.isUnderControl(true)){\r\n\t\t\t\t\t\t\tvar skills=[];\r\n\t\t\t\t\t\t\tfor(var i in player.$.gzhuashen_map){\r\n\t\t\t\t\t\t\t\tskills.addArray(player.$.gzhuashen_map[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn get.translation(storage)+'；可用技能：'+(skills.length?get.translation(skills):'无');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\treturn '共有'+get.cnNumber(storage.length)+'张“化身”'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfilterSkill:function(name){\r\n\t\t\t\t\tvar skills=lib.character[name][3].slice(0);\r\n\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\tvar info=lib.skill[skills[i]];\r\n\t\t\t\t\t\tif(info.unique||info.limited||info.mainSkill||info.viceSkill||get.is.locked(skills[i])){\r\n\t\t\t\t\t\t\tskills.splice(i--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn skills;\r\n\t\t\t\t},\r\n\t\t\t\taddCharacter:function(player,name,show){\r\n\t\t\t\t\tvar skills=lib.skill.gzhuashen.filterSkill(name);\r\n\t\t\t\t\tif(skills.length){\r\n\t\t\t\t\t\tplayer.$.gzhuashen_map[name]=skills;\r\n\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\tplayer.addAdditionalSkill('hidden:gzhuashen',skills[i],true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.$.gzhuashen.add(name);\r\n\t\t\t\t\tplayer.updateMarks('gzhuashen');\r\n\t\t\t\t\t_status.characterlist.remove(name);\r\n\t\t\t\t\tif(show){\r\n\t\t\t\t\t\tlib.skill.gzhuashen.drawCharacter(player,[name]);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdrawCharacter:function(player,list){\r\n\t\t\t\t\tgame.broadcastAll(function(player,list){\r\n\t\t\t\t\t\tif(player.isUnderControl(true)){\r\n\t\t\t\t\t\t\tvar cards=[];\r\n\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\tvar cardname='huashen_card_'+list[i];\r\n\t\t\t\t\t\t\t\tlib.card[cardname]={\r\n\t\t\t\t\t\t\t\t\tfullimage:true,\r\n\t\t\t\t\t\t\t\t\timage:'character:'+list[i]\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tlib.translate[cardname]=get.rawName2(list[i]);\r\n\t\t\t\t\t\t\t\tcards.push(game.createCard(cardname,'',''));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.$draw(cards,'nobroadcast');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},player,list);\r\n\t\t\t\t},\r\n\t\t\t\tremoveCharacter:function(player,name){\r\n\t\t\t\t\tvar skills=lib.skill.gzhuashen.filterSkill(name);\r\n\t\t\t\t\tif(skills.length){\r\n\t\t\t\t\t\tdelete player.$.gzhuashen_map[name];\r\n\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\tvar remove=true;\r\n\t\t\t\t\t\t\tfor(var j in player.$.gzhuashen_map){\r\n\t\t\t\t\t\t\t\tif(j!=name&&game.expandSkills(player.$.gzhuashen_map[j].slice(0)).contains(skills[i])){\r\n\t\t\t\t\t\t\t\t\tremove=false;break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(remove){\r\n\t\t\t\t\t\t\t\tplayer.removeAdditionalSkill('hidden:gzhuashen',skills[i]);\r\n\t\t\t\t\t\t\t\tplayer.$.gzhuashen_removing.remove(skills[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.$.gzhuashen.remove(name);\r\n\t\t\t\t\tplayer.updateMarks('gzhuashen');\r\n\t\t\t\t\t_status.characterlist.add(name);\r\n\t\t\t\t},\r\n\t\t\t\tgetSkillSources:function(player,skill){\r\n\t\t\t\t\tif(player.getStockSkills().contains(skill)) return [];\r\n\t\t\t\t\tvar sources=[];\r\n\t\t\t\t\tfor(var i in player.$.gzhuashen_map){\r\n\t\t\t\t\t\tif(game.expandSkills(player.$.gzhuashen_map[i].slice(0)).contains(skill)) sources.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn sources;\r\n\t\t\t\t},\r\n\t\t\t\tsubfrequent:['add'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tadd:{\r\n\t\t\t\t\t\ttrigger:{player:'phaseBeginStart'},\r\n\t\t\t\t\t\tfrequent:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.$.gzhuashen.length<2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=_status.characterlist.randomGets(5);\r\n\t\t\t\t\t\t\tif(!list.length){\r\n\t\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.chooseButton([1,2]).set('ai',function(button){\r\n\t\t\t\t\t\t\t\treturn get.rank(button.link,true);\r\n\t\t\t\t\t\t\t}).set('createDialog',['选择至多两张武将牌作为“化身”',[list,'character']]);\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<result.links.length;i++){\r\n\t\t\t\t\t\t\t\t\tlib.skill.gzhuashen.addCharacter(player,result.links[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tlib.skill.gzhuashen.drawCharacter(player,result.links.slice(0));\r\n\t\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\t\tplayer.addTempSkill('gzhuashen_triggered');\r\n\t\t\t\t\t\t\t\tgame.log(player,'获得了'+get.cnNumber(result.links.length)+'张','#g化身');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tswap:{\r\n\t\t\t\t\t\ttrigger:{player:'phaseBeginStart'},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.hasSkill('gzhuashen_triggered')) return false;\r\n\t\t\t\t\t\t\treturn player.$.gzhuashen.length>=2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=player.$.gzhuashen.slice(0);\r\n\t\t\t\t\t\t\tif(!list.length){\r\n\t\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.chooseButton().set('ai',function(){\r\n\t\t\t\t\t\t\t\treturn Math.random()-0.3;\r\n\t\t\t\t\t\t\t}).set('createDialog',['是否替换一张“化身”？',[list,'character']]);\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tplayer.logSkill('gzhuashen');\r\n\t\t\t\t\t\t\t\tgame.log(player,'替换了一张','#g化身');\r\n\t\t\t\t\t\t\t\tlib.skill.gzhuashen.addCharacter(player,_status.characterlist.randomGet(),true);\r\n\t\t\t\t\t\t\t\tlib.skill.gzhuashen.removeCharacter(player,result.links[0]);\r\n\t\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttriggered:{},\r\n\t\t\t\t\tflash:{\r\n\t\t\t\t\t\thookTrigger:{\r\n\t\t\t\t\t\t\tlog:function(player,skill){\r\n\t\t\t\t\t\t\t\tvar sources=lib.skill.gzhuashen.getSkillSources(player,skill);\r\n\t\t\t\t\t\t\t\tif(sources.length){\r\n\t\t\t\t\t\t\t\t\tplayer.flashAvatar('gzhuashen',sources.randomGet());\r\n\t\t\t\t\t\t\t\t\tplayer.$.gzhuashen_removing.add(skill);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttrigger:{player:['useSkillBegin','useCard','respond']},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.skill&&lib.skill.gzhuashen.getSkillSources(player,event.skill).length>0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tlib.skill.gzhuashen_flash.hookTrigger.log(player,trigger.skill);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tclear:{\r\n\t\t\t\t\t\ttrigger:{player:'phaseAfter'},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.gzhuashen_trigger.length=0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdisallow:{\r\n\t\t\t\t\t\thookTrigger:{\r\n\t\t\t\t\t\t\tblock:function(event,player,name,skill){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<player.$.gzhuashen_trigger.length;i++){\r\n\t\t\t\t\t\t\t\t\tvar info=player.$.gzhuashen_trigger[i];\r\n\t\t\t\t\t\t\t\t\tif(info[0]==event&&info[1]==name&&\r\n\t\t\t\t\t\t\t\t\tlib.skill.gzhuashen.getSkillSources(player,skill).length>0){\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tremove:{\r\n\t\t\t\t\t\ttrigger:{player:['useSkillAfter','useCardAfter','respondAfter','triggerAfter','skillAfter']},\r\n\t\t\t\t\t\thookTrigger:{\r\n\t\t\t\t\t\t\tafter:function(event,player){\r\n\t\t\t\t\t\t\t\tif(event._direct&&!player.$.gzhuashen_removing.contains(event.skill)) return false;\r\n\t\t\t\t\t\t\t\tif(lib.skill[event.skill].silent) return false;\r\n\t\t\t\t\t\t\t\treturn lib.skill.gzhuashen.getSkillSources(player,event.skill).length>0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.skill&&lib.skill.gzhuashen.getSkillSources(player,event.skill).length>0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tif(trigger.name=='trigger'){\r\n\t\t\t\t\t\t\t\tplayer.$.gzhuashen_trigger.push([trigger._trigger,trigger.triggername]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar sources=lib.skill.gzhuashen.getSkillSources(player,trigger.skill);\r\n\t\t\t\t\t\t\tif(sources.length==1){\r\n\t\t\t\t\t\t\t\tevent.directresult=sources[0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tplayer.chooseButton(true).set('createDialog',['移除一张“化身”牌',[sources,'character']]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(!event.directresult&&result&&result.links[0]){\r\n\t\t\t\t\t\t\t\tevent.directresult=result.links[0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar name=event.directresult;\r\n\t\t\t\t\t\t\tlib.skill.gzhuashen.removeCharacter(player,name);\r\n\t\t\t\t\t\t\tgame.log(player,'移除了化身牌','#g'+get.translation(name));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tnofrequent:true,\r\n\t\t\t\t\tskillTagFilter:function(player,tag,arg){\r\n\t\t\t\t\t\tif(arg&&player.$.gzhuashen){\r\n\t\t\t\t\t\t\tif(lib.skill.gzhuashen.getSkillSources(player,arg).length>0){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzxiongsuan:{\r\n\t\t\t\tlimited:true,\r\n\t\t\t\taudio:'xiongsuan',\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tfilterCard:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('h');\r\n\t\t\t\t},\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target.isFriendOf(player);\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\treturn 7-get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.awakenSkill('gzxiongsuan');\r\n\t\t\t\t\ttarget.damage('nocard');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.draw(3);\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tvar skills=target.getOriginalSkills();\r\n\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\tif(lib.skill[skills[i]].limited&&target.awakenedSkills.contains(skills[i])){\r\n\t\t\t\t\t\t\tlist.push(skills[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(list.length==1){\r\n\t\t\t\t\t\ttarget.$.gzxiongsuan_restore=list[0];\r\n\t\t\t\t\t\ttarget.addTempSkill('gzxiongsuan_restore','phaseZhunbeiBegin');\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(list.length>1){\r\n\t\t\t\t\t\tplayer.chooseControl(list).set('prompt','选择一个限定技在回合结束后重置之');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\ttarget.$.gzxiongsuan_restore=result.control;\r\n\t\t\t\t\ttarget.addTempSkill('gzxiongsuan_restore','phaseZhunbeiBegin');\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\trestore:{\r\n\t\t\t\t\t\ttrigger:{global:'phaseAfter'},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.restoreSkill(player.$.gzxiongsuan_restore);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:4,\r\n\t\t\t\t\tdamage:true,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(target.hp>1){\r\n\t\t\t\t\t\t\t\tvar skills=target.getOriginalSkills();\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(lib.skill[skills[i]].limited&&target.awakenedSkills.contains(skills[i])){\r\n\t\t\t\t\t\t\t\t\t\treturn 8;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(target!=player) return 0;\r\n\t\t\t\t\t\t\tif(get.damageEffect(target,player,player)>=0) return 10;\r\n\t\t\t\t\t\t\tif(target.hp>=4) return 5;\r\n\t\t\t\t\t\t\tif(target.hp==3){\r\n\t\t\t\t\t\t\t\tif(player.countCards('h')<=2&&game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\treturn current.hp<=1&&get.attitude(player,current)<0;\r\n\t\t\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\t\t\treturn 3;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzsuishi:{\r\n\t\t\t\taudio:'suishi',\r\n\t\t\t\tpreHidden:['gzsuishi2'],\r\n\t\t\t\ttrigger:{global:'dying'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\t//priority:6.5,\r\n\t\t\t\tcheck:function(){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player!=player&&event.parent.name=='damage'&&event.parent.source&&event.parent.source.isFriendOf(player);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t},\r\n\t\t\t\tgroup:'gzsuishi2'\r\n\t\t\t},\r\n\t\t\tgzsuishi2:{\r\n\t\t\t\taudio:'suishi',\r\n\t\t\t\ttrigger:{global:'dieAfter'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcheck:function(){return false},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player.isFriendOf(player);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thongfa_respond:{\r\n\t\t\t\taudio:'huangjintianbingfu',\r\n\t\t\t\tforceaudio:true,\r\n\t\t\t\ttrigger:{player:'chooseToRespondBegin'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.responded) return false;\r\n\t\t\t\t\tif(!event.filterCard({name:'sha'})) return false;\r\n\t\t\t\t\tvar zhu=get.zhu(player,'hongfa');\r\n\t\t\t\t\tif(zhu&&zhu.$.huangjintianbingfu&&zhu.$.huangjintianbingfu.length>0){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar zhu=get.zhu(player,'hongfa');\r\n\t\t\t\t\tplayer.chooseCardButton(get.prompt('huangjintianbingfu'),zhu.$.huangjintianbingfu).set('ai',function(){\r\n\t\t\t\t\t\tif(_status.event.goon) return 1;\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}).set('goon',player.countCards('h','sha')==0);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar card=result.links[0];\r\n\t\t\t\t\t\ttrigger.untrigger();\r\n\t\t\t\t\t\ttrigger.responded=true;\r\n\t\t\t\t\t\ttrigger.result={bool:true,card:{name:'sha'},cards:[card]};\r\n\t\t\t\t\t\tvar zhu=get.zhu(player,'hongfa');\r\n\t\t\t\t\t\tzhu.$.huangjintianbingfu.remove(card);\r\n\t\t\t\t\t\tzhu.syncStorage('huangjintianbingfu');\r\n\t\t\t\t\t\tzhu.updateMarks('huangjintianbingfu');\r\n\t\t\t\t\t\tplayer.logSkill('hongfa_respond');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thongfa_use:{\r\n\t\t\t\taudio:'huangjintianbingfu',\r\n\t\t\t\tforceaudio:true,\r\n\t\t\t\tenable:'chooseToUse',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(!event.filterCard({name:'sha'},player)) return false;\r\n\t\t\t\t\tvar zhu=get.zhu(player,'hongfa');\r\n\t\t\t\t\tif(zhu&&zhu.$.huangjintianbingfu&&zhu.$.huangjintianbingfu.length>0){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tchooseButton:{\r\n\t\t\t\t\tdialog:function(event,player){\r\n\t\t\t\t\t\tvar zhu=get.zhu(player,'hongfa');\r\n\t\t\t\t\t\treturn ui.create.dialog('黄巾天兵符',zhu.$.huangjintianbingfu,'hidden');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbackup:function(links,player){\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tfilterCard:function(){return false},\r\n\t\t\t\t\t\t\tselectCard:-1,\r\n\t\t\t\t\t\t\tviewAs:{name:'sha',cards:links},\r\n\t\t\t\t\t\t\tcards:links,\r\n\t\t\t\t\t\t\tonuse:function(result,player){\r\n\t\t\t\t\t\t\t\tresult.cards=lib.skill[result.skill].cards;\r\n\t\t\t\t\t\t\t\tvar card=result.cards[0];\r\n\t\t\t\t\t\t\t\tvar zhu=get.zhu(player,'hongfa');\r\n\t\t\t\t\t\t\t\tzhu.$.huangjintianbingfu.remove(card);\r\n\t\t\t\t\t\t\t\tzhu.syncStorage('huangjintianbingfu');\r\n\t\t\t\t\t\t\t\tzhu.updateMarks('huangjintianbingfu');\r\n\t\t\t\t\t\t\t\tplayer.logSkill('hongfa_use',result.targets);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tprompt:function(links,player){\r\n\t\t\t\t\t\treturn '选择杀的目标';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\trespondSha:true,\r\n\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\tvar zhu=get.zhu(player,'hongfa');\r\n\t\t\t\t\t\tif(zhu&&zhu.$.huangjintianbingfu&&zhu.$.huangjintianbingfu.length>0){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\torder:function(){\r\n\t\t\t\t\t\treturn get.order({name:'sha'})-0.1;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player){\r\n\t\t\t\t\t\t\tif(player.countCards('h','sha')) return 0;\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thongfa:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.$.huangjintianbingfu=[];\r\n\t\t\t\t},\r\n\t\t\t\tderivation:'huangjintianbingfu',\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\ttrigger:{player:'phaseZhunbeiBegin'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.$.huangjintianbingfu.length==0&&get.population('qun')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar cards=get.cards(get.population('qun'));\r\n\t\t\t\t\tplayer.$.huangjintianbingfu.addArray(cards);\r\n\t\t\t\t\tgame.cardsGotoSpecial(cards);\r\n\t\t\t\t\tplayer.syncStorage('huangjintianbingfu');\r\n\t\t\t\t\tplayer.updateMarks('huangjintianbingfu');\r\n\t\t\t\t\t//event.trigger('addCardToStorage');\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:2,\r\n\t\t\t\t},\r\n\t\t\t\tgroup:'hongfa_hp',\r\n\t\t\t\tglobal:['hongfa_use','hongfa_respond'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\thp:{\r\n\t\t\t\t\t\taudio:true,\r\n\t\t\t\t\t\ttrigger:{player:'loseHpBefore'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.$.huangjintianbingfu.length>0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tplayer.chooseCardButton(get.prompt('hongfa'),player.$.huangjintianbingfu).set('ai',function(){\r\n\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tvar card=result.links[0];\r\n\t\t\t\t\t\t\t\tgame.cardsDiscard(card);\r\n\t\t\t\t\t\t\t\tplayer.$.huangjintianbingfu.remove(card);\r\n\t\t\t\t\t\t\t\tplayer.$throw(card,1000);\r\n\t\t\t\t\t\t\t\tplayer.updateMarks('huangjintianbingfu');\r\n\t\t\t\t\t\t\t\tplayer.syncStorage('huangjintianbingfu');\r\n\t\t\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\t\t\tplayer.logSkill('hongfa_hp');\r\n\t\t\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\twendao:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilterCard:function(card){\r\n\t\t\t\t\treturn get.name(card)!='taipingyaoshu'&&get.color(card)=='red';\r\n\t\t\t\t},\r\n\t\t\t\tposition:'he',\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tonChooseToUse:function(event){\r\n\t\t\t\t\tif(game.online) return;\r\n\t\t\t\t\tevent.set('wendao',function(){\r\n\t\t\t\t\t\tfor(var i=0;i<ui.discardPile.childElementCount;i++){\r\n\t\t\t\t\t\t\tif(ui.discardPile.childNodes[i].name=='taipingyaoshu') return true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current.countCards('ej','taipingyaoshu');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}());\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.wendao==true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(var i=0;i<ui.discardPile.childElementCount;i++){\r\n\t\t\t\t\t\tif(ui.discardPile.childNodes[i].name=='taipingyaoshu'){\r\n\t\t\t\t\t\t\tlist.add(ui.discardPile.childNodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\tvar ej=current.getCards('ej','taipingyaoshu');\r\n\t\t\t\t\t\tif(ej.length){\r\n\t\t\t\t\t\t\tlist.addArray(ej);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\tvar card=list.randomGet();\r\n\t\t\t\t\t\tvar owner=get.owner(card);\r\n\t\t\t\t\t\tif(owner){\r\n\t\t\t\t\t\t\tplayer.gain(card,owner,'give');\r\n\t\t\t\t\t\t\tplayer.line(owner,'green');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tplayer.gain(card,'log');\r\n\t\t\t\t\t\t\tplayer.$draw(card);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:8.5,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thuangjintianbingfu:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tnopop:true,\r\n\t\t\t\tmark:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'cards',\r\n\t\t\t\t\tonunmark:function(storage,player){\r\n\t\t\t\t\t\tif(storage&&storage.length){\r\n\t\t\t\t\t\t\tplayer.$throw(storage,1000);\r\n\t\t\t\t\t\t\tgame.cardsDiscard(storage);\r\n\t\t\t\t\t\t\tgame.log(storage,'被置入了弃牌堆');\r\n\t\t\t\t\t\t\tstorage.length=0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmark:function(dialog,content,player){\r\n\t\t\t\t\t\tif(content&&content.length){\r\n\t\t\t\t\t\t\tdialog.addSmall(content);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.addText('<ul style=\"margin-top:5px;padding-left:22px;\"><li>当你计算群势力角色数时，每一张“天兵”均可视为一名群势力角色。<li>每当你失去体力时，你可改为将一张“天兵”置入弃牌堆。<li>与你势力相同的角色可将一张“天兵”当【杀】使用或打出。',false)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\twuxin:{\r\n\t\t\t\t// unique:true,\r\n\t\t\t\ttrigger:{player:'phaseDrawBegin1'},\r\n\t\t\t\t// frequent:'check',\r\n\t\t\t\t// check:function(event,player){\r\n\t\t\t\t// \tvar num=get.population('qun');\r\n\t\t\t\t// \tif(player.hasSkill('huangjintianbingfu')){\r\n\t\t\t\t// \t\tnum+=player.$.huangjintianbingfu.length;\r\n\t\t\t\t// \t}\r\n\t\t\t\t// \treturn num>event.num;\r\n\t\t\t\t// },\r\n\t\t\t\taudio:2,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn get.population('qun')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar num=get.population('qun');\r\n\t\t\t\t\tif(player.hasSkill('huangjintianbingfu')){\r\n\t\t\t\t\t\tnum+=player.$.huangjintianbingfu.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.chooseCardButton(num,true,get.cards(num),'按顺序将卡牌置于牌堆顶（先选择的在上）').set('ai',function(button){\r\n\t\t\t\t\t\treturn get.value(button.link);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar list=result.links.slice(0);\r\n\t\t\t\t\t\twhile(list.length){\r\n\t\t\t\t\t\t\tui.cardPile.insertBefore(list.pop(),ui.cardPile.firstChild);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.updateRoundNumber();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tzhangwu:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:2,\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['zhangwu_gain','zhangwu_clear','zhangwu_count1','zhangwu_count2','zhangwu_count3'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tgain:{\r\n\t\t\t\t\t\taudio:'zhangwu',\r\n\t\t\t\t\t\ttrigger:{global:['discardAfter','respondAfter','useCardAfter','equipAfter',\r\n\t\t\t\t\t\t\t'judgeAfter','useSkillAfter','phaseDrawBegin','phaseAfter']},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.$.zhangwu){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<player.$.zhangwu.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(get.owner(player.$.zhangwu[i])==player) continue;\r\n\t\t\t\t\t\t\t\t\tvar position=get.position(player.$.zhangwu[i]);\r\n\t\t\t\t\t\t\t\t\tif(position&&position!='s'&&position!='c'){\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(event.name=='equip'&&player!=event.player&&event.card.name=='feilongduofeng') return true;\r\n\t\t\t\t\t\t\t//if(game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t//\treturn current!=player&&current.getEquip('feilongduofeng');\r\n\t\t\t\t\t\t\t//})){\r\n\t\t\t\t\t\t\t//\treturn true;\r\n\t\t\t\t\t\t\t//}\r\n\t\t\t\t\t\t\tif(['discard','respond','useCard'].contains(event.name)&&event.cards){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<event.cards.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(event.cards[i].name=='feilongduofeng'&&get.position(event.cards[i])=='d'){\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<ui.discardPile.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tif(ui.discardPile.childNodes[i].name=='feilongduofeng') return true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tif(trigger.name=='equip'||trigger.name=='respond'||trigger.delay==false) game.delay();\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\t/*game.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(current!=player){\r\n\t\t\t\t\t\t\t\t\tvar es=current.getEquip('feilongduofeng');\r\n\t\t\t\t\t\t\t\t\tif(es){\r\n\t\t\t\t\t\t\t\t\t\tlist.add(es);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});*/\r\n\t\t\t\t\t\t\tif(trigger.name=='equip'&&player!=trigger.player) list.add(trigger.card);\r\n\t\t\t\t\t\t\tif(['discard','respond','useCard'].contains(trigger.name)&&trigger.cards){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<trigger.cards.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(trigger.cards[i].name=='feilongduofeng'&&get.position(trigger.cards[i])=='d'){\r\n\t\t\t\t\t\t\t\t\t\ttrigger.cards[i].fix();\r\n\t\t\t\t\t\t\t\t\t\tlist.add(trigger.cards[i]);\r\n\t\t\t\t\t\t\t\t\t\tui.special.appendChild(trigger.cards[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<ui.discardPile.childElementCount;i++){\r\n\t\t\t\t\t\t\t\tif(ui.discardPile.childNodes[i].name=='feilongduofeng'){\r\n\t\t\t\t\t\t\t\t\tlist.add(ui.discardPile.childNodes[i]);\r\n\t\t\t\t\t\t\t\t\tui.special.appendChild(ui.discardPile.childNodes[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\t\t\tif(player.$.zhangwu){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(player.$.zhangwu.contains(list[i])){\r\n\t\t\t\t\t\t\t\t\t\tplayer.$.zhangwu.remove(list[i]);\r\n\t\t\t\t\t\t\t\t\t\tlist2.add(list[i]);\r\n\t\t\t\t\t\t\t\t\t\tlist.splice(i--,1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<player.$.zhangwu.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(get.owner(player.$.zhangwu[i])==player) continue;\r\n\t\t\t\t\t\t\t\t\tvar position=get.position(player.$.zhangwu[i]);\r\n\t\t\t\t\t\t\t\t\tif(position&&position!='s'&&position!='c'){\r\n\t\t\t\t\t\t\t\t\t\tlist2.add(player.$.zhangwu[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\t\t\tplayer.gain(list);\r\n\t\t\t\t\t\t\t\tvar owner=get.owner(list[0]);\r\n\t\t\t\t\t\t\t\tif(trigger.name!='respond'&&owner){\r\n\t\t\t\t\t\t\t\t\tplayer.line(owner,'green');\r\n\t\t\t\t\t\t\t\t\towner.$give(list,player);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tplayer.$gain2(list,true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tevent.delay=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(list2.length){\r\n\t\t\t\t\t\t\t\tplayer.showCards(get.translation(player)+'发动了【章武】',list2);\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<list2.length;i++){\r\n\t\t\t\t\t\t\t\t\tvar owner=get.owner(list2[i]);\r\n\t\t\t\t\t\t\t\t\tif(owner){\r\n\t\t\t\t\t\t\t\t\t\towner.lose(list2[i],ui.special);\r\n\t\t\t\t\t\t\t\t\t\tevent.delay=true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tevent.list2=list2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tif(event.delay){\r\n\t\t\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 3'\r\n\t\t\t\t\t\t\tif(event.list2&&event.list2.length){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<event.list2.length;i++){\r\n\t\t\t\t\t\t\t\t\tevent.list2[i].fix();\r\n\t\t\t\t\t\t\t\t\tui.cardPile.appendChild(event.list2[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.log(player,'将',event.list2,'置于牌堆底');\r\n\t\t\t\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcount1:{\r\n\t\t\t\t\t\ttrigger:{player:'loseAfter'},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(event.type!='gain'&&event.type!='equip') return true;\r\n\t\t\t\t\t\t\tif(event.parent.player==player) return true;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tif(!player.$.zhangwu){\r\n\t\t\t\t\t\t\t\tplayer.$.zhangwu=[];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<trigger.stockcards.length;i++){\r\n\t\t\t\t\t\t\t\tif(trigger.stockcards[i].name=='feilongduofeng'){\r\n\t\t\t\t\t\t\t\t\tplayer.$.zhangwu.add(trigger.stockcards[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcount2:{\r\n\t\t\t\t\t\taudio:'zhangwu',\r\n\t\t\t\t\t\ttrigger:{player:'loseAfter'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(lib.skill.zhangwu_count1.filter(event,player)){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var i=0;i<event.stockcards.length;i++){\r\n\t\t\t\t\t\t\t\tif(event.stockcards[i].name=='feilongduofeng'){\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\tfor(var i=0;i<trigger.stockcards.length;i++){\r\n\t\t\t\t\t\t\t\tif(trigger.stockcards[i].name=='feilongduofeng'){\r\n\t\t\t\t\t\t\t\t\tlist.add(trigger.stockcards[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\t\t\tif(trigger.type=='gain'){\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\t\ttrigger.parent.cards.remove(list[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(trigger.type=='equip'){\r\n\t\t\t\t\t\t\t\t\ttrigger.parent.cancelled=true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tplayer.showCards(get.translation(player)+'发动了【章武】',list);\r\n\t\t\t\t\t\t\t\tevent.list=list;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tfor(var i=0;i<event.list.length;i++){\r\n\t\t\t\t\t\t\t\tevent.list[i].fix();\r\n\t\t\t\t\t\t\t\tui.cardPile.appendChild(event.list[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.log(player,'将',event.list,'置于牌堆底');\r\n\t\t\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcount3:{\r\n\t\t\t\t\t\taudio:'zhangwu',\r\n\t\t\t\t\t\ttrigger:{global:'equipBefore'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn event.card&&event.card.name=='feilongduofeng'&&event.player!=player&&\r\n\t\t\t\t\t\t\t\tplayer.$.zhangwu&&player.$.zhangwu.contains(event.card);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\t\ttrigger.card.fix();\r\n\t\t\t\t\t\t\tplayer.showCards(get.translation(player)+'发动了【章武】',[trigger.card]);\r\n\t\t\t\t\t\t\tvar owner=get.owner(trigger.card);\r\n\t\t\t\t\t\t\tif(owner){\r\n\t\t\t\t\t\t\t\towner.lose(trigger.card,ui.special);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.$.zhangwu.remove(trigger.card);\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\ttrigger.card.fix();\r\n\t\t\t\t\t\t\tui.cardPile.appendChild(trigger.card);\r\n\t\t\t\t\t\t\tgame.log(player,'将',trigger.card,'置于牌堆底');\r\n\t\t\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tclear:{\r\n\t\t\t\t\t\ttrigger:{global:'phaseAfter'},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tdelete player.$.zhangwu;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshouyue:{\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tgroup:'wuhujiangdaqi',\r\n\t\t\t\tderivation:'wuhujiangdaqi',\r\n\t\t\t\tmark:true,\r\n\t\t\t},\r\n\t\t\twuhujiangdaqi:{\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tnopop:true,\r\n\t\t\t\tmark:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:\"@<div style=\\\"margin-top:-5px\\\"><div class=\\\"skill\\\">【武圣】</div><div class=\\\"skillinfo\\\">将“红色牌”改为“任意牌”</div><div class=\\\"skill\\\">【咆哮】</div><div class=\\\"skillinfo\\\">增加描述“你使用的【杀】无视其他角色的防具”</div><div class=\\\"skill\\\">【龙胆】</div><div class=\\\"skillinfo\\\">增加描述“你每发动一次‘龙胆’便摸一张牌”</div><div class=\\\"skill\\\">【烈弓】</div><div class=\\\"skillinfo\\\">增加描述“你的攻击范围+1”</div><div class=\\\"skill\\\">【铁骑】</div><div class=\\\"skillinfo\\\">将“一张明置的武将牌”改为“所有明置的武将牌”</div></div>\",\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjizhao:{\r\n\t\t\t\tderivation:'rerende',\r\n\t\t\t\tunique:true,\r\n\t\t\t\taudio:2,\r\n\t\t\t\tenable:'chooseToUse',\r\n\t\t\t\tmark:true,\r\n\t\t\t\tskillAnimation:true,\r\n\t\t\t\tanimationColor:'fire',\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.$.jizhao=false;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(player.$.jizhao) return false;\r\n\t\t\t\t\tif(event.type=='dying'){\r\n\t\t\t\t\t\tif(player!=event.dying) return false;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.awakenSkill('jizhao');\r\n\t\t\t\t\tplayer.$.jizhao=true;\r\n\t\t\t\t\tvar num=player.maxHp-player.countCards('h');\r\n\t\t\t\t\tif(num>0){\r\n\t\t\t\t\t\tplayer.draw(num);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(player.hp<2){\r\n\t\t\t\t\t\tplayer.recover(2-player.hp);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tplayer.removeSkill('shouyue');\r\n\t\t\t\t\tplayer.removeSkill('wuhujiangdaqi');\r\n\t\t\t\t\tplayer.addSkill('rerende');\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:1,\r\n\t\t\t\t\tskillTagFilter:function(player,arg,target){\r\n\t\t\t\t\t\tif(player!=target||player.$.jizhao) return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsave:true,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:10\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'limited'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzshoucheng:{\r\n\t\t\t\tinherit:'shoucheng',\r\n\t\t\t\taudio:'shoucheng',\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\tif(current==_status.currentPhase||!current.isFriendOf(player)) return false;\r\n\t\t\t\t\t\tvar evt=event.getl(current);\r\n\t\t\t\t\t\treturn evt&&evt.hs&&evt.hs.length&&current.countCards('h')==0;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\tif(current==_status.currentPhase||!current.isFriendOf(player)) return false;\r\n\t\t\t\t\t\tvar evt=trigger.getl(current);\r\n\t\t\t\t\t\treturn evt&&evt.hs&&evt.hs.length;\r\n\t\t\t\t\t}).sortBySeat(_status.currentPhase);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tvar target=event.list.shift();\r\n\t\t\t\t\tevent.target=target;\r\n\t\t\t\t\tif(target.isAlive()&&target.countCards('h')==0){\r\n\t\t\t\t\t\tplayer.chooseBool(get.prompt2('gzshoucheng',target)).set('ai',function(){\r\n\t\t\t\t\t\t\treturn get.attitude(_status.event.player,_status.event.getParent().target)>0;\r\n\t\t\t\t\t\t}).setHiddenSkill(event.name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.goto(3);\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill(event.name,target);\r\n\t\t\t\t\t\ttarget.draw();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tif(event.list.length) event.goto(1);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tyicheng:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{global:'useCardToTargeted'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.card.name=='sha'&&event.target.isFriendOf(player);\r\n\t\t\t\t},\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tlogTarget:'target',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\ttrigger.target.draw();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\ttrigger.target.chooseToDiscard('he',true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzjixi:{\r\n\t\t\t\tinherit:'jixi',\r\n\t\t\t\taudio:'jixi',\r\n\t\t\t\tmainSkill:true,\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tif(player.checkMainSkill('gzjixi')){\r\n\t\t\t\t\t\tplayer.removeMaxHp();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tziliang:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{global:'damageEnd'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player.isIn()&&event.player.isFriendOf(player)&&player.$.tuntian&&player.$.tuntian.length;\r\n\t\t\t\t},\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.checkViceSkill('ziliang');\r\n\t\t\t\t},\r\n\t\t\t\tviceSkill:true,\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseCardButton(get.prompt('ziliang',trigger.player),player.$.tuntian).set('ai',function(button){\r\n\t\t\t\t\t\treturn get.value(button.link);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar card=result.links[0];\r\n\t\t\t\t\t\tplayer.logSkill('ziliang',trigger.player);\r\n\t\t\t\t\t\tplayer.$.tuntian.remove(card);\r\n\t\t\t\t\t\tplayer.syncStorage('tuntian');\r\n\t\t\t\t\t\tif(!player.$.tuntian.length){\r\n\t\t\t\t\t\t\tplayer.unmarkSkill('tuntian');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tplayer.updateMarks('tuntian');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttrigger.player.gain(card);\r\n\t\t\t\t\t\tif(trigger.player==player){\r\n\t\t\t\t\t\t\tplayer.$draw(card,true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tplayer.$give(card,trigger.player);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thuyuan:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'phaseJieshuBegin'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('he',{type:'equip'})>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseCardTarget({\r\n\t\t\t\t\t\tfilterCard:function(card){\r\n\t\t\t\t\t\t\treturn get.type(card)=='equip';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tposition:'he',\r\n\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\t\t\treturn target.isEmpty(get.subtype(card));\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai1:function(card){\r\n\t\t\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai2:function(target){\r\n\t\t\t\t\t\t\treturn get.attitude(_status.event.player,target)-3;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprompt:get.prompt2('huyuan')\r\n\t\t\t\t\t}).setHiddenSkill('huyuan');\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar target=result.targets[0];\r\n\t\t\t\t\t\tplayer.logSkill('huyuan',target);\r\n\t\t\t\t\t\tevent.current=target;\r\n\t\t\t\t\t\ttarget.equip(result.cards[0]);\r\n\t\t\t\t\t\tif(target!=player){\r\n\t\t\t\t\t\t\tplayer.$give(result.cards,target,false);\r\n\t\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.chooseTarget('弃置一名角色的一张牌',function(card,player,target){\r\n\t\t\t\t\t\t\tvar source=_status.event.source;\r\n\t\t\t\t\t\t\treturn get.distance(source,target)<=1&&source!=target&&target.countCards('he');\r\n\t\t\t\t\t\t}).set('ai',function(target){\r\n\t\t\t\t\t\t\treturn -get.attitude(_status.event.player,target);\r\n\t\t\t\t\t\t}).set('source',target);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result.bool&&result.targets.length){\r\n\t\t\t\t\t\tevent.current.line(result.targets,'green');\r\n\t\t\t\t\t\tplayer.discardPlayerCard(true,result.targets[0],'he');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\theyi:{\r\n\t\t\t\tzhenfa:'inline',\r\n\t\t\t\tglobal:'heyi_distance'\r\n\t\t\t},\r\n\t\t\theyi_distance:{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tglobalTo:function(from,to,distance){\r\n\t\t\t\t\t\tif(game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current.hasSkill('heyi')&&current.inline(to)&&current!=to;\r\n\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\treturn distance+1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttianfu:{\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.checkMainSkill('tianfu');\r\n\t\t\t\t},\r\n\t\t\t\tmainSkill:true,\r\n\t\t\t\tinherit:'kanpo',\r\n\t\t\t\tzhenfa:'inline',\r\n\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\treturn _status.currentPhase&&_status.currentPhase.inline(player)&&!player.hasSkill('kanpo')&&player.countCards('h',{color:'black'})>0;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tyizhi:{\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tif(player.checkViceSkill('yizhi')&&!player.viceChanged){\r\n\t\t\t\t\t\tplayer.removeMaxHp();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tviceSkill:true,\r\n\t\t\t\tinherit:'guanxing',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn !player.hasSkill('guanxing');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzshangyi:{\r\n\t\t\t\taudio:'shangyi',\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('h')>0;\r\n\t\t\t\t},\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn player!=target&&(target.countCards('h')||target.isUnseen(2));\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\ttarget.viewHandcards(player);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(!target.countCards('h')){\r\n\t\t\t\t\t\tevent._result={index:1};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(!target.isUnseen(2)){\r\n\t\t\t\t\t\tevent._result={index:0};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.chooseControl().set('choiceList',[\r\n\t\t\t\t\t\t\t'观看'+get.translation(target)+'的手牌并可以弃置其中的一张黑色牌',\r\n\t\t\t\t\t\t\t'观看'+get.translation(target)+'的所有暗置的武将牌',\r\n\t\t\t\t\t\t]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result.index==0){\r\n\t\t\t\t\t\tplayer.discardPlayerCard(target,'h').set('filterButton',function(button){\r\n\t\t\t\t\t\t\treturn get.color(button.link)=='black';\r\n\t\t\t\t\t\t}).set('visible',true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.viewCharacter(target,2);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:11,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\treturn -target.countCards('h');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten:1.1\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tniaoxiang:{\r\n\t\t\t\tzhenfa:'siege',\r\n\t\t\t\taudio:'zniaoxiang',\r\n\t\t\t\tglobal:'niaoxiang_sha',\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\ttrigger:{global:'useCardToPlayered'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.card.name!='sha') return false;\r\n\t\t\t\t\tif(game.countPlayer()<4) return false;\r\n\t\t\t\t\treturn player.siege(event.target)&&event.player.siege(event.target);\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\taudio:'zniaoxiang',\r\n\t\t\t\tforceaudio:true,\r\n\t\t\t\tlogTarget:'target',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar id=trigger.target.playerid;\r\n\t\t\t\t\tvar map=trigger.getParent().customArgs;\r\n\t\t\t\t\tif(!map[id]) map[id]={};\r\n\t\t\t\t\tif(typeof map[id].shanRequired=='number'){\r\n\t\t\t\t\t\tmap[id].shanRequired++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tmap[id].shanRequired=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfengshi:{\r\n\t\t\t\taudio:'zfengshi',\r\n\t\t\t\tzhenfa:'siege',\r\n\t\t\t\ttrigger:{global:'useCardToPlayered'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.card.name!='sha'||game.countPlayer()<4) return false;\r\n\t\t\t\t\treturn player.siege(event.target)&&event.player.siege(event.target)&&event.target.countCards('e');\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'target',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.target.chooseToDiscard('e',true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzguixiu:{\r\n\t\t\t\taudio:'guixiu',\r\n\t\t\t\ttrigger:{player:['showCharacterAfter','removeCharacterBefore']},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.name=='removeCharacter'||event.name=='changeVice') return event.toRemove=='gz_mifuren'&&player.isDamaged();\r\n\t\t\t\t\treturn event.toShow.contains('gz_mifuren');\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(trigger.name=='showCharacter'){\r\n\t\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzcunsi:{\r\n\t\t\t\tderivation:'gzyongjue',\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\taudio:'cunsi',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.checkMainSkill('gzcunsi',false)||player.checkViceSkill('gzcunsi',false);\r\n\t\t\t\t},\r\n\t\t\t\tunique:true,\r\n\t\t\t\tforceunique:true,\r\n\t\t\t\tfilterTarget:true,\r\n\t\t\t\tskillAnimation:true,\r\n\t\t\t\tanimationColor:'orange',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(player.checkMainSkill('gzcunsi',false)){\r\n\t\t\t\t\t\tplayer.removeCharacter(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.removeCharacter(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\ttarget.addSkill('gzyongjue');\r\n\t\t\t\t\tif(target!=player){\r\n\t\t\t\t\t\ttarget.draw(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:9,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(player,target){\r\n\t\t\t\t\t\t\tvar num=0;\r\n\t\t\t\t\t\t\tif(player.isDamaged()&&target.isFriendOf(player)){\r\n\t\t\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t\t\t\tif(target.hasSkill('kanpo')) num+=0.5;\r\n\t\t\t\t\t\t\t\tif(target.hasSkill('liegong')) num+=0.5;\r\n\t\t\t\t\t\t\t\tif(target.hasSkill('tieji')) num+=0.5;\r\n\t\t\t\t\t\t\t\tif(target.hasSkill('gzrende')) num+=1.2;\r\n\t\t\t\t\t\t\t\tif(target.hasSkill('longdan')) num+=1.2;\r\n\t\t\t\t\t\t\t\tif(target.hasSkill('paoxiao')) num+=1.2;\r\n\t\t\t\t\t\t\t\tif(target.hasSkill('zhangwu')) num+=1.5;\r\n\t\t\t\t\t\t\t\tif(target!=player) num+=0.5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzyongjue:{\r\n\t\t\t\taudio:'yongjue',\r\n\t\t\t\ttrigger:{global:'useCardAfter'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event==event.player.getHistory('useCard')[0]&&event.card.name=='sha'&&_status.currentPhase==event.player&&event.player.isFriendOf(player)){\r\n\t\t\t\t\t\tfor(var i=0;i<event.cards.length;i++){\r\n\t\t\t\t\t\t\tif(get.position(event.cards[i],true)=='o'){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'若与你势力相同的一名角色于其回合内使用的第一张牌为【杀】，则该角色可以在此【杀】结算完成后获得之'\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar cards=[];\r\n\t\t\t\t\tfor(var i=0;i<trigger.cards.length;i++){\r\n\t\t\t\t\t\tif(get.position(trigger.cards[i],true)=='o'){\r\n\t\t\t\t\t\t\tcards.push(trigger.cards[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttrigger.player.gain(cards,'gain2');\r\n\t\t\t\t},\r\n\t\t\t\tglobal:'gzyongjue_ai'\r\n\t\t\t},\r\n\t\t\tgzyongjue_ai:{\r\n\t\t\t\tai:{\r\n\t\t\t\t\tpresha:true,\r\n\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\tif(!game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current.isFriendOf(player)&&current.hasSkill('gzyongjue');\r\n\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbaoling:{\r\n\t\t\t\ttrigger:{player:'phaseUseEnd'},\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.checkMainSkill('baoling');\r\n\t\t\t\t},\r\n\t\t\t\tmainSkill:true,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.hasViceCharacter();\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn player.hp<=1||get.guozhanRank(player.name2,player)<=3;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.removeCharacter(1);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.removeSkill('baoling');\r\n\t\t\t\t\tplayer.gainMaxHp(3,true);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tplayer.recover(3);\r\n\t\t\t\t\tplayer.addSkill('benghuai');\r\n\t\t\t\t},\r\n\t\t\t\tderivation:'benghuai'\r\n\t\t\t},\r\n\t\t\tgzmingshi:{\r\n\t\t\t\taudio:'mingshi',\r\n\t\t\t\ttrigger:{player:'damageBegin3'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.num>0&&event.source&&event.source.isUnseen(2);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num--;\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(player.hasSkillTag('jueqing',false,target)) return;\r\n\t\t\t\t\t\t\tif(!player.isUnseen(2)) return;\r\n\t\t\t\t\t\t\tvar num=get.tag(card,'damage');\r\n\t\t\t\t\t\t\tif(num){\r\n\t\t\t\t\t\t\t\tif(num>1) return 0.5;\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\thunshang:{\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tif(player.checkViceSkill('hunshang')&&!player.viceChanged){\r\n\t\t\t\t\t\tplayer.removeMaxHp();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['hunshang_yingzi','hunshang_yinghun'],\r\n\t\t\t},\r\n\t\t\treyingzi_sunce:{audio:2},\r\n\t\t\tyinghun_sunce:{audio:2},\r\n\t\t\thunshang_yingzi:{\r\n\t\t\t\tinherit:'yingzi',\r\n\t\t\t\taudio:'reyingzi_sunce',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.hp<=1&&!player.hasSkill('yingzi');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thunshang_yinghun:{\r\n\t\t\t\tinherit:'gzyinghun',\r\n\t\t\t\taudio:'yinghun_sunce',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.hp<=1&&player.isDamaged()&&!player.hasSkill('gzyinghun');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyingyang:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'compare',target:'compare'},\r\n\t\t\t\tfilter:function(event){\r\n\t\t\t\t\treturn !event.iwhile;\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseControl('点数+3','点数-3','cancel2').set('prompt',get.prompt2('yingyang')).set('ai',function(){\r\n\t\t\t\t\t\tif(_status.event.small) return 1;\r\n\t\t\t\t\t\telse return 0;\r\n\t\t\t\t\t}).set('small',trigger.small);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.index!=2){\r\n\t\t\t\t\t\tplayer.logSkill('yingyang');\r\n\t\t\t\t\t\tif(result.index==0){\r\n\t\t\t\t\t\t\tgame.log(player,'拼点牌点数+3');\r\n\t\t\t\t\t\t\tif(player==trigger.player){\r\n\t\t\t\t\t\t\t\ttrigger.num1+=3;\r\n\t\t\t\t\t\t\t\tif(trigger.num1>13) trigger.num1=13;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\ttrigger.num2+=3;\r\n\t\t\t\t\t\t\t\tif(trigger.num2>13) trigger.num2=13;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.log(player,'拼点牌点数-3');\r\n\t\t\t\t\t\t\tif(player==trigger.player){\r\n\t\t\t\t\t\t\t\ttrigger.num1-=3;\r\n\t\t\t\t\t\t\t\tif(trigger.num1<1) trigger.num1=1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\ttrigger.num2-=3;\r\n\t\t\t\t\t\t\t\tif(trigger.num2<1) trigger.num2=1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzqianxi:{\r\n\t\t\t\taudio:'qianxi',\r\n\t\t\t\ttrigger:{player:'phaseZhunbeiBegin'},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.judge();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tevent.color=result.color;\r\n\t\t\t\t\tplayer.chooseTarget(function(card,player,target){\r\n\t\t\t\t\t\treturn player!=target&&get.distance(player,target)<=1;\r\n\t\t\t\t\t},true).set('ai',function(target){\r\n\t\t\t\t\t\treturn -get.attitude(_status.event.player,target);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result.bool&&result.targets.length){\r\n\t\t\t\t\t\tresult.targets[0].storage.qianxi2=event.color;\r\n\t\t\t\t\t\tresult.targets[0].addSkill('qianxi2');\r\n\t\t\t\t\t\tplayer.line(result.targets,'green');\r\n\t\t\t\t\t\tgame.addVideo('storage',result.targets[0],['qianxi2',event.color]);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tgzduanchang:{\r\n\t\t\t\taudio:'duanchang',\r\n\t\t\t\ttrigger:{player:'die'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tforceDie:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.source&&event.source.isIn()&&event.source!=player&&\r\n\t\t\t\t\t(event.source.hasMainCharacter()||event.source.hasViceCharacter());\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(!trigger.source.hasViceCharacter()){\r\n\t\t\t\t\t\tevent._result={control:'主将'}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(!trigger.source.hasMainCharacter()){\r\n\t\t\t\t\t\tevent._result={control:'副将'}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.chooseControl('主将','副将',function(){\r\n\t\t\t\t\t\t\treturn _status.event.choice;\r\n\t\t\t\t\t\t}).set('prompt','令'+get.translation(trigger.source)+'失去一张武将牌的所有技能').set('forceDie',true).set('choice',function(){\r\n\t\t\t\t\t\tvar rank=get.guozhanRank(trigger.source.name1,trigger.source)-get.guozhanRank(trigger.source.name2,trigger.source);\r\n\t\t\t\t\t\tif(rank==0) rank=Math.random()>0.5?1:-1;\r\n\t\t\t\t\t\treturn (rank*get.attitude(player,trigger.source))>0?'副将':'主将';\r\n\t\t\t\t\t\t}());\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar skills;\r\n\t\t\t\t\tif(result.control=='主将'){\r\n\t\t\t\t\t\ttrigger.source.showCharacter(0);\r\n\t\t\t\t\t\tgame.broadcastAll(function(player){\r\n\t\t\t\t\t\t\tplayer.node.avatar.classList.add('disabled');\r\n\t\t\t\t\t\t},trigger.source);\r\n\t\t\t\t\t\tskills=lib.character[trigger.source.name][3];\r\n\t\t\t\t\t\tgame.log(trigger.source,'失去了主将技能');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\ttrigger.source.showCharacter(1);\r\n\t\t\t\t\t\tgame.broadcastAll(function(player){\r\n\t\t\t\t\t\t\tplayer.node.avatar2.classList.add('disabled');\r\n\t\t\t\t\t\t},trigger.source);\r\n\t\t\t\t\t\tskills=lib.character[trigger.source.name2][3];\r\n\t\t\t\t\t\tgame.log(trigger.source,'失去了副将技能');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\tlist.add(skills[i]);\r\n\t\t\t\t\t\tvar info=lib.skill[skills[i]];\r\n\t\t\t\t\t\tif(info.charlotte){list.splice(i--);continue};\r\n\t\t\t\t\t\tif(typeof info.derivation=='string'){\r\n\t\t\t\t\t\t\tlist.add(info.derivation);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(Array.isArray(info.derivation)){\r\n\t\t\t\t\t\t\tlist.addArray(info.derivation);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttrigger.source.removeSkill(list);\r\n\t\t\t\t\ttrigger.source.syncSkills();\r\n\t\t\t\t\tplayer.line(trigger.source,'green');\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'source',\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:function(player,target){\r\n\t\t\t\t\t\tif(target.hp==1) return 0.2;\r\n\t\t\t\t\t\treturn 1.5;\r\n\t\t\t\t\t},\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(!target.hasFriend()) return;\r\n\t\t\t\t\t\t\tif(target.hp<=1&&get.tag(card,'damage')) return [1,0,0,-2];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzweimu:{\r\n\t\t\t\taudio:'weimu',\r\n\t\t\t\ttrigger:{target:'useCardToTarget',player:'addJudgeBefore'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpriority:15,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn event.name=='addJudge'||(event.card.name!='chiling'&&get.effect(event.target,event.card,event.player,player)<0);\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn get.type(event.card,'trick')=='trick'&&get.color(event.card)=='black';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(trigger.name=='addJudge'){\r\n\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\tvar owner=get.owner(trigger.card);\r\n\t\t\t\t\t\tif(owner&&owner.getCards('hej').contains(trigger.card)) owner.lose(trigger.card,ui.discardPile);\r\n\t\t\t\t\t\telse game.cardsDiscard(trigger.card);\r\n\t\t\t\t\t\tgame.log(trigger.card,'进入了弃牌堆');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse trigger.getParent().targets.remove(player);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(get.type(card,'trick')=='trick'&&get.color(card)=='black') return 'zeroplayertarget';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzqianxun:{\r\n\t\t\t\taudio:'qianxun',\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\ttarget:'useCardToTarget',\r\n\t\t\t\t\tplayer:'addJudgeBefore',\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tpriority:15,\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn event.name=='addJudge'||get.effect(event.target,event.card,event.player,player)<0;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.card.name=='shunshou'||event.card.name=='lebu';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(trigger.name=='addJudge'){\r\n\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\tvar owner=get.owner(trigger.card);\r\n\t\t\t\t\t\tif(owner&&owner.getCards('hej').contains(trigger.card)) owner.lose(trigger.card,ui.discardPile);\r\n\t\t\t\t\t\telse game.cardsDiscard(trigger.card);\r\n\t\t\t\t\t\tgame.log(trigger.card,'进入了弃牌堆');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse trigger.getParent().targets.remove(player);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(card.name=='shunshou'||card.name=='lebu') return 'zeroplayertarget';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzkongcheng:{\r\n\t\t\t\taudio:'kongcheng',\r\n\t\t\t\ttrigger:{target:'useCardToTarget'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpriority:15,\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn get.effect(event.target,event.card,event.player,player)<0;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('h')==0&&(event.card.name=='sha'||event.card.name=='juedou');\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.getParent().targets.remove(player);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(target.countCards('h')==0&&(card.name=='sha'||card.name=='juedou')) return 'zeroplayertarget';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzxiaoji:{\r\n\t\t\t\tinherit:'xiaoji',\r\n\t\t\t\taudio:'xiaoji',\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzrende:{\r\n\t\t\t\taudio:'rende',\r\n\t\t\t\tgroup:['gzrende1'],\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tfilterCard:true,\r\n\t\t\t\tselectCard:[1,Infinity],\r\n\t\t\t\tdiscard:false,\r\n\t\t\t\tprepare:'give',\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn player!=target;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\tif(ui.selected.cards.length>2) return 0;\r\n\t\t\t\t\tif(ui.selected.cards.length&&ui.selected.cards[0].name=='du') return 0;\r\n\t\t\t\t\tif(!ui.selected.cards.length&&card.name=='du') return 20;\r\n\t\t\t\t\tvar player=get.owner(card);\r\n\t\t\t\t\tif(player.hp==player.maxHp||player.$.gzrende<0||player.countCards('h')+player.$.gzrende<=2){\r\n\t\t\t\t\t\tif(ui.selected.cards.length){\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar players=game.filterPlayer();\r\n\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\tif(players[i].hasSkill('haoshi')&&\r\n\t\t\t\t\t\t\t\t!players[i].isTurnedOver()&&\r\n\t\t\t\t\t\t\t\t!players[i].hasJudge('lebu')&&\r\n\t\t\t\t\t\t\t\tget.attitude(player,players[i])>=3&&\r\n\t\t\t\t\t\t\t\tget.attitude(players[i],player)>=3){\r\n\t\t\t\t\t\t\t\treturn 11-get.value(card);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(player.countCards('h')>player.hp) return 10-get.value(card);\r\n\t\t\t\t\t\tif(player.countCards('h')>2) return 6-get.value(card);\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn 10-get.value(card);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttarget.gain(cards,player);\r\n\t\t\t\t\tif(typeof player.$.gzrende!='number'){\r\n\t\t\t\t\t\tplayer.$.gzrende=0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(player.$.gzrende>=0){\r\n\t\t\t\t\t\tplayer.$.gzrende+=cards.length;\r\n\t\t\t\t\t\tif(player.$.gzrende>=3){\r\n\t\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t\t\tplayer.$.gzrende=-1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:function(skill,player){\r\n\t\t\t\t\t\tif(player.hp==player.maxHp||player.$.gzrende<0||player.countCards('h')+player.$.gzrende<=2){\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 10;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(ui.selected.cards.length&&ui.selected.cards[0].name=='du'){\r\n\t\t\t\t\t\t\t\treturn -10;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(target.hasJudge('lebu')) return 0;\r\n\t\t\t\t\t\t\tvar nh=target.countCards('h');\r\n\t\t\t\t\t\t\tvar np=player.countCards('h');\r\n\t\t\t\t\t\t\tif(player.hp==player.maxHp||player.$.gzrende<0||player.countCards('h')+player.$.gzrende<=2){\r\n\t\t\t\t\t\t\t\tif(nh>=np-1&&np<=player.hp&&!target.hasSkill('haoshi')) return 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn Math.max(1,5-nh);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(player==target&&get.type(card)=='equip'){\r\n\t\t\t\t\t\t\t\tif(player.countCards('e',{subtype:get.subtype(card)})){\r\n\t\t\t\t\t\t\t\t\tvar players=game.filterPlayer();\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\t\t\t\tif(players[i]!=player&&get.attitude(player,players[i])>0){\r\n\t\t\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten:0.8\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzrende1:{\r\n\t\t\t\ttrigger:{player:'phaseUseBegin'},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.$.gzrende=0;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzzhiheng:{\r\n\t\t\t\tinherit:'zhiheng',\r\n\t\t\t\taudio:'zhiheng',\r\n\t\t\t\tselectCard:function(){\r\n\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\tvar range1=[1,player.maxHp];\r\n\t\t\t\t\tif(player.hasSkill('dinglanyemingzhu_skill')){\r\n\t\t\t\t\t\tfor(var i=0;i<ui.selected.cards.length;i++){\r\n\t\t\t\t\t\t\tif(ui.selected.cards[i]==player.getEquip(5)) return range1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn [1,Infinity]\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn range1;\r\n\t\t\t\t},\r\n\t\t\t\tfilterCard:function(card,player){\r\n\t\t\t\t\tif(ui.selected.cards.length<player.maxHp||!player.hasSkill('dinglanyemingzhu_skill')) return true;\r\n\t\t\t\t\treturn card!=player.getEquip(5);\r\n\t\t\t\t},\r\n\t\t\t\tcomplexCard:true,\r\n\t\t\t\tcomplexSelect:true,\r\n\t\t\t\tprompt:function(){\r\n\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\tif(player.hasSkill('dinglanyemingzhu_skill')) return '出牌阶段限一次，你可以弃置任意张牌，然后摸等量的牌';\r\n\t\t\t\t\treturn '出牌阶段限一次，你可以弃置至多X张牌（X为你的体力上限），然后摸等量的牌';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tzhiheng:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\taudioname:['gz_jun_sunquan'],\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tusable:1,\r\n\t\t\t\tposition:'he',\r\n\t\t\t\tfilterCard:true,\r\n\t\t\t\tselectCard:[1,Infinity],\r\n\t\t\t\tprompt:'弃置任意张牌并摸等量的牌',\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\treturn 6-get.value(card)\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.draw(cards.length);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:1,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthreaten:1.5\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tduoshi:{\r\n\t\t\t\tenable:'chooseToUse',\r\n\t\t\t\tviewAs:{name:'yiyi'},\r\n\t\t\t\tusable:4,\r\n\t\t\t\tfilterCard:{color:'red'},\r\n\t\t\t\tposition:'hs',\r\n\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\treturn player.countCards('hs',{color:'red'})>0;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\treturn 5-get.value(card);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgzxiaoguo:{\r\n\t\t\t\tinherit:'xiaoguo',\r\n\t\t\t\taudio:'xiaoguo',\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar nono=(Math.abs(get.attitude(player,trigger.player))<3);\r\n\t\t\t\t\tif(get.damageEffect(trigger.player,player,player)<=0){\r\n\t\t\t\t\t\tnono=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar next=player.chooseToDiscard(get.prompt2('gzxiaoguo',trigger.player),{type:'basic'});\r\n\t\t\t\t\tnext.set('ai',function(card){\r\n\t\t\t\t\t\tif(_status.event.nono) return 0;\r\n\t\t\t\t\t\treturn 8-get.useful(card);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.set('logSkill',['gzxiaoguo',trigger.player]);\r\n\t\t\t\t\tnext.set('nono',nono);\r\n\t\t\t\t\tnext.setHiddenSkill('gzxiaoguo');\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar nono=(get.damageEffect(trigger.player,player,trigger.player)>=0);\r\n\t\t\t\t\t\ttrigger.player.chooseToDiscard('弃置一张装备牌，或受到一点伤害','he',{type:'equip'}).set('ai',function(card){\r\n\t\t\t\t\t\t\tif(_status.event.nono){\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(_status.event.player.hp==1) return 10-get.value(card);\r\n\t\t\t\t\t\t\treturn 9-get.value(card);\r\n\t\t\t\t\t\t}).set('nono',nono);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(!result.bool){\r\n\t\t\t\t\t\ttrigger.player.damage();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_mingzhi1:{\r\n\t\t\t\ttrigger:{player:'phaseBeginStart'},\r\n\t\t\t\tpriority:19,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar choice=1;\r\n\t\t\t\t\tfor(var i=0;i<player.hiddenSkills.length;i++){\r\n\t\t\t\t\t\tif(lib.skill[player.hiddenSkills[i]].ai){\r\n\t\t\t\t\t\t\tvar mingzhi=lib.skill[player.hiddenSkills[i]].ai.mingzhi;\r\n\t\t\t\t\t\t\tif(mingzhi==false){\r\n\t\t\t\t\t\t\t\tchoice=0;break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(typeof mingzhi=='function'&&mingzhi(trigger,player)==false){\r\n\t\t\t\t\t\t\t\tchoice=0;break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(player.isUnseen()){\r\n\t\t\t\t\t\tvar group=lib.character[player.name1][1];\r\n\t\t\t\t\t\tplayer.chooseControl('bumingzhi','明置'+get.translation(player.name1),\r\n\t\t\t\t\t\t\t'明置'+get.translation(player.name2),'tongshimingzhi',true).ai=function(event,player){\r\n\t\t\t\t\t\t\tif(player.hasSkillTag('mingzhi_yes')) return get.rand(1,2);\r\n\t\t\t\t\t\t\tif(player.hasSkillTag('mingzhi_no')) return 0;\r\n\t\t\t\t\t\t\tvar popu=get.population(lib.character[player.name1][1])\r\n\t\t\t\t\t\t\tif(popu>=2||(popu==1&&game.players.length<=4)){\r\n\t\t\t\t\t\t\t\treturn Math.random()<0.5?3:(Math.random()<0.5?2:1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(choice==0) return 0;\r\n\t\t\t\t\t\t\tif(get.population(group)>0&&player.wontYe()){\r\n\t\t\t\t\t\t\t\treturn Math.random()<0.2?(Math.random()<0.5?3:(Math.random()<0.5?2:1)):0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar nming=0;\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i]!=player&&game.players[i].identity!='unknown'){\r\n\t\t\t\t\t\t\t\t\tnming++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(nming==game.players.length-1) return Math.random()<0.5?(Math.random()<0.5?3:(Math.random()<0.5?2:1)):0;\r\n\t\t\t\t\t\t\treturn (Math.random()<0.1*nming/game.players.length)?(Math.random()<0.5?3:(Math.random()<0.5?2:1)):0;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(Math.random()<0.5) choice=0;\r\n\t\t\t\t\t\tif(player.isUnseen(0)){\r\n\t\t\t\t\t\t\tplayer.chooseControl('bumingzhi','明置'+get.translation(player.name1),true).choice=choice;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(player.isUnseen(1)){\r\n\t\t\t\t\t\t\tplayer.chooseControl('bumingzhi','明置'+get.translation(player.name2),true).choice=choice;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tswitch(result.control){\r\n\t\t\t\t\t\tcase '明置'+get.translation(player.name1):player.showCharacter(0);break;\r\n\t\t\t\t\t\tcase '明置'+get.translation(player.name2):player.showCharacter(1);break;\r\n\t\t\t\t\t\tcase 'tongshimingzhi':player.showCharacter(2);break;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t_mingzhi2:{\r\n\t\t\t\ttrigger:{player:'triggerHidden'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tforceDie:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tpriority:10,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tif(get.info(trigger.skill).silent){\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.skillHidden=true;\r\n\t\t\t\t\t\tvar bool1=(game.expandSkills(lib.character[player.name1][3]).contains(trigger.skill));\r\n\t\t\t\t\t\tvar bool2=(game.expandSkills(lib.character[player.name2][3]).contains(trigger.skill));\r\n\t\t\t\t\t\tvar nai=function(){\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\tif(!_status.event.yes) return false;\r\n\t\t\t\t\t\t\tif(player.hasSkillTag('mingzhi_no')) return false;\r\n\t\t\t\t\t\t\tif(player.hasSkillTag('mingzhi_yes')) return true;\r\n\t\t\t\t\t\t\tif(player.identity!='unknown') return true;\r\n\t\t\t\t\t\t\tif(Math.random()<0.5) return true;\r\n\t\t\t\t\t\t\tvar info=get.info(_status.event.hsskill);\r\n\t\t\t\t\t\t\tif(info&&info.ai&&info.ai.mingzhi==true) return true;\r\n\t\t\t\t\t\t\tif(info&&info.ai&&info.ai.maixie) return true;\r\n\t\t\t\t\t\t\tvar group=lib.character[player.name1][1];\r\n\t\t\t\t\t\t\tvar popu=get.population(lib.character[player.name1][1])\r\n\t\t\t\t\t\t\tif(popu>=2||(popu==1&&game.players.length<=4)){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(get.population(group)>0&&player.wontYe()){\r\n\t\t\t\t\t\t\t\treturn Math.random()<0.2?true:false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar nming=0;\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i]!=player&&game.players[i].identity!='unknown'){\r\n\t\t\t\t\t\t\t\t\tnming++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(nming==game.players.length-1) return Math.random()<0.5?true:false;\r\n\t\t\t\t\t\t\treturn (Math.random()<0.1*nming/game.players.length)?true:false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(bool1&&bool2){\r\n\t\t\t\t\t\t\tevent.name=player.name1;\r\n\t\t\t\t\t\t\tevent.name2=player.name2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tevent.name=bool1?player.name1:player.name2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar info=get.info(trigger.skill);\r\n\t\t\t\t\t\tvar next=player.chooseBool('是否明置'+get.translation(event.name)+'以发动【'+get.translation(trigger.skill)+'】？');\r\n\t\t\t\t\t\tnext.set('yes',!info.check||info.check(trigger._trigger,player));\r\n\t\t\t\t\t\tnext.set('hsskill',trigger.skill);\r\n\t\t\t\t\t\tnext.set('ai',nai);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tif(event.name==player.name1) player.showCharacter(0);\r\n\t\t\t\t\t\telse player.showCharacter(1);\r\n\t\t\t\t\t\ttrigger.revealed=true;\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.name2){\r\n\t\t\t\t\t\tvar info=get.info(trigger.skill);\r\n\t\t\t\t\t\tvar next=player.chooseBool('是否明置'+get.translation(event.name2)+'以发动【'+get.translation(trigger.skill)+'】？');\r\n\t\t\t\t\t\tnext.set('yes',!info.check||info.check(trigger._trigger,player));\r\n\t\t\t\t\t\tnext.set('ai',function(){\r\n\t\t\t\t\t\t\treturn _status.event.yes;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\ttrigger.untrigger();\r\n\t\t\t\t\t\ttrigger.cancelled=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(event.name2){\r\n\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\tplayer.showCharacter(1);\r\n\t\t\t\t\t\t\ttrigger.revealed=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\ttrigger.untrigger();\r\n\t\t\t\t\t\t\ttrigger.cancelled=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t_mingzhi3:{\r\n\t\t\t\ttrigger:{player:'phaseBefore'},\r\n\t\t\t\tpriority:19.1,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(player.$._mingzhi3) return false\r\n\t\t\t\t\tif(_status.connectMode){\r\n\t\t\t\t\t\tif(!lib.configOL.junzhu) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(!get.config('junzhu')) return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.$._mingzhi3=true;\r\n\t\t\t\t\tvar name=player.name1;\r\n\t\t\t\t\tif(!player.isUnseen(0)||name.indexOf('gz_')!=0\r\n\t\t\t\t\t||!lib.junList.contains(name.slice(3))||!lib.character['gz_jun_'+name.slice(3)]\r\n\t\t\t\t\t||(player.identity!='ye'&&player.identity!='unknown'&&lib.character[player.name1][1]!=player.identity)) event.finish();\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.chooseBool(\"是否将主武将牌替换为君主武将？\").ai=function(){\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\treturn player.name1=='gz_liubei'||!player.hasSkillTag('mingzhi_no');\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar from=player.name1;\r\n\t\t\t\t\t\tvar to='gz_jun_'+player.name1.slice(3);\r\n\t\t\t\t\t\tevent.maxHp=player.maxHp;\r\n\t\t\t\t\t\tplayer.reinit(from,to,4);\r\n\t\t\t\t\t\tif(lib.skill[to]) game.trySkillAudio(to,player);\r\n\t\t\t\t\t\tplayer.showCharacter(0);\r\n\t\t\t\t\t\tvar yelist=[];\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i].identity=='ye'&&game.players[i]._group==player.group&&lib.character[game.players[i].name1][1]!='ye'){\r\n\t\t\t\t\t\t\t\tyelist.push(game.players[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.broadcastAll(function(list,group){\r\n\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\tlist[i].identity=group;\r\n\t\t\t\t\t\t\t\tlist[i].setIdentity();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},yelist,player.group);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(player.maxHp>event.maxHp) player.recover(player.maxHp-event.maxHp);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgz_jun_liubei:{audio:true},\r\n\t\t\tgz_jun_caocao:{audio:true},\r\n\t\t\tgz_jun_sunquan:{audio:true},\r\n\t\t\tgz_jun_zhangjiao:{audio:true},\r\n\t\t\t_zhenfazhaohuan:{\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tusable:1,\r\n\t\t\t\tgetConfig:function(player,target){\r\n\t\t\t\t\tvar config={};\r\n\t\t\t\t\tvar skills=player.getSkills();\r\n\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\tvar info=get.info(skills[i]).zhenfa;\r\n\t\t\t\t\t\tif(info){\r\n\t\t\t\t\t\t\tconfig[info]=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(config.inline){\r\n\t\t\t\t\t\tvar next=target.getNext();\r\n\t\t\t\t\t\tvar previous=target.getPrevious();\r\n\t\t\t\t\t\tif(next==player||previous==player||next&&next.inline(player)||previous&&previous.inline(player)) return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(config.siege){\r\n\t\t\t\t\t\tif(target==player.getNext().getNext()||target==player.getPrevious().getPrevious()) return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(player.identity=='ye') return false;\r\n\t\t\t\t\tif(player.hasSkill('undist')) return false;\r\n\t\t\t\t\tif(game.countPlayer(function(current){\r\n\t\t\t\t\t\treturn !current.hasSkill('undist');\r\n\t\t\t\t\t})<4) return false;\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current!=player&&current.isUnseen()&&lib.skill._zhenfazhaohuan.getConfig(player,current);\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current!=player&&current.isUnseen();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.current=event.list.shift();\r\n\t\t\t\t\tif(lib.skill._zhenfazhaohuan.getConfig(player,event.current)){\r\n\t\t\t\t\t\tplayer.line(event.current,'green');\r\n\t\t\t\t\t\tif(event.current._group==player.group&&event.current.wontYe()){\r\n\t\t\t\t\t\t\tevent.current.chooseControl('明置主将','明置副将','取消').set('prompt','是否响应'+get.translation(player)+'的阵法召唤？').ai=function(){return Math.floor(Math.random()*2)};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse event.goto(3);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.goto(3);\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.control=='明置主将'){\r\n\t\t\t\t\t\tevent.current.showCharacter(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(result.control=='明置副将'){\r\n\t\t\t\t\t\tevent.current.showCharacter(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(event.list.length) event.goto(1);\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:5,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tushio_huanxin:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:['damageEnd','useCardAfter'],\r\n\t\t\t\t\tsource:'damageSource',\r\n\t\t\t\t},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tfilter:function(event,player,name){\r\n\t\t\t\t\tif(name=='useCardAfter') return get.type(event.card)=='equip';\r\n\t\t\t\t\tif(name=='damageEnd') return true;\r\n\t\t\t\t\treturn event.getParent().name=='sha';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.judge().set('callback',function(){\r\n\t\t\t\t\t\tvar card=event.judgeResult.card;\r\n\t\t\t\t\t\tif(card&&get.position(card,true)=='o'){\r\n\t\t\t\t\t\t\tplayer.gain(card,'gain2');\r\n\t\t\t\t\t\t\tplayer.chooseToDiscard(true,'he');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tushio_xilv:{\r\n\t\t\t\ttrigger:{player:'judgeEnd'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpreHidden:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.addTempSkill('ushio_xilv2',{player:'phaseJieshu'});\r\n\t\t\t\t\tplayer.addMark('ushio_xilv2',1,false);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tushio_xilv2:{\r\n\t\t\t\tonremove:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tmaxHandcard:function(player,num){\r\n\t\t\t\t\t\treturn num+player.countMark('ushio_xilv2');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'手牌上限+#',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tgame:{\r\n\t\t\tshowYexings:function(){\r\n\t\t\t\tif(_status.showYexings) return;\r\n\t\t\t\t_status.showYexings=true;\r\n\t\t\t\tvar next=game.createEvent('showYexings',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.targets=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn lib.character[current.name1][1]=='ye';\r\n\t\t\t\t\t}).sortBySeat(_status.currentPhase);\r\n\t\t\t\t\tevent.targets2=[];\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar target=targets.shift();\r\n\t\t\t\t\tevent.target=target;\r\n\t\t\t\t\ttarget.chooseBool('是否【暴露野心】，展示主将并继续战斗？','若选择“否”，则视为本局游戏失败');\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tevent.targets2.push(target);\r\n\t\t\t\t\t\ttarget.$fullscreenpop('暴露野心','thunder');\r\n\t\t\t\t\t\tgame.log(target,'暴露了野心');\r\n\t\t\t\t\t\ttarget.showCharacter(0);\r\n\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t\tif(targets.length) event.goto(1);\r\n\t\t\t\t\t\telse if(game.players.length<3){\r\n\t\t\t\t\t\t\tdelete _status.showYexings;\r\n\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(targets.length) event.goto(1);\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tvar winner=game.findPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn lib.character[current.name1][1]!='ye';\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(winner){\r\n\t\t\t\t\t\t\t\tgame.broadcastAll(function(id){\r\n\t\t\t\t\t\t\t\t\tgame.winner_id=id;\r\n\t\t\t\t\t\t\t\t},winner.playerid);\r\n\t\t\t\t\t\t\t\tgame.checkResult();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete _status.showYexings;\r\n\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tvar source=event.targets2.shift();\r\n\t\t\t\t\tevent.source=source;\r\n\t\t\t\t\tvar targets=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.identity!='ye'&&current!=source&&!get.is.jun(current)&&!event.targets2.contains(current)&&!current.$.yexinjia_friend;\r\n\t\t\t\t\t}).sortBySeat(source);\r\n\t\t\t\t\tif(!targets.length){\r\n\t\t\t\t\t\tdelete _status.showYexings;\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.targets=targets;\r\n\t\t\t\t\t\ttarget.chooseBool('是否发起【拉拢人心】？','令所有其他不为君主/暴露野心家的角色依次选择是否与你结盟。第一个选择加入的人将势力和胜利条件改为与你相同');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tif(!result.bool){\r\n\t\t\t\t\t\tif(event.targets2.length) event.goto(3);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar target=targets.shift();\r\n\t\t\t\t\tevent.target=target;\r\n\t\t\t\t\tsource.line(target,'green');\r\n\t\t\t\t\ttarget.chooseBool('是否响应'+get.translation(source)+'发起的【拉拢人心】？','将势力改为野心家，且视为和该角色阵营相同').set('ai',function(){\r\n\t\t\t\t\t\tif(game.players.length<4) return true;\r\n\t\t\t\t\t\tif(game.players.length<5) return Math.random()<0.5;\r\n\t\t\t\t\t\treturn Math.random()<0.3;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tgame.broadcastAll(function(player,target){\r\n\t\t\t\t\t\t\tplayer.say('加入');\r\n\t\t\t\t\t\t\tplayer.identity='ye';\r\n\t\t\t\t\t\t\tplayer.setIdentity('ye');\r\n\t\t\t\t\t\t\tplayer.$.yexinjia_friend=target;\r\n\t\t\t\t\t\t},target,source);\r\n\t\t\t\t\t\ttarget.markSkill('yexinjia_friend');\r\n\t\t\t\t\t\tsource.removeMark('yexinjia_mark',1);\r\n\t\t\t\t\t\ttarget.drawTo(4);\r\n\t\t\t\t\t\ttarget.recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\ttarget.chat('拒绝');\r\n\t\t\t\t\t\tgame.delay(1.5);\r\n\t\t\t\t\t\tif(targets.length) event.goto(4);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tif(event.targets2.length) event.goto(3);\r\n\t\t\t\t\telse delete _status.showYexings;\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetCharacterChoice:function(list,num){\r\n\t\t\t\tvar choice=list.splice(0,num).sort(function(a,b){\r\n\t\t\t\t\treturn (get.is.double(a)?1:-1)-(get.is.double(b)?1:-1);\r\n\t\t\t\t});\r\n\t\t\t\tvar map={wei:[],shu:[],wu:[],qun:[],key:[],jin:[],ye:[]};\r\n\t\t\t\tfor(var i=0;i<choice.length;i++){\r\n\t\t\t\t\tif(get.is.double(choice[i])){\r\n\t\t\t\t\t\tvar group=get.is.double(choice[i],true);\r\n\t\t\t\t\t\tfor(var ii of group){\r\n\t\t\t\t\t\t\tif(map[ii]&&map[ii].length){\r\n\t\t\t\t\t\t\t\tmap[ii].push(choice[i]);\r\n\t\t\t\t\t\t\t\tlib.character[choice[i]][1]=ii;\r\n\t\t\t\t\t\t\t\tgroup=false;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(group) choice.splice(i--,1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar group=lib.character[choice[i]][1];\r\n\t\t\t\t\t\tif(map[group]){\r\n\t\t\t\t\t\t\tmap[group].push(choice[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(map.ye.length){\r\n\t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\tif(i!='ye'&&map[i].length) return choice.randomSort();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tchoice.remove(map.ye[0]);\r\n\t\t\t\t\tmap.ye.remove(map.ye[0]);\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(lib.character[list[i]][1]!='ye'){\r\n\t\t\t\t\t\t\tchoice.push(list[i]);\r\n\t\t\t\t\t\t\tlist.splice(i--,1);\r\n\t\t\t\t\t\t\treturn choice.randomSort();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor(var i in map){\r\n\t\t\t\t\tif(map[i].length<2){\r\n\t\t\t\t\t\tif(map[i].length==1){\r\n\t\t\t\t\t\t\tchoice.remove(map[i][0]);\r\n\t\t\t\t\t\t\tlist.push(map[i][0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmap[i]=false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(choice.length==num-1){\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(map[lib.character[list[i]][1]]){\r\n\t\t\t\t\t\t\tchoice.push(list[i]);\r\n\t\t\t\t\t\t\tlist.splice(i--,1);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if(choice.length<num-1){\r\n\t\t\t\t\tvar group=null;\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(group){\r\n\t\t\t\t\t\t\tif(lib.character[list[i]][1]==group||lib.character[list[i]][1]=='ye'){\r\n\t\t\t\t\t\t\t\tchoice.push(list[i]);\r\n\t\t\t\t\t\t\t\tlist.splice(i--,1);\r\n\t\t\t\t\t\t\t\tif(choice.length>=num){\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(!map[lib.character[list[i]][1]]&&!get.is.double(list[i])){\r\n\t\t\t\t\t\t\t\tgroup=lib.character[list[i]][1];\r\n\t\t\t\t\t\t\t\tif(group=='ye') group=null;\r\n\t\t\t\t\t\t\t\tchoice.push(list[i]);\r\n\t\t\t\t\t\t\t\tlist.splice(i--,1);\r\n\t\t\t\t\t\t\t\tif(choice.length>=num){\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn choice.randomSort();\r\n\t\t\t},\r\n\t\t\tgetState:function(){\r\n\t\t\t\tvar state={};\r\n\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\tstate[i]={\r\n\t\t\t\t\t\tidentity:player.identity,\r\n\t\t\t\t\t\t//group:player.group,\r\n\t\t\t\t\t\tshown:player.ai.shown,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\treturn state;\r\n\t\t\t},\r\n\t\t\tupdateState:function(state){\r\n\t\t\t\tfor(var i in state){\r\n\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\tif(player){\r\n\t\t\t\t\t\tplayer.identity=state[i].identity;\r\n\t\t\t\t\t\t//player.group=state[i].group;\r\n\t\t\t\t\t\tplayer.ai.shown=state[i].shown;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetRoomInfo:function(uiintro){\r\n\t\t\t\tvar num,last;\r\n\t\t\t\tif(lib.configOL.initshow_draw=='off'){\r\n\t\t\t\t\tnum='关闭'\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnum={mark:'标记',draw:'摸牌'}[lib.configOL.initshow_draw];\r\n\t\t\t\t}\r\n\t\t\t\tuiintro.add('<div class=\"text chat\">首亮奖励：'+num);\r\n\t\t\t\tuiintro.add('<div class=\"text chat\">珠联璧合：'+(lib.configOL.zhulian?'开启':'关闭'));\r\n\t\t\t\tuiintro.add('<div class=\"text chat\">出牌时限：'+lib.configOL.choose_timeout+'秒');\r\n\t\t\t\tuiintro.add('<div class=\"text chat\">国战牌堆：'+(lib.configOL.guozhanpile?'开启':'关闭'));\r\n\t\t\t\tuiintro.add('<div class=\"text chat\">鏖战模式：'+(lib.configOL.aozhan?'开启':'关闭'));\r\n\t\t\t\tlast=uiintro.add('<div class=\"text chat\">观看下家副将：'+(lib.configOL.viewnext?'开启':'关闭'));\r\n\t\t\t\tlast.style.paddingBottom='8px';\r\n\t\t\t},\r\n\t\t\taddRecord:function(bool){\r\n\t\t\t\tif(typeof bool=='boolean'){\r\n\t\t\t\t\tvar data=lib.config.gameRecord.guozhan.data;\r\n\t\t\t\t\tvar identity=game.me.identity;\r\n\t\t\t\t\tif(!data[identity]){\r\n\t\t\t\t\t\tdata[identity]=[0,0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(bool){\r\n\t\t\t\t\t\tdata[identity][0]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tdata[identity][1]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list=lib.group.slice(0);\r\n\t\t\t\t\tlist.add('ye');\r\n\t\t\t\t\tvar str='';\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(list[i]!='shen'&&data[list[i]]){\r\n\t\t\t\t\t\t\tstr+=lib.translate[list[i]+'2']+'：'+data[list[i]][0]+'胜'+' '+data[list[i]][1]+'负<br>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.config.gameRecord.guozhan.str=str;\r\n\t\t\t\t\tgame.saveConfig('gameRecord',lib.config.gameRecord);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetIdentityList:function(player){\r\n\t\t\t\tif(!player.isUnseen()) return;\r\n\t\t\t\tif(player==game.me) return;\r\n\t\t\t\tvar list={\r\n\t\t\t\t\tholo:'杏',\r\n\t\t\t\t\tnijisanji:'虹',\r\n\t\t\t\t\tvtuber:'企',\r\n\t\t\t\t\tclubs:'社',\r\n\t\t\t\t\tye:'野',\r\n\t\t\t\t\tunknown:'猜'\r\n\t\t\t\t}\r\n\t\t\t\tvar num=Math.floor((game.players.length+game.dead.length)/2);\r\n\t\t\t\tvar noye=true;\r\n\t\t\t\tfor(let i in list){\r\n\t\t\t\t\tif(!['ye','unknown'].contains(i)&&get.population(i)>=num){\r\n\t\t\t\t\t\tdelete list[i];\r\n\t\t\t\t\t\tnoye=false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(noye){\r\n\t\t\t\t\tdelete list.ye;\r\n\t\t\t\t}\r\n\t\t\t\treturn list;\r\n\t\t\t},\r\n\t\t\tgetIdentityList2:function(list){\r\n\t\t\t\tfor(var i in list){\r\n\t\t\t\t\tswitch(i){\r\n\t\t\t\t\t\tcase 'unknown':list[i]='未知';break;\r\n\t\t\t\t\t\tcase 'ye':list[i]='野心家';break;\r\n\t\t\t\t\t\tcase 'qun':list[i]+='雄';break;\r\n\t\t\t\t\t\tcase 'key':list[i]='Key';break;\r\n\t\t\t\t\t\tcase 'jin':list[i]+='朝';break;\r\n\t\t\t\t\t\tcase 'vtuber':list[i]+='联';break;\r\n\t\t\t\t\t\tcase 'clubs':list[i]+='联';break;\r\n\t\t\t\t\t\tdefault:list[i]+='国';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetVideoName:function(){\r\n\t\t\t\tvar str=get.translation(game.me.name1)+'/'+get.translation(game.me.name2);\r\n\t\t\t\tvar str2=get.cnNumber(parseInt(get.config('player_number')))+'人'+\r\n\t\t\t\t\tget.translation(lib.config.mode);\r\n\t\t\t\tif(game.me.identity=='ye'){\r\n\t\t\t\t\tstr2+=' - 野心家';\r\n\t\t\t\t}\r\n\t\t\t\tvar name=[str,str2];\r\n\t\t\t\treturn name;\r\n\t\t\t},\r\n\t\t\tshowIdentity:function(started){\r\n\t\t\t\tif(game.phaseNumber==0&&!started) return;\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].showCharacter(2,false);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttryResult:function(){\r\n\t\t\t\tvar map={},sides=[],pmap=_status.connectMode?lib.playerOL:game.playerMap,hiddens=[];\r\n\t\t\t\tfor(var i of game.players){\r\n\t\t\t\t\tif(i.identity=='unknown'){\r\n\t\t\t\t\t\thiddens.push(i);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar added=false;\r\n\t\t\t\t\tfor(var j of sides){\r\n\t\t\t\t\t\tif(i.isFriendOf(pmap[j])){\r\n\t\t\t\t\t\t\tadded=true;\r\n\t\t\t\t\t\t\tmap[j].push(i);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!added){\r\n\t\t\t\t\t\tmap[i.playerid]=[i];\r\n\t\t\t\t\t\tsides.push(i.playerid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(!sides.length) return;\r\n\t\t\t\telse if(sides.length>1){\r\n\t\t\t\t\tif(sides.length==2){\r\n\t\t\t\t\t\tif(map[sides[0]].length==1) map[sides[0]][0].showGiveup();\r\n\t\t\t\t\t\tif(map[sides[1]].length==1) map[sides[1]][0].showGiveup();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tvar isYe=function(player){\r\n\t\t\t\t\t\treturn player.identity!='ye'&&lib.character[player.name1][1]=='ye';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!hiddens.length){\r\n\t\t\t\t\t\tif(map[sides[0]].length>1){\r\n\t\t\t\t\t\t\tfor(var i of map[sides[0]]){\r\n\t\t\t\t\t\t\t\tif(isYe(i)){\r\n\t\t\t\t\t\t\t\t\tgame.showYexings();\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.broadcastAll(function(id){\r\n\t\t\t\t\t\t\tgame.winner_id=id;\r\n\t\t\t\t\t\t},sides[0]);\r\n\t\t\t\t\t\tgame.checkResult();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar identity=map[sides[0]][0].identity;\r\n\t\t\t\t\t\tif(identity=='ye') return;\r\n\t\t\t\t\t\tfor(var i of map[sides[0]]){\r\n\t\t\t\t\t\t\tif(isYe(i)) return;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var i of hiddens){\r\n\t\t\t\t\t\t\tif(isYe(i)||i.getGuozhanGroup(2)!=identity||!i.wontYe()) return;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.broadcastAll(function(id){\r\n\t\t\t\t\t\t\tgame.winner_id=id;\r\n\t\t\t\t\t\t},sides[0]);\r\n\t\t\t\t\t\tgame.checkResult();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcheckResult:function(){\r\n\t\t\t\t_status.overing=true;\r\n\t\t\t\tvar me=game.me._trueMe||game.me;\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].showCharacter(2);\r\n\t\t\t\t}\r\n\t\t\t\tvar winner=(_status.connectMode?lib.playerOL:game.playerMap)[game.winner_id];\r\n\t\t\t\tgame.over(winner&&winner.isFriendOf(me)?true:false);\r\n\t\t\t\tgame.showIdentity();\r\n\t\t\t},\r\n\t\t\tcheckOnlineResult:function(player){\r\n\t\t\t\tvar winner=lib.playerOL[game.winner_id];\r\n\t\t\t\treturn winner&&winner.isFriendOf(game.me);\r\n\t\t\t},\r\n\t\t\tchooseCharacter:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.addPlayer=true;\r\n\t\t\t\tnext.ai=function(player,list,back){\r\n\t\t\t\t\tif(_status.brawl&&_status.brawl.chooseCharacterAi){\r\n\t\t\t\t\t\tif(_status.brawl.chooseCharacterAi(player,list,back)!==false){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar filterChoice=function(name1,name2){\r\n\t\t\t\t\t\tif(get.is.double(name1)) return false;\r\n\t\t\t\t\t\tvar group1=lib.character[name1][1];\r\n\t\t\t\t\t\tvar group2=lib.character[name2][1];\r\n\t\t\t\t\t\tif(group1=='ye') return group2!='ye';\r\n\t\t\t\t\t\tvar double=get.is.double(name2,true);\r\n\t\t\t\t\t\tif(double) return double.contains(group1);\r\n\t\t\t\t\t\treturn group1==group2;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tfor(var i=0;i<list.length-1;i++){\r\n\t\t\t\t\t\tfor(var j=i+1;j<list.length;j++){\r\n\t\t\t\t\t\t\tif(filterChoice(list[i],list[j])||filterChoice(list[j],list[i])){\r\n\t\t\t\t\t\t\t\tvar mainx=list[i];\r\n\t\t\t\t\t\t\t\tvar vicex=list[j];\r\n\t\t\t\t\t\t\t\tif(!filterChoice(mainx,vicex)||(filterChoice(vicex,mainx)&&get.guozhanReverse(mainx,vicex))){\r\n\t\t\t\t\t\t\t\t\tmainx=list[j];\r\n\t\t\t\t\t\t\t\t\tvicex=list[i];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tplayer.init(mainx,vicex,false);\r\n\t\t\t\t\t\t\t\tif(back){\r\n\t\t\t\t\t\t\t\t\tlist.remove(player.name1);\r\n\t\t\t\t\t\t\t\t\tlist.remove(player.name2);\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\t\tback.push(list[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar addSetting=function(dialog){\r\n\t\t\t\t\t\tdialog.add('选择座位').classList.add('add-setting');\r\n\t\t\t\t\t\tvar seats=document.createElement('table');\r\n\t\t\t\t\t\tseats.classList.add('add-setting');\r\n\t\t\t\t\t\tseats.style.margin='0';\r\n\t\t\t\t\t\tseats.style.width='100%';\r\n\t\t\t\t\t\tseats.style.position='relative';\r\n\t\t\t\t\t\tfor(var i=1;i<=game.players.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.innerHTML='<span>'+get.cnNumber(i,true)+'</span>';\r\n\t\t\t\t\t\t\ttd.link=i-1;\r\n\t\t\t\t\t\t\tseats.appendChild(td);\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.cheat_seat){\r\n\t\t\t\t\t\t\t\t\t_status.cheat_seat.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t\tif(_status.cheat_seat==this){\r\n\t\t\t\t\t\t\t\t\t\tdelete _status.cheat_seat;\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t_status.cheat_seat=this;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(seats);\r\n\t\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\t\tseats.previousSibling.style.display='none';\r\n\t\t\t\t\t\t\tseats.style.display='none';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tif(get.is.phoneLayout()) dialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar removeSetting=function(){\r\n\t\t\t\t\t\tvar dialog=_status.event.dialog;\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tdialog.style.height='';\r\n\t\t\t\t\t\t\tdelete dialog._scrollset;\r\n\t\t\t\t\t\t\tvar list=Array.from(dialog.querySelectorAll('.add-setting'));\r\n\t\t\t\t\t\t\twhile(list.length){\r\n\t\t\t\t\t\t\t\tlist.shift().remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.addSetting=addSetting;\r\n\t\t\t\t\tevent.removeSetting=removeSetting;\r\n\r\n\t\t\t\t\tvar chosen=lib.config.continue_name||[];\r\n\t\t\t\t\tgame.saveConfig('continue_name');\r\n\t\t\t\t\tevent.chosen=chosen;\r\n\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(i.indexOf('gz_shibing')==0) continue;\r\n\t\t\t\t\t\tif(chosen.contains(i)) continue;\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tif(get.config('onlyguozhan')){\r\n\t\t\t\t\t\t\tif(!lib.characterPack.mode_guozhan[i]) continue;\r\n\t\t\t\t\t\t\tif(get.is.jun(i)) continue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(lib.character[i][4].contains('hiddenSkill')) continue;\r\n\t\t\t\t\t\tif(lib.character[i][2]==3||lib.character[i][2]==4||lib.character[i][2]==5)\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\t_status.yeidentity=[];\r\n\t\t\t\t\tif(_status.brawl&&_status.brawl.chooseCharacterFilter){\r\n\t\t\t\t\t\tevent.list=_status.brawl.chooseCharacterFilter(event.list);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t// var list=event.list.splice(0,parseInt(get.config('choice_num')));\r\n\t\t\t\t\tvar list;\r\n\t\t\t\t\tif(_status.brawl&&_status.brawl.chooseCharacter){\r\n\t\t\t\t\t\tlist=_status.brawl.chooseCharacter(event.list,game.me);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlist=game.getCharacterChoice(event.list,parseInt(get.config('choice_num')));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_status.auto){\r\n\t\t\t\t\t\tevent.ai(game.me,list);\r\n\t\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(chosen.length){\r\n\t\t\t\t\t\tgame.me.init(chosen[0],chosen[1],false);\r\n\t\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('选择角色','hidden',[list,'character']);\r\n\t\t\t\t\t\tif(!_status.brawl||!_status.brawl.noAddSetting){\r\n\t\t\t\t\t\t\tif(get.config('change_identity')){\r\n\t\t\t\t\t\t\t\taddSetting(dialog);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar next=game.me.chooseButton(dialog,true,2).set('onfree',true);\r\n\t\t\t\t\t\tnext.filterButton=function(button){\r\n\t\t\t\t\t\t\tif(ui.dialog.buttons.length<=10){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<ui.dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(ui.dialog.buttons[i]!=button){\r\n\t\t\t\t\t\t\t\t\t\tif(lib.element.player.perfectPair.call({\r\n\t\t\t\t\t\t\t\t\t\t\tname1:button.link,name2:ui.dialog.buttons[i].link\r\n\t\t\t\t\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\t\t\t\t\tbutton.classList.add('glow2');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(lib.character[button.link][4].contains('hiddenSkill')) return false;\r\n\t\t\t\t\t\t\tif(ui.selected.buttons.length==0){\r\n\t\t\t\t\t\t\t\tif(get.is.double(button.link)) return false;\r\n\t\t\t\t\t\t\t\tif(lib.character[button.link][1]=='ye') return true;\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<ui.dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\t\tvar double=get.is.double(ui.dialog.buttons[i].link,true);\r\n\t\t\t\t\t\t\t\t\tif(ui.dialog.buttons[i]!=button&&(lib.character[button.link][1]==lib.character[ui.dialog.buttons[i].link][1]||double&&double.contains(lib.character[button.link][1]))){\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tif(!lib.character[button.link]||lib.character[button.link][1]=='ye') return false;\r\n\t\t\t\t\t\t\tif(get.is.double(ui.selected.buttons[0].link)) return false;\r\n\t\t\t\t\t\t\tif(lib.character[ui.selected.buttons[0].link][1]=='ye') return true;\r\n\t\t\t\t\t\t\tif(get.is.double(button.link)) return get.is.double(button.link,true).contains(lib.character[ui.selected.buttons[0].link][1]);\r\n\t\t\t\t\t\t\treturn (lib.character[button.link][1]==lib.character[ui.selected.buttons[0].link][1]);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tnext.switchToAuto=function(){\r\n\t\t\t\t\t\t\tevent.ai(game.me,list);\r\n\t\t\t\t\t\t\tui.arena.classList.remove('selecting');\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar createCharacterDialog=function(){\r\n\t\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset',function(i){\r\n\t\t\t\t\t\t\t\tif(i.indexOf('gz_shibing')==0) return true;\r\n\t\t\t\t\t\t\t\tif(get.config('onlyguozhan')){\r\n\t\t\t\t\t\t\t\t\tif(!lib.characterPack.mode_guozhan[i]) return true;\r\n\t\t\t\t\t\t\t\t\tif(get.is.jun(i)) return true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},get.config('onlyguozhanexpand')?'expandall':undefined,get.config('onlyguozhan')?'onlypack:mode_guozhan':undefined);\r\n\t\t\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\t\tlib.onfree.push(createCharacterDialog);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tcreateCharacterDialog();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tui.create.cheat2=function(){\r\n\t\t\t\t\t\t\tui.cheat2=ui.create.control('自由选将',function(){\r\n\t\t\t\t\t\t\t\tif(this.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t\t_status.event.dialog=this.backup;\r\n\t\t\t\t\t\t\t\t\tthis.backup.open();\r\n\t\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis.backup=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t\t_status.event.dialog=_status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\t\tthis.dialog=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t\tthis.dialog.open();\r\n\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tui.create.cheat=function(){\r\n\t\t\t\t\t\t\t_status.createControl=ui.cheat2;\r\n\t\t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n\t\t\t\t\t\t\t\tif(ui.cheat2&&ui.cheat2.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tevent.list=event.list.concat(list);\r\n\t\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\t\t// list=event.list.splice(0,parseInt(get.config('choice_num')));\r\n\t\t\t\t\t\t\t\tlist=game.getCharacterChoice(event.list,parseInt(get.config('choice_num')));\r\n\t\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list,'character',buttons);\r\n\t\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!_status.brawl||!_status.brawl.chooseCharacterFixed){\r\n\t\t\t\t\t\t\tif(!ui.cheat&&get.config('change_choice'))\r\n\t\t\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\t\t\tif(!ui.cheat2&&get.config('free_choose'))\r\n\t\t\t\t\t\t\tui.create.cheat2();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(result.buttons){\r\n\t\t\t\t\t\tgame.me.init(result.buttons[0].link,result.buttons[1].link,false);\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link,result.buttons[1].link);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// game.me.setIdentity(game.me.group);\r\n\t\t\t\t\tevent.list.remove(game.me.name1);\r\n\t\t\t\t\tevent.list.remove(game.me.name2);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tevent.ai(game.players[i],game.getCharacterChoice(event.list,parseInt(get.config('choice_num'))),event.list);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].classList.add('unseen');\r\n\t\t\t\t\t\tgame.players[i].classList.add('unseen2');\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='猜';\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.dataset.color='unknown';\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.classList.add('guessing');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].hiddenSkills=lib.character[game.players[i].name1][3].slice(0);\r\n\t\t\t\t\t\tvar hiddenSkills2=lib.character[game.players[i].name2][3];\r\n\t\t\t\t\t\tfor(var j=0;j<hiddenSkills2.length;j++){\r\n\t\t\t\t\t\t\tgame.players[i].hiddenSkills.add(hiddenSkills2[j]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var j=0;j<game.players[i].hiddenSkills.length;j++){\r\n\t\t\t\t\t\t\tif(!lib.skill[game.players[i].hiddenSkills[j]]){\r\n\t\t\t\t\t\t\t\tgame.players[i].hiddenSkills.splice(j--,1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].group='unknown';\r\n\t\t\t\t\t\tgame.players[i].sex='unknown';\r\n\t\t\t\t\t\tgame.players[i].name1=game.players[i].name;\r\n\t\t\t\t\t\tgame.players[i].name='unknown';\r\n\t\t\t\t\t\tgame.players[i].identity='unknown';\r\n\t\t\t\t\t\tgame.players[i].node.name.show();\r\n\t\t\t\t\t\tgame.players[i].node.name2.show();\r\n\t\t\t\t\t\tgame.players[i]._group=lib.character[game.players[i].name1][1];\r\n\t\t\t\t\t\tfor(var j=0;j<game.players[i].hiddenSkills.length;j++){\r\n\t\t\t\t\t\t\tgame.players[i].addSkillTrigger(game.players[i].hiddenSkills[j],true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.broadcastAll(function(){\r\n\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t//if(lib.configOL.onlyguozhan){\r\n\t\t\t\t\t\t//list=[];\r\n\t\t\t\t\t\tfor(var i in lib.characterPack.mode_guozhan){\r\n\t\t\t\t\t\t\tif(i.indexOf('gz_shibing')==0) continue;\r\n\t\t\t\t\t\t\tif(get.is.jun(i)) continue;\r\n\t\t\t\t\t\t\tif(lib.config.guozhan_banned&&lib.config.guozhan_banned.contains(i)) continue;\r\n\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t//}\r\n\t\t\t\t\t//else{\r\n\t\t\t\t\t//\tlist=get.charactersOL(function(i){\r\n\t\t\t\t\t//\t\treturn lib.character[i][4].contains('hiddenSkill');\r\n\t\t\t\t\t//\t});\r\n\t\t\t\t\t//}\r\n\t\t\t\t\t_status.characterlist=list.slice(0);\r\n\t\t\t\t\t_status.yeidentity=[];\r\n\t\t\t\t\tevent.list=list.slice(0);\r\n\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\tvar num;\r\n\t\t\t\t\tif(lib.configOL.number*6>list.length){\r\n\t\t\t\t\t\tnum=5;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(lib.configOL.number*7>list.length){\r\n\t\t\t\t\t\tnum=6;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tnum=7;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar filterButton=function(button){\r\n\t\t\t\t\t\tif(ui.dialog){\r\n\t\t\t\t\t\t\tif(ui.dialog.buttons.length<=10){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<ui.dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(ui.dialog.buttons[i]!=button){\r\n\t\t\t\t\t\t\t\t\t\tif(lib.element.player.perfectPair.call({\r\n\t\t\t\t\t\t\t\t\t\t\tname1:button.link,name2:ui.dialog.buttons[i].link\r\n\t\t\t\t\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\t\t\t\t\tbutton.classList.add('glow2');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(ui.selected.buttons.length==0){\r\n\t\t\t\t\t\t\tif(get.is.double(button.link)) return false;\r\n\t\t\t\t\t\t\tif(lib.character[button.link][1]=='ye') return true;\r\n\t\t\t\t\t\t\tfor(var i=0;i<ui.dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tvar double=get.is.double(ui.dialog.buttons[i].link,true);\r\n\t\t\t\t\t\t\t\tif(ui.dialog.buttons[i]!=button&&(lib.character[button.link][1]==lib.character[ui.dialog.buttons[i].link][1]||double&&double.contains(lib.character[button.link][1]))){\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif(!lib.character[button.link]||lib.character[button.link][1]=='ye') return false;\r\n\t\t\t\t\t\tif(lib.character[ui.selected.buttons[0].link][1]=='ye') return true;\r\n\t\t\t\t\t\tif(get.is.double(ui.selected.buttons[0].link)) return false;\r\n\t\t\t\t\t\tif(get.is.double(button.link)) return get.is.double(button.link,true).contains(lib.character[ui.selected.buttons[0].link][1]);\r\n\t\t\t\t\t\treturn (lib.character[button.link][1]==lib.character[ui.selected.buttons[0].link][1]);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tlist2.push([game.players[i],['选择角色',[game.getCharacterChoice(list,num),'character']],2,\r\n\t\t\t\t\t\ttrue,function(){return Math.random()},filterButton]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(list2,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0],result.links[1],false);\r\n\t\t\t\t\t}).set('switchToAuto',function(){\r\n\t\t\t\t\t\t_status.event.result='ai';\r\n\t\t\t\t\t}).set('processAI',function(){\r\n\t\t\t\t\t\tvar buttons=_status.event.dialog.buttons;\r\n\t\t\t\t\t\tvar filterChoice=function(name1,name2){\r\n\t\t\t\t\t\t\tif(get.is.double(name1)) return false;\r\n\t\t\t\t\t\t\tvar group1=lib.character[name1][1];\r\n\t\t\t\t\t\t\tvar group2=lib.character[name2][1];\r\n\t\t\t\t\t\t\tif(group1=='ye') return group2!='ye';\r\n\t\t\t\t\t\t\tvar double=get.is.double(name2,true);\r\n\t\t\t\t\t\t\tif(double) return double.contains(group1);\r\n\t\t\t\t\t\t\treturn group1==group2;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tfor(var i=0;i<buttons.length-1;i++){\r\n\t\t\t\t\t\t\tfor(var j=i+1;j<buttons.length;j++){\r\n\t\t\t\t\t\t\t\tif(filterChoice(buttons[i].link,buttons[j].link)||filterChoice(buttons[j].link,buttons[i].link)){\r\n\t\t\t\t\t\t\t\t\tvar mainx=buttons[i].link;\r\n\t\t\t\t\t\t\t\t\tvar vicex=buttons[j].link;\r\n\t\t\t\t\t\t\t\t\tif(!filterChoice(mainx,vicex)||(filterChoice(vicex,mainx)&&get.guozhanReverse(mainx,vicex))){\r\n\t\t\t\t\t\t\t\t\t\tmainx=buttons[j].link;\r\n\t\t\t\t\t\t\t\t\t\tvicex=buttons[i].link;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tvar list=[mainx,vicex];\r\n\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\tbool:true,\r\n\t\t\t\t\t\t\t\t\t\tlinks:list,\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar sort=true;\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]&&result[i].links){\r\n\t\t\t\t\t\t\tfor(var j=0;j<result[i].links.length;j++){\r\n\t\t\t\t\t\t\t\tevent.list.remove(result[i].links[j]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]=='ai'||!result[i].links||result[i].links.length<1){\r\n\t\t\t\t\t\t\tif(sort){\r\n\t\t\t\t\t\t\t\tsort=false;\r\n\t\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tresult[i]=[event.list.shift()];\r\n\t\t\t\t\t\t\tvar group=lib.character[result[i][0]][1];\r\n\t\t\t\t\t\t\tfor(var j=0;j<event.list.length;j++){\r\n\t\t\t\t\t\t\t\tif(lib.character[event.list[j]][1]==group){\r\n\t\t\t\t\t\t\t\t\tresult[i].push(event.list[j]);\r\n\t\t\t\t\t\t\t\t\tevent.list.splice(j--,1);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tresult[i]=result[i].links\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0],result[i][1],false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t\tgame.players[i].hiddenSkills=lib.character[game.players[i].name1][3].slice(0);\r\n\t\t\t\t\t\tvar hiddenSkills2=lib.character[game.players[i].name2][3];\r\n\t\t\t\t\t\tfor(var j=0;j<hiddenSkills2.length;j++){\r\n\t\t\t\t\t\t\tgame.players[i].hiddenSkills.add(hiddenSkills2[j]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var j=0;j<game.players[i].hiddenSkills.length;j++){\r\n\t\t\t\t\t\t\tif(!lib.skill[game.players[i].hiddenSkills[j]]){\r\n\t\t\t\t\t\t\t\tgame.players[i].hiddenSkills.splice(j--,1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var j=0;j<game.players[i].hiddenSkills.length;j++){\r\n\t\t\t\t\t\t\tgame.players[i].name1=game.players[i].name;\r\n\t\t\t\t\t\t\tgame.players[i].addSkillTrigger(game.players[i].hiddenSkills[j],true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function(result){\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0],result[i][1],false);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tgame.players[i].classList.add('unseen');\r\n\t\t\t\t\t\t\tgame.players[i].classList.add('unseen2');\r\n\t\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='猜';\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.dataset.color='unknown';\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.classList.add('guessing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.players[i].hiddenSkills=lib.character[game.players[i].name1][3].slice(0);\r\n\t\t\t\t\t\t\tvar hiddenSkills2=lib.character[game.players[i].name2][3];\r\n\t\t\t\t\t\t\tfor(var j=0;j<hiddenSkills2.length;j++){\r\n\t\t\t\t\t\t\t\tgame.players[i].hiddenSkills.add(hiddenSkills2[j]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(var j=0;j<game.players[i].hiddenSkills.length;j++){\r\n\t\t\t\t\t\t\t\tif(!lib.skill[game.players[i].hiddenSkills[j]]){\r\n\t\t\t\t\t\t\t\t\tgame.players[i].hiddenSkills.splice(j--,1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.players[i].group='unknown';\r\n\t\t\t\t\t\t\tgame.players[i].sex='unknown';\r\n\t\t\t\t\t\t\tgame.players[i].name1=game.players[i].name;\r\n\t\t\t\t\t\t\tgame.players[i].name='unknown';\r\n\t\t\t\t\t\t\tgame.players[i].identity='unknown';\r\n\t\t\t\t\t\t\tgame.players[i].node.name.show();\r\n\t\t\t\t\t\t\tgame.players[i].node.name2.show();\r\n\t\t\t\t\t\t\tgame.players[i]._group=lib.character[game.players[i].name2][1];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},result);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\ttranslate:{\r\n\t\t\tye:'野',\r\n\t\t\tye2:'野心家',\r\n\t\t\tyexinjia_mark:'野心家',\r\n\r\n\t\t\tbumingzhi:'不明置',\r\n\t\t\tmingzhizhujiang:'明置主将',\r\n\t\t\tmingzhifujiang:'明置副将',\r\n\t\t\ttongshimingzhi:'同时明置',\r\n\t\t\tmode_guozhan_character_config:'国战武将',\r\n\t\t\t_zhenfazhaohuan:'阵法召唤',\r\n\t\t\t_zhenfazhaohuan_info:'由拥有阵法技的角色发起，满足此阵法技条件的未确定势力角色均可按逆时针顺序依次明置其一张武将牌(响应阵法召唤)，以发挥阵法技的效果。',\r\n\r\n\t\t\tjunling:'军令',\r\n\t\t\tjunling1:'军令一',\r\n\t\t\tjunling1_bg:'令',\r\n\t\t\tjunling1_info:'若被执行，执行者对发起者指定的一名角色造成一点伤害。',\r\n\t\t\tjunling2:'军令二',\r\n\t\t\tjunling2_bg:'令',\r\n\t\t\tjunling2_info:'若被执行，执行者摸一张牌，然后依次交给发起者两张牌。',\r\n\t\t\tjunling3:'军令三',\r\n\t\t\tjunling3_bg:'令',\r\n\t\t\tjunling3_info:'若被执行，执行者失去一点体力。',\r\n\t\t\tjunling4:'军令四',\r\n\t\t\tjunling4_bg:'令',\r\n\t\t\tjunling4_info:'若被执行，直到回合结束，执行者不能使用或打出手牌且非锁定技全部失效。',\r\n\t\t\tjunling4_eff:'军令四',\r\n\t\t\tjunling5:'军令五',\r\n\t\t\tjunling5_bg:'令',\r\n\t\t\tjunling5_info:'若被执行，执行者将武将牌叠置，且不能回复体力直到回合结束。',\r\n\t\t\tjunling5_eff:'军令五',\r\n\t\t\tjunling6:'军令六',\r\n\t\t\tjunling6_bg:'令',\r\n\t\t\tjunling6_info:'若被执行，执行者选择一张手牌和一张装备区内牌（若有），然后弃置其余的牌。',\r\n\r\n\r\n\t\t\tgz_yuanlv:'远虑',\r\n\t\t\tgz_yuanlv_info:'每回合限一次。你使用锦囊后或受到伤害后，你可以摸两张牌，然后将一张牌置于牌堆顶。',\r\n\r\n\t\t\tdisui: '抵碎',\r\n\t\t\tdisui_info: '出牌阶段，你可以废除一个装备栏令你的攻击范围+1，然后本回合你使用牌指定唯一目标时，可以废除其一个你已废除的装备栏。若你因此失去了牌，本回合你使用牌指定目标时可以暗置其中一张武将牌。',\r\n\t\t\tdisui_disableEquip: '抵碎-废弃',\r\n\t\t\tdisui_hideC: '抵碎-暗置',\r\n\t\t\tdengyan: '瞪眼',\r\n\t\t\tdengyan_info: '锁定技 你的回合内其他角色不能明置武将牌；其他角色每回合第一次明置武将牌时，你摸一张牌。',\r\n\r\n\t\t\tgz_huxi:'呼吸',\r\n\t\t\tgz_huxi_info:'出牌阶段开始时或你造成伤害后，你可以与一名本回合未以此法指定过的角色交换一张手牌。然后若你获得了红色牌，你摸一张牌，使用的下一张【杀】不计入次数。当你为杏时，本回合使用交换获得的【杀】无距离限制；当你为虹时，你交换获得的装备牌可立即置于场上（若置于判定区，红色视为【乐不思蜀】，黑色视为【兵粮寸断】）。',\r\n\r\n\t\t\tgz_kuali: '夸力满满',\r\n\t\t\tgz_kuali_info: '摸牌阶段，你可以改为摸X张牌。你的手牌上限始终+X。（X为体力值为你整数倍的其他角色数）',\r\n\t\t\t\r\n\t\t\tgz_guiren: '鬼刃',\r\n\t\t\tgz_guiren_info: '你可以将两张红色/黑色牌当做一张【杀】使用，然后根据你转化牌包含的类型获得对应效果：基本~使之具有火焰/雷电属性；锦囊~若造成伤害，令目标交给你一张牌；装备~不可被抵消。若被抵消，你可以收回之并结束此阶段。',\r\n\r\n\t\t\tgz_bingdielei:'并蒂恶蕾',\r\n\t\t\tgz_bingdielei_info:'每轮限一次。你造成或受到过伤害的回合结束时，可以获得一个额外回合。',\r\n\r\n\t\t\tgz_kuangbaoshuangren:'狂暴双刃',\r\n\t\t\tgz_kuangbaoshuangren_info:'锁定技 你的黑色【杀】指定目标后，需额外指定攻击范围内的一名角色为目标；你的红色【杀】无距离与次数限制。',\r\n\r\n\t\t\tgz_zhenxin:'真信',\r\n\t\t\tgz_zhenxin_info:'锁定技 你受到伤害时，若来源有暗置的武将牌，此伤害-1。',\r\n\r\n\t\t\tgz_duanli: '断离',\r\n\t\t\tgz_duanli_info: '当你受到伤害后或出牌阶段限一次，你可以弃置所有手牌，然后你于本回合结束时摸等量的牌。',\r\n\t\t\tgz_qingyi: '情遗',\r\n\t\t\tgz_qingyi_info: '其他角色使用的【桃】进入弃牌堆时，你可以令其摸一张牌，然后你获得其一张牌。',\r\n\r\n\t\t\tgz_jiaku: '生笹',\r\n\t\t\tgz_jiaku_info: '锁定技 你赢得拼点时，摸一张牌；你没赢得拼点时，重铸一张牌。',\r\n\r\n\t\t\tgz_shengcai: '声彩',\r\n\t\t\tgz_shengcai_info: '当你使用一张牌或受到伤害后，你可以弃置一张牌，若与本回合之前进入弃牌堆的牌颜色均不同，你摸X张牌。（X为本回合之前被使用过的牌数）',\r\n\r\n\t\t\tliexing: '列星',\r\n\t\t\tliexing_info: '出牌阶段限一次，当你使用牌指定目标后，可以令目标外的一名其他角色弃置一张牌，若与你使用牌点数之和不小于12，你获得之，且本回合使用此牌不受距离与次数限制。若等于12，你与其各回复1点体力。',\r\n\r\n\t\t\tgz_zuodun: '作盾',\r\n\t\t\tgz_zuodun_info: '每回合限一次，其他角色受到伤害时，你可将此伤害转移给你，然后获得『列星』直到你的回合结束，若已有『列星』，摸一张牌。',\r\n\t\t\tgz_baidao: '白道',\r\n\t\t\tgz_baidao_info: '出牌阶段，你可以将一张K点牌交给其他角色以回复1点体力；或展示一张本回合未展示过的A点牌以重置『列星』。',\r\n\r\n\t\t\tgz_niaoji: '鸟肌',\r\n\t\t\tgz_niaoji_info: '你造成/受到伤害后，可以进行判定：若为♥️，你摸X张牌；若为♠️，你弃置目标/来源X张牌。（X为你已损失的体力值且至少为1）',\r\n\t\t\r\n\t\t\tgz_xuyan: '虚研',\r\n\t\t\tgz_xuyan_info: '结束阶段，你可以选择一名其他角色；你下个回合开始时，若该角色在此期间：造成或受到过伤害~你摸一张牌；死亡或杀死角色~你回复1点体力；均不满足~你与其各失去1点体力。',\r\n\r\n\t\t\tgz_yingdan: '盈弹',\r\n\t\t\tgz_yingdan_info: '当你需要抵消一张牌时，若来源在你的攻击范围内，你可以使用一张【杀】抵消之。若此【杀】未造成伤害，你摸一张牌。',\r\n\t\t\t\t\t\t\r\n\t\t\tzhanni: '斩逆',\r\n\t\t\tzhanni_info: '当你使用牌指定目标后，你可选择其中一名目标角色，其每满足下列一项你便可将其一张牌移出游戏直到此回合结束：手牌数不少于你；体力值不少于你；装备区牌数不少于你。然后若该角色没有手牌，其摸一张牌。',\r\n\r\n\t\t\tgz_longdan: '龙胆雄心',\r\n\t\t\tgz_longdan_info: '转换技 阳~你可以将你任意一张不为【杀】的基本牌当作一张【杀】使用或打出；阴~你可以将一张【杀】当作任意一张不为【杀】的基本牌使用或打出。你以此法转化点数大于7的牌无次数与距离限制。',\r\n\r\n\t\t\tgz_tiantang: '天扉',\r\n\t\t\tgz_tiantang_info: '一名角色的回合开始时，你可以弃置X张牌并声明一种花色，然后：观看并弃置其一张声明花色的牌，令其执行一个额外的出牌阶段；或令其摸两张牌，然后只能使用声明花色的牌直到回合结束。（X为本轮你发动此技能的次数且至少为1）',\r\n\t\t\t\r\n\t\t\tgz_luecai: '掠财',\r\n\t\t\tgz_luecai_info: '你使用牌指定唯一目标时，若其手牌数大于你，你可以获得其一张牌。然后若你的手牌数大于其，你失去此技能。',\r\n\r\n\t\t\tgz_xiemen: '斜门',\r\n\t\t\tgz_xiemen_info: '你使用目标不仅为你的牌时，可令其他角色随机移除一张手牌直到回合结束。',\r\n\r\n\t\t\tgz_yuxia: '玉箱',\r\n\t\t\tgz_yuxia_info: '每回合限一次，你可以将三张牌以任意顺序置于牌堆顶，视为使用了一张通常锦囊牌。',\r\n\t\t\tgz_lianjue: '连崛',\r\n\t\t\tgz_lianjue_info: '回合结束时，若你的手牌数与本回合开始时差值为三的倍数，你可以选择一项：令至多三名角色各摸一张牌；或将你下一次发动『玉箱』条件改为“任意张牌”。',\r\n\r\n\t\t\tgz_cuimao:'崔琰毛玠',\r\n\t\t\tgzzhengbi:'征辟',\r\n\t\t\tgzzhengbi_info:'出牌阶段开始时，你可以选择一项：选择一名未确定势力的角色，此出牌阶段结束时，若其有明置的武将牌，则你获得其每个区域内的各一张牌；或将一张基本牌交给一名有明置武将牌的角色，然后其交给你一张非基本牌或两张基本牌。',\r\n\t\t\tgzfengying:'奉迎',\r\n\t\t\tgzfengying_info:'限定技，你可以将所有手牌当【挟天子以令诸侯】使用（无视大势力限制），然后所有与你势力相同的角色将手牌补至体力上限。',\r\n\t\t\tgz_yujin:'于禁',\r\n\t\t\tgzjieyue:'节钺',\r\n\t\t\tgzjieyue_info:'准备阶段开始时，你可以将一张手牌交给一名非魏势力角色，然后选择一个“军令”并令其选择一项：执行该军令，然后你摸一张牌；或令你于此回合摸牌阶段额外摸三张牌。',\r\n\t\t\tgz_wangping:'王平',\r\n\t\t\tjianglue:'将略',\r\n\t\t\tjianglue_info:'限定技，出牌阶段，你可以选择一个“军令”，然后与你势力相同的其他角色可以执行该军令（未确定势力角色可以在此时明置一张单势力武将牌）。你与所有执行该军令的角色增加一点体力上限，然后回复一点体力，然后你摸X张牌（X为以此法回复了体力的角色数）。',\r\n\t\t\tgz_fazheng:'法正',\r\n\t\t\tgzxuanhuo:'眩惑',\r\n\t\t\tgzxuanhuo_info:'与你势力相同的其他角色的出牌阶段限一次，其可弃置一张手牌，然后选择获得以下一项技能直到回合结束：〖武圣〗、〖咆哮〗、〖龙胆〗、〖铁骑〗、〖烈弓〗、〖狂骨〗。',\r\n\t\t\tgzenyuan:'恩怨',\r\n\t\t\tgzenyuan_info:'锁定技，当其他角色对你使用【桃】时，该角色摸一张牌；当你受到伤害后，伤害来源须交给你一张手牌或失去1点体力。',\r\n\t\t\tgzbuyi:'补益',\r\n\t\t\tgzbuyi_info:'每回合限一次，当一名与你势力相同的角色脱离濒死状态后，你可以选择一个“军令”，令伤害来源选择一项：执行该军令，或令该脱离濒死状态的角色回复一点体力。',\r\n\t\t\tgz_lukang:'陆抗',\r\n\t\t\tkeshou:'恪守',\r\n\t\t\tkeshou_info:'当你受到伤害时，你发动此技能。你可弃置两张颜色相同的牌，若如此做，此伤害-1。你的势力已确定且场上没有与你势力相同的其他角色，则你进行判定，若结果为红色，你摸一张牌。',\r\n\t\t\tzhuwei:'筑围',\r\n\t\t\tzhuwei_info:'当你的判定牌生效后，你可以获得之。然后，你可令当前回合角色本回合内使用【杀】的次数上限和手牌上限+1。',\r\n\t\t\tgz_yuanshu:'袁术',\r\n\t\t\tgzweidi:'伪帝',\r\n\t\t\tgzweidi_info:'出牌阶段限一次，你可以指定一名本回合从牌堆获得过牌的其他角色并选择一个“军令”，令其选择一项：执行该军令；或令你获得其所有手牌，然后交给其等量的牌。',\r\n\t\t\tgzyongsi:'庸肆',\r\n\t\t\tgzyongsi_info:'锁定技，若场上没有【玉玺】，则视为你装备了【玉玺】；当你成为【知己知彼】的目标时，你展示你的所有手牌。',\r\n\t\t\t//gzyongsi_eff1:'玉玺',\r\n\t\t\t//gzyongsi_eff2:'玉玺',\r\n\t\t\tgz_zhangxiu:'张绣',\r\n\t\t\tgzfudi:'附敌',\r\n\t\t\tgzfudi_info:'当你受到伤害后，你可以交给伤害来源一张手牌。若如此做，你对其势力中体力值最大且不小于你的一名角色造成一点伤害。',\r\n\t\t\tcongjian:'从谏',\r\n\t\t\tcongjian_info:'锁定技，当你于回合外造成伤害，或于回合内受到伤害时，此伤害+1。',\r\n\t\t\tgz_jun_caocao:'君曹操',\r\n\t\t\tjianan:'建安',\r\n\t\t\tjianan_info:'君主技，只要此武将处于明置状态，你便拥有“五子良将纛”。',\r\n\t\t\tg_jianan:'五子良将纛',\r\n\t\t\twuziliangjiangdao:'五子良将纛',\r\n\t\t\twuziliangjiangdao_ab:'将纛',\r\n\t\t\twuziliangjiangdao_bg:'纛',\r\n\t\t\twuziliangjiangdao_info:'魏势力角色的准备阶段开始时，其可以弃置一张牌。若如此做，其选择一张暗置的武将牌（若没有，则选择一张暗置），然后获得下列技能中的一项（其他角色已有的技能无法选择）且不能明置选择的武将牌直到你的下个回合开始：〖突袭〗，〖巧变〗，〖骁果〗，〖节钺〗，〖断粮〗。',\r\n\t\t\thuibian:'挥鞭',\r\n\t\t\thuibian_info:'出牌阶段限一次，你可以选择一名魏势力角色和另一名已受伤的魏势力角色。若如此做，你对前者造成一点伤害，然后其摸两张牌，然后后者回复一点体力。',\r\n\t\t\tgzzongyu:'总御',\r\n\t\t\tgzzongyu_info:'当【六龙骖驾】进入其他角色的装备区后，你可以将你装备区内所有坐骑牌（至少一张）与【六龙骖驾】交换位置。锁定技，当你使用坐骑牌后，若场上或弃牌堆中有【六龙骖驾】，则将【六龙骖驾】置入你的装备区。',\r\n\t\t\t\t\t\r\n\t\t\txindiaodu:\"调度\",\r\n\t\t\t\"xindiaodu_info\":\"每回合限一次，与你势力相同的角色使用装备牌时，其可以摸一张牌；出牌阶段开始时，你可以获得与你势力相同的一名角色装备区内的一张牌，然后你可以将此牌交给另一名与你势力相同的其他角色。\",\r\n\t\t\tyigui:\"役鬼\",\r\n\t\t\t\"yigui_info\":\"当你首次明置此武将牌时，你将剩余武将牌堆的两张牌扣置于游戏外，称为“魂”；你可以展示一张“魂”并将其置入剩余武将牌堆，视为使用了一张本回合内未以此法使用过的基本牌或普通锦囊牌。（此牌需指定目标，且目标须为未确定势力的角色或野心家或与此“魂”势力相同的角色）\",\r\n\t\t\t\"yigui_init\":\"役鬼\",\r\n\t\t\t\"yigui_init_info\":\"\",\r\n\t\t\t\"yigui_refrain\":\"役鬼\",\r\n\t\t\t\"yigui_refrain_info\":\"\",\r\n\t\t\tyigui_shan:'役鬼',\r\n\t\t\tyigui_wuxie:'役鬼',\r\n\t\t\tjihun:\"汲魂\",\r\n\t\t\tjihun_info:\"当你受到伤害后，或与你势力不同的角色脱离濒死状态后，你可以将剩余武将牌堆的一张牌当做“魂”扣置于游戏外。\",\r\n\t\t\t\r\n\t\t\t_guozhan_marks:'标记',\r\n\t\t\t_guozhan_marks_backup:'标记',\r\n\t\t\txianqu_mark:\"先驱\",\r\n\t\t\tzhulianbihe_mark:\"珠联璧合\",\r\n\t\t\tyinyang_mark:\"阴阳鱼\",\r\n\t\t\t_zhulianbihe_mark_tao:\"珠联\",\r\n\t\t\t_yinyang_mark_add:\"阴阳鱼\",\r\n\t\t\tyinyang_add:\"阴阳鱼\",\r\n\t\t\t\r\n\t\t\tgzjushou:\"据守\",\r\n\t\t\tgzjushou_info:\"结束阶段，你可以摸X张牌（X为亮明势力数），然后弃置一张手牌。若以此法弃置的牌为装备牌，则改为使用此牌。若X大于2，则你将武将牌叠置。\",\r\n\t\t\t\"new_duanliang\":\"断粮\",\r\n\t\t\t\"new_duanliang_info\":\"出牌阶段，你可以将一张黑色基本牌或黑色装备牌当做【兵粮寸断】使用。你使用【兵粮寸断】没有距离限制。若你对距离超过2的角色发动了〖断粮〗，则本回合不能再发动〖断粮〗。\",\r\n\t\t\t\"new_shushen\":\"淑慎\",\r\n\t\t\t\"new_shushen_info\":\"当你回复1点体力后，你可令一名其他角色摸一张牌。\",\r\n\t\t\t\"new_luanji\":\"乱击\",\r\n\t\t\t\"new_luanji_info\":\"你可以将两张与你本回合以此法转化的花色均不相同的手牌当【万箭齐发】使用。当一名与你势力相同的角色因响应此牌而打出【闪】时，该角色摸一张牌。\",\r\n\t\t\t\"new_qingcheng\":\"倾城\",\r\n\t\t\t\"new_qingcheng_info\":\"出牌阶段，你可以弃置一张黑色牌并选择一名武将牌均明置的其他角色，然后你暗置其一张武将牌。若你以此法弃置的牌为装备牌，则你可以暗置另一名武将牌均明置的角色的一张武将牌。\",\r\n\t\t\thuoshui:'祸水',\r\n\t\t\thuoshui_info:'锁定技。你的回合内，若此武将牌处于明置状态，其他角色不能明置其武将牌。',\r\n\t\t\t\"new_kongcheng\":\"空城\",\r\n\t\t\t\"new_kongcheng_info\":\"锁定技，若你没有手牌，1.当你成为【杀】或【决斗】的目标时，取消之；2.你的回合外，其他角色交给你牌后，你将这些牌置于你的武将牌上。摸牌阶段开始时，你获得武将牌上的这些牌。\",\r\n\t\t\t\"new_keji\":\"克己\",\r\n\t\t\t\"new_keji_info\":\"锁定技，若你没有在出牌阶段内使用过颜色不同的牌，则你本回合的手牌上限+4。\",\r\n\t\t\t\"keji_add\":\"克己\",\r\n\t\t\t\"keji_add_info\":\"\",\r\n\t\t\t\"new_mouduan\":\"谋断\",\r\n\t\t\t\"new_mouduan_info\":\"结束阶段，若你于本回合内使用过四种花色或三种类别的牌，则你可以移动场上的一张牌。\",\r\n\t\t\t\"new_longdan\":\"龙胆\",\r\n\t\t\t\"new_longdan_info\":\"你可以将【杀】当【闪】，【闪】当【杀】使用或打出。当你发动〖龙胆〗使用的【杀】被【闪】抵消时，你可以对另一名角色造成1点伤害；当你发动〖龙胆〗使用的【闪】抵消了【杀】时，你可以令一名其他角色回复1点体力（不能是【杀】的使用者）。\",\r\n\t\t\t\"fz_new_longdan\":\"龙胆\",\r\n\t\t\t\"fz_new_longdan_info\":\"你可以将【杀】当【闪】，【闪】当【杀】使用或打出。当你发动〖龙胆〗使用的【杀】被【闪】抵消时，你可以对另一名角色造成1点伤害；当你发动〖龙胆〗使用的【闪】抵消了【杀】时，你可以令一名其他角色回复1点体力（不能是【杀】的使用者）。\",\r\n\t\t\tgzpaoxiao:\"咆哮\",\r\n\t\t\tgzpaoxiao_info:\"锁定技，你使用【杀】无数量限制；当你于一回合内使用第二张【杀】时，摸一张牌。\",\r\n\t\t\t\"new_kurou\":\"苦肉\",\r\n\t\t\t\"new_kurou_info\":\"出牌阶段限一次，你可以弃置一张牌，然后失去1点体力并摸三张牌，本回合使用【杀】的次数上限+1。\",\r\n\t\t\t\"kurou_effect\":\"苦肉\",\r\n\t\t\t\"kurou_effect_info\":\"\",\r\n\t\t\t\"new_chuli\":\"除疠\",\r\n\t\t\t\"new_chuli_info\":\"出牌阶段限一次，若你有牌，你可以选择至多三名势力各不相同或未确定势力的其他角色，你弃置你和这些角色的各一张牌。然后所有以此法弃置过黑桃牌的角色各摸一张牌。\",\r\n\t\t\t\"baka_hunshang\":\"魂殇\",\r\n\t\t\t\"baka_hunshang_info\":\"副将技，此武将牌减少半个阴阳鱼；准备阶段，若你的体力值不大于1，则你获得〖英姿〗和〖英魂〗直到回合结束。\",\r\n\t\t\t\"baka_yinghun\":\"英魂\",\r\n\t\t\t\"baka_yinghun_info\":\"准备阶段开始时，若你已受伤，你可令一名其他角色执行一项：摸X张牌，然后弃置一张牌；或摸一张牌，然后弃置X张牌（X为你已损失的体力值）\",\r\n\t\t\t\"baka_yingzi\":\"英姿\",\r\n\t\t\t\"baka_yingzi_info\":\"锁定技，摸牌阶段摸，你多摸一张牌；你的手牌上限+X（X为你已损失的体力值）。\",\r\n\t\t\tgzyiji:\"遗计\",\r\n\t\t\tgzyiji_info:\"当你受到伤害后，你可以观看牌堆顶的两张牌，并将其交给任意角色。\",\r\n\t\t\tgzjieming:\"节命\",\r\n\t\t\tgzjieming_info:\"当你受到伤害后，你可以令一名角色将手牌摸至X张（X为其体力上限且最多为5）。\",\r\n\t\t\tgzfangzhu:\"放逐\",\r\n\t\t\tgzfangzhu_info:\"当你受到伤害后，你可以令一名其他角色选择一项：摸X张牌并将武将牌叠置（X为你已损失的体力值）；弃置一张牌并失去1点体力。\",\r\n\t\t\t\"fengyin_main\":\"封印[主将]\",\r\n\t\t\t\"fengyin_main_info\":\"\",\r\n\t\t\t\"fengyin_vice\":\"封印[副将]\",\r\n\t\t\t\"fengyin_vice_info\":\"\",\r\n\t\t\t\"new_tieji\":\"铁骑\",\r\n\t\t\t\"new_tieji_info\":\"当你使用【杀】指定目标后，你可以令其一张明置的武将牌上的非锁定技于本回合内失效，然后你进行判定，除非该角色弃置与结果花色相同的一张牌，否则其不能使用【闪】响应此【杀】。\",\r\n\t\t\thmkyuanyu:\"远域\",\r\n\t\t\t\"hmkyuanyu_info\":\"锁定技，当你受到伤害时，若伤害来源与你的座次不相邻，防止此伤害。\",\r\n\t\t\thmkguishu:\"鬼术\",\r\n\t\t\t\"hmkguishu_info\":\"出牌阶段，你可以将一张黑桃手牌当作【知己知彼】或【远交近攻】使用。若你本局游戏内已经发动过了〖鬼术〗，则你必须选择与上次不同的选项。\",\r\n\t\t\t\"_mingzhisuodingji\":\"亮将\",\r\n\t\t\t\"_mingzhisuodingji_info\":\"出牌阶段，你可以明置拥有“锁定技”的武将牌。\",\r\n\r\n\t\t\tgz_jun_liubei:'君刘备',\r\n\t\t\tgz_jun_zhangjiao:'君张角',\r\n\t\t\tgz_jun_sunquan:'君孙权',\r\n\t\t\tgz_liqueguosi:'李傕郭汜',\r\n\t\t\tgz_bianfuren:'卞夫人',\r\n\t\t\tgz_lvfan:'吕范',\r\n\t\t\tgz_shamoke:'沙摩柯',\r\n\t\t\tgz_masu:'马谡',\r\n\t\t\tgz_yuji:'于吉',\r\n\r\n\t\t\tgzshushen:'淑慎',\r\n\t\t\tgzshushen_info:'当你回复1点体力时，你可令与你势力相同的一名其他角色摸一张牌。',\r\n\t\t\t_lianheng:'合纵',\r\n\t\t\tlianheng_tag:'合',\r\n\t\t\tguo_tag:'国',\r\n\t\t\tqianhuan:'千幻',\r\n\t\t\tqianhuan_bg:'幻',\r\n\t\t\tqianhuan_info:'当与你势力相同的一名角色受到伤害后，你可以将一张与你武将牌上花色均不同的牌置于你的武将牌上。当一名与你势力相同的角色成为基本牌或锦囊牌的唯一目标时，你可以移去一张“千幻”牌，取消之。',\r\n\t\t\tgzzhiman:'制蛮',\r\n\t\t\tgzzhiman_info:'当你对其他角色造成伤害时，你可以防止此伤害。若如此做，你获得其装备区或判定区里的一张牌。然后若该角色与你势力相同，该角色可以变更副将。',\r\n\t\t\t\r\n\t\t\tgzdiancai:'典财',\r\n\t\t\tgzdiancai_info:'其他角色的出牌阶段结束时，若你于此阶段失去了x张或更多的牌，则你可以将手牌摸至体力上限。若如此做，你可以变更副将（x为你的体力值）。',\r\n\t\t\txuanlve:'旋略',\r\n\t\t\txuanlve_info:'当你失去装备区里的牌后，你可以弃置一名其他角色的一张牌。',\r\n\t\t\tlianzi:'敛资',\r\n\t\t\tlianzi_info:'出牌阶段限一次，你可以弃置一张手牌，然后亮出牌堆顶X张牌（X为吴势力角色装备区里的牌和“烽火”的总和），获得其中所有与你弃置牌类别相同的牌，将其余的牌置入弃牌堆，若你以此法一次获得了三张或更多的牌，则你失去技能〖敛资〗并获得技能〖制衡〗。',\r\n\t\t\tgzqice:'奇策',\r\n\t\t\tgzqice_backup:'奇策',\r\n\t\t\tgzqice_info:'出牌阶段限一次，你可以将所有手牌当做任意一张普通锦囊牌使用（此牌的目标数不能超过你的手牌数）。然后，你可以变更副将。',\r\n\t\t\tgzyuejian:'约俭',\r\n\t\t\tgzyuejian_info:'锁定技，与你势力相同角色的弃牌阶段开始时，若其本回合未使用牌指定过其他势力的角色为目标，则该角色本回合手牌上限+X（X为其已损失的体力值）。',\r\n\t\t\tgzxiongsuan:'凶算',\r\n\t\t\tgzxiongsuan_info:'限定技，出牌阶段，你可以弃置一张手牌并选择与你势力相同的一名角色，对其造成1点伤害，然后你摸三张牌。若该角色有已发动的限定技，则你选择其中一个限定技，此回合结束后视为该限定技未发动过。',\r\n\t\t\tgzhuashen:'化身',\r\n\t\t\tgzhuashen_info:'准备阶段开始时，若你的“化身”不足两张，则你可以观看剩余武将牌堆中的五张牌，然后扣置其中至多两张武将牌在你的武将旁，称为“化身”；若“化身”有两张以上，则你可以用剩余武将牌堆顶的一张牌替换一张“化身”。你可以于相应的时机明置并发动“化身”的一个技能，技能结算完成后将该“化身”放回剩余武将牌堆。你每个时机只能发动一张“化身”的技能，且不能发动带有技能类型的技能（锁定技、限定技等）。',\r\n\t\t\tgzxinsheng:'新生',\r\n\t\t\tgzxinsheng_info:'当你受到伤害后，你可以从剩余武将牌堆中扣置一张牌加入到“化身”牌中。',\r\n\r\n\t\t\tjubao:'聚宝',\r\n\t\t\tjubao_info:'锁定技，你装备区里的宝物牌不能被其他角色获得。结束阶段开始时，若场上或弃牌堆有【定澜夜明珠】，则你摸一张牌，然后获得装备区里有【定澜夜明珠】角色的一张牌。',\r\n\t\t\tjiahe:'嘉禾',\r\n\t\t\tjiahe_info:'君主技，只要此武将牌处于明置状态，你便拥有“缘江烽火图”。',\r\n\t\t\tjiahe_put:'烽火',\r\n\t\t\tjiahe_put_info:'出牌阶段限一次，你可以将一张装备牌置于“缘江烽火图”上，称之为“烽火”。',\r\n\t\t\tjiahe_skill:'缘江烽火图',\r\n\t\t\tyuanjiangfenghuotu:'缘江烽火图',\r\n\t\t\tyuanjiangfenghuotu_info:'每名吴势力角色的出牌阶段限一次，该角色可以将一张装备牌置于“缘江烽火图”上，称之为“烽火”。<br>根据“烽火”的数量，所有吴势力角色可于其准备阶段开始时选择并获得其中一个技能直到回合结束：一张以上：〖英姿〗；两张以上：〖好施〗；三张以上：〖涉猎〗；四张以上：〖度势〗；五张以上：可额外选择一项。<br>锁定技，当你受到【杀】或锦囊牌造成的伤害后，你将一张“烽火”置入弃牌堆。',\r\n\t\t\tyuanjiangfenghuotu_ab:'江图',\r\n\t\t\tyuanjiangfenghuotu_bg:'图',\r\n\t\t\twuxin:'悟心',\r\n\t\t\twuxin_info:'摸牌阶段开始时，你可以观看牌堆顶的X张牌（X为群势力角色的数量），然后将这些牌以任意顺序置于牌堆顶',\r\n\t\t\thongfa:'弘法',\r\n\t\t\thongfa_use:'天兵',\r\n\t\t\thongfa_respond:'天兵',\r\n\t\t\thongfa_info:'君主技，锁定技，此武将牌明置时，你获得“黄巾天兵符”；准备阶段开始时，若没有“天兵”，你将牌堆顶的X张牌置于“黄巾天兵符”上，称为“天兵”（X为群势力角色的数量）',\r\n\t\t\twendao:'问道',\r\n\t\t\twendao_info:'出牌阶段限一次，你可以弃置一张不为【太平要术】的红色牌，然后获得弃牌堆或场上的一张【太平要术】。',\r\n\t\t\thuangjintianbingfu:'黄巾天兵符',\r\n\t\t\thuangjintianbingfu_ab:'兵符',\r\n\t\t\thuangjintianbingfu_bg:'符',\r\n\t\t\thuangjintianbingfu_info:'锁定技 ：当你计算群势力角色数时，每一张“天兵”均可视为一名群势力角色。<br>当你失去体力时，你可改为将一张“天兵”置入弃牌堆。<br>与你势力相同的角色可将一张“天兵”当作【杀】使用或打出。',\r\n\t\t\twuhujiangdaqi:'五虎将大旗',\r\n\t\t\twuhujiangdaqi_ab:'将旗',\r\n\t\t\twuhujiangdaqi_bg:'旗',\r\n\t\t\twuhujiangdaqi_info:'存活的蜀势力角色的技能按以下规则改动：<br><strong>武圣</strong>：将“红色牌”改为“任意牌”<br><strong>咆哮</strong>：增加描述“你使用的【杀】无视其他角色的防具”<br><strong>龙胆</strong>：增加描述“你发动〖龙胆〗使用或打出牌时摸一张牌”<br><strong>烈弓</strong>：增加描述“你的攻击范围+1”<br><strong>铁骑</strong>：将“一张明置的武将牌”改为“所有明置的武将牌”',\r\n\t\t\tzhangwu:'章武',\r\n\t\t\tzhangwu_info:'锁定技。当【飞龙夺凤】进入弃牌堆或其他角色的装备区时，你获得之。当你失去【飞龙夺风】时，展示之，然后将此牌置于牌堆底并摸两张牌',\r\n\t\t\tshouyue:'授钺',\r\n\t\t\tshouyue_info:'君主技。只要此武将牌处于明置状态，你便拥有“五虎将大旗”。',\r\n\t\t\tjizhao:'激诏',\r\n\t\t\tjizhao_bg:'诏',\r\n\t\t\tjizhao_info:'限定技。当你处于濒死状态时，你可以将手牌补至体力上限，体力回复至2点，失去技能〖授钺〗并获得技能〖仁德〗。',\r\n\t\t\tgzshoucheng:'守成',\r\n\t\t\tgzshoucheng_info:'当与你势力相同的一名角色于其回合外失去手牌时，若其没有手牌，则你可以令其摸一张牌。',\r\n\t\t\tgzmingshi:'名士',\r\n\t\t\tgzmingshi_info:'锁定技，当你受到伤害时，若伤害来源有暗置的武将牌，此伤害-1。',\r\n\t\t\tfengshi:'锋矢',\r\n\t\t\tfengshi_sha:'锋矢',\r\n\t\t\tfengshi_info:'阵法技，在一个围攻关系中，若你是围攻角色，则你或另一名围攻角色使用【杀】指定被围攻角色为目标后，可令该角色弃置装备区内的一张牌。',\r\n\t\t\tgzsuishi:'随势',\r\n\t\t\tgzsuishi2:'随势',\r\n\t\t\tgzsuishi_info:'锁定技，其他角色进入濒死状态时，若伤害来源与你势力相同，你摸一张牌；其他角色死亡时，若其与你势力相同，你失去1点体力。',\r\n\t\t\tbaoling:'暴凌',\r\n\t\t\tbaoling_info:'主将技，锁定技，出牌阶段结束时，若你有副将，则你移除副将，然后加3点体力上限，回复3点体力，失去技能〖暴凌〗并获得〖崩坏〗',\r\n\t\t\tyingyang:'鹰扬',\r\n\t\t\tyingyang_info:'当你的拼点牌亮出后，你可以令此牌的点数+3或-3（至多为K，至少为1）。',\r\n\t\t\thunshang:'魂殇',\r\n\t\t\thunshang_info:'副将技，此武将牌减少半个阴阳鱼；准备阶段，若你的体力值不大于1，则你本回合获得“英姿”和“英魂”',\r\n\t\t\tgzguixiu:'闺秀',\r\n\t\t\tgzguixiu_info:'当你明置此武将牌时，你可以摸两张牌；当你移除此武将牌时，你可以回复1点体力。',\r\n\t\t\tgzcunsi:'存嗣',\r\n\t\t\tgzcunsi_info:'出牌阶段，你可以移除此武将牌并选择一名角色，然后其获得技能〖勇决〗，若你选择的目标角色不是自己，则其摸两张牌。',\r\n\t\t\tgzyongjue:'勇决',\r\n\t\t\tgzyongjue_info:'与你势力相同的一名角色于其回合内使用【杀】结算完成后，若此牌是其本回合内使用的第一张牌，则其可以获得此牌对应的所有实体牌。',\r\n\t\t\tgzqianxi:'潜袭',\r\n\t\t\tgzqianxi_info:'准备阶段开始时，你可以进行判定，然后你选择距离为1的一名角色，直到回合结束，该角色不能使用或打出与结果颜色相同的手牌',\r\n\t\t\tgzshangyi:'尚义',\r\n\t\t\tgzshangyi_info:'出牌阶段限一次，你可以令一名其他角色观看你的手牌。若如此做，你选择一项：1.观看其手牌并可以弃置其中的一张黑色牌；2.观看其所有暗置的武将牌。',\r\n\t\t\tniaoxiang:'鸟翔',\r\n\t\t\tniaoxiang_sha:'鸟翔',\r\n\t\t\tniaoxiang_info:'阵法技，在同一个围攻关系中，若你是围攻角色，则你或另一名围攻角色使用【杀】指定被围攻角色为目标后，该角色需依次使用两张【闪】才能抵消。',\r\n\t\t\tyicheng:'疑城',\r\n\t\t\tyicheng_info:'当与你势力相同的一名角色成为【杀】的目标后，你可以令该角色摸一张牌，然后弃置一张牌。',\r\n\t\t\tyizhi:'遗志',\r\n\t\t\tyizhi_info:'副将技，此武将牌减少半个阴阳鱼。若你的主将拥有技能〖观星〗，则将其描述中的X改为5；若你的主将没有技能〖观星〗，则你视为拥有技能〖观星〗。',\r\n\t\t\ttianfu:'天覆',\r\n\t\t\ttianfu_info:'主将技，阵法技，若当前回合角色与你处于同一队列，则你视为拥有技能〖看破〗。',\r\n\t\t\tziliang:'资粮',\r\n\t\t\tziliang_info:'副将技，当与你势力相同的一名角色受到伤害后，你可以将一张“田”交给该角色 ',\r\n\t\t\tgzjixi:'急袭',\r\n\t\t\tgzjixi_info:'主将技，此武将牌减少半个阴阳鱼。你可以将一张“田”当作【顺手牵羊】使用。',\r\n\t\t\thuyuan:'护援',\r\n\t\t\thuyuan_info:'结束阶段开始时，你可以将一张装备牌置入一名角色的装备区，然后你可以弃置该角色距离为1的一名角色的一张牌。',\r\n\t\t\theyi:'鹤翼',\r\n\t\t\theyi_info:'阵法技，与你处于同一队列的其他角色视为拥有技能【飞影】。',\r\n\t\t\tgz_shibing1wei:'魏兵',\r\n\t\t\tgz_shibing2wei:'魏兵',\r\n\t\t\tgz_shibing1shu:'蜀兵',\r\n\t\t\tgz_shibing2shu:'蜀兵',\r\n\t\t\tgz_shibing1wu:'吴兵',\r\n\t\t\tgz_shibing2wu:'吴兵',\r\n\t\t\tgz_shibing1qun:'群兵',\r\n\t\t\tgz_shibing2qun:'群兵',\r\n\t\t\tgz_shibing1jin:'晋兵',\r\n\t\t\tgz_shibing2jin:'晋兵',\r\n\t\t\tgz_shibing1ye:'士兵',\r\n\t\t\tgz_shibing2ye:'士兵',\r\n\t\t\tgz_shibing1key:'键兵',\r\n\t\t\tgz_shibing2key:'键兵',\r\n\r\n\t\t\tgz_shibing1holo:'杏兵',\r\n\t\t\tgz_shibing2holo:'杏兵',\r\n\t\t\tgz_shibing1nijisanji:'虹兵',\r\n\t\t\tgz_shibing2nijisanji:'虹兵',\r\n\t\t\tgz_shibing1vtuber:'企兵',\r\n\t\t\tgz_shibing2vtuber:'企兵',\r\n\t\t\tgz_shibing1clubs:'社兵',\r\n\t\t\tgz_shibing2clubs:'社兵',\r\n\r\n\t\t\tgzduanchang:'断肠',\r\n\t\t\tgzduanchang_info:'锁定技，当你死亡时，你令杀死你的角色失去一张武将牌上的所有技能。',\r\n\t\t\tgzweimu:'帷幕',\r\n\t\t\tgzweimu_info:'锁定技，当你成为黑色锦囊牌的目标时，取消之。',\r\n\t\t\tgzqianxun:'谦逊',\r\n\t\t\tgzqianxun_info:'锁定技，当你成为【顺手牵羊】或【乐不思蜀】的目标时，取消之。',\r\n\t\t\tgzkongcheng:'空城',\r\n\t\t\tgzkongcheng_info:'锁定技，当你成为【杀】或【决斗】的目标时，若你没有手牌，则取消之',\r\n\t\t\tgzxiaoji:'枭姬',\r\n\t\t\tgzxiaoji_info:'当你失去装备区里的牌后，你可以摸两张牌。',\r\n\t\t\tgzrende:'仁德',\r\n\t\t\tgzrende_info:'出牌阶段，你可以将任意张手牌交给其他角色，然后若你于此阶段内给出第三张“仁德”牌时，你回复1点体力',\r\n\t\t\tgzzhiheng:'制衡',\r\n\t\t\tgzzhiheng_info:'出牌阶段限一次，你可以弃置至多X张牌（X为你的体力上限），然后摸等量的牌。',\r\n\t\t\tzhiheng:'制衡',\r\n\t\t\tzhiheng_info:'出牌阶段一次，你可以弃置任意张牌，然后摸等量的牌。',\r\n\t\t\tduoshi:'度势',\r\n\t\t\tduoshi_info:'出牌阶段限四次，你可以将一张红色手牌当做【以逸待劳】使用。',\r\n\t\t\tgzxiaoguo:'骁果',\r\n\t\t\tgzxiaoguo_info:'其他角色的结束阶段开始时，你可以弃置一张基本牌，令该角色选择一项：1.弃置一张装备牌；2.受到你对其造成的1点伤害。',\r\n\r\n\t\t\tgz_key_ushio:'冈崎汐',\r\n\t\t\tushio_huanxin:'幻心',\r\n\t\t\tushio_huanxin_info:'当你受到伤害后/使用【杀】造成伤害后/使用装备牌后，你可进行判定。然后你获得判定牌并弃置一张牌。',\r\n\t\t\tushio_xilv:'汐旅',\r\n\t\t\tushio_xilv2:'汐旅',\r\n\t\t\tushio_xilv_info:'锁定技，此武将牌可作为任意单势力武将牌的副将。当你进行判定后，你令你的手牌上限+1直至你的下个结束阶段。',\r\n\r\n\t\t\tguozhan_default:\"国战标准\",\r\n\t\t\tguozhan_zhen:\"君临天下·阵\",\r\n\t\t\tguozhan_shi:\"君临天下·势\",\r\n\t\t\tguozhan_bian:\"君临天下·变\",\r\n\t\t\tguozhan_quan:\"君临天下·权\",\r\n\t\t\tguozhan_jun:\"君主武将\",\r\n\t\t\tguozhan_jin:'文德武备',\r\n\t\t\tguozhan_single:'君临天下EX',\r\n\t\t\tguozhan_double:'双势力武将',\r\n\t\t\tguozhan_yexinjia:'野心家武将',\r\n\t\t\tguozhan_zongheng:'纵横捭阖',\r\n\t\t\tguozhan_others:\"其他\",\r\n\r\n\t\t\tguozhan_guangjie:\"广结良盟\",\r\n\t\t},\r\n\t\tdynamicTranslate:{\r\n\t\t\tgz_longdan:function(player){\r\n\t\t\t\tif(player.$.gz_longdan) return '转换技 <span class=\"changetext\">阳~你可以将你任意一张不为【杀】的基本牌当作一张【杀】使用或打出；</span>阴~你可以将一张【杀】当作任意一张不为【杀】的基本牌使用或打出。你以此法转化点数大于7的牌无次数与距离限制。';\r\n\t\t\t\treturn '转换技 阳~你可以将你任意一张不为【杀】的基本牌当作一张【杀】使用或打出；<span class=\"changetext\">阴~你可以将一张【杀】当作任意一张不为【杀】的基本牌使用或打出。</span>你以此法转化点数大于7的牌无次数与距离限制。';\r\n\t\t\t},\r\n\t\t},\r\n\t\tjunList:['liubei','zhangjiao','sunquan','caocao'],\r\n\t\tguozhanPile_yingbian:[\r\n\t\t\t['spade',1,'juedou'],\r\n\t\t\t['spade',1,'shandian'],\r\n\t\t\t['spade',2,'cixiong'],\r\n\t\t\t['spade',2,'bagua'],\r\n\t\t\t['spade',2,'taigongyinfu'],\r\n\t\t\t['spade',3,'shuiyanqijunx',null,['yingbian_zhuzhan']],\r\n\t\t\t['spade',3,'zhujinqiyuan',null,['yingbian_zhuzhan']],\r\n\t\t\t['spade',4,'guohe'],\r\n\t\t\t['spade',4,'shuiyanqijunx',null,['yingbian_zhuzhan']],\r\n\t\t\t['spade',5,'sha'],\r\n\t\t\t['spade',5,'jueying'],\r\n\t\t\t['spade',6,'qinggang'],\r\n\t\t\t['spade',6,'sha','ice'],\r\n\t\t\t['spade',7,'sha'],\r\n\t\t\t['spade',7,'sha','ice'],\r\n\t\t\t['spade',8,'sha','ice'],\r\n\t\t\t['spade',8,'sha','ice'],\r\n\t\t\t['spade',9,'sha'],\r\n\t\t\t['spade',9,'jiu'],\r\n\t\t\t['spade',10,'sha',null,['yingbian_canqu']],\r\n\t\t\t['spade',10,'bingliang'],\r\n\t\t\t['spade',11,'sha',null,['yingbian_canqu']],\r\n\t\t\t['spade',11,'wuxie',null,['yingbian_kongchao']],\r\n\t\t\t['spade',12,'zhangba'],\r\n\t\t\t['spade',12,'tiesuo'],\r\n\t\t\t['spade',13,'nanman',null,['yingbian_fujia']],\r\n\t\t\t['spade',13,'wutiesuolian'],\r\n\r\n\t\t\t['heart',1,'taoyuan'],\r\n\t\t\t['heart',1,'wanjian'],\r\n\t\t\t['heart',2,'shan'],\r\n\t\t\t['heart',2,'chuqibuyi',null,['yingbian_zhuzhan']],\r\n\t\t\t['heart',3,'wugu'],\r\n\t\t\t['heart',3,'chuqibuyi',null,['yingbian_zhuzhan']],\r\n\t\t\t['heart',4,'tao'],\r\n\t\t\t['heart',4,'sha','fire',['yingbian_canqu']],\r\n\t\t\t['heart',5,'qilin'],\r\n\t\t\t['heart',5,'chitu'],\r\n\t\t\t['heart',6,'tao'],\r\n\t\t\t['heart',6,'lebu'],\r\n\t\t\t['heart',7,'tao'],\r\n\t\t\t['heart',7,'dongzhuxianji'],\r\n\t\t\t['heart',8,'tao'],\r\n\t\t\t['heart',8,'dongzhuxianji'],\r\n\t\t\t['heart',9,'tao'],\r\n\t\t\t['heart',9,'yuanjiao'],\r\n\t\t\t['heart',10,'tao'],\r\n\t\t\t['heart',10,'sha'],\r\n\t\t\t['heart',11,'shan'],\r\n\t\t\t['heart',11,'yiyi'],\r\n\t\t\t['heart',12,'tao'],\r\n\t\t\t['heart',12,'sha'],\r\n\t\t\t['heart',12,'guohe'],\r\n\t\t\t['heart',13,'shan'],\r\n\t\t\t['heart',13,'zhuahuang'],\r\n\r\n\t\t\t['diamond',1,'zhuge'],\r\n\t\t\t['diamond',1,'wuxinghelingshan'],\r\n\t\t\t['diamond',2,'shan'],\r\n\t\t\t['diamond',2,'tao'],\r\n\t\t\t['diamond',3,'shan'],\r\n\t\t\t['diamond',3,'shunshou'],\r\n\t\t\t['diamond',4,'yiyi'],\r\n\t\t\t['diamond',4,'sha','fire',['yingbian_canqu']],\r\n\t\t\t['diamond',5,'guanshi'],\r\n\t\t\t['diamond',5,'sha','fire'],\r\n\t\t\t['diamond',6,'shan'],\r\n\t\t\t['diamond',6,'wuliu'],\r\n\t\t\t['diamond',7,'shan',null,['yingbian_kongchao']],\r\n\t\t\t['diamond',7,'shan',null,['yingbian_kongchao']],\r\n\t\t\t['diamond',8,'shan',null,['yingbian_kongchao']],\r\n\t\t\t['diamond',8,'shan',null,['yingbian_kongchao']],\r\n\t\t\t['diamond',9,'shan'],\r\n\t\t\t['diamond',9,'jiu'],\r\n\t\t\t['diamond',10,'shan'],\r\n\t\t\t['diamond',10,'sha'],\r\n\t\t\t['diamond',11,'shan'],\r\n\t\t\t['diamond',11,'sha'],\r\n\t\t\t['diamond',12,'sha'],\r\n\t\t\t['diamond',12,'sanjian'],\r\n\t\t\t['diamond',12,'wuxie',null,['guo']],\r\n\t\t\t['diamond',13,'shan'],\r\n\t\t\t['diamond',13,'zixin'],\r\n\r\n\t\t\t['club',1,'juedou'],\r\n\t\t\t['club',1,'huxinjing'],\r\n\t\t\t['club',2,'sha'],\r\n\t\t\t['club',2,'tengjia'],\r\n\t\t\t['club',2,'renwang'],\r\n\t\t\t['club',3,'guohe'],\r\n\t\t\t['club',3,'zhibi'],\r\n\t\t\t['club',4,'sha',null,['yingbian_kongchao']],\r\n\t\t\t['club',4,'zhibi'],\r\n\t\t\t['club',5,'sha',null,['yingbian_kongchao']],\r\n\t\t\t['club',5,'tongque'],\r\n\t\t\t['club',6,'lebu'],\r\n\t\t\t['club',6,'sha','thunder'],\r\n\t\t\t['club',7,'nanman'],\r\n\t\t\t['club',7,'sha','thunder'],\r\n\t\t\t['club',8,'sha'],\r\n\t\t\t['club',8,'sha','thunder'],\r\n\t\t\t['club',9,'sha'],\r\n\t\t\t['club',9,'jiu'],\r\n\t\t\t['club',10,'sha'],\r\n\t\t\t['club',10,'bingliang'],\r\n\t\t\t['club',11,'sha'],\r\n\t\t\t['club',11,'sha'],\r\n\t\t\t['club',12,'zhujinqiyuan',null,['yingbian_zhuzhan']],\r\n\t\t\t['club',12,'tiesuo'],\r\n\t\t\t['club',13,'wuxie',null,['guo']],\r\n\t\t\t['club',13,'tiesuo'],\r\n\t\t],\r\n\t\tguozhanPile_old:[\r\n\t\t\t['spade',1,'juedou'],\r\n\t\t\t['spade',1,'shandian'],\r\n\t\t\t['spade',2,'cixiong'],\r\n\t\t\t['spade',2,'bagua'],\r\n\t\t\t['spade',2,'hanbing'],\r\n\t\t\t['spade',3,'guohe'],\r\n\t\t\t['spade',3,'shunshou'],\r\n\t\t\t['spade',4,'guohe'],\r\n\t\t\t['spade',4,'shunshou'],\r\n\t\t\t['spade',5,'sha'],\r\n\t\t\t['spade',5,'jueying'],\r\n\t\t\t['spade',6,'qinggang'],\r\n\t\t\t['spade',6,'sha','thunder'],\r\n\t\t\t['spade',7,'sha'],\r\n\t\t\t['spade',7,'sha','thunder'],\r\n\t\t\t['spade',8,'sha'],\r\n\t\t\t['spade',8,'sha'],\r\n\t\t\t['spade',9,'sha'],\r\n\t\t\t['spade',9,'jiu'],\r\n\t\t\t['spade',10,'sha'],\r\n\t\t\t['spade',10,'bingliang'],\r\n\t\t\t['spade',11,'sha'],\r\n\t\t\t['spade',11,'wuxie'],\r\n\t\t\t['spade',12,'zhangba'],\r\n\t\t\t['spade',12,'tiesuo'],\r\n\t\t\t['spade',13,'nanman'],\r\n\t\t\t['spade',13,'dawan'],\r\n\r\n\t\t\t['club',1,'juedou'],\r\n\t\t\t['club',1,'baiyin'],\r\n\t\t\t['club',2,'sha'],\r\n\t\t\t['club',2,'tengjia'],\r\n\t\t\t['club',2,'renwang'],\r\n\t\t\t['club',3,'sha'],\r\n\t\t\t['club',3,'zhibi'],\r\n\t\t\t['club',4,'sha'],\r\n\t\t\t['club',4,'zhibi'],\r\n\t\t\t['club',5,'sha'],\r\n\t\t\t['club',5,'dilu'],\r\n\t\t\t['club',6,'lebu'],\r\n\t\t\t['club',6,'sha','thunder'],\r\n\t\t\t['club',7,'nanman'],\r\n\t\t\t['club',7,'sha','thunder'],\r\n\t\t\t['club',8,'sha'],\r\n\t\t\t['club',8,'sha','thunder'],\r\n\t\t\t['club',9,'sha'],\r\n\t\t\t['club',9,'jiu'],\r\n\t\t\t['club',10,'sha'],\r\n\t\t\t['club',10,'bingliang'],\r\n\t\t\t['club',11,'sha'],\r\n\t\t\t['club',11,'sha'],\r\n\t\t\t['club',12,'jiedao'],\r\n\t\t\t['club',12,'tiesuo'],\r\n\t\t\t['club',13,'wuxie',null,['guo']],\r\n\t\t\t['club',13,'tiesuo'],\r\n\r\n\t\t\t['diamond',1,'zhuge'],\r\n\t\t\t['diamond',1,'zhuque'],\r\n\t\t\t['diamond',2,'shan'],\r\n\t\t\t['diamond',2,'tao'],\r\n\t\t\t['diamond',3,'shan'],\r\n\t\t\t['diamond',3,'shunshou'],\r\n\t\t\t['diamond',4,'yiyi'],\r\n\t\t\t['diamond',4,'sha','fire'],\r\n\t\t\t['diamond',5,'guanshi'],\r\n\t\t\t['diamond',5,'sha','fire'],\r\n\t\t\t['diamond',6,'shan'],\r\n\t\t\t['diamond',6,'wuliu'],\r\n\t\t\t['diamond',7,'shan'],\r\n\t\t\t['diamond',7,'shan'],\r\n\t\t\t['diamond',8,'shan'],\r\n\t\t\t['diamond',8,'shan'],\r\n\t\t\t['diamond',9,'shan'],\r\n\t\t\t['diamond',9,'jiu'],\r\n\t\t\t['diamond',10,'shan'],\r\n\t\t\t['diamond',10,'sha'],\r\n\t\t\t['diamond',11,'shan'],\r\n\t\t\t['diamond',11,'sha'],\r\n\t\t\t['diamond',12,'sha'],\r\n\t\t\t['diamond',12,'sanjian'],\r\n\t\t\t['diamond',12,'wuxie',null,['guo']],\r\n\t\t\t['diamond',13,'shan'],\r\n\t\t\t['diamond',13,'zixin'],\r\n\r\n\t\t\t['heart',1,'taoyuan'],\r\n\t\t\t['heart',1,'wanjian'],\r\n\t\t\t['heart',2,'shan'],\r\n\t\t\t['heart',2,'huogong'],\r\n\t\t\t['heart',3,'wugu'],\r\n\t\t\t['heart',3,'huogong'],\r\n\t\t\t['heart',4,'tao'],\r\n\t\t\t['heart',4,'sha','fire'],\r\n\t\t\t['heart',5,'qilin'],\r\n\t\t\t['heart',5,'chitu'],\r\n\t\t\t['heart',6,'tao'],\r\n\t\t\t['heart',6,'lebu'],\r\n\t\t\t['heart',7,'tao'],\r\n\t\t\t['heart',7,'wuzhong'],\r\n\t\t\t['heart',8,'tao'],\r\n\t\t\t['heart',8,'wuzhong'],\r\n\t\t\t['heart',9,'tao'],\r\n\t\t\t['heart',9,'yuanjiao'],\r\n\t\t\t['heart',10,'tao'],\r\n\t\t\t['heart',10,'sha'],\r\n\t\t\t['heart',11,'shan'],\r\n\t\t\t['heart',11,'yiyi'],\r\n\t\t\t['heart',12,'tao'],\r\n\t\t\t['heart',12,'sha'],\r\n\t\t\t['heart',12,'guohe'],\r\n\t\t\t['heart',13,'shan'],\r\n\t\t\t['heart',13,'zhuahuang'],\r\n\t\t],\r\n\t\tguozhanPile:[\r\n\t\t\t['spade',1,'juedou'],\r\n\t\t\t['spade',1,'shandian'],\r\n\t\t\t['spade',2,'feilongduofeng'],\r\n\t\t\t['spade',2,'bagua'],\r\n\t\t\t['spade',2,'hanbing'],\r\n\t\t\t['spade',3,'guohe'],\r\n\t\t\t['spade',3,'shunshou'],\r\n\t\t\t['spade',4,'guohe'],\r\n\t\t\t['spade',4,'shunshou'],\r\n\t\t\t['spade',5,'sha'],\r\n\t\t\t['spade',5,'jueying'],\r\n\t\t\t['spade',6,'qinggang'],\r\n\t\t\t['spade',6,'sha','thunder'],\r\n\t\t\t['spade',7,'sha'],\r\n\t\t\t['spade',7,'sha','thunder'],\r\n\t\t\t['spade',8,'sha'],\r\n\t\t\t['spade',8,'sha'],\r\n\t\t\t['spade',9,'sha'],\r\n\t\t\t['spade',9,'jiu'],\r\n\t\t\t['spade',10,'sha'],\r\n\t\t\t['spade',10,'bingliang'],\r\n\t\t\t['spade',11,'sha'],\r\n\t\t\t['spade',11,'wuxie'],\r\n\t\t\t['spade',12,'zhangba'],\r\n\t\t\t['spade',12,'tiesuo'],\r\n\t\t\t['spade',13,'nanman'],\r\n\t\t\t['spade',13,'dawan'],\r\n\r\n\t\t\t['club',1,'juedou'],\r\n\t\t\t['club',1,'baiyin'],\r\n\t\t\t['club',2,'sha'],\r\n\t\t\t['club',2,'tengjia'],\r\n\t\t\t['club',2,'renwang'],\r\n\t\t\t['club',3,'sha'],\r\n\t\t\t['club',3,'zhibi'],\r\n\t\t\t['club',4,'sha'],\r\n\t\t\t['club',4,'zhibi'],\r\n\t\t\t['club',5,'sha'],\r\n\t\t\t['club',5,'dilu'],\r\n\t\t\t['club',6,'lebu'],\r\n\t\t\t['club',6,'sha','thunder'],\r\n\t\t\t['club',7,'nanman'],\r\n\t\t\t['club',7,'sha','thunder'],\r\n\t\t\t['club',8,'sha'],\r\n\t\t\t['club',8,'sha','thunder'],\r\n\t\t\t['club',9,'sha'],\r\n\t\t\t['club',9,'jiu'],\r\n\t\t\t['club',10,'sha'],\r\n\t\t\t['club',10,'bingliang'],\r\n\t\t\t['club',11,'sha'],\r\n\t\t\t['club',11,'sha'],\r\n\t\t\t['club',12,'jiedao'],\r\n\t\t\t['club',12,'tiesuo'],\r\n\t\t\t['club',13,'wuxie',null,['guo']],\r\n\t\t\t['club',13,'tiesuo'],\r\n\r\n\t\t\t['diamond',1,'zhuge'],\r\n\t\t\t['diamond',1,'zhuque'],\r\n\t\t\t['diamond',2,'shan'],\r\n\t\t\t['diamond',2,'tao'],\r\n\t\t\t['diamond',3,'shan'],\r\n\t\t\t['diamond',3,'shunshou'],\r\n\t\t\t['diamond',4,'yiyi'],\r\n\t\t\t['diamond',4,'sha','fire'],\r\n\t\t\t['diamond',5,'guanshi'],\r\n\t\t\t['diamond',5,'sha','fire'],\r\n\t\t\t['diamond',6,'shan'],\r\n\t\t\t['diamond',6,'wuliu'],\r\n\t\t\t['diamond',7,'shan'],\r\n\t\t\t['diamond',7,'shan'],\r\n\t\t\t['diamond',8,'shan'],\r\n\t\t\t['diamond',8,'shan'],\r\n\t\t\t['diamond',9,'shan'],\r\n\t\t\t['diamond',9,'jiu'],\r\n\t\t\t['diamond',10,'shan'],\r\n\t\t\t['diamond',10,'sha'],\r\n\t\t\t['diamond',11,'shan'],\r\n\t\t\t['diamond',11,'sha'],\r\n\t\t\t['diamond',12,'sha'],\r\n\t\t\t['diamond',12,'sanjian'],\r\n\t\t\t['diamond',12,'wuxie',null,['guo']],\r\n\t\t\t['diamond',13,'shan'],\r\n\t\t\t['diamond',13,'zixin'],\r\n\r\n\t\t\t['heart',1,'taoyuan'],\r\n\t\t\t['heart',1,'wanjian'],\r\n\t\t\t['heart',2,'shan'],\r\n\t\t\t['heart',2,'huogong'],\r\n\t\t\t['heart',3,'wugu'],\r\n\t\t\t['heart',3,'taipingyaoshu'],\r\n\t\t\t['heart',3,'huogong'],\r\n\t\t\t['heart',4,'tao'],\r\n\t\t\t['heart',4,'sha','fire'],\r\n\t\t\t['heart',5,'qilin'],\r\n\t\t\t['heart',5,'chitu'],\r\n\t\t\t['heart',6,'tao'],\r\n\t\t\t['heart',6,'lebu'],\r\n\t\t\t['heart',7,'tao'],\r\n\t\t\t['heart',7,'wuzhong'],\r\n\t\t\t['heart',8,'tao'],\r\n\t\t\t['heart',8,'wuzhong'],\r\n\t\t\t['heart',9,'tao'],\r\n\t\t\t['heart',9,'yuanjiao'],\r\n\t\t\t['heart',10,'tao'],\r\n\t\t\t['heart',10,'sha'],\r\n\t\t\t['heart',11,'shan'],\r\n\t\t\t['heart',11,'yiyi'],\r\n\t\t\t['heart',12,'tao'],\r\n\t\t\t['heart',12,'sha'],\r\n\t\t\t['heart',12,'guohe'],\r\n\t\t\t['heart',13,'shan'],\r\n\t\t\t['heart',13,'zhuahuang'],\r\n\r\n\t\t\t['spade',1,'xietianzi',null,['lianheng']],\r\n\t\t\t['spade',2,'minguangkai'],\r\n\t\t\t['spade',3,'huoshaolianying',null,['lianheng']],\r\n\t\t\t['spade',4,'sha'],\r\n\t\t\t['spade',5,'qinglong'],\r\n\t\t\t['spade',6,'jiu',null,['lianheng']],\r\n\t\t\t['spade',7,'sha'],\r\n\t\t\t['spade',8,'sha'],\r\n\t\t\t['spade',9,'sha','thunder'],\r\n\t\t\t['spade',10,'sha','thunder'],\r\n\t\t\t['spade',11,'sha','thunder',['lianheng']],\r\n\t\t\t['spade',12,'lulitongxin'],\r\n\t\t\t['spade',13,'wuxie'],\r\n\r\n\t\t\t['heart',1,'lianjunshengyan'],\r\n\t\t\t['heart',2,'diaohulishan'],\r\n\t\t\t['heart',3,'jingfanma',null,['lianheng']],\r\n\t\t\t['heart',4,'shan'],\r\n\t\t\t['heart',5,'shan'],\r\n\t\t\t['heart',6,'shan'],\r\n\t\t\t['heart',7,'shan'],\r\n\t\t\t['heart',8,'tao'],\r\n\t\t\t['heart',9,'tao'],\r\n\t\t\t['heart',10,'sha'],\r\n\t\t\t['heart',11,'sha'],\r\n\t\t\t['heart',12,'huoshaolianying',null,['lianheng']],\r\n\t\t\t['heart',13,'shuiyanqijunx'],\r\n\r\n\t\t\t['club',1,'yuxi'],\r\n\t\t\t['club',2,'huxinjing',null,['lianheng']],\r\n\t\t\t['club',3,'chiling'],\r\n\t\t\t['club',4,'sha'],\r\n\t\t\t['club',5,'sha','thunder',['lianheng']],\r\n\t\t\t['club',6,'sha'],\r\n\t\t\t['club',7,'sha'],\r\n\t\t\t['club',8,'sha'],\r\n\t\t\t['club',9,'jiu'],\r\n\t\t\t['club',10,'lulitongxin'],\r\n\t\t\t['club',11,'huoshaolianying',null,['lianheng']],\r\n\t\t\t['club',12,'shuiyanqijunx'],\r\n\t\t\t['club',13,'wuxie',null,['guo']],\r\n\r\n\t\t\t['diamond',1,'xietianzi',null,['lianheng']],\r\n\t\t\t['diamond',2,'tao'],\r\n\t\t\t['diamond',3,'tao',null,['lianheng']],\r\n\t\t\t['diamond',4,'xietianzi',null,['lianheng']],\r\n\t\t\t['diamond',5,'muniu'],\r\n\t\t\t['diamond',6,'shan'],\r\n\t\t\t['diamond',7,'shan'],\r\n\t\t\t['diamond',8,'sha','fire'],\r\n\t\t\t['diamond',9,'sha','fire'],\r\n\t\t\t['diamond',10,'diaohulishan',null,['lianheng']],\r\n\t\t\t['diamond',11,'wuxie',null,['guo']],\r\n\t\t\t['diamond',12,'fangtian'],\r\n\t\t\t['diamond',13,'shan'],\r\n\r\n\t\t\t['diamond',6,'dinglanyemingzhu'],\r\n\t\t\t['heart',13,'liulongcanjia'],\r\n\t\t\t\r\n\t\t\t//['spade',12,'gz_haolingtianxia'],\r\n\t\t\t//['diamond',1,'gz_kefuzhongyuan'],\r\n\t\t\t//['heart',1,'gz_guguoanbang'],\r\n\t\t\t//['club',12,'gz_wenheluanwu'],\r\n\t\t],\r\n\t\telement:{\r\n\t\t\tcontent:{\r\n\t\t\t\thideCharacter:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.trigger('hideCharacterEnd');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.trigger('hideCharacterAfter');\r\n\t\t\t\t},\r\n\t\t\t\tchooseJunlingFor:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list=['junling1','junling2','junling3','junling4','junling5','junling6'];\r\n\t\t\t\t\tlist=list.randomGets(2).sort();\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++) list[i]=['军令','',list[i]];\r\n\t\t\t\t\tvar prompt=event.prompt||'选择一张军令牌';\r\n\t\t\t\t\tif(target!=undefined&&!event.prompt){\r\n\t\t\t\t\t\tvar str=target==player?'（你）':'';\r\n\t\t\t\t\t\tprompt+='，令'+get.translation(target)+str+'选择是否执行';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.chooseButton([prompt,[list,'vcard']],true).set('ai',function(button){\r\n\t\t\t\t\t\treturn get.junlingEffect(_status.event.player,button.link[2],_status.event.getParent().target,[],_status.event.player);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.result={\r\n\t\t\t\t\t\tjunling:result.links[0][2],\r\n\t\t\t\t\t\ttargets:[],\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(result.links[0][2]=='junling1') player.chooseTarget('选择一名角色，做为若该军令被执行，受到伤害的角色',true).set('ai',function(_target){\r\n\t\t\t\t\t\treturn get.damageEffect(_target,target,player);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(result.targets.length){\r\n\t\t\t\t\t\tplayer.line(result.targets,'green');\r\n\t\t\t\t\t\tevent.result.targets=result.targets;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tchooseJunlingControl:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar dialog=[];\r\n\t\t\t\t\tvar str1=source==player?'（你）':'';\r\n\t\t\t\t\tvar str2=event.targets?'（被指定的角色为'+get.translation(event.targets)+'）':'';\r\n\t\t\t\t\tif(!event.prompt) dialog.add(get.translation(event.source)+str1+'选择的军令'+str2+'为');\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tdialog.add(event.prompt);\r\n\t\t\t\t\t\tdialog.add(get.translation(event.source)+str1+'选择的军令'+str2+'为');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdialog.add([[event.junling],'vcard']);\r\n\t\t\t\t\tvar controls=[];\r\n\t\t\t\t\tif(event.choiceList){\r\n\t\t\t\t\t\tfor(var i=0;i<event.choiceList.length;i++){\r\n\t\t\t\t\t\t\tdialog.add('<div class=\"popup text\" style=\"width:calc(100% - 10px);display:inline-block\">选项'+get.cnNumber(i+1,true)+'：'+event.choiceList[i]+'</div>');\r\n\t\t\t\t\t\t\tcontrols.push('选项'+get.cnNumber(i+1,true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.controls) controls=event.controls;\r\n\t\t\t\t\telse controls=['执行该军令','不执行该军令'];\r\n\t\t\t\t\tif(!event.ai) event.ai=function(){return Math.floor(controls.length*Math.random())};\r\n\t\t\t\t\tplayer.chooseControl(controls).set('dialog',dialog).set('ai',event.ai);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.result={\r\n\t\t\t\t\t\tindex:result.index,\r\n\t\t\t\t\t\tcontrol:result.control,\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\t\t\t\tcarryOutJunling:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tswitch(event.junling){\r\n\t\t\t\t\t\tcase 'junling1':{\r\n\t\t\t\t\t\t\tif(targets[0].isAlive()){\r\n\t\t\t\t\t\t\t\tplayer.line(targets,'green');\r\n\t\t\t\t\t\t\t\ttargets[0].damage(player);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 'junling2':player.draw();event.num=1;break;\r\n\t\t\t\t\t\tcase 'junling3':player.loseHp();break;\r\n\t\t\t\t\t\tcase 'junling4':player.addTempSkill('junling4_eff');player.addTempSkill('fengyin_vice');player.addTempSkill('fengyin_main');break;\r\n\t\t\t\t\t\tcase 'junling5':player.turnOver();player.addTempSkill('junling5_eff');break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(event.junling=='junling2'&&source!=player&&player.countCards('he')>0){\r\n\t\t\t\t\t\tplayer.chooseCard('交给'+get.translation(source)+'第'+get.cnNumber(event.num)+'张牌（共两张）','he',true);\r\n\t\t\t\t\t\tevent.ing=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(event.junling=='junling6'){\r\n\t\t\t\t\t\tvar position='',num0=0;\r\n\t\t\t\t\t\tif(player.countCards('h')){position+='h';num0++;}\r\n\t\t\t\t\t\tif(player.countCards('e')){position+='e';num0++;}\r\n\t\t\t\t\t\tplayer.chooseCard('选择一张手牌和一张装备区内牌（若有），然后弃置其余的牌',position,num0,function(card){\r\n\t\t\t\t\t\t\tif(ui.selected.cards.length) return get.position(card)!=get.position(ui.selected.cards[0]);\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t},true).set('complexCard',true).set('ai',function(card){return get.value(card)});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(event.junling=='junling2'&&source!=player){\r\n\t\t\t\t\t\tif(result.cards.length&&event.ing){\r\n\t\t\t\t\t\t\tsource.gain(result.cards,player,'giveAuto');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.num++;\r\n\t\t\t\t\t\tif(event.num<3){\r\n\t\t\t\t\t\t\tevent.ing=false;\r\n\t\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(event.junling=='junling6'){\r\n\t\t\t\t\t\tvar cards=player.getCards('he');\r\n\t\t\t\t\t\tfor(var i=0;i<result.cards.length;i++) cards.remove(result.cards[i]);\r\n\t\t\t\t\t\tplayer.discard(cards);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdoubleDraw:function(){\r\n\t\t\t\t\tif(!player.hasMark('yinyang_mark')) player.addMark('yinyang_mark',1);\r\n\t\t\t\t},\r\n\t\t\t\tchangeViceOnline:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar group=lib.character[player.name1][1];\r\n\t\t\t\t\t_status.characterlist.randomSort();\r\n\t\t\t\t\tvar name=false;\r\n\t\t\t\t\tfor(var i=0;i<_status.characterlist.length;i++){\r\n\t\t\t\t\t\tif(lib.character[_status.characterlist[i]][1]==group&&!get.is.double(_status.characterlist[i])){name=_status.characterlist[i];break;}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!name){event.finish();return;}\r\n\t\t\t\t\t_status.characterlist.remove(name);\r\n\t\t\t\t\tif(player.hasViceCharacter()){\r\n\t\t\t\t\t\t\tevent.change=true;\r\n\t\t\t\t\t\t_status.characterlist.add(player.name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.toRemove=player.name2;\r\n\t\t\t\t\tevent.toChange=name;\r\n\t\t\t\t\tif(event.change) event.trigger('removeCharacterBefore');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar name=event.toChange;\r\n\t\t\t\t\tgame.log(player,'将副将变更为','#g'+get.translation(name));\r\n\t\t\t\t\tplayer.viceChanged=true;\r\n\t\t\t\t\tif(player.isUnseen(1)){\r\n\t\t\t\t\t\tplayer.showCharacter(1,false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.reinit(player.name2,name,false);\r\n\t\t\t\t},\r\n\t\t\t\tchangeVice:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(!event.num) event.num=3;\r\n\t\t\t\t\tvar group=player.identity;\r\n\t\t\t\t\tif(!lib.group.contains(group)) group=lib.character[player.name1][1];\r\n\t\t\t\t\t_status.characterlist.randomSort();\r\n\t\t\t\t\tevent.tochange=[]\r\n\t\t\t\t\tfor(var i=0;i<_status.characterlist.length;i++){\r\n\t\t\t\t\t\tvar double=get.is.double(_status.characterlist[i],true);\r\n\t\t\t\t\t\tif(group=='ye'?(lib.character[_status.characterlist[i]][1]!=group):(lib.character[_status.characterlist[i]][1]==group||(double&&double.contains(group)))) event.tochange.push(_status.characterlist[i]);\r\n\t\t\t\t\t\tif(event.tochange.length==event.num) break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!event.tochange.length) event.finish();\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(event.tochange.length==1) event._result={\r\n\t\t\t\t\t\t\tbool:true,\r\n\t\t\t\t\t\t\tlinks:event.tochange,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse player.chooseButton(true,['选择要变更的武将牌',[event.tochange,'character']]).ai=function(button){\r\n\t\t\t\t\t\t\treturn get.guozhanRank(button.link);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar name=result.links[0];\r\n\t\t\t\t\t_status.characterlist.remove(name);\r\n\t\t\t\t\tif(player.hasViceCharacter()){\r\n\t\t\t\t\t\tevent.change=true;\r\n\t\t\t\t\t\t_status.characterlist.add(player.name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.toRemove=player.name2;\r\n\t\t\t\t\tevent.toChange=name;\r\n\t\t\t\t\tif(event.change) event.trigger('removeCharacterBefore');\r\n\t\t\t\t\tif(event.hidden){\r\n\t\t\t\t\t\tif(player.isUnseen(0)) player.showCharacter(0,false);\r\n\t\t\t\t\t\tif(!player.isUnseen(1)) player.hideCharacter(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(player.isUnseen(1)){\r\n\t\t\t\t\t\tplayer.showCharacter(1,false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar name=event.toChange;\r\n\t\t\t\t\tif(event.hidden) game.log(player,'替换了副将','#g'+get.translation(player.name2));\r\n\t\t\t\t\telse game.log(player,'将副将从','#g'+get.translation(player.name2),'变更为','#g'+get.translation(name));\r\n\t\t\t\t\tplayer.viceChanged=true;\r\n\t\t\t\t\tplayer.reinit(player.name2,name,false);\r\n\t\t\t\t},\r\n\t\t\t\t/*----分界线----*/\r\n\t\t\t\tmayChangeVice:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseBool('是否变更副将？').set('ai',function(){\r\n\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\treturn get.guozhanRank(player.name2,player)<=3;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tif(!event.repeat) _status.changedSkills.add(event.skill)\r\n\t\t\t\t\t\tplayer.changeVice(event.hidden);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tzhulian:function(){\r\n\t\t\t\t\tplayer.popup('珠联璧合');\r\n\t\t\t\t\tif(!player.hasMark('zhulianbihe_mark')) player.addMark('zhulianbihe_mark',1);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tplayer:{\r\n\t\t\t\tgetGuozhanGroup:function(){\r\n\t\t\t\t\tif(get.is.double(this.name2)) return lib.character[this.name1][1];\r\n\t\t\t\t\treturn lib.character[this.name2][1];\r\n\t\t\t\t},\r\n\t\t\t\tchooseJunlingFor:function(target){\r\n\t\t\t\t\t\tvar next=game.createEvent('chooseJunlingFor');\r\n\t\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\t\tnext.target=target;\r\n\t\t\t\t\t\tnext.setContent('chooseJunlingFor');\r\n\t\t\t\t\t\treturn next;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tchooseJunlingControl:function(source,junling,targets){\r\n\t\t\t\t\t\tvar next=game.createEvent('chooseJunlingControl');\r\n\t\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\t\tnext.source=source;\r\n\t\t\t\t\t\tnext.junling=junling;\r\n\t\t\t\t\t\tif(targets.length) next.targets=targets;\r\n\t\t\t\t\t\tnext.setContent('chooseJunlingControl');\r\n\t\t\t\t\t\treturn next;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcarryOutJunling:function(source,junling,targets){\r\n\t\t\t\t\t\tvar next=game.createEvent('carryOutJunling');\r\n\t\t\t\t\t\tnext.source=source;\r\n\t\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\t\tif(targets.length) next.targets=targets;\r\n\t\t\t\t\t\tnext.junling=junling;\r\n\t\t\t\t\t\tnext.setContent('carryOutJunling');\r\n\t\t\t\t\t\treturn next;\r\n\t\t\t\t\t},\r\n\t\t\t\t/**/\r\n\t\t\t\tmayChangeVice:function(repeat,hidden){\r\n\t\t\t\t\tif(!_status.changedSkills) _status.changedSkills=[];\r\n\t\t\t\t\tvar skill=_status.event.name;\r\n\t\t\t\t\tif(repeat||!_status.changedSkills.contains(skill)){\r\n\t\t\t\t\t\tvar next=game.createEvent('mayChangeVice');\r\n\t\t\t\t\t\tnext.setContent('mayChangeVice');\r\n\t\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\t\tnext.skill=skill;\r\n\t\t\t\t\t\tif(repeat||(!_status.connectMode&&get.config('changeViceType')=='online')) next.repeat=true;\r\n\t\t\t\t\t\tif(hidden=='hidden') next.hidden=true;\r\n\t\t\t\t\t\treturn next;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdifferentIdentityFrom:function(target,self){\r\n\t\t\t\t\tif(this==target) return false;\r\n\t\t\t\t\tif(this.$.yexinjia_friend==target||target.$.yexinjia_friend==this) return false;\r\n\t\t\t\t\tif(self){\r\n\t\t\t\t\t\tif(target.identity=='unknown') return false;\r\n\t\t\t\t\t\tif(target.identity=='ye'||this.identity=='ye') return true;\r\n\t\t\t\t\t\tif(this.identity=='unknown'){\r\n\t\t\t\t\t\t\tvar identity=lib.character[this.name1][1];\r\n\t\t\t\t\t\t\tif(this.wontYe()) return identity!=target.identity;\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(this.identity=='unknown'||target.identity=='unknown') return false;\r\n\t\t\t\t\t\tif(this.identity=='ye'||target.identity=='ye') return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this.identity!=target.identity;\r\n\t\t\t\t},\r\n\t\t\t\tsameIdentityAs:function(target,shown){\r\n\t\t\t\t\tif(this.$.yexinjia_friend==target||target.$.yexinjia_friend==this) return true;\r\n\t\t\t\t\tif(shown){\r\n\t\t\t\t\t\tif(this.identity=='ye'||this.identity=='unknown') return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(this==target) return true;\r\n\t\t\t\t\t\tif(target.identity=='unknown'||target.identity=='ye'||this.identity=='ye') return false;\r\n\t\t\t\t\t\tif(this.identity=='unknown'){\r\n\t\t\t\t\t\t\tvar identity=lib.character[this.name1][1];\r\n\t\t\t\t\t\t\tif(this.wontYe()) return identity==target.identity;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this.identity==target.identity;\r\n\t\t\t\t},\r\n\t\t\t\tgetModeState:function(){\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tunseen:this.isUnseen(0),\r\n\t\t\t\t\t\tunseen2:this.isUnseen(1),\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetModeState:function(info){\r\n\t\t\t\t\tif(info.mode.unseen) this.classList.add('unseen');\r\n\t\t\t\t\tif(info.mode.unseen2) this.classList.add('unseen2');\r\n\t\t\t\t\tif(!info.name) return;\r\n\t\t\t\t\t// if(info.name.indexOf('unknown')==0){\r\n\t\t\t\t\t// \tif(this==game.me){\r\n\t\t\t\t\t// \t\tlib.translate[info.name]+='（你）';\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// }\r\n\t\t\t\t\tthis.init(info.name1,info.name2,false);\r\n\t\t\t\t\tthis.name1=info.name1;\r\n\t\t\t\t\tthis.name=info.name;\r\n\t\t\t\t\tthis.node.name_seat=ui.create.div('.name.name_seat',get.verticalStr(lib.translate[this.name].slice(0,3)),this);\r\n\t\t\t\t\tif(info.identityShown){\r\n\t\t\t\t\t\tthis.setIdentity(info.identity);\r\n\t\t\t\t\t\tthis.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(this!=game.me){\r\n\t\t\t\t\t\tthis.node.identity.firstChild.innerHTML='猜';\r\n\t\t\t\t\t\tthis.node.identity.dataset.color='unknown';\r\n\t\t\t\t\t\tthis.node.identity.classList.add('guessing');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdieAfter2:function(source){\r\n\t\t\t\t\tvar that=this;\r\n\t\t\t\t\tif(source&&source.hasSkillTag('noDieAfter2',null,this)) return;\r\n\t\t\t\t\tif(source&&source.shijun){\r\n\t\t\t\t\t\tsource.discard(source.getCards('he'));\r\n\t\t\t\t\t\tdelete source.shijun;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(source&&source.identity!='unknown'){\r\n\t\t\t\t\t\tif(source.identity=='ye') source.draw(3);\r\n\t\t\t\t\t\telse if(source.shijun2){\r\n\t\t\t\t\t\t\tdelete source.shijun2;\r\n\t\t\t\t\t\t\tsource.draw(1+game.countPlayer(function(current){\r\n\t\t\t\t\t\t\t\treturn current.group==that.group\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(this.identity=='ye') source.draw(1);\r\n\t\t\t\t\t\telse if(this.identity!=source.identity) source.draw(get.population(this.identity)+1);\r\n\t\t\t\t\t\telse source.discard(source.getCards('he'));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdieAfter:function(source){\r\n\t\t\t\t\tthis.showCharacter(2);\r\n\t\t\t\t\tif(get.is.jun(this.name1)){\r\n\t\t\t\t\t\tif(source&&source.identity==this.identity) source.shijun=true;\r\n\t\t\t\t\t\telse if(source&&source.identity!='ye') source.shijun2=true;\r\n\t\t\t\t\t\tvar yelist=[];\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i].identity==this.identity){\r\n\t\t\t\t\t\t\t\tyelist.push(game.players[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.broadcastAll(function(list){\r\n\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\tlist[i].identity='ye';\r\n\t\t\t\t\t\t\t\tlist[i].setIdentity();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},yelist);\r\n\t\t\t\t\t\t_status.yeidentity.add(this.identity);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.tryResult();\r\n\t\t\t\t},\r\n\t\t\t\tviewCharacter:function(target,num){\r\n\t\t\t\t\tif(num!=0&&num!=1){\r\n\t\t\t\t\t\tnum=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!target.isUnseen(num)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar next=game.createEvent('viewCharacter');\r\n\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\tnext.target=target;\r\n\t\t\t\t\tnext.num=num;\r\n\t\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\tif(!player.$.zhibi){\r\n\t\t\t\t\t\t\tplayer.$.zhibi=[];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.$.zhibi.add(target);\r\n\t\t\t\t\t\tvar content,str=get.translation(target)+'的';\r\n\t\t\t\t\t\tif(event.num==0||!target.isUnseen(1)){\r\n\t\t\t\t\t\t\tcontent=[str+'主将',[[target.name1],'character']];\r\n\t\t\t\t\t\t\tgame.log(player,'观看了',target,'的主将');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(event.num==1||!target.isUnseen(0)){\r\n\t\t\t\t\t\t\tcontent=[str+'副将',[[target.name2],'character']];\r\n\t\t\t\t\t\t\tgame.log(player,'观看了',target,'的副将');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tcontent=[str+'主将和副将',[[target.name1,target.name2],'character']];\r\n\t\t\t\t\t\t\tgame.log(player,'观看了',target,'的主将和副将');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.chooseControl('ok').set('dialog',content);\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\t\t\t\tcheckViceSkill:function(skill,disable){\r\n\t\t\t\t\tif(game.expandSkills(lib.character[this.name2][3].slice(0)).contains(skill)){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(disable!==false){\r\n\t\t\t\t\t\t\tthis.awakenSkill(skill);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcheckMainSkill:function(skill,disable){\r\n\t\t\t\t\tif(game.expandSkills(lib.character[this.name1][3].slice(0)).contains(skill)){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(disable!==false){\r\n\t\t\t\t\t\t\tthis.awakenSkill(skill);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremoveMaxHp:function(){\r\n\t\t\t\t\tif(game.online) return;\r\n\t\t\t\t\tif(typeof this.singleHp=='boolean'){\r\n\t\t\t\t\t\tif(this.singleHp){\r\n\t\t\t\t\t\t\tthis.singleHp=false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tthis.singleHp=true;\r\n\t\t\t\t\t\t\tthis.maxHp--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tthis.maxHp--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.update();\r\n\t\t\t\t},\r\n\t\t\t\thideCharacter:function(num,log){\r\n\t\t\t\t\tif(this.isUnseen(2)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.addVideo('hideCharacter',this,num);\r\n\t\t\t\t\tvar toHide;\r\n\t\t\t\t\tvar skills;\r\n\t\t\t\t\tswitch(num){\r\n\t\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\tif(log!==false) game.log(this,'暗置了主将'+get.translation(this.name1));\r\n\t\t\t\t\t\ttoHide=this.name1;\r\n\t\t\t\t\t\tskills=lib.character[this.name1][3];\r\n\t\t\t\t\t\tthis.name=this.name2;\r\n\t\t\t\t\t\tthis.sex=lib.character[this.name2][0];\r\n\t\t\t\t\t\tthis.classList.add('unseen');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tif(log!==false) game.log(this,'暗置了副将'+get.translation(this.name2));\r\n\t\t\t\t\t\ttoHide=this.name2;\r\n\t\t\t\t\t\tskills=lib.character[this.name2][3];\r\n\t\t\t\t\t\tthis.classList.add('unseen2');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function(player,name,sex,num,skills){\r\n\t\t\t\t\t\tplayer.name=name;\r\n\t\t\t\t\t\tplayer.sex=sex;\r\n\t\t\t\t\t\tswitch(num){\r\n\t\t\t\t\t\t\tcase 0:player.classList.add('unseen');break;\r\n\t\t\t\t\t\t\tcase 1:player.classList.add('unseen2');break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\t\tif(!player.skills.contains(skills[i])) continue;\r\n\t\t\t\t\t\t\tplayer.hiddenSkills.add(skills[i]);\r\n\t\t\t\t\t\t\tplayer.skills.remove(skills[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},this,this.name,this.sex,num,skills);\r\n\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\tif(!this.skills.contains(skills[i])) continue;\r\n\t\t\t\t\t\tthis.hiddenSkills.add(skills[i]);\r\n\t\t\t\t\t\tvar info=get.info(skills[i]);\r\n\t\t\t\t\t\tif(info.ondisable&&info.onremove){\r\n\t\t\t\t\t\t\tinfo.onremove(this);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.skills.remove(skills[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.checkConflict();\r\n\t\t\t\t\tvar next=game.createEvent('hideCharacter',false);\r\n\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\tnext.toHide=toHide;\r\n\t\t\t\t\tnext.setContent('hideCharacter');\r\n\t\t\t\t\treturn next;\r\n\t\t\t\t},\r\n\t\t\t\tremoveCharacter:function(num){\r\n\t\t\t\t\tvar name=this['name'+(num+1)];\r\n\t\t\t\t\tvar next=game.createEvent('removeCharacter');\r\n\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\tnext.toRemove=name;\r\n\t\t\t\t\tnext.num=num;\r\n\t\t\t\t\tnext.setContent('removeCharacter');\r\n\t\t\t\t\treturn next;\r\n\t\t\t\t},\r\n\t\t\t\t$removeCharacter:function(num){\r\n\t\t\t\t\tvar name=this['name'+(num+1)];\r\n\t\t\t\t\tvar info=lib.character[name];\r\n\t\t\t\t\tif(!info) return;\r\n\t\t\t\t\tvar to='gz_shibing'+(info[0]=='male'?1:2)+info[1];\r\n\t\t\t\t\tgame.log(this,'移除了'+(num?'副将':'主将'),'#b'+name);\r\n\t\t\t\t\tthis.reinit(name,to,false);\r\n\t\t\t\t\tthis.showCharacter(num,false);\r\n\t\t\t\t\t_status.characterlist.add(name);\r\n\t\t\t\t},\r\n\t\t\t\tchangeVice:function(hidden){\r\n\t\t\t\t\tvar next=game.createEvent('changeVice');\r\n\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\tnext.setContent('changeVice');\r\n\t\t\t\t\tnext.num=(!_status.connectMode&&get.config('changeViceType')=='online')?1:3;\r\n\t\t\t\t\tif(hidden) next.hidden=true;\r\n\t\t\t\t\treturn next;\r\n\t\t\t\t},\r\n\t\t\t\thasMainCharacter:function(){\r\n\t\t\t\t\treturn this.name1.indexOf('gz_shibing')!=0;\r\n\t\t\t\t},\r\n\t\t\t\thasViceCharacter:function(){\r\n\t\t\t\t\treturn this.name2.indexOf('gz_shibing')!=0;\r\n\t\t\t\t},\r\n\t\t\t\t$showCharacter:function(num,log){\r\n\t\t\t\t\tvar showYe=false;\r\n\t\t\t\t\tif(num==0&&!this.isUnseen(0)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(num==1&&!this.isUnseen(1)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!this.isUnseen(2)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.addVideo('showCharacter',this,num);\r\n\t\t\t\t\tif(this.identity=='unknown'||(this.identity!='ye'&&(num==0||num==2)&&lib.character[this.name1][1]=='ye')){\r\n\t\t\t\t\t\tthis.group=this.getGuozhanGroup(num);\r\n\t\t\t\t\t\tthis._group=this.group;\r\n\t\t\t\t\t\tif((num==0||num==2)&&lib.character[this.name1][1]==='ye'){\r\n\t\t\t\t\t\t\tthis.identity='ye';\r\n\t\t\t\t\t\t\tif(!this._ye){\r\n\t\t\t\t\t\t\t\tthis._ye=true;\r\n\t\t\t\t\t\t\t\tshowYe=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(get.is.jun(this.name1)&&this.isAlive()){\r\n\t\t\t\t\t\t\tthis.identity=this.group;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(this.wontYe(this.group)){\r\n\t\t\t\t\t\t\tthis.identity=this.group;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tthis.identity='ye';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.setIdentity(this.identity);\r\n\t\t\t\t\t\tthis.ai.shown=1;\r\n\t\t\t\t\t\tthis.node.identity.classList.remove('guessing');\r\n\r\n\t\t\t\t\t\tif(_status.clickingidentity&&_status.clickingidentity[0]==this){\r\n\t\t\t\t\t\t\tfor(var i=0;i<_status.clickingidentity[1].length;i++){\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform='';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.addVideo('setIdentity',this,this.identity);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar skills;\r\n\t\t\t\t\tswitch(num){\r\n\t\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\tif(log!==false) game.log(this,'展示了主将','#b'+this.name1);\r\n\t\t\t\t\t\tthis.name=this.name1;\r\n\t\t\t\t\t\tskills=lib.character[this.name][3];\r\n\t\t\t\t\t\tthis.sex=lib.character[this.name][0];\r\n\t\t\t\t\t\tthis.classList.remove('unseen');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tif(log!==false) game.log(this,'展示了副将','#b'+this.name2);\r\n\t\t\t\t\t\tskills=lib.character[this.name2][3];\r\n\t\t\t\t\t\tif(this.sex=='unknown') this.sex=lib.character[this.name2][0];\r\n\t\t\t\t\t\tif(this.name.indexOf('unknown')==0) this.name=this.name2;\r\n\t\t\t\t\t\tthis.classList.remove('unseen2');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tif(log!==false) game.log(this,'展示了主将','#b'+this.name1,'、副将','#b'+this.name2);\r\n\t\t\t\t\t\tthis.name=this.name1;\r\n\t\t\t\t\t\tskills=lib.character[this.name][3].concat(lib.character[this.name2][3]);\r\n\t\t\t\t\t\tthis.sex=lib.character[this.name][0];\r\n\t\t\t\t\t\tthis.classList.remove('unseen');\r\n\t\t\t\t\t\tthis.classList.remove('unseen2');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function(player,name,sex,num,identity,group){\r\n\t\t\t\t\t\tplayer.identityShown=true;\r\n\t\t\t\t\t\tplayer.group=group;\r\n\t\t\t\t\t\tplayer.name=name;\r\n\t\t\t\t\t\tplayer.sex=sex;\r\n\t\t\t\t\t\tplayer.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\tswitch(num){\r\n\t\t\t\t\t\t\tcase 0:player.classList.remove('unseen');break;\r\n\t\t\t\t\t\t\tcase 1:player.classList.remove('unseen2');break;\r\n\t\t\t\t\t\t\tcase 2:player.classList.remove('unseen');player.classList.remove('unseen2');break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.ai.shown=1;\r\n\t\t\t\t\t\tplayer.identity=identity;\r\n\t\t\t\t\t\tplayer.setIdentity(identity);\r\n\t\t\t\t\t\tif(_status.clickingidentity&&_status.clickingidentity[0]==player){\r\n\t\t\t\t\t\t\tfor(var i=0;i<_status.clickingidentity[1].length;i++){\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform='';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},this,this.name,this.sex,num,this.identity,this.group);\r\n\t\t\t\t\tthis.identityShown=true;\r\n\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\tthis.hiddenSkills.remove(skills[i]);\r\n\t\t\t\t\t\tthis.addSkill(skills[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.checkConflict();\r\n\t\t\t\t\tif(!this.viceChanged){\r\n\t\t\t\t\t\tvar initdraw=get.config('initshow_draw');\r\n\t\t\t\t\t\tif(_status.connectMode) initdraw=lib.configOL.initshow_draw;\r\n\t\t\t\t\t\tif(!_status.initshown&&!_status.overing&&initdraw!='off'&&this.isAlive()&&_status.mode!='mingjiang'){\r\n\t\t\t\t\t\t\tthis.popup('首亮');\r\n\t\t\t\t\t\t\tif(initdraw=='draw'){\r\n\t\t\t\t\t\t\t\tgame.log(this,'首先明置武将，得到奖励');\r\n\t\t\t\t\t\t\t\tgame.log(this,'摸了两张牌');\r\n\t\t\t\t\t\t\t\tthis.draw(2).log=false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tthis.addMark('xianqu_mark',1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_status.initshown=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!this.isUnseen(2)&&!this._mingzhied){\r\n\t\t\t\t\t\t\tthis._mingzhied=true;\r\n\t\t\t\t\t\t\tif(this.singleHp){\r\n\t\t\t\t\t\t\t\tthis.doubleDraw();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(this.perfectPair()){\r\n\t\t\t\t\t\t\t\tvar next=game.createEvent('guozhanDraw');\r\n\t\t\t\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\t\t\t\tnext.setContent('zhulian');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(showYe){\r\n\t\t\t\t\t\t\tthis.addMark('yexinjia_mark',1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.tryResult();\r\n\t\t\t\t},\r\n\t\t\t\twontYe:function(group){\r\n\t\t\t\t\tif(!group) group=lib.character[this.name1][1];\r\n\t\t\t\t\tif(_status.yeidentity&&_status.yeidentity.contains(group)) return false;\r\n\t\t\t\t\tif(get.zhu(this,null,true)) return true;\r\n\t\t\t\t\treturn get.totalPopulation(group)+1<=get.population()/2;\r\n\t\t\t\t},\r\n\t\t\t\tperfectPair:function(){\r\n\t\t\t\t\tif(_status.connectMode){\r\n\t\t\t\t\t\tif(!lib.configOL.zhulian) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(!get.config('zhulian')) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar name1=this.name1;\r\n\t\t\t\t\tvar name2=this.name2;\r\n\t\t\t\t\tif(name1.indexOf('gz_shibing')==0) return false;\r\n\t\t\t\t\tif(name2.indexOf('gz_shibing')==0) return false;\r\n\t\t\t\t\tif(lib.character[name1][1]!='ye'&&lib.character[name2][1]!='ye'&&lib.character[name1][1]!=lib.character[name2][1]) return false;\r\n\t\t\t\t\tif(get.is.jun(this.name1)) return true;\r\n\t\t\t\t\tvar list=['re','diy','sp','jsp','shen','jg','xin','old','gz','ol'];\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(name1.indexOf(list[i]+'_')==0){\r\n\t\t\t\t\t\t\tname1=name1.slice(list[i].length+1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(name2.indexOf(list[i]+'_')==0){\r\n\t\t\t\t\t\t\tname2=name2.slice(list[i].length+1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(lib.perfectPair[name1]&&lib.perfectPair[name1].contains(name2)){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(lib.perfectPair[name2]&&lib.perfectPair[name2].contains(name1)){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tsiege:function(player){\r\n\t\t\t\t\tif(this.identity=='unknown'||this.identity=='ye'||this.hasSkill('undist')) return false;\r\n\t\t\t\t\tif(!player){\r\n\t\t\t\t\t\tvar next=this.getNext();\r\n\t\t\t\t\t\tif(next&&next.sieged()) return true;\r\n\t\t\t\t\t\tvar previous=this.getPrevious();\r\n\t\t\t\t\t\tif(previous&&previous.sieged()) return true;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\treturn player.sieged()&&(player.getNext()==this||player.getPrevious()==this);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsieged:function(player){\r\n\t\t\t\t\tif(this.identity=='unknown') return false;\r\n\t\t\t\t\tif(player){\r\n\t\t\t\t\t\treturn player.siege(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar next=this.getNext();\r\n\t\t\t\t\t\tvar previous=this.getPrevious();\r\n\t\t\t\t\t\tif(next&&previous&&next!=previous){\r\n\t\t\t\t\t\t\tif(next.identity=='unknown'||next.identity=='ye'||next.identity==this.identity) return false;\r\n\t\t\t\t\t\t\treturn next.identity==previous.identity;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinline:function(){\r\n\t\t\t\t\tif(this.identity=='unknown'||this.identity=='ye'||this.hasSkill('undist')) return false;\r\n\t\t\t\t\tvar next=this,previous=this;\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(var i=0;next||previous;i++){\r\n\t\t\t\t\t\tif(next){\r\n\t\t\t\t\t\t\tnext=next.getNext();\r\n\t\t\t\t\t\t\tif(next.identity!=this.identity||next==this){\r\n\t\t\t\t\t\t\t\tnext=null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tlist.add(next);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(previous){\r\n\t\t\t\t\t\t\tprevious=previous.getPrevious();\r\n\t\t\t\t\t\t\tif(previous.identity!=this.identity||previous==this){\r\n\t\t\t\t\t\t\t\tprevious=null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tlist.add(previous);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!list.length) return false;\r\n\t\t\t\t\tfor(var i=0;i<arguments.length;i++){\r\n\t\t\t\t\t\tif(!list.contains(arguments[i])&&arguments[i]!=this) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tisMajor:function(){\r\n\t\t\t\t\tif(this.identity=='unknown') return false;\r\n\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.identity!='unknown'&&current.hasSkillTag('forceMajor');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\tfor(var i of list){\r\n\t\t\t\t\t\t\tif(i.isFriendOf(this)) return true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar map={},sides=[],pmap=_status.connectMode?lib.playerOL:game.playerMap,player;\r\n\t\t\t\t\tfor(var i of game.players){\r\n\t\t\t\t\t\tif(i.identity=='unknown') continue;\r\n\t\t\t\t\t\tvar added=false;\r\n\t\t\t\t\t\tfor(var j of sides){\r\n\t\t\t\t\t\t\tif(i.isFriendOf(pmap[j])){\r\n\t\t\t\t\t\t\t\tadded=true;\r\n\t\t\t\t\t\t\t\tmap[j].push(i);\r\n\t\t\t\t\t\t\t\tif(i==this) player=j;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!added){\r\n\t\t\t\t\t\t\tmap[i.playerid]=[i];\r\n\t\t\t\t\t\t\tsides.push(i.playerid);\r\n\t\t\t\t\t\t\tif(i==this) player=i.playerid;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!player||map[player].length<2) return false;\r\n\t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\tif(map[i].length>map[player].length) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tisNotMajor:function(){\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].isMajor()){\r\n\t\t\t\t\t\t\treturn !this.isMajor();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tisMinor:function(nomajor){\r\n\t\t\t\t\tif(this.identity=='unknown'||(!nomajor&&this.isMajor())) return false;\r\n\t\t\t\t\tif(!nomajor&&!game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isMajor();\r\n\t\t\t\t\t})){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar map={},sides=[],pmap=_status.connectMode?lib.playerOL:game.playerMap,player;\r\n\t\t\t\t\tfor(var i of game.players){\r\n\t\t\t\t\t\tif(i.identity=='unknown') continue;\r\n\t\t\t\t\t\tvar added=false;\r\n\t\t\t\t\t\tfor(var j of sides){\r\n\t\t\t\t\t\t\tif(i.isFriendOf(pmap[j])){\r\n\t\t\t\t\t\t\t\tadded=true;\r\n\t\t\t\t\t\t\t\tmap[j].push(i);\r\n\t\t\t\t\t\t\t\tif(i==this) player=j;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!added){\r\n\t\t\t\t\t\t\tmap[i.playerid]=[i];\r\n\t\t\t\t\t\t\tsides.push(i.playerid);\r\n\t\t\t\t\t\t\tif(i==this) player=i.playerid;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\tif(map[i].length<map[player].length) return false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tlogAi:function(targets,card){\r\n\t\t\t\t\tif(this.ai.shown==1||this.isMad()) return;\r\n\t\t\t\t\tif(typeof targets=='number'){\r\n\t\t\t\t\t\tthis.ai.shown+=targets;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar effect=0,c,shown;\r\n\t\t\t\t\t\tvar info=get.info(card);\r\n\t\t\t\t\t\tif(info.ai&&info.ai.expose){\r\n\t\t\t\t\t\t\tif(_status.event.name=='_wuxie'){\r\n\t\t\t\t\t\t\t\tif(_status.event.source&&_status.event.source.ai.shown){\r\n\t\t\t\t\t\t\t\t\tthis.ai.shown+=0.2;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tthis.ai.shown+=info.ai.expose;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(targets.length>0){\r\n\t\t\t\t\t\t\tfor(var i=0;i<targets.length;i++){\r\n\t\t\t\t\t\t\t\tshown=Math.abs(targets[i].ai.shown);\r\n\t\t\t\t\t\t\t\tif(shown<0.2||targets[i].identity=='nei') c=0;\r\n\t\t\t\t\t\t\t\telse if(shown<0.4) c=0.5;\r\n\t\t\t\t\t\t\t\telse if(shown<0.6) c=0.8;\r\n\t\t\t\t\t\t\t\telse c=1;\r\n\t\t\t\t\t\t\t\teffect+=get.effect(targets[i],card,this)*c;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(effect>0){\r\n\t\t\t\t\t\t\tif(effect<1) c=0.5;\r\n\t\t\t\t\t\t\telse c=1;\r\n\t\t\t\t\t\t\tif(targets.length==1&&targets[0]==this);\r\n\t\t\t\t\t\t\telse if(targets.length==1) this.ai.shown+=0.2*c;\r\n\t\t\t\t\t\t\telse this.ai.shown+=0.1*c;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.ai.shown>0.95) this.ai.shown=0.95;\r\n\t\t\t\t\tif(this.ai.shown<-0.5) this.ai.shown=-0.5;\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t},\r\n\t\tget:{\r\n\t\t\tguozhanReverse:function(name1,name2){\r\n\t\t\t\tif(get.is.double(name2)) return false;\r\n\t\t\t\tif(['gz_xunyou','gz_lvfan','gz_liubei'].contains(name2)) return true;\r\n\t\t\t\tif(name1=='gz_re_xushu') return true;\r\n\t\t\t\tif(name2=='gz_dengai') return lib.character[name1][2]%2==1;\r\n\t\t\t\tif(['gz_sunce','gz_jiangwei'].contains(name1)) return name2=='gz_zhoutai'||lib.character[name2][2]%2==1;\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tguozhanRank:function(name,player){\r\n\t\t\t\tif(name.indexOf('gz_shibing')==0) return -1;\r\n\t\t\t\tif(name.indexOf('gz_jun_')==0) return 7;\r\n\t\t\t\tif(player){\r\n\t\t\t\t\tvar skills=lib.character[name][3].slice(0);\r\n\t\t\t\t\tfor(var i=0;i<skills.length;i++){\r\n\t\t\t\t\t\tif(lib.skill[skills[i]].limited&&player.awakenedSkills.contains(skills[i])) return skills.length-1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(_status._aozhan){\r\n\t\t\t\t\tfor(var i in lib.aozhanRank){\r\n\t\t\t\t\t\tif(lib.aozhanRank[i].contains(name)) return parseInt(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor(var i in lib.guozhanRank){\r\n\t\t\t\t\tif(lib.guozhanRank[i].contains(name)) return parseInt(i);\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t},\r\n\t\t\tjunlingEffect:function(source,junling,performer,targets,viewer){\r\n\t\t\t\tvar att1=get.attitude(viewer,source),att2=get.attitude(viewer,performer);\r\n\t\t\t\tvar eff1=0,eff2=0;\r\n\t\t\t\tswitch(junling){\r\n\t\t\t\t\tcase 'junling1':\r\n\t\t\t\t\tif(!targets.length&&game.countPlayer(function(current){return get.damageEffect(viewer,current,viewer)>0})) eff1=2;\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(get.damageEffect(targets[0],performer,source)>=0) eff1=2;\r\n\t\t\t\t\t\telse eff1=-2;\r\n\t\t\t\t\t\tif(get.damageEffect(targets[0],source,performer)>=0) eff2=2;\r\n\t\t\t\t\t\telse eff2=-2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'junling2':\r\n\t\t\t\t\tif(performer.countCards('he')){eff1=1;eff2=0;}\r\n\t\t\t\t\telse{eff1=2;eff2=-1;}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'junling3':\r\n\t\t\t\t\tif(performer.hp==1&&!performer.hasSkillTag('save',true)) eff2=-5;\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(performer==viewer){\r\n\t\t\t\t\t\t\tif(performer.hasSkillTag('maihp',true)) eff2=3;\r\n\t\t\t\t\t\t\telse eff2=-2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(performer.hasSkillTag('maihp',false)) eff2=3;\r\n\t\t\t\t\t\t\telse eff2=-2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'junling4':eff1=0;eff2=-2;break;\r\n\t\t\t\t\tcase 'junling5':\r\n\t\t\t\t\tvar td=performer.isTurnedOver();\r\n\t\t\t\t\tif(td){\r\n\t\t\t\t\t\tif(performer==viewer){\r\n\t\t\t\t\t\t\tif(_status.currentPhase==performer&&performer.hasSkill('jushou')) eff2=-3;\r\n\t\t\t\t\t\t\telse eff2=3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse eff2=3;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(performer==viewer){\r\n\t\t\t\t\t\t\tif(performer.hasSkillTag('noturn',true)) eff2=0;\r\n\t\t\t\t\t\t\telse eff2=-3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(performer.hasSkillTag('noturn',false)) eff2=0;\r\n\t\t\t\t\t\t\telse eff2=-3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'junling6':\r\n\t\t\t\t\tif(performer.countCards('h')>1) eff2+=1-performer.countCards('h');\r\n\t\t\t\t\tif(performer.countCards('e')>1) eff2+=1-performer.countCards('e');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\treturn Math.sign(att1)*eff1+Math.sign(att2)*eff2;\r\n\t\t\t},\r\n\t\t\trealAttitude:function(from,to,difficulty,toidentity){\r\n\t\t\t\tif(from.identity==toidentity&&toidentity!='ye'){\r\n\t\t\t\t\treturn 4+difficulty;\r\n\t\t\t\t}\r\n\t\t\t\tif(from.identity=='unknown'&&lib.character[from.name1][1]==toidentity){\r\n\t\t\t\t\tif(from.wontYe()) return 4+difficulty;\r\n\t\t\t\t}\r\n\t\t\t\tvar groups=[];\r\n\t\t\t\tvar map={},sides=[],pmap=_status.connectMode?lib.playerOL:game.playerMap,player;\r\n\t\t\t\tfor(var i of game.players){\r\n\t\t\t\t\tif(i.identity=='unknown') continue;\r\n\t\t\t\t\tvar added=false;\r\n\t\t\t\t\tfor(var j of sides){\r\n\t\t\t\t\t\tif(i.isFriendOf(pmap[j])){\r\n\t\t\t\t\t\t\tadded=true;\r\n\t\t\t\t\t\t\tmap[j].push(i);\r\n\t\t\t\t\t\t\tif(i==this) player=j;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!added){\r\n\t\t\t\t\t\tmap[i.playerid]=[i];\r\n\t\t\t\t\t\tsides.push(i.playerid);\r\n\t\t\t\t\t\tif(i==this) player=i.playerid;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor(var i in map) groups.push(map[i].length);\r\n\t\t\t\tvar max=Math.max.apply(this,groups);\r\n\t\t\t\tif(max<=1) return -3;\r\n\t\t\t\tvar from_p;\r\n\t\t\t\tif(from.identity=='unknown'&&from.wontYe()) from_p=get.population(lib.character[from.name1][1]);\r\n\t\t\t\telse from_p=game.countPlayer(function(current){\r\n\t\t\t\t\treturn current.isFriendOf(from);\r\n\t\t\t\t});\r\n\t\t\t\tvar to_p=game.countPlayer(function(current){\r\n\t\t\t\t\treturn current.isFriendOf(to);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif(to_p==max) return -5;\r\n\t\t\t\tif(from_p==max) return -2-to_p;\r\n\t\t\t\tif(max>=game.players.length/2){\r\n\t\t\t\t\tif(to_p<=from_p){\r\n\t\t\t\t\t\treturn 0.5;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\tif(to_p<max-1) return 0;\r\n\t\t\t\treturn -0.5;\r\n\t\t\t},\r\n\t\t\trawAttitude:function(from,to){\r\n\t\t\t\tif(to.identity=='unknown'&&game.players.length==2) return -5;\r\n\t\t\t\tif(_status.currentPhase==from&&from.ai.tempIgnore&&\r\n\t\t\t\t\tfrom.ai.tempIgnore.contains(to)&&to.identity=='unknown'&&\r\n\t\t\t\t\t(!from.$.zhibi||!from.$.zhibi.contains(to))) return 0;\r\n\t\t\t\tvar difficulty=0;\r\n\t\t\t\tif(to==game.me) difficulty=(2-get.difficulty())*1.5;\r\n\t\t\t\tif(from==to) return 5+difficulty;\r\n\t\t\t\tif(from.isFriendOf(to)) return 5+difficulty;\r\n\t\t\t\tif(from.identity=='unknown'&&lib.character[from.name1][1]==to.identity){\r\n\t\t\t\t\tif(from.wontYe()) return 4+difficulty;\r\n\t\t\t\t}\r\n\t\t\t\tvar toidentity=to.identity;\r\n\t\t\t\tif(toidentity=='unknown'){\r\n\t\t\t\t\ttoidentity=lib.character[to.name1][1];\r\n\t\t\t\t\tif(!to.wontYe()){\r\n\t\t\t\t\t\ttoidentity='ye';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar att=get.realAttitude(from,to,difficulty,toidentity);\r\n\t\t\t\tif(from.$.zhibi&&from.$.zhibi.contains(to)){\r\n\t\t\t\t\treturn att;\r\n\t\t\t\t}\r\n\t\t\t\tif(to.ai.shown>=0.5) return att*to.ai.shown;\r\n\r\n\t\t\t\tvar nshown=0;\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tif(game.players[i]!=from&&game.players[i].identity=='unknown'){\r\n\t\t\t\t\t\tnshown++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(to.ai.shown==0){\r\n\t\t\t\t\tif(nshown>=game.players.length/2&&att>=0){\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn Math.min(0,Math.random()-0.5)+difficulty;\r\n\t\t\t\t}\r\n\t\t\t\tif(to.ai.shown>=0.2){\r\n\t\t\t\t\tif(att>2){\r\n\t\t\t\t\t\treturn Math.max(0,Math.random()-0.5)+difficulty;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(att>=0){\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn Math.min(0,Math.random()-0.7)+difficulty;\r\n\t\t\t\t}\r\n\t\t\t\tif(att>2){\r\n\t\t\t\t\treturn Math.max(0,Math.random()-0.7)+difficulty;\r\n\t\t\t\t}\r\n\t\t\t\tif(att>=0){\r\n\t\t\t\t\treturn Math.min(0,Math.random()-0.3)+difficulty;\r\n\t\t\t\t}\r\n\t\t\t\treturn Math.min(0,Math.random()-0.5)+difficulty;\r\n\t\t\t},\r\n\t\t},\r\n\t\thelp:{\r\n\t\t\t'国战模式':\r\n\t\t\t'<div style=\"margin:10px\">声明</div><ul style=\"margin-top:0\"><li>以下所有规则均为根据公开爆料整理，经村规改动后制定的临时规则。不代表任何官方意见。请以后续发布的官方规则作为标准。</ul>'\r\n\t\t\t+'<div style=\"margin:10px\">双势力武将</div><ul style=\"margin-top:0\"><li>双势力武将牌只能放在副将位置。主将可以为普通武将牌和野心家武将牌。<br><li>双势力武将牌明置时，势力按照主将的势力进行结算（无论是否明置主将）。胜负条件与正常的单势力武将相同。<br><li>变更副将时，可以选择包含原势力的双势力武将牌。</ul>'\r\n\t\t\t+'<div style=\"margin:10px\">野心家武将</div><ul style=\"margin-top:0\"><li>野心家武将只能放在主将位置。副将可以为任意非野心家武将牌。<br><li>选择了野心家武将牌的角色（以下简称“野心家角色”）仅明置副将时，若副将为单势力武将牌，则势力暂时视为与该武将牌相同。若副将为双势力武将牌，则势力视为野心家。<br><li>野心家角色明置主将时，其势力改为野心家。若其是首次明置该武将牌，则其获得一个“野心家”标记。<br><li>“野心家”标记可以当做“先驱”标记，“阴阳鱼”标记或是“珠联璧合”标记使用。当同时拥有两种标记时，优先弃置原装标记，下次发动时才弃置“野心家”标记。<br><li>野心家角色变更副将时，若其主将未明置过，则按照副将的势力进行变更。若主将已经明置过，则可以选择所有的非野心家武将牌。'\r\n\t\t\t+'<br><li>当场上触发了胜利条件时，若这些角色中存在未明置过主将的野心家角色，则这些野心家角色选择是否“暴露野心”。若无人选择“是”且场上存在非野心家角色存活，则所有非野心家角色胜利，野心家角色失败。若有人选择“是”，则这些角色明置主将。然后若场上存活角色数大于等于3，则这些角色选择是否发起“拉拢人心”<br><li>选择发起“拉拢人心”的野心家角色，令所有其他非野心家角色和非君主角色依次选择是否和该野心家角色“结盟”。若有人选择“是”，则野心家角色弃置“野心家”标记，且该角色将势力改为野心家，将手牌摸至四张并回复1点体力，且视为和发起“拉拢人心”的野心家角色势力相同，并终止对其他角色的询问。</ul>'\r\n\t\t\t+'<div style=\"margin:10px\">纵横捭阖</div><ul style=\"margin-top:0\"><li>当一名角色对目标角色发动具有拥有“纵横”衍生技的技能时，其可以令对方获得“纵横”衍生技直到其下回合结束。</ul>',\r\n\t\t},\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/guozhan.js?")},"./src/mode/identity.js":function(){eval("\r\ngame.import('mode', function (lib, game, ui, get, ai, _status) {\r\n\treturn {\r\n\t\tname: 'identity',\r\n\t\tstart: function () {\r\n\t\t\t\"step 0\"\r\n\t\t\t_status.mode = get.config('identity_mode');\r\n\t\t\tif (_status.brawl && _status.brawl.submode) {\r\n\t\t\t\t_status.mode = _status.brawl.submode;\r\n\t\t\t}\r\n\t\t\tevent.replacePile = function () {\r\n\t\t\t\tvar list = ['shengdong', 'qijia', 'caomu', 'jinchan', 'zengbin', 'fulei', 'qibaodao', 'zhungangshuo', 'lanyinjia'];\r\n\t\t\t\tvar map = {\r\n\t\t\t\t\tshunshou: 'shengdong',\r\n\t\t\t\t\tjiedao: 'qijia',\r\n\t\t\t\t\tbingliang: 'caomu',\r\n\t\t\t\t\twuxie: 'jinchan',\r\n\t\t\t\t\twuzhong: 'zengbin',\r\n\t\t\t\t\twugu: 'zengbin',\r\n\t\t\t\t\tshandian: 'fulei',\r\n\t\t\t\t\tqinggang: 'qibaodao',\r\n\t\t\t\t\tqinglong: 'zhungangshuo',\r\n\t\t\t\t\tbagua: 'lanyinjia'\r\n\t\t\t\t};\r\n\t\t\t\tfor (var i = 0; i < lib.card.list.length; i++) {\r\n\t\t\t\t\tvar name = lib.card.list[i][2];\r\n\t\t\t\t\tif (list.contains(name)) {\r\n\t\t\t\t\t\tlib.card.list.splice(i--, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (map[name]) {\r\n\t\t\t\t\t\tlib.card.list[i][2] = map[name];\r\n\t\t\t\t\t\tlib.card.list[i]._replaced = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (get.config('card_remark')) {\r\n\t\t\t\tfor (var i = 0; i < lib.card.list.length; i++) {\r\n\t\t\t\t\tif (get.type(lib.card.list[i][2]) == 'equip') {\r\n\t\t\t\t\t\tlib.card.list[i][2] = 'rm_' + lib.card.list[i][2];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\"step 1\"\r\n\t\t\tvar playback = localStorage.getItem(lib.configprefix + 'playback');\r\n\t\t\tif (playback) {\r\n\t\t\t\tui.create.me();\r\n\t\t\t\tui.arena.style.display = 'none';\r\n\t\t\t\tui.system.style.display = 'none';\r\n\t\t\t\t_status.playback = playback;\r\n\t\t\t\tlocalStorage.removeItem(lib.configprefix + 'playback');\r\n\t\t\t\tvar store = lib.db.transaction(['video'], 'readwrite').objectStore('video');\r\n\t\t\t\tstore.get(parseInt(playback)).onsuccess = function (e) {\r\n\t\t\t\t\tif (e.target.result) {\r\n\t\t\t\t\t\tgame.playVideoContent(e.target.result.video);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\talert('播放失败：找不到录像');\r\n\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tevent.finish();\r\n\t\t\t}\r\n\t\t\telse if (!_status.connectMode) {\r\n\t\t\t\tif (_status.mode == 'zhong') {\r\n\t\t\t\t\tif (get.config('zhong_card')) {\r\n\t\t\t\t\t\tevent.replacePile();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.prepareArena(8);\r\n\t\t\t\t}\r\n\t\t\t\telse if (_status.mode == 'purple') {\r\n\t\t\t\t\tgame.prepareArena(8);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tgame.prepareArena();\r\n\t\t\t\t}\r\n\t\t\t\tgame.delay();\r\n\t\t\t}\r\n\t\t\t\"step 2\"\r\n\t\t\tif (!_status.connectMode) {\r\n\t\t\t\tgame.showChangeLog();\r\n\t\t\t}\r\n\t\t\t\"step 3\"\r\n\t\t\tif (_status.new_tutorial) {\r\n\t\t\t\t_status.new_beginner = true;\r\n\t\t\t}\r\n\t\t\tif (typeof _status.new_tutorial == 'function') {\r\n\t\t\t\t_status.new_tutorial();\r\n\t\t\t}\r\n\t\t\tdelete _status.new_tutorial;\r\n\t\t\tif (_status.connectMode) {\r\n\t\t\t\tgame.waitForPlayer(function () {\r\n\t\t\t\t\tif (lib.configOL.identity_mode == 'zhong' || lib.configOL.identity_mode == 'purple') {\r\n\t\t\t\t\t\tlib.configOL.number = 8;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\"step 4\"\r\n\t\t\tif (_status.connectMode) {\r\n\t\t\t\t_status.mode = lib.configOL.identity_mode;\r\n\t\t\t\tif (_status.mode == 'zhong') {\r\n\t\t\t\t\tlib.configOL.number = 8;\r\n\t\t\t\t\tif (lib.configOL.zhong_card) {\r\n\t\t\t\t\t\tevent.replacePile();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (_status.mode == 'purple') {\r\n\t\t\t\t\tlib.configOL.number = 8;\r\n\t\t\t\t}\r\n\t\t\t\tif (lib.configOL.number < 2) {\r\n\t\t\t\t\tlib.configOL.number = 2;\r\n\t\t\t\t}\r\n\t\t\t\tgame.randomMapOL();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t}\r\n\t\t\t\tif (_status.brawl && _status.brawl.chooseCharacterBefore) {\r\n\t\t\t\t\t_status.brawl.chooseCharacterBefore();\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacter(_status.new_beginner);\r\n\t\t\t}\r\n\t\t\t\"step 5\"\r\n\t\t\tif (ui.coin) {\r\n\t\t\t\t_status.coinCoeff = get.coinCoeff([game.me.name]);\r\n\t\t\t}\r\n\t\t\tif (game.players.length == 2) {\r\n\t\t\t\tgame.showIdentity(true);\r\n\t\t\t\tvar map = {};\r\n\t\t\t\tfor (var i in lib.playerOL) {\r\n\t\t\t\t\tmap[i] = lib.playerOL[i].identity;\r\n\t\t\t\t}\r\n\t\t\t\tgame.broadcast(function (map) {\r\n\t\t\t\t\tfor (var i in map) {\r\n\t\t\t\t\t\tlib.playerOL[i].identity = map[i];\r\n\t\t\t\t\t\tlib.playerOL[i].setIdentity();\r\n\t\t\t\t\t\tlib.playerOL[i].ai.shown = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, map);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\tgame.players[i].ai.shown = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (game.zhu == game.me && game.zhu.identity != 'zhu' && _status.brawl && _status.brawl.identityShown) {\r\n\t\t\t\tdelete game.zhu;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tgame.zhu.ai.shown = 1;\r\n\t\t\t\tif (game.zhu2) {\r\n\t\t\t\t\tgame.zhong = game.zhu;\r\n\t\t\t\t\tgame.zhu = game.zhu2;\r\n\t\t\t\t\tdelete game.zhu2;\r\n\t\t\t\t\tif (game.zhong.sex == 'male' && game.zhong.maxHp <= 4) {\r\n\t\t\t\t\t\tgame.zhong.addSkill('dongcha');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.zhong.addSkill('sheshen');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar enhance_zhu = false;\r\n\t\t\t\tif (_status.connectMode) {\r\n\t\t\t\t\tenhance_zhu = (_status.mode != 'zhong' && _status.mode != 'purple' && lib.configOL.enhance_zhu && get.population('fan') >= 3);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tenhance_zhu = (_status.mode != 'zhong' && _status.mode != 'purple' && get.config('enhance_zhu') && get.population('fan') >= 3);\r\n\t\t\t\t}\r\n\t\t\t\tif (enhance_zhu) {\r\n\t\t\t\t\tvar skill;\r\n\t\t\t\t\tswitch (game.zhu.name) {\r\n\t\t\t\t\t\tcase 'key_yuri': skill = 'buqu'; break;\r\n\t\t\t\t\t\tcase 'liubei': skill = 'jizhen'; break;\r\n\t\t\t\t\t\tcase 'dongzhuo': skill = 'hengzheng'; break;\r\n\t\t\t\t\t\tcase 'sunquan': skill = 'batu'; break;\r\n\t\t\t\t\t\tcase 'sp_zhangjiao': skill = 'tiangong'; break;\r\n\t\t\t\t\t\tcase 'liushan': skill = 'shengxi'; break;\r\n\t\t\t\t\t\tcase 'sunce': skill = 'ciqiu'; break;\r\n\t\t\t\t\t\tcase 're_sunben': skill = 'ciqiu'; break;\r\n\t\t\t\t\t\tcase 'yuanshao': skill = 'geju'; break;\r\n\t\t\t\t\t\tcase 're_caocao': skill = 'dangping'; break;\r\n\t\t\t\t\t\tcase 'caopi': skill = 'junxing'; break;\r\n\t\t\t\t\t\tcase 'liuxie': skill = 'moukui'; break;\r\n\t\t\t\t\t\tdefault: skill = 'tianming'; break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function (player, skill) {\r\n\t\t\t\t\t\tplayer.addSkill(skill);\r\n\t\t\t\t\t\tplayer.$.enhance_zhu = skill;\r\n\t\t\t\t\t}, game.zhu, skill);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tgame.syncState();\r\n\t\t\tevent.trigger('gameStart');\r\n\r\n\t\t\tvar players = get.players(lib.sort.position);\r\n\t\t\tvar info = [];\r\n\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\tinfo.push({\r\n\t\t\t\t\tname: players[i].name1,\r\n\t\t\t\t\tname2: players[i].name2,\r\n\t\t\t\t\tidentity: players[i].identity\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t_status.videoInited = true;\r\n\t\t\tgame.addVideo('init', null, info);\r\n\t\t\t\"step 6\"\r\n\t\t\tgame.gameDraw(_status.firstAct2 || game.zhong || game.zhu || _status.firstAct || game.me, function (player) {\r\n\t\t\t\tif (_status.mode == 'purple' && player.seatNum > 5) return 5;\r\n\t\t\t\treturn 4;\r\n\t\t\t});\r\n\t\t\tif (_status.connectMode && lib.configOL.change_card) game.replaceHandcards(game.players.slice(0));\r\n\t\t\t\"step 7\"\r\n\t\t\tif (_status.new_beginner) {\r\n\t\t\t\tvar step0 = function () {\r\n\t\t\t\t\tui.create.dialog('是否需要关于身份模式的简单讲解？');\r\n\t\t\t\t\tui.dialog.add('<div class=\"text center\">如果熟悉三国杀原版游戏规则，请随意跳过');\r\n\t\t\t\t\tui.create.control('跳过向导', function () {\r\n\t\t\t\t\t\tclear();\r\n\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tui.create.control('继续', step7);\r\n\t\t\t\t}\r\n\t\t\t\tvar step1 = function () {\r\n\t\t\t\t\tclear();\r\n\t\t\t\t\t// ui.window.classList.add('noclick_important');\r\n\t\t\t\t\t// ui.control.classList.add('noclick_click_important');\r\n\t\t\t\t\t//ui.control.style.top='calc(100% - 105px)';\r\n\t\t\t\t\tui.create.control('如你所见，V杀是一个玩家操作各自角色进行战斗的游戏', function () {\r\n\t\t\t\t\t\tgame.me.classList.add('glow_phase');\r\n\t\t\t\t\t\tui.create.dialog(`画面左下角的虚拟角色形象(${get.translation(game.me)})是你操纵的角色<br>（如果你是app或者客户端，你需要下载完游戏资源后才会看见图片）`);\r\n\t\t\t\t\t\tui.controls[0].replace('继续', function () {\r\n\t\t\t\t\t\t\tui.create.dialog(`角色左侧的数字(${game.me.countCards('h')})是你的手牌数，游戏开始时所有玩家都会摸四张牌<br>在角色右侧的是你的体力值，不同角色卡上记载着各自的初始体力/初始体力上限<br>一旦一名角色的体力归零且没有被救回，ta就在本局游戏内死亡了`);\r\n\t\t\t\t\t\t\tui.controls[0].replace('继续', function () {\r\n\t\t\t\t\t\t\t\tgame.me.classList.remove('glow_phase');\r\n\t\t\t\t\t\t\t\tgame.zhu.classList.add('glow_phase');\r\n\t\t\t\t\t\t\t\tui.create.dialog(`现在被黄框框出的虚拟角色形象(${get.translation(game.zhu)})本局游戏的“主公” <br>每一局标准【身份】模式都将有一个“主公”身份`);\r\n\t\t\t\t\t\t\t\tui.controls[0].replace(`“主公”是${get.translation(game.zhu)}的身份`, function () {\r\n\t\t\t\t\t\t\t\t\tui.create.dialog('每名玩家将在一局游戏中扮演不同的身份<br>不同的身份对应了不同的胜利条件<br>比如“主公”的胜利条件就是杀死所有身份为“反贼”或“内奸”的玩家');\r\n\t\t\t\t\t\t\t\t\tui.controls[0].replace('继续', function () {\r\n\t\t\t\t\t\t\t\t\t\tgame.zhu.classList.remove('glow_phase');\r\n\t\t\t\t\t\t\t\t\t\tgame.me.classList.add('glow_phase');\r\n\t\t\t\t\t\t\t\t\t\tui.create.dialog('而你的身份是“反贼”，你的胜利条件就是杀死身份为“主公”的角色<br>除此以外还有身份为“忠臣”和“内奸的玩家');\r\n\t\t\t\t\t\t\t\t\t\tui.dialog.add('<div class=\"text center\">“忠臣”的胜利条件就是保护主公，让主公胜利，而“内奸”的胜利条件是成为最后一个存活的角色');\r\n\t\t\t\t\t\t\t\t\t\tui.controls[0].replace('一旦主公死亡，反贼立即获得胜利', function () {\r\n\t\t\t\t\t\t\t\t\t\t\tui.create.dialog('特殊的规则是，杀死反贼的角色将摸三张牌<br>主公在杀死忠臣将弃掉所有的牌');\r\n\t\t\t\t\t\t\t\t\t\t\tui.controls[0].replace('继续', function () {\r\n\t\t\t\t\t\t\t\t\t\t\t\tui.create.dialog('牌和角色的技能是驱动游戏的核心要素<br>你在接下来的游戏过程中，可以随时使用鼠标右键（移动端为长按）查看角色或卡牌的技能');\r\n\t\t\t\t\t\t\t\t\t\t\t\tui.dialog.add('<div class=\"text center\">你面前的这些牌便是你的“手牌”，尝试学会查看它们的详细信息吧！');\r\n\t\t\t\t\t\t\t\t\t\t\t\tui.controls[0].replace('每个轮次会从主公开始，由逆时针进行回合', function () {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tui.controls[0].replace('跟随着ai们的步伐，学会在V杀世界里战斗吧！', function () {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstep8();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t};\r\n\t\t\t\tvar step2 = function () {\r\n\t\t\t\t\tclear();\r\n\t\t\t\t\tui.create.dialog('<a href=\"https://jq.qq.com/?_wv=1027&k=iVuy3lDN\" target=\"_blank\">如果还有其它问题，欢迎来到V杀联机群（623566610）进行交流</a>');\r\n\t\t\t\t\tui.create.control('完成', function () {\r\n\t\t\t\t\t\tclear();\r\n\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t})\r\n\t\t\t\t};\r\n\t\t\t\tvar clear = function () {\r\n\t\t\t\t\tui.dialog.close();\r\n\t\t\t\t\twhile (ui.controls.length) ui.controls[0].close();\r\n\t\t\t\t};\r\n\t\t\t\tgame.pause();\r\n\t\t\t\tstep0();\r\n\t\t\t}\r\n\t\t\t\"step 8\"\r\n\t\t\tevent.trigger('phaseLoopBefore');\r\n\t\t\t\"step 9\"\r\n\t\t\tdelete _status.new_beginner;\r\n\t\t\tgame.phaseLoop(_status.firstAct2 || game.zhong || game.zhu || _status.firstAct || game.me);\r\n\t\t},\r\n\t\tgame: {\r\n\t\t\tgetState: function () {\r\n\t\t\t\tvar state = {};\r\n\t\t\t\tfor (var i in lib.playerOL) {\r\n\t\t\t\t\tvar player = lib.playerOL[i];\r\n\t\t\t\t\tstate[i] = { identity: player.identity };\r\n\t\t\t\t\tif (player == game.zhu) {\r\n\t\t\t\t\t\tstate[i].zhu = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (player == game.zhong) {\r\n\t\t\t\t\t\tstate[i].zhong = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (player.isZhu) {\r\n\t\t\t\t\t\tstate[i].isZhu = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (player.special_identity) {\r\n\t\t\t\t\t\tstate[i].special_identity = player.special_identity;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstate[i].shown = player.ai.shown;\r\n\t\t\t\t\t//state[i].group=player.group;\r\n\t\t\t\t}\r\n\t\t\t\treturn state;\r\n\t\t\t},\r\n\t\t\tupdateState: function (state) {\r\n\t\t\t\tfor (var i in state) {\r\n\t\t\t\t\tvar player = lib.playerOL[i];\r\n\t\t\t\t\tif (player) {\r\n\t\t\t\t\t\tplayer.identity = state[i].identity;\r\n\t\t\t\t\t\tif (state[i].identity == 'rZhu' || state[i].identity == 'bZhu') game[state[i].identity] = player;\r\n\t\t\t\t\t\tif (state[i].special_identity) {\r\n\t\t\t\t\t\t\tplayer.special_identity = state[i].special_identity;\r\n\t\t\t\t\t\t\tif (player.node.dieidentity) {\r\n\t\t\t\t\t\t\t\tplayer.node.dieidentity.innerHTML = get.translation(state[i].special_identity);\r\n\t\t\t\t\t\t\t\tplayer.node.identity.firstChild.innerHTML = get.translation(state[i].special_identity + '_bg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (state[i].zhu) {\r\n\t\t\t\t\t\t\tgame.zhu = player;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (state[i].isZhu) {\r\n\t\t\t\t\t\t\tplayer.isZhu = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (state[i].zhong) {\r\n\t\t\t\t\t\t\tgame.zhong = player;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.ai.shown = state[i].shown;\r\n\t\t\t\t\t\t//player.group=state[i].group;\r\n\t\t\t\t\t\t//player.node.name.dataset.nature=get.groupnature(player.group);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetRoomInfo: function (uiintro) {\r\n\t\t\t\tuiintro.add('<div class=\"text chat\">游戏模式：' + (lib.configOL.identity_mode == 'zhong' ? '明忠' : '标准'));\r\n\t\t\t\tuiintro.add('<div class=\"text chat\">双将模式：' + (lib.configOL.double_character ? '开启' : '关闭'));\r\n\t\t\t\tif (lib.configOL.identity_mode != 'zhong') {\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">双内奸：' + (lib.configOL.double_nei ? '开启' : '关闭'));\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">加强主公：' + (lib.configOL.enhance_zhu ? '开启' : '关闭'));\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">卡牌替换：' + (lib.configOL.zhong_card ? '开启' : '关闭'));\r\n\t\t\t\t}\r\n\t\t\t\tvar last = uiintro.add('<div class=\"text chat\">出牌时限：' + lib.configOL.choose_timeout + '秒');\r\n\t\t\t\t// uiintro.add('<div class=\"text chat\">屏蔽弱将：'+(lib.configOL.ban_weak?'开启':'关闭'));\r\n\t\t\t\t// var last=uiintro.add('<div class=\"text chat\">屏蔽强将：'+(lib.configOL.ban_strong?'开启':'关闭'));\r\n\t\t\t\tif (lib.configOL.banned.length) {\r\n\t\t\t\t\tlast = uiintro.add('<div class=\"text chat\">禁用武将：' + get.translation(lib.configOL.banned));\r\n\t\t\t\t}\r\n\t\t\t\tif (lib.configOL.bannedcards.length) {\r\n\t\t\t\t\tlast = uiintro.add('<div class=\"text chat\">禁用卡牌：' + get.translation(lib.configOL.bannedcards));\r\n\t\t\t\t}\r\n\t\t\t\tlast.style.paddingBottom = '8px';\r\n\t\t\t},\r\n\t\t\tgetIdentityList: function (player) {\r\n\t\t\t\tif (player.identityShown) return;\r\n\t\t\t\tif (player == game.me) return;\r\n\t\t\t\tif (_status.mode == 'purple') {\r\n\t\t\t\t\tif (_status.yeconfirm && ['rNei', 'bNei'].contains(game.me.identity) && ['rNei', 'bNei'].contains(player.identity)) return;\r\n\t\t\t\t\tif (player.identity.slice(0, 1) == 'r') return {\r\n\t\t\t\t\t\tcai2: '猜',\r\n\t\t\t\t\t\trZhong: '忠',\r\n\t\t\t\t\t\trNei: '内',\r\n\t\t\t\t\t\trYe: '野',\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tcai: '猜',\r\n\t\t\t\t\t\tbZhong: '忠',\r\n\t\t\t\t\t\tbNei: '内',\r\n\t\t\t\t\t\tbYe: '野',\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (_status.mode == 'zhong') {\r\n\t\t\t\t\tif (player.fanfixed) return;\r\n\t\t\t\t\tif (game.zhu && game.zhu.isZhu) {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tfan: '反',\r\n\t\t\t\t\t\t\tzhong: '忠',\r\n\t\t\t\t\t\t\tnei: '内',\r\n\t\t\t\t\t\t\tcai: '猜',\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tfan: '反',\r\n\t\t\t\t\t\t\tzhong: '忠',\r\n\t\t\t\t\t\t\tnei: '内',\r\n\t\t\t\t\t\t\tzhu: '主',\r\n\t\t\t\t\t\t\tcai: '猜',\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tfan: '反',\r\n\t\t\t\t\t\tzhong: '忠',\r\n\t\t\t\t\t\tnei: '内',\r\n\t\t\t\t\t\tcai: '猜',\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetIdentityList2: function (list) {\r\n\t\t\t\tfor (var i in list) {\r\n\t\t\t\t\tswitch (i) {\r\n\t\t\t\t\t\tcase 'fan': list[i] = '反贼'; break;\r\n\t\t\t\t\t\tcase 'zhong': list[i] = '忠臣'; break;\r\n\t\t\t\t\t\tcase 'nei': list[i] = '内奸'; break;\r\n\t\t\t\t\t\tcase 'zhu': list[i] = '主公'; break;\r\n\t\t\t\t\t\tcase 'cai': case 'cai2': list[i] = '未知'; break;\r\n\t\t\t\t\t\tcase 'rZhong': case 'bZhong': list[i] = '前锋'; break;\r\n\t\t\t\t\t\tcase 'rNei': case 'bNei': list[i] = '细作'; break;\r\n\t\t\t\t\t\tcase 'rYe': case 'bYe': list[i] = '野心家'; break;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetVideoName: function () {\r\n\t\t\t\tvar str = get.translation(game.me.name);\r\n\t\t\t\tif (game.me.name2) {\r\n\t\t\t\t\tstr += '/' + get.translation(game.me.name2);\r\n\t\t\t\t}\r\n\t\t\t\tvar str2;\r\n\t\t\t\tif (game.identityVideoName) str2 = game.identityVideoName;\r\n\t\t\t\telse {\r\n\t\t\t\t\tswitch (_status.mode) {\r\n\t\t\t\t\t\tcase 'purple': str2 = '3v3v2 - ' + (game.me.identity.indexOf('r') == 0 ? '暖色' : '冷色') + lib.translate[game.me.identity + '2']; break;\r\n\t\t\t\t\t\tcase 'zhong': str2 = '忠胆英杰 - ' + lib.translate[game.me.identity + '2']; break;\r\n\t\t\t\t\t\tdefault: str2 = get.cnNumber(get.playerNumber()) + '人' +\r\n\t\t\t\t\t\t\tget.translation(lib.config.mode) + ' - ' + lib.translate[game.me.identity + '2']\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar name = [\r\n\t\t\t\t\tstr,\r\n\t\t\t\t\tstr2,\r\n\t\t\t\t];\r\n\t\t\t\treturn name;\r\n\t\t\t},\r\n\t\t\taddRecord: function (bool) {\r\n\t\t\t\tif (typeof bool == 'boolean') {\r\n\t\t\t\t\tvar data = lib.config.gameRecord.identity.data;\r\n\t\t\t\t\tvar identity = game.me.identity;\r\n\t\t\t\t\tif (identity == 'mingzhong') {\r\n\t\t\t\t\t\tidentity = 'zhong';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!data[identity]) {\r\n\t\t\t\t\t\tdata[identity] = [0, 0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (bool) {\r\n\t\t\t\t\t\tdata[identity][0]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tdata[identity][1]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list = ['zhu', 'zhong', 'nei', 'fan'];\r\n\t\t\t\t\tvar str = '';\r\n\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\tif (data[list[i]]) {\r\n\t\t\t\t\t\t\tstr += lib.translate[list[i] + '2'] + '：' + data[list[i]][0] + '胜' + ' ' + data[list[i]][1] + '负<br>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.config.gameRecord.identity.str = str;\r\n\t\t\t\t\tgame.saveConfig('gameRecord', lib.config.gameRecord);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tshowIdentity: function (me) {\r\n\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t// if(me===false&&game.players[i]==game.me) continue;\r\n\t\t\t\t\tgame.players[i].node.identity.classList.remove('guessing');\r\n\t\t\t\t\tgame.players[i].identityShown = true;\r\n\t\t\t\t\tgame.players[i].ai.shown = 1;\r\n\t\t\t\t\tgame.players[i].setIdentity(game.players[i].identity);\r\n\t\t\t\t\tif (game.players[i].special_identity) {\r\n\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML = get.translation(game.players[i].special_identity + '_bg');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (game.players[i].identity == 'zhu') {\r\n\t\t\t\t\t\tgame.players[i].isZhu = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (_status.clickingidentity) {\r\n\t\t\t\t\tfor (var i = 0; i < _status.clickingidentity[1].length; i++) {\r\n\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcheckResult: function () {\r\n\t\t\t\tvar me = game.me._trueMe || game.me;\r\n\t\t\t\tif (_status.brawl && _status.brawl.checkResult) {\r\n\t\t\t\t\t_status.brawl.checkResult();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\telse if (_status.mode == 'purple') {\r\n\t\t\t\t\tvar winner = [];\r\n\t\t\t\t\tvar loser = [];\r\n\t\t\t\t\tvar ye = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn ['rYe', 'bYe'].contains(current.identity);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar red = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn ['rZhu', 'rZhong', 'bNei'].contains(current.identity);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar blue = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\treturn ['bZhu', 'bZhong', 'rNei'].contains(current.identity);\r\n\t\t\t\t\t})\r\n\t\t\t\t\tgame.countPlayer2(function (current) {\r\n\t\t\t\t\t\tswitch (current.identity) {\r\n\t\t\t\t\t\t\tcase 'rZhu':\r\n\t\t\t\t\t\t\t\tif (ye.length == 0 && game.bZhu.isDead()) winner.push(current);\r\n\t\t\t\t\t\t\t\tif (current.isDead()) loser.push(current);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'rZhong': case 'bNei':\r\n\t\t\t\t\t\t\t\tif (ye.length == 0 && game.bZhu.isDead()) winner.push(current);\r\n\t\t\t\t\t\t\t\tif (game.rZhu.isDead()) loser.push(current);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'bZhu':\r\n\t\t\t\t\t\t\t\tif (ye.length == 0 && game.rZhu.isDead()) winner.push(current);\r\n\t\t\t\t\t\t\t\tif (current.isDead()) loser.push(current);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'bZhong': case 'rNei':\r\n\t\t\t\t\t\t\t\tif (ye.length == 0 && game.rZhu.isDead()) winner.push(current);\r\n\t\t\t\t\t\t\t\tif (game.bZhu.isDead()) loser.push(current);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tif (red.length + blue.length == 0) winner.push(current);\r\n\t\t\t\t\t\t\t\telse if (game.rZhu.isDead() && game.bZhu.isDead()) loser.push(current);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar winner2 = winner.slice(0);\r\n\t\t\t\t\tvar loser2 = loser.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < winner.length; i++) {\r\n\t\t\t\t\t\tif (winner[i].isDead()) winner.splice(i--, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < loser.length; i++) {\r\n\t\t\t\t\t\tif (loser[i].isDead()) loser.splice(i--, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (winner.length > 0 || loser.length == game.players.length) {\r\n\t\t\t\t\t\tgame.broadcastAll(function (winner, loser) {\r\n\t\t\t\t\t\t\t_status.winner = winner;\r\n\t\t\t\t\t\t\t_status.loser = loser;\r\n\t\t\t\t\t\t}, winner, loser);\r\n\t\t\t\t\t\tif (loser.length == game.players.length) {\r\n\t\t\t\t\t\t\tgame.showIdentity();\r\n\t\t\t\t\t\t\tgame.over('游戏平局');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (winner2.contains(me)) {\r\n\t\t\t\t\t\t\tgame.showIdentity();\r\n\t\t\t\t\t\t\tif (loser2.contains(me)) game.over(false);\r\n\t\t\t\t\t\t\telse game.over(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tgame.showIdentity();\r\n\t\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!game.zhu) {\r\n\t\t\t\t\tif (get.population('fan') == 0) {\r\n\t\t\t\t\t\tswitch (me.identity) {\r\n\t\t\t\t\t\t\tcase 'fan': game.over(false); break;\r\n\t\t\t\t\t\t\tcase 'zhong': game.over(true); break;\r\n\t\t\t\t\t\t\tdefault: game.over(); break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (get.population('zhong') == 0) {\r\n\t\t\t\t\t\tswitch (me.identity) {\r\n\t\t\t\t\t\t\tcase 'fan': game.over(true); break;\r\n\t\t\t\t\t\t\tcase 'zhong': game.over(false); break;\r\n\t\t\t\t\t\t\tdefault: game.over(); break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (game.zhu.isAlive() && get.population('fan') + get.population('nei') > 0) return;\r\n\t\t\t\tif (game.zhong) {\r\n\t\t\t\t\tgame.zhong.identity = 'zhong';\r\n\t\t\t\t}\r\n\t\t\t\tgame.showIdentity();\r\n\t\t\t\tif (me.identity == 'zhu' || me.identity == 'zhong' || me.identity == 'mingzhong') {\r\n\t\t\t\t\tif (game.zhu.classList.contains('dead')) {\r\n\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (me.identity == 'nei') {\r\n\t\t\t\t\tif (game.players.length == 1 && me.isAlive()) {\r\n\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif ((get.population('fan') + get.population('zhong') > 0 || get.population('nei') > 1) &&\r\n\t\t\t\t\t\tgame.zhu.classList.contains('dead')) {\r\n\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcheckOnlineResult: function (player) {\r\n\t\t\t\tif (_status.winner && _status.loser) {\r\n\t\t\t\t\tif (_status.loser.length == game.players.length) return null;\r\n\t\t\t\t\tif (_status.loser.contains(player)) return false;\r\n\t\t\t\t\tif (_status.winner.contains(player)) return true;\r\n\t\t\t\t}\r\n\t\t\t\tif (game.zhu.isAlive()) {\r\n\t\t\t\t\treturn (player.identity == 'zhu' || player.identity == 'zhong' || player.identity == 'mingzhong');\r\n\t\t\t\t}\r\n\t\t\t\telse if (game.players.length == 1 && game.players[0].identity == 'nei') {\r\n\t\t\t\t\treturn player.isAlive();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn player.identity == 'fan';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchooseCharacterPurpleOL: function () {\r\n\t\t\t\tvar next = game.createEvent('chooseCharacter', false);\r\n\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tvar list = ['rZhu', 'rZhong', 'rNei', 'rYe'];\r\n\t\t\t\t\tvar list2 = ['bZhu', 'bZhong', 'bNei', 'bYe'];\r\n\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\tlist2.randomSort();\r\n\t\t\t\t\tvar identityList = list.concat(list2);\r\n\t\t\t\t\tvar num = get.rand(0, 7);\r\n\t\t\t\t\tvar players = game.players.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < num; i++) {\r\n\t\t\t\t\t\tplayers.push(players.shift());\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function (players, identityList, list) {\r\n\t\t\t\t\t\t_status.mode = 'purple';\r\n\t\t\t\t\t\tif (game.online) ui.arena.classList.add('choose-character');\r\n\t\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\t\tplayers[i].node.identity.classList.add('guessing');\r\n\t\t\t\t\t\t\tplayers[i].identity = identityList[i];\r\n\t\t\t\t\t\t\tplayers[i].setIdentity(list.contains(identityList[i]) ? 'cai2' : 'cai');\r\n\t\t\t\t\t\t\tif (['rZhu', 'bZhu'].contains(identityList[i])) {\r\n\t\t\t\t\t\t\t\tgame[identityList[i]] = players[i];\r\n\t\t\t\t\t\t\t\tplayers[i].setIdentity(identityList[i]);\r\n\t\t\t\t\t\t\t\tplayers[i].identityShown = true;\r\n\t\t\t\t\t\t\t\tplayers[i].node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.zhu = game.rZhu;\r\n\t\t\t\t\t\tgame.rZhu.isZhu = true;\r\n\t\t\t\t\t\tgame.bZhu.isZhu = true;\r\n\t\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\t\tgame.me.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t}, players, identityList, list);\r\n\t\t\t\t\tplayers.sortBySeat(game.zhu);\r\n\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\tplayers[i].seatNum = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tvar map = {};\r\n\t\t\t\t\tvar map_zhu = {};\r\n\t\t\t\t\tevent.mapNum = {};\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tvar libCharacter = {};\r\n\t\t\t\t\tfor (var i = 0; i < lib.configOL.characterPack.length; i++) {\r\n\t\t\t\t\t\tvar pack = lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor (var j in pack) {\r\n\t\t\t\t\t\t\tif (j == 'zuoci') continue;\r\n\t\t\t\t\t\t\tif (lib.character[j]) libCharacter[j] = pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i in libCharacter) {\r\n\t\t\t\t\t\tif (lib.filter.characterDisabled(i, libCharacter)) continue;\r\n\t\t\t\t\t\tif (i.indexOf('lingju') != -1 || get.is.double(i)) continue;\r\n\t\t\t\t\t\tvar group = lib.character[i][1];\r\n\t\t\t\t\t\tif (group == 'shen') continue;\r\n\t\t\t\t\t\tif (!map[group]) {\r\n\t\t\t\t\t\t\tmap[group] = [];\r\n\t\t\t\t\t\t\tlist.push(group);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmap[group].push(i);\r\n\t\t\t\t\t\tif (lib.character[i][4] && lib.character[i][4].contains('zhu')) {\r\n\t\t\t\t\t\t\tif (!map_zhu[group]) {\r\n\t\t\t\t\t\t\t\tmap_zhu[group] = [];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tmap_zhu[group].push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i in map) {\r\n\t\t\t\t\t\tif (map[i].length < 12) {\r\n\t\t\t\t\t\t\tdelete map[i];\r\n\t\t\t\t\t\t\tlist.remove(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse event.mapNum[i] = map[i].length > 15 ? 5 : 3;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.sort(function (a, b) {\r\n\t\t\t\t\t\treturn lib.group.indexOf(a) - lib.group.indexOf(b);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tevent.list = list;\r\n\t\t\t\t\tevent.map = map;\r\n\t\t\t\t\tevent.map_zhu = map_zhu;\r\n\t\t\t\t\tgame.bZhu.chooseControl(list).set('prompt', '请选择冷方武将势力').set('ai', function () {\r\n\t\t\t\t\t\treturn _status.event.choice;\r\n\t\t\t\t\t}).set('choice', event.list.randomGet());\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tevent.bZhu = result.control;\r\n\t\t\t\t\tevent.list.remove(event.bZhu);\r\n\t\t\t\t\tgame.rZhu.chooseControl(event.list).set('prompt', '请选择暖方武将的势力').set('ai', function () {\r\n\t\t\t\t\t\treturn _status.event.choice;\r\n\t\t\t\t\t}).set('choice', event.list.randomGet());\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tevent.rZhu = result.control;\r\n\t\t\t\t\tvar players = [game.rZhu, game.bZhu];\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\tif (true) {\r\n\t\t\t\t\t\t\tvar group = event[players[i].identity];\r\n\t\t\t\t\t\t\tvar str = '选择角色';\r\n\t\t\t\t\t\t\tvar list2 = event.map[group].randomGets(4);\r\n\t\t\t\t\t\t\tif (event.map_zhu[group]) list2.addArray(event.map_zhu[group].randomGets(2));\r\n\t\t\t\t\t\t\tevent.map[players[i].playerid] = list2;\r\n\t\t\t\t\t\t\tlist.push([players[i], [str, [list2, 'character']], true]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(list, function (player, result) {\r\n\t\t\t\t\t\tif (game.online || player == game.me) {\r\n\t\t\t\t\t\t\tplayer.init(result.links[0]);\r\n\t\t\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 5\"\r\n\t\t\t\t\tfor (var i in result) {\r\n\t\t\t\t\t\tif (result[i] == 'ai' || !result[i] || !result[i].links) {\r\n\t\t\t\t\t\t\tresult[i] = event.map[i].randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tresult[i] = result[i].links\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar group = lib.character[result[i][0]][1];\r\n\t\t\t\t\t\tevent.map[group].remove(result[i][0]);\r\n\t\t\t\t\t\tif (!lib.playerOL[i].name) {\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function (result) {\r\n\t\t\t\t\t\tfor (var i in result) {\r\n\t\t\t\t\t\t\tif (!lib.playerOL[i].name) {\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0], result[i][1]);\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].hp++;\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].maxHp++;\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].update();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, result);\r\n\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tvar players = game.players.slice(0);\r\n\t\t\t\t\tplayers.removeArray([game.rZhu, game.bZhu]);\r\n\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\tif (true) {\r\n\t\t\t\t\t\t\tvar group = event[players[i].identity.slice(0, 1) + 'Zhu'];\r\n\t\t\t\t\t\t\tvar str = '选择角色';\r\n\t\t\t\t\t\t\tvar list2 = event.map[group].randomRemove(event.mapNum[group]);\r\n\t\t\t\t\t\t\tevent.map[players[i].playerid] = list2;\r\n\t\t\t\t\t\t\tlist.push([players[i], [str, [list2, 'character']], true]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(list, function (player, result) {\r\n\t\t\t\t\t\tif (game.online || player == game.me) {\r\n\t\t\t\t\t\t\tplayer.init(result.links[0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 6\"\r\n\t\t\t\t\tfor (var i in result) {\r\n\t\t\t\t\t\tif (result[i] == 'ai' || !result[i] || !result[i].links) {\r\n\t\t\t\t\t\t\tresult[i] = event.map[i].randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tresult[i] = result[i].links\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar group = lib.character[result[i][0]][1];\r\n\t\t\t\t\t\tevent.map[group].remove(result[i][0]);\r\n\t\t\t\t\t\tif (!lib.playerOL[i].name) {\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function (result) {\r\n\t\t\t\t\t\tfor (var i in result) {\r\n\t\t\t\t\t\t\tif (!lib.playerOL[i].name) {\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0], result[i][1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t}, result);\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t}, 500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterPurple: function () {\r\n\t\t\t\tvar next = game.createEvent('chooseCharacter', false);\r\n\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tgame.no_continue_game = true;\r\n\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tvar list = ['rZhu', 'rZhong', 'rNei', 'rYe'];\r\n\t\t\t\t\tvar list2 = ['bZhu', 'bZhong', 'bNei', 'bYe'];\r\n\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\tlist2.randomSort();\r\n\t\t\t\t\tvar identityList = list.concat(list2);\r\n\t\t\t\t\tvar num = get.rand(0, 7);\r\n\t\t\t\t\tvar players = game.players.slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < num; i++) {\r\n\t\t\t\t\t\tplayers.push(players.shift());\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\tplayers[i].node.identity.classList.add('guessing');\r\n\t\t\t\t\t\tplayers[i].identity = identityList[i];\r\n\t\t\t\t\t\tplayers[i].setIdentity(list.contains(identityList[i]) ? 'cai2' : 'cai');\r\n\t\t\t\t\t\tif (['rZhu', 'bZhu'].contains(identityList[i])) {\r\n\t\t\t\t\t\t\tgame[identityList[i]] = players[i];\r\n\t\t\t\t\t\t\tplayers[i].setIdentity(identityList[i]);\r\n\t\t\t\t\t\t\tplayers[i].identityShown = true;\r\n\t\t\t\t\t\t\tplayers[i].node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.zhu = game.rZhu;\r\n\t\t\t\t\tgame.rZhu.isZhu = true;\r\n\t\t\t\t\tgame.bZhu.isZhu = true;\r\n\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\tgame.me.node.identity.classList.remove('guessing');\r\n\t\t\t\t\tplayers.sortBySeat(game.zhu);\r\n\t\t\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\t\t\tplayers[i].seatNum = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tvar map = {};\r\n\t\t\t\t\tvar map_zhu = {};\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tfor (var i in lib.character) {\r\n\t\t\t\t\t\tif (lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tif (i.indexOf('lingju') != -1 || get.is.double(i)) continue;\r\n\t\t\t\t\t\tvar group = lib.character[i][1];\r\n\t\t\t\t\t\tif (group == 'shen') continue;\r\n\t\t\t\t\t\tif (!map[group]) {\r\n\t\t\t\t\t\t\tmap[group] = [];\r\n\t\t\t\t\t\t\tlist.push(group);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmap[group].push(i);\r\n\t\t\t\t\t\tif (lib.character[i][4] && lib.character[i][4].contains('zhu')) {\r\n\t\t\t\t\t\t\tif (!map_zhu[group]) {\r\n\t\t\t\t\t\t\t\tmap_zhu[group] = [];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tmap_zhu[group].push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i in map) {\r\n\t\t\t\t\t\tif (map[i].length < 12) {\r\n\t\t\t\t\t\t\tdelete map[i];\r\n\t\t\t\t\t\t\tlist.remove(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.sort(function (a, b) {\r\n\t\t\t\t\t\treturn lib.group.indexOf(a) - lib.group.indexOf(b);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tevent.list = list;\r\n\t\t\t\t\tevent.map = map;\r\n\t\t\t\t\tevent.map_zhu = map_zhu;\r\n\t\t\t\t\tgame.bZhu.chooseControl(list).set('prompt', '请选择冷方武将势力').set('ai', function () {\r\n\t\t\t\t\t\treturn _status.event.choice;\r\n\t\t\t\t\t}).set('choice', event.list.randomGet());\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tevent.bZhu = result.control;\r\n\t\t\t\t\tevent.list.remove(event.bZhu);\r\n\t\t\t\t\tgame.rZhu.chooseControl(event.list).set('prompt', '请选择暖方武将的势力').set('ai', function () {\r\n\t\t\t\t\t\treturn _status.event.choice;\r\n\t\t\t\t\t}).set('choice', event.list.randomGet());\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tevent.rZhu = result.control;\r\n\t\t\t\t\tif (game.me == game.rZhu || game.me == game.bZhu) {\r\n\t\t\t\t\t\tevent.isZhu = true;\r\n\t\t\t\t\t\tvar list = event.map[event[game.me.identity]].randomGets(4);\r\n\t\t\t\t\t\tif (event.map_zhu[event[game.me.identity]]) list.addArray(event.map_zhu[event[game.me.identity]].randomGets(2));\r\n\t\t\t\t\t\tgame.me.chooseButton(true, ['请选择您的武将牌', [list, 'character']]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 5\"\r\n\t\t\t\t\tif (event.isZhu) {\r\n\t\t\t\t\t\tevent.map[event[game.me.identity]].remove(result.links[0]);\r\n\t\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!game.rZhu.name) {\r\n\t\t\t\t\t\tvar list = event.map[event.rZhu].randomGets(3);\r\n\t\t\t\t\t\tif (event.map_zhu[event.rZhu]) list.addArray(event.map_zhu[event.rZhu]);\r\n\t\t\t\t\t\tvar character = list.randomGet();\r\n\t\t\t\t\t\tevent.map[event.rZhu].remove(character);\r\n\t\t\t\t\t\tgame.rZhu.init(character);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!game.bZhu.name) {\r\n\t\t\t\t\t\tvar list = event.map[event.bZhu].randomGets(4);\r\n\t\t\t\t\t\tif (event.map_zhu[event.bZhu]) list.addArray(event.map_zhu[event.bZhu].randomGets(2));\r\n\t\t\t\t\t\tvar character = list.randomGet();\r\n\t\t\t\t\t\tevent.map[event.bZhu].remove(character);\r\n\t\t\t\t\t\tgame.bZhu.init(character);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.rZhu.maxHp++;\r\n\t\t\t\t\tgame.rZhu.hp++;\r\n\t\t\t\t\tgame.rZhu.update();\r\n\t\t\t\t\tgame.bZhu.maxHp++;\r\n\t\t\t\t\tgame.bZhu.hp++;\r\n\t\t\t\t\tgame.bZhu.update();\r\n\t\t\t\t\tif (!event.isZhu) {\r\n\t\t\t\t\t\tvar group = game.me.identity.indexOf('r') == 0 ? event.rZhu : event.bZhu;\r\n\t\t\t\t\t\tgame.me.chooseButton(true, ['请选择您的武将牌', [event.map[group].randomRemove(5), 'character']]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 6\"\r\n\t\t\t\t\tif (!event.isZhu) {\r\n\t\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.countPlayer(function (current) {\r\n\t\t\t\t\t\tif (!current.name) {\r\n\t\t\t\t\t\t\tvar group = current.identity.indexOf('r') == 0 ? event.rZhu : event.bZhu;\r\n\t\t\t\t\t\t\tcurrent.init(event.map[group].randomRemove(1)[0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 7\"\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t}, 500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacter: function (isbeginner) {\r\n\t\t\t\tif (_status.mode == 'purple') {\r\n\t\t\t\t\tgame.chooseCharacterPurple();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = game.createEvent('chooseCharacter', false);\r\n\t\t\t\tnext.showConfig = true;\r\n\t\t\t\tnext.addPlayer = function (player) {\r\n\t\t\t\t\tvar list = lib.config.mode_config.identity.identity[game.players.length - 3].slice(0);\r\n\t\t\t\t\tvar list2 = lib.config.mode_config.identity.identity[game.players.length - 2].slice(0);\r\n\t\t\t\t\tfor (var i = 0; i < list.length; i++) list2.remove(list[i]);\r\n\t\t\t\t\tplayer.identity = list2[0];\r\n\t\t\t\t\tplayer.setIdentity('cai');\r\n\t\t\t\t};\r\n\t\t\t\tnext.removePlayer = function () {\r\n\t\t\t\t\treturn game.players.randomGet(game.me, game.zhu);\r\n\t\t\t\t};\r\n\t\t\t\tnext.ai = function (player, list, list2, back) {\r\n\t\t\t\t\tif (_status.brawl && _status.brawl.chooseCharacterAi) {\r\n\t\t\t\t\t\tif (_status.brawl.chooseCharacterAi(player, list, list2, back) !== false) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (_status.event.zhongmode) {\r\n\t\t\t\t\t\tvar listc = list.slice(0, 2);\r\n\t\t\t\t\t\tfor (var i = 0; i < listc.length; i++) {\r\n\t\t\t\t\t\t\tvar listx = lib.characterReplace[listc[i]];\r\n\t\t\t\t\t\t\tif (listx && listx.length) listc[i] = listx.randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (get.config('double_character')) {\r\n\t\t\t\t\t\t\tplayer.init(listc[0], listc[1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tplayer.init(listc[0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (player.identity == 'mingzhong') {\r\n\t\t\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (player.identity == 'zhu') {\r\n\t\t\t\t\t\tlist2.randomSort();\r\n\t\t\t\t\t\tvar choice, choice2;\r\n\t\t\t\t\t\tif (!_status.event.zhongmode && Math.random() - 0.8 < 0 && list2.length) {\r\n\t\t\t\t\t\t\tchoice = list2[0];\r\n\t\t\t\t\t\t\tchoice2 = list[0];\r\n\t\t\t\t\t\t\tif (choice2 == choice) {\r\n\t\t\t\t\t\t\t\tchoice2 = list[1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tchoice = list[0];\r\n\t\t\t\t\t\t\tchoice2 = list[1];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (lib.characterReplace[choice] && lib.characterReplace[choice].length) choice = lib.characterReplace[choice].randomGet();\r\n\t\t\t\t\t\tif (lib.characterReplace[choice2] && lib.characterReplace[choice2].length) choice2 = lib.characterReplace[choice2].randomGet();\r\n\t\t\t\t\t\tif (get.config('double_character')) {\r\n\t\t\t\t\t\t\tplayer.init(choice, choice2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tplayer.init(choice);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (game.players.length > 4) {\r\n\t\t\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (player.identity == 'zhong' && (Math.random() < 0.5 || ['sunliang', 'key_akane'].contains(game.zhu.name))) {\r\n\t\t\t\t\t\tvar listc = list.slice(0);\r\n\t\t\t\t\t\tfor (var i = 0; i < listc.length; i++) {\r\n\t\t\t\t\t\t\tvar listx = lib.characterReplace[listc[i]];\r\n\t\t\t\t\t\t\tif (listx && listx.length) listc[i] = listx.randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar choice = 0;\r\n\t\t\t\t\t\tfor (var i = 0; i < listc.length; i++) {\r\n\t\t\t\t\t\t\tif (lib.character[listc[i]][1] == game.zhu.group) {\r\n\t\t\t\t\t\t\t\tchoice = i; break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (get.config('double_character')) {\r\n\t\t\t\t\t\t\tplayer.init(listc[choice], listc[choice == 0 ? choice + 1 : choice - 1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tplayer.init(listc[choice]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar listc = list.slice(0, 2);\r\n\t\t\t\t\t\tfor (var i = 0; i < listc.length; i++) {\r\n\t\t\t\t\t\t\tvar listx = lib.characterReplace[listc[i]];\r\n\t\t\t\t\t\t\tif (listx && listx.length) listc[i] = listx.randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (get.config('double_character')) {\r\n\t\t\t\t\t\t\tplayer.init(listc[0], listc[1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tplayer.init(listc[0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (back) {\r\n\t\t\t\t\t\tlist.remove(get.sourceCharacter(player.name1));\r\n\t\t\t\t\t\tlist.remove(get.sourceCharacter(player.name2));\r\n\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\tback.push(list[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (typeof lib.config.test_game == 'string' && player == game.me.next) {\r\n\t\t\t\t\t\tplayer.init(lib.config.test_game);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (get.is.double(player.name1)) {\r\n\t\t\t\t\t\tplayer._groupChosen = true;\r\n\t\t\t\t\t\tplayer.group = get.is.double(player.name1, true).randomGet();\r\n\t\t\t\t\t\tplayer.node.name.dataset.nature = get.groupnature(player.group);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (get.config('choose_group') && player.group == 'shen' && !player.isUnseen(0)) {\r\n\t\t\t\t\t\tvar list = lib.group2.slice(0);\r\n\t\t\t\t\t\tif (list.length) player.group = function () {\r\n\t\t\t\t\t\t\tif (_status.mode != 'zhong' && game.zhu && game.zhu.group) {\r\n\t\t\t\t\t\t\t\tif (['re_zhangjiao', 'liubei', 're_liubei', 'caocao', 're_caocao', 'sunquan', 're_sunquan', 'zhangjiao', 'sp_zhangjiao', 'caopi', 're_caopi', 'liuchen', 'caorui', 'sunliang', 'sunxiu', 'sunce', 're_sunben', 'ol_liushan', 're_liushan', 'key_akane', 'dongzhuo', 're_dongzhuo', 'ol_dongzhuo', 'jin_simashi'].contains(game.zhu.name)) return game.zhu.group;\r\n\t\t\t\t\t\t\t\tif (['sunhao', 'xin_yuanshao', 're_yuanshao', 're_sunce', 'ol_yuanshao', 'yuanshu', 'jin_simazhao', 'liubian'].contains(game.zhu.name)) {\r\n\t\t\t\t\t\t\t\t\tif (player.identity != 'zhong') list.remove(game.zhu.group);\r\n\t\t\t\t\t\t\t\t\telse return game.zhu.group;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn list.randomGet();\r\n\t\t\t\t\t\t}();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.node.name.dataset.nature = get.groupnature(player.group);\r\n\t\t\t\t}\r\n\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar list;\r\n\t\t\t\t\tvar list2 = [];\r\n\t\t\t\t\tvar list3 = [];\r\n\t\t\t\t\tvar list4 = [];\r\n\t\t\t\t\tvar list5 = [];\r\n\t\t\t\t\tvar identityList;\r\n\t\t\t\t\tvar chosen = lib.config.continue_name || [];\r\n\t\t\t\t\tgame.saveConfig('continue_name');\r\n\t\t\t\t\tevent.chosen = chosen;\r\n\t\t\t\t\tif (_status.mode == 'zhong') {\r\n\t\t\t\t\t\tevent.zhongmode = true;\r\n\t\t\t\t\t\tidentityList = ['zhu', 'zhong', 'mingzhong', 'nei', 'fan', 'fan', 'fan', 'fan'];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tidentityList = lib.config.mode_config.identity.identity[game.players.length - 2].slice(0);\r\n\t\t\t\t\t\tif (get.config('double_nei')) {\r\n\t\t\t\t\t\t\tswitch (get.playerNumber()) {\r\n\t\t\t\t\t\t\t\tcase 8:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 7:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('zhong');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('zhong');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar addSetting = function (dialog) {\r\n\t\t\t\t\t\tdialog.add('选择身份').classList.add('add-setting');\r\n\t\t\t\t\t\tvar table = document.createElement('div');\r\n\t\t\t\t\t\ttable.classList.add('add-setting');\r\n\t\t\t\t\t\ttable.style.margin = '0';\r\n\t\t\t\t\t\ttable.style.width = '100%';\r\n\t\t\t\t\t\ttable.style.position = 'relative';\r\n\t\t\t\t\t\tvar listi;\r\n\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\tlisti = ['random', 'zhu', 'mingzhong', 'zhong', 'nei', 'fan'];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tlisti = ['random', 'zhu', 'zhong', 'nei', 'fan'];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (let i = 0; i < listi.length; i++) {\r\n\t\t\t\t\t\t\tlet td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.link = listi[i];\r\n\t\t\t\t\t\t\tif (td.link === game.me.identity) {\r\n\t\t\t\t\t\t\t\ttd.classList.add('bluebg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.appendChild(td);\r\n\t\t\t\t\t\t\ttd.innerHTML = '<span>' + get.translation(listi[i] + '2') + '</span>';\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n\t\t\t\t\t\t\t\tif (_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif (_status.justdragged) return;\r\n\t\t\t\t\t\t\t\t_status.tempNoButton = true;\r\n\t\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\t\t_status.tempNoButton = false;\r\n\t\t\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t\t\t\tvar link = this.link;\r\n\t\t\t\t\t\t\t\tif (game.zhu.name) {\r\n\t\t\t\t\t\t\t\t\tif (link != 'random') {\r\n\t\t\t\t\t\t\t\t\t\t_status.event.parent.fixedseat = get.distance(game.me, game.zhu, 'absolute');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tgame.zhu.uninit();\r\n\t\t\t\t\t\t\t\t\tdelete game.zhu.isZhu;\r\n\t\t\t\t\t\t\t\t\tdelete game.zhu.identityShown;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar current = this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif (current) {\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcurrent = seats.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif (current) {\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (link == 'random') {\r\n\t\t\t\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\t\t\t\tlink = ['zhu', 'zhong', 'nei', 'fan', 'mingzhong'].randomGet();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tlink = ['zhu', 'zhong', 'nei', 'fan'].randomGet();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < this.parentNode.childElementCount; i++) {\r\n\t\t\t\t\t\t\t\t\t\tif (this.parentNode.childNodes[i].link == link) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.parentNode.childNodes[i].classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tnum = get.config('choice_' + link);\r\n\t\t\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\t\t\tnum = 6;\r\n\t\t\t\t\t\t\t\t\tif (link == 'zhu' || link == 'nei' || link == 'mingzhong') {\r\n\t\t\t\t\t\t\t\t\t\tnum = 8;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t_status.event.parent.swapnodialog = function (dialog, list) {\r\n\t\t\t\t\t\t\t\t\tvar buttons = ui.create.div('.buttons');\r\n\t\t\t\t\t\t\t\t\tvar node = dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t\t\tdialog.buttons = ui.create.buttons(list, 'characterx', buttons);\r\n\t\t\t\t\t\t\t\t\tdialog.content.insertBefore(buttons, node);\r\n\t\t\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < seats.childElementCount; i++) {\r\n\t\t\t\t\t\t\t\t\t\tif (get.distance(game.zhu, game.me, 'absolute') === seats.childNodes[i].link) {\r\n\t\t\t\t\t\t\t\t\t\t\tseats.childNodes[i].classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t_status.event = _status.event.parent;\r\n\t\t\t\t\t\t\t\t_status.event.step = 0;\r\n\t\t\t\t\t\t\t\t_status.event.identity = link;\r\n\t\t\t\t\t\t\t\tif (link != (event.zhongmode ? 'mingzhong' : 'zhu')) {\r\n\t\t\t\t\t\t\t\t\tseats.previousSibling.style.display = '';\r\n\t\t\t\t\t\t\t\t\tseats.style.display = '';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tseats.previousSibling.style.display = 'none';\r\n\t\t\t\t\t\t\t\t\tseats.style.display = 'none';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(table);\r\n\r\n\t\t\t\t\t\tdialog.add('选择座位').classList.add('add-setting');\r\n\t\t\t\t\t\tvar seats = document.createElement('div');\r\n\t\t\t\t\t\tseats.classList.add('add-setting');\r\n\t\t\t\t\t\tseats.style.margin = '0';\r\n\t\t\t\t\t\tseats.style.width = '100%';\r\n\t\t\t\t\t\tseats.style.position = 'relative';\r\n\t\t\t\t\t\tfor (let i = 2; i <= game.players.length; i++) {\r\n\t\t\t\t\t\t\tlet td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.innerHTML = get.cnNumber(i, true);\r\n\t\t\t\t\t\t\ttd.link = i - 1;\r\n\t\t\t\t\t\t\tseats.appendChild(td);\r\n\t\t\t\t\t\t\tif (get.distance(game.zhu, game.me, 'absolute') === i - 1) {\r\n\t\t\t\t\t\t\t\ttd.classList.add('bluebg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n\t\t\t\t\t\t\t\tif (_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif (_status.justdragged) return;\r\n\t\t\t\t\t\t\t\tif (get.distance(game.zhu, game.me, 'absolute') == this.link) return;\r\n\t\t\t\t\t\t\t\tvar current = this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif (current) {\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\t\t\tif (get.distance(game.players[i], game.me, 'absolute') == this.link) {\r\n\t\t\t\t\t\t\t\t\t\tgame.swapSeat(game.zhu, game.players[i], false); return;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(seats);\r\n\t\t\t\t\t\tif (game.me == game.zhu) {\r\n\t\t\t\t\t\t\tseats.previousSibling.style.display = 'none';\r\n\t\t\t\t\t\t\tseats.style.display = 'none';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tif (get.is.phoneLayout()) dialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar removeSetting = function () {\r\n\t\t\t\t\t\tvar dialog = _status.event.dialog;\r\n\t\t\t\t\t\tif (dialog) {\r\n\t\t\t\t\t\t\tdialog.style.height = '';\r\n\t\t\t\t\t\t\tdelete dialog._scrollset;\r\n\t\t\t\t\t\t\tvar list = Array.from(dialog.querySelectorAll('.add-setting'));\r\n\t\t\t\t\t\t\twhile (list.length) {\r\n\t\t\t\t\t\t\t\tlist.shift().remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.addSetting = addSetting;\r\n\t\t\t\t\tevent.removeSetting = removeSetting;\r\n\t\t\t\t\tevent.list = [];\r\n\t\t\t\t\tidentityList.randomSort();\r\n\t\t\t\t\tif (_status.event.isbeginner) {\r\n\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\tidentityList.unshift('fan');\r\n\t\t\t\t\t\tif (event.fixedseat) {\r\n\t\t\t\t\t\t\tvar zhuIdentity = (_status.mode == 'zhong') ? 'mingzhong' : 'zhu';\r\n\t\t\t\t\t\t\tif (zhuIdentity != 'fan') {\r\n\t\t\t\t\t\t\t\tidentityList.remove(zhuIdentity);\r\n\t\t\t\t\t\t\t\tidentityList.splice(event.fixedseat, 0, zhuIdentity);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete event.fixedseat;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (event.identity) {\r\n\t\t\t\t\t\tidentityList.remove(event.identity);\r\n\t\t\t\t\t\tidentityList.unshift(event.identity);\r\n\t\t\t\t\t\tif (event.fixedseat) {\r\n\t\t\t\t\t\t\tvar zhuIdentity = (_status.mode == 'zhong') ? 'mingzhong' : 'zhu';\r\n\t\t\t\t\t\t\tif (zhuIdentity != event.identity) {\r\n\t\t\t\t\t\t\t\tidentityList.remove(zhuIdentity);\r\n\t\t\t\t\t\t\t\tidentityList.splice(event.fixedseat, 0, zhuIdentity);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete event.fixedseat;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete event.identity;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (_status.mode != 'zhong' && (!_status.brawl || !_status.brawl.identityShown)) {\r\n\t\t\t\t\t\tvar ban_identity = [];\r\n\t\t\t\t\t\tban_identity.push(get.config('ban_identity') || 'off');\r\n\t\t\t\t\t\tif (ban_identity[0] != 'off') {\r\n\t\t\t\t\t\t\tban_identity.push(get.config('ban_identity2') || 'off');\r\n\t\t\t\t\t\t\tif (ban_identity[1] != 'off') {\r\n\t\t\t\t\t\t\t\tban_identity.push(get.config('ban_identity3') || 'off');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tban_identity.remove('off');\r\n\t\t\t\t\t\tif (ban_identity.length) {\r\n\t\t\t\t\t\t\tvar identityList2 = identityList.slice(0);\r\n\t\t\t\t\t\t\tfor (var i = 0; i < ban_identity.length; i++) {\r\n\t\t\t\t\t\t\t\twhile (identityList2.remove(ban_identity[i]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tban_identity = identityList2.randomGet();\r\n\t\t\t\t\t\t\tidentityList.remove(ban_identity);\r\n\t\t\t\t\t\t\tidentityList.splice(game.players.indexOf(game.me), 0, ban_identity);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (_status.brawl && _status.brawl.identityShown) {\r\n\t\t\t\t\t\t\tif (game.players[i].identity == 'zhu') game.zhu = game.players[i];\r\n\t\t\t\t\t\t\tgame.players[i].identityShown = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.classList.add('guessing');\r\n\t\t\t\t\t\t\tgame.players[i].identity = identityList[i];\r\n\t\t\t\t\t\t\tgame.players[i].setIdentity('cai');\r\n\t\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\t\tif (identityList[i] == 'mingzhong') {\r\n\t\t\t\t\t\t\t\t\tgame.zhu = game.players[i];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (identityList[i] == 'zhu') {\r\n\t\t\t\t\t\t\t\t\tgame.zhu2 = game.players[i];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (identityList[i] == 'zhu') {\r\n\t\t\t\t\t\t\t\t\tgame.zhu = game.players[i];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.players[i].identityShown = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (get.config('special_identity') && !event.zhongmode && game.players.length == 8) {\r\n\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\tdelete game.players[i].special_identity;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.special_identity = [];\r\n\t\t\t\t\t\tvar zhongs = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.identity == 'zhong';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar fans = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.identity == 'fan';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (fans.length >= 1) {\r\n\t\t\t\t\t\t\tfans.randomRemove().special_identity = 'identity_zeishou';\r\n\t\t\t\t\t\t\tevent.special_identity.push('identity_zeishou');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (zhongs.length > 1) {\r\n\t\t\t\t\t\t\tzhongs.randomRemove().special_identity = 'identity_dajiang';\r\n\t\t\t\t\t\t\tzhongs.randomRemove().special_identity = 'identity_junshi';\r\n\t\t\t\t\t\t\tevent.special_identity.push('identity_dajiang');\r\n\t\t\t\t\t\t\tevent.special_identity.push('identity_junshi');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (zhongs.length == 1) {\r\n\t\t\t\t\t\t\tif (Math.random() < 0.5) {\r\n\t\t\t\t\t\t\t\tzhongs.randomRemove().special_identity = 'identity_dajiang';\r\n\t\t\t\t\t\t\t\tevent.special_identity.push('identity_dajiang');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tzhongs.randomRemove().special_identity = 'identity_junshi';\r\n\t\t\t\t\t\t\t\tevent.special_identity.push('identity_junshi');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!game.zhu) game.zhu = game.me;\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.zhu.setIdentity();\r\n\t\t\t\t\t\tgame.zhu.identityShown = true;\r\n\t\t\t\t\t\tgame.zhu.isZhu = (game.zhu.identity == 'zhu');\r\n\t\t\t\t\t\tgame.zhu.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\t\tgame.me.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//选将框分配\r\n\t\t\t\t\tfor (i in lib.characterReplace) {\r\n\t\t\t\t\t\tvar ix = lib.characterReplace[i];\r\n\t\t\t\t\t\tfor (var j = 0; j < ix.length; j++) {\r\n\t\t\t\t\t\t\tif (chosen.contains(ix[j]) || lib.filter.characterDisabled(ix[j])) ix.splice(j--, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (ix.length) {\r\n\t\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t\tvar bool = false;\r\n\t\t\t\t\t\t\tfor (var j of ix) {\r\n\t\t\t\t\t\t\t\tif (lib.character[j][4] && lib.character[j][4].contains('zhu')) {\r\n\t\t\t\t\t\t\t\t\tbool = true; break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t(bool ? list2 : list3).push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (i in lib.character) {\r\n\t\t\t\t\t\tif (list4.contains(i)) continue;\r\n\t\t\t\t\t\tif (chosen.contains(i)) continue;\r\n\t\t\t\t\t\tif (lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\tlist4.push(i);\r\n\t\t\t\t\t\tif (lib.character[i][4] && lib.character[i][4].contains('zhu')) {\r\n\t\t\t\t\t\t\tlist2.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tlist3.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (_status.new_beginner) {\r\n\t\t\t\t\t\t\tvar rank = lib.rank.rarity;\r\n\t\t\t\t\t\t\tif (rank.beginner.contains(i)) list5.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist2.sort(lib.sort.character);\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t_status.characterlist = list4.slice(0).randomSort();\r\n\t\t\t\t\tlist3.randomSort();\r\n\t\t\t\t\tif (_status.brawl && _status.brawl.chooseCharacterFilter) {\r\n\t\t\t\t\t\t_status.brawl.chooseCharacterFilter(event.list, list2, list3);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar num = Number(get.config('choice_' + game.me.identity)) + Number(get.config('choice_ex'));\r\n\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\tnum = 6;\r\n\t\t\t\t\t\tif (game.me.identity == 'zhu' || game.me.identity == 'nei' || game.me.identity == 'mingzhong') {\r\n\t\t\t\t\t\t\tnum = 8;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (game.zhu != game.me) {\r\n\t\t\t\t\t\tevent.ai(game.zhu, event.list, list2)\r\n\t\t\t\t\t\tevent.list.remove(get.sourceCharacter(game.zhu.name1));\r\n\t\t\t\t\t\tevent.list.remove(get.sourceCharacter(game.zhu.name2));\r\n\t\t\t\t\t\tif (_status.brawl && _status.brawl.chooseCharacter) {\r\n\t\t\t\t\t\t\tlist = _status.brawl.chooseCharacter(event.list, num);\r\n\t\t\t\t\t\t\tif (list === false || list === 'nozhu') {\r\n\t\t\t\t\t\t\t\tlist = event.list.slice(0, num);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tlist = event.list.slice(0, num);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (_status.brawl && _status.brawl.chooseCharacter) {\r\n\t\t\t\t\t\t\tlist = _status.brawl.chooseCharacter(list2, list3, num);\r\n\t\t\t\t\t\t\tif (list === false) {\r\n\t\t\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\t\t\tlist = list3.slice(0, 6);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tlist = list2.concat(list3.slice(0, num));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (list === 'nozhu') {\r\n\t\t\t\t\t\t\t\tlist = event.list.slice(0, num);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\t\tlist = list3.slice(0, 8);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tlist = list2.concat(list3.slice(0, num));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar str0 = '选择角色';\r\n\t\t\t\t\tif (_status.new_beginner) {\r\n\t\t\t\t\t\tstr0 += '（新手推荐）';\r\n\t\t\t\t\t\tif (list5.length) list = list5.slice(0, 8);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete event.swapnochoose;\r\n\t\t\t\t\tvar dialog;\r\n\t\t\t\t\tif (event.swapnodialog) {\r\n\t\t\t\t\t\tdialog = ui.dialog;\r\n\t\t\t\t\t\tevent.swapnodialog(dialog, list);\r\n\t\t\t\t\t\tdelete event.swapnodialog;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar str = '选择角色';\r\n\t\t\t\t\t\tif (_status.brawl && _status.brawl.chooseCharacterStr) {\r\n\t\t\t\t\t\t\tstr = _status.brawl.chooseCharacterStr;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog = ui.create.dialog(str, 'hidden', [list, 'characterx']);\r\n\t\t\t\t\t\tif (!_status.brawl || !_status.brawl.noAddSetting) {\r\n\t\t\t\t\t\t\tif (get.config('change_identity')) {\r\n\t\t\t\t\t\t\t\taddSetting(dialog);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (game.me.special_identity) {\r\n\t\t\t\t\t\tdialog.setCaption('选择角色（' + get.translation(game.me.special_identity) + '）');\r\n\t\t\t\t\t\tgame.me.node.identity.firstChild.innerHTML = get.translation(game.me.special_identity + '_bg');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tdialog.setCaption(str0);\r\n\t\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!event.chosen.length) {\r\n\t\t\t\t\t\tgame.me.chooseButton(dialog, true).set('onfree', true).selectButton = function () {\r\n\t\t\t\t\t\t\tif (_status.brawl && _status.brawl.doubleCharacter) return 2;\r\n\t\t\t\t\t\t\treturn get.config('double_character') ? 2 : 1\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.create.cheat = function () {\r\n\t\t\t\t\t\t_status.createControl = ui.cheat2;\r\n\t\t\t\t\t\tui.cheat = ui.create.control('更换', function () {\r\n\t\t\t\t\t\t\tif (ui.cheat2 && ui.cheat2.dialog == _status.event.dialog) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (game.changeCoin) {\r\n\t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (game.zhu != game.me) {\r\n\t\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\t\tif (_status.brawl && _status.brawl.chooseCharacter) {\r\n\t\t\t\t\t\t\t\t\tlist = _status.brawl.chooseCharacter(event.list, num);\r\n\t\t\t\t\t\t\t\t\tif (list === false || list === 'nozhu') {\r\n\t\t\t\t\t\t\t\t\t\tlist = event.list.slice(0, num);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tlist = event.list.slice(0, num);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tlist2.sort(lib.sort.character);\r\n\t\t\t\t\t\t\t\tlist3.randomSort();\r\n\t\t\t\t\t\t\t\tif (_status.brawl && _status.brawl.chooseCharacter) {\r\n\t\t\t\t\t\t\t\t\tlist = _status.brawl.chooseCharacter(list2, list3, num);\r\n\t\t\t\t\t\t\t\t\tif (list === false) {\r\n\t\t\t\t\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\t\t\t\t\tlist = list3.slice(0, 6);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tlist = list2.concat(list3.slice(0, num));\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse if (list === 'nozhu') {\r\n\t\t\t\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\t\t\t\tlist = event.list.slice(0, num);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\t\t\t\tlist = list3.slice(0, 6);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tlist = list2.concat(list3.slice(0, num));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar buttons = ui.create.div('.buttons');\r\n\t\t\t\t\t\t\tvar node = _status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t_status.event.dialog.buttons = ui.create.buttons(list, 'characterx', buttons);\r\n\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons, node);\r\n\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (lib.onfree) {\r\n\t\t\t\t\t\tlib.onfree.push(function () {\r\n\t\t\t\t\t\t\tevent.dialogxx = ui.create.characterDialog('heightset');\r\n\t\t\t\t\t\t\tif (ui.cheat2) {\r\n\t\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx', 500);\r\n\t\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.dialogxx = ui.create.characterDialog('heightset');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tui.create.cheat2 = function () {\r\n\t\t\t\t\t\tui.cheat2 = ui.create.control('自由选将', function () {\r\n\t\t\t\t\t\t\tif (this.dialog == _status.event.dialog) {\r\n\t\t\t\t\t\t\t\tif (game.changeCoin) {\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog = this.backup;\r\n\t\t\t\t\t\t\t\tthis.backup.open();\r\n\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif (ui.cheat) {\r\n\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx', 500);\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (game.changeCoin) {\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.backup = _status.event.dialog;\r\n\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog = _status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\tthis.dialog = _status.event.dialog;\r\n\t\t\t\t\t\t\t\tthis.dialog.open();\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif (ui.cheat) {\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (lib.onfree) {\r\n\t\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!_status.brawl || !_status.brawl.chooseCharacterFixed) {\r\n\t\t\t\t\t\tif (!ui.cheat && get.config('change_choice'))\r\n\t\t\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\t\tif (!ui.cheat2 && get.config('free_choose'))\r\n\t\t\t\t\t\t\tui.create.cheat2();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (ui.cheat) {\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (ui.cheat2) {\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (event.chosen.length) {\r\n\t\t\t\t\t\tevent.choosed = event.chosen;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (event.modchosen) {\r\n\t\t\t\t\t\tif (event.modchosen[0] == 'random') event.modchosen[0] = result.buttons[0].link;\r\n\t\t\t\t\t\telse event.modchosen[1] = result.buttons[0].link;\r\n\t\t\t\t\t\tevent.choosed = event.modchosen;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (result.buttons.length == 2) {\r\n\t\t\t\t\t\tevent.choosed = [result.buttons[0].link, result.buttons[1].link];\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link, result.buttons[1].link);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.choosed = [result.buttons[0].link];\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar name = event.choosed[0];\r\n\t\t\t\t\tif (get.is.double(name)) {\r\n\t\t\t\t\t\tlet list = get.is.double(name, true);\r\n\t\t\t\t\t\tlist = list.map(i => ['', '', 'group_' + i])\r\n\t\t\t\t\t\tconsole.log(list)\r\n\t\t\t\t\t\tgame.me._groupChosen = true;\r\n\t\t\t\t\t\tgame.me.chooseButton(['请选择你的势力', [list, 'vcard']], true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (lib.character[name][1] == 'shen' && !lib.character[name][4].contains('hiddenSkill') && get.config('choose_group')) {\r\n\t\t\t\t\t\tlet list = lib.group2.slice(0);\r\n\t\t\t\t\t\tlist = list.map(i => ['', '', 'group_' + i])\r\n\t\t\t\t\t\tgame.me.chooseButton(['请选择神武将的势力', [list, 'vcard']], true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif (result.links && result.links.length) event.group = result.links[0][2].slice(6) || false;\r\n\t\t\t\t\tif (event.choosed.length == 2) {\r\n\t\t\t\t\t\tgame.me.init(event.choosed[0], event.choosed[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tgame.me.init(event.choosed[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.remove(get.sourceCharacter(game.me.name1));\r\n\t\t\t\t\tevent.list.remove(get.sourceCharacter(game.me.name2));\r\n\t\t\t\t\tif (game.me == game.zhu && game.players.length > 4) {\r\n\t\t\t\t\t\tgame.me.hp++;\r\n\t\t\t\t\t\tgame.me.maxHp++;\r\n\t\t\t\t\t\tgame.me.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i] != game.zhu && game.players[i] != game.me) {\r\n\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\tevent.ai(game.players[i], event.list.splice(0, get.config('choice_' + game.players[i].identity)), null, event.list)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tif (event.group) {\r\n\t\t\t\t\t\tgame.me.group = event.group;\r\n\t\t\t\t\t\tgame.me.node.name.dataset.nature = get.groupnature(game.me.group);\r\n\t\t\t\t\t\tgame.me.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t}, 500);\r\n\r\n\t\t\t\t\tif (event.special_identity) {\r\n\t\t\t\t\t\tfor (var i = 0; i < event.special_identity.length; i++) {\r\n\t\t\t\t\t\t\tgame.zhu.addSkill(event.special_identity[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tnext.set('isbeginner', isbeginner)\r\n\t\t\t},\r\n\t\t\tchooseCharacterChangeOL: function () {\r\n\t\t\t\tvar next = game.createEvent('chooseCharacter', false);\r\n\t\t\t\tnext.showConfig = true;\r\n\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar identityList;\r\n\t\t\t\t\tidentityList = lib.config.mode_config.identity.identity[game.players.length - 2].slice(0);\r\n\t\t\t\t\tif (lib.configOL.double_nei) {\r\n\t\t\t\t\t\tswitch (lib.configOL.number) {\r\n\t\t\t\t\t\t\tcase 8:\r\n\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 7:\r\n\t\t\t\t\t\t\t\tidentityList.remove('zhong');\r\n\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\tidentityList.remove('zhong');\r\n\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tidentityList.randomSort();\r\n\t\t\t\t\tfor (i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tgame.players[i].identity = identityList[i];\r\n\t\t\t\t\t\tgame.players[i].setIdentity('cai');\r\n\t\t\t\t\t\tgame.players[i].node.identity.classList.add('guessing');\r\n\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\tif (identityList[i] == 'mingzhong') {\r\n\t\t\t\t\t\t\t\tgame.zhu = game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (identityList[i] == 'zhu') {\r\n\t\t\t\t\t\t\t\tgame.zhu2 = game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (identityList[i] == 'zhu') {\r\n\t\t\t\t\t\t\t\tgame.zhu = game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].identityShown = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (lib.configOL.special_identity && !event.zhongmode && game.players.length == 8) {\r\n\t\t\t\t\t\tvar map = {};\r\n\t\t\t\t\t\tvar zhongs = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.identity == 'zhong';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar fans = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.identity == 'fan';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (fans.length >= 1) {\r\n\t\t\t\t\t\t\tmap.identity_zeishou = fans.randomRemove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (zhongs.length > 1) {\r\n\t\t\t\t\t\t\tmap.identity_dajiang = zhongs.randomRemove();\r\n\t\t\t\t\t\t\tmap.identity_junshi = zhongs.randomRemove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (zhongs.length == 1) {\r\n\t\t\t\t\t\t\tif (Math.random() < 0.5) {\r\n\t\t\t\t\t\t\t\tmap.identity_dajiang = zhongs.randomRemove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tmap.identity_junshi = zhongs.randomRemove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.broadcastAll(function (zhu, map) {\r\n\t\t\t\t\t\t\tfor (var i in map) {\r\n\t\t\t\t\t\t\t\tmap[i].special_identity = i;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, game.zhu, map);\r\n\t\t\t\t\t\tevent.special_identity = map;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgame.zhu.setIdentity();\r\n\t\t\t\t\tgame.zhu.identityShown = true;\r\n\t\t\t\t\tgame.zhu.isZhu = (game.zhu.identity == 'zhu');\r\n\t\t\t\t\tgame.zhu.node.identity.classList.remove('guessing');\r\n\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\tgame.me.node.identity.classList.remove('guessing');\r\n\t\t\t\t\tif (game.me.special_identity) {\r\n\t\t\t\t\t\tgame.me.node.identity.firstChild.innerHTML = get.translation(game.me.special_identity + '_bg');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tgame.players[i].send(function (zhu, zhuid, me, identity, players) {\r\n\t\t\t\t\t\t\tfor (const player of players) {\r\n\t\t\t\t\t\t\t\tplayer.setIdentity('cai');\r\n\t\t\t\t\t\t\t\tplayer.node.identity.classList.add('guessing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tzhu.identityShown = true;\r\n\t\t\t\t\t\t\tzhu.identity = zhuid;\r\n\t\t\t\t\t\t\tzhu.setIdentity();\r\n\t\t\t\t\t\t\tzhu.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t\tme.setIdentity(identity);\r\n\t\t\t\t\t\t\tme.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t\tif (me.special_identity) {\r\n\t\t\t\t\t\t\t\tme.node.identity.firstChild.innerHTML = get.translation(me.special_identity + '_bg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, game.zhu, game.zhu.identity, game.players[i], game.players[i].identity, game.players);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tevent.videoId = lib.status.videoId++;\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tvar libCharacter = {};\r\n\t\t\t\t\tfor (var i = 0; i < lib.configOL.characterPack.length; i++) {\r\n\t\t\t\t\t\tvar pack = lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor (var j in pack) {\r\n\t\t\t\t\t\t\tif (lib.character[j]) libCharacter[j] = pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (i in libCharacter) {\r\n\t\t\t\t\t\tif (lib.filter.characterDisabled(i, libCharacter)) continue;\r\n\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function (list, id) {\r\n\t\t\t\t\t\t_status.characterlist = list;\r\n\t\t\t\t\t\tvar filter = function (name) {\r\n\t\t\t\t\t\t\treturn !_status.characterlist.contains(name);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar dialog = ui.create.characterDialog('heightset', filter).open();\r\n\t\t\t\t\t\tdialog.videoId = id;\r\n\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t}, list, event.videoId);\r\n\t\t\t\t\tgame.zhu.chooseButton(true).set('ai', function (button) {\r\n\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t}).set('dialog', event.videoId);\r\n\t\t\t\t\tevent.player = game.zhu;\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tgame.broadcastAll(function (player, character, id) {\r\n\t\t\t\t\t\tplayer.init(character);\r\n\t\t\t\t\t\tif (player == game.me) game.addRecentCharacter(character);\r\n\t\t\t\t\t}, event.player, result.links[0]);\r\n\t\t\t\t\tevent.player.next.chooseButton(true).set('ai', function (button) {\r\n\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t}).set('dialog', event.videoId);\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tevent.player = event.player.next\r\n\t\t\t\t\tif (event.player.next.name1) {\r\n\t\t\t\t\t\tgame.broadcastAll('closeDialog', event.videoId);\r\n\t\t\t\t\t\tgame.broadcastAll(function (player, character, id) {\r\n\t\t\t\t\t\t\tvar dialog = get.idDialog(id);\r\n\t\t\t\t\t\t\tif (dialog) {\r\n\t\t\t\t\t\t\t\tdialog.close();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.init(character);\r\n\t\t\t\t\t\t\tif (player == game.me) game.addRecentCharacter(character);\r\n\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t\t}, event.player, result.links[0], event.videoId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tevent.goto(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL: function () {\r\n\t\t\t\tif (get.config('connect_change_choice')) {\r\n\t\t\t\t\tgame.chooseCharacterChangeOL();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (_status.mode == 'purple') {\r\n\t\t\t\t\tgame.chooseCharacterPurpleOL();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = game.createEvent('chooseCharacter', false);\r\n\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar identityList;\r\n\t\t\t\t\tif (_status.mode == 'zhong') {\r\n\t\t\t\t\t\tevent.zhongmode = true;\r\n\t\t\t\t\t\tidentityList = ['zhu', 'zhong', 'mingzhong', 'nei', 'fan', 'fan', 'fan', 'fan'];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tidentityList = lib.config.mode_config.identity.identity[game.players.length - 2].slice(0);\r\n\t\t\t\t\t\tif (lib.configOL.double_nei) {\r\n\t\t\t\t\t\t\tswitch (lib.configOL.number) {\r\n\t\t\t\t\t\t\t\tcase 8:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 7:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('zhong');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('zhong');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t\tidentityList.remove('fan');\r\n\t\t\t\t\t\t\t\t\tidentityList.push('nei');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tidentityList.randomSort();\r\n\t\t\t\t\tfor (i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tgame.players[i].identity = identityList[i];\r\n\t\t\t\t\t\tgame.players[i].setIdentity('cai');\r\n\t\t\t\t\t\tgame.players[i].node.identity.classList.add('guessing');\r\n\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\tif (identityList[i] == 'mingzhong') {\r\n\t\t\t\t\t\t\t\tgame.zhu = game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (identityList[i] == 'zhu') {\r\n\t\t\t\t\t\t\t\tgame.zhu2 = game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (identityList[i] == 'zhu') {\r\n\t\t\t\t\t\t\t\tgame.zhu = game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].identityShown = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (lib.configOL.special_identity && !event.zhongmode && game.players.length == 8) {\r\n\t\t\t\t\t\tvar map = {};\r\n\t\t\t\t\t\tvar zhongs = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.identity == 'zhong';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar fans = game.filterPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn current.identity == 'fan';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (fans.length >= 1) {\r\n\t\t\t\t\t\t\tmap.identity_zeishou = fans.randomRemove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (zhongs.length > 1) {\r\n\t\t\t\t\t\t\tmap.identity_dajiang = zhongs.randomRemove();\r\n\t\t\t\t\t\t\tmap.identity_junshi = zhongs.randomRemove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (zhongs.length == 1) {\r\n\t\t\t\t\t\t\tif (Math.random() < 0.5) {\r\n\t\t\t\t\t\t\t\tmap.identity_dajiang = zhongs.randomRemove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tmap.identity_junshi = zhongs.randomRemove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.broadcastAll(function (zhu, map) {\r\n\t\t\t\t\t\t\tfor (var i in map) {\r\n\t\t\t\t\t\t\t\tmap[i].special_identity = i;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, game.zhu, map);\r\n\t\t\t\t\t\tevent.special_identity = map;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgame.zhu.setIdentity();\r\n\t\t\t\t\tgame.zhu.identityShown = true;\r\n\t\t\t\t\tgame.zhu.isZhu = (game.zhu.identity == 'zhu');\r\n\t\t\t\t\tgame.zhu.node.identity.classList.remove('guessing');\r\n\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\tgame.me.node.identity.classList.remove('guessing');\r\n\t\t\t\t\tif (game.me.special_identity) {\r\n\t\t\t\t\t\tgame.me.node.identity.firstChild.innerHTML = get.translation(game.me.special_identity + '_bg');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tgame.players[i].send(function (zhu, zhuid, me, identity, players) {\r\n\t\t\t\t\t\t\tfor (const player of players) {\r\n\t\t\t\t\t\t\t\tplayer.setIdentity('cai');\r\n\t\t\t\t\t\t\t\tplayer.node.identity.classList.add('guessing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tzhu.identityShown = true;\r\n\t\t\t\t\t\t\tzhu.identity = zhuid;\r\n\t\t\t\t\t\t\tzhu.setIdentity();\r\n\t\t\t\t\t\t\tzhu.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t\tme.setIdentity(identity);\r\n\t\t\t\t\t\t\tme.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t\tif (me.special_identity) {\r\n\t\t\t\t\t\t\t\tme.node.identity.firstChild.innerHTML = get.translation(me.special_identity + '_bg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t\t}, game.zhu, game.zhu.identity, game.players[i], game.players[i].identity, game.players);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar list;\r\n\t\t\t\t\tvar list2 = [];\r\n\t\t\t\t\tvar list3 = [];\r\n\t\t\t\t\tvar list4 = [];\r\n\t\t\t\t\tevent.list = [];\r\n\t\t\t\t\tevent.list2 = [];\r\n\r\n\t\t\t\t\tvar libCharacter = {};\r\n\t\t\t\t\tfor (var i = 0; i < lib.configOL.characterPack.length; i++) {\r\n\t\t\t\t\t\tvar pack = lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor (var j in pack) {\r\n\t\t\t\t\t\t\tif (j == 'zuoci') continue;\r\n\t\t\t\t\t\t\tif (lib.character[j]) libCharacter[j] = pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (i in lib.characterReplace) {\r\n\t\t\t\t\t\tvar ix = lib.characterReplace[i];\r\n\t\t\t\t\t\tfor (var j = 0; j < ix.length; j++) {\r\n\t\t\t\t\t\t\tif (!libCharacter[ix[j]] || lib.filter.characterDisabled(ix[j])) ix.splice(j--, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (ix.length) {\r\n\t\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\t\tevent.list2.push(i);\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t\tvar bool = false;\r\n\t\t\t\t\t\t\tfor (var j of ix) {\r\n\t\t\t\t\t\t\t\tif (libCharacter[j][4] && libCharacter[j][4].contains('zhu')) {\r\n\t\t\t\t\t\t\t\t\tbool = true; break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t(bool ? list2 : list3).push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function (list) {\r\n\t\t\t\t\t\tfor (var i in lib.characterReplace) {\r\n\t\t\t\t\t\t\tvar ix = lib.characterReplace[i];\r\n\t\t\t\t\t\t\tfor (var j = 0; j < ix.length; j++) {\r\n\t\t\t\t\t\t\t\tif (!list.contains(ix[j])) ix.splice(j--, 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, list4);\r\n\t\t\t\t\tfor (i in libCharacter) {\r\n\t\t\t\t\t\tif (list4.contains(i)) continue;\r\n\t\t\t\t\t\tif (lib.filter.characterDisabled(i, libCharacter)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\tevent.list2.push(i);\r\n\t\t\t\t\t\tlist4.push(i);\r\n\t\t\t\t\t\tif (libCharacter[i][4] && libCharacter[i][4].contains('zhu')) {\r\n\t\t\t\t\t\t\tlist2.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tlist3.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.characterlist = list4.slice(0);\r\n\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\tlist = event.list.randomGets(8 + Number(get.config('choice_ex')));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tlist2.sort(lib.sort.character);\r\n\t\t\t\t\t\tlist = list2.concat(list3.randomGets(5 + Number(get.config('choice_ex'))));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar next = game.zhu.chooseButton(true);\r\n\t\t\t\t\tnext.set('selectButton', (lib.configOL.double_character ? 2 : 1));\r\n\t\t\t\t\tnext.set('createDialog', ['选择角色', [list, 'characterx']]);\r\n\t\t\t\t\tnext.set('callback', function (player, result) {\r\n\t\t\t\t\t\tplayer.init(result.links[0], result.links[1]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.set('ai', function (button) {\r\n\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (game.me != game.zhu) {\r\n\t\t\t\t\t\tgame.zhu.init(result.links[0], result.links[1])\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.remove(get.sourceCharacter(game.zhu.name1));\r\n\t\t\t\t\tevent.list.remove(get.sourceCharacter(game.zhu.name2));\r\n\t\t\t\t\tevent.list2.remove(get.sourceCharacter(game.zhu.name1));\r\n\t\t\t\t\tevent.list2.remove(get.sourceCharacter(game.zhu.name2));\r\n\r\n\t\t\t\t\tif (game.players.length > 4) {\r\n\t\t\t\t\t\tgame.zhu.maxHp++;\r\n\t\t\t\t\t\tgame.zhu.hp++;\r\n\t\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function (zhu, name, name2, addMaxHp) {\r\n\t\t\t\t\t\tif (game.zhu != game.me) {\r\n\t\t\t\t\t\t\tzhu.init(name, name2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (addMaxHp) {\r\n\t\t\t\t\t\t\tzhu.maxHp++;\r\n\t\t\t\t\t\t\tzhu.hp++;\r\n\t\t\t\t\t\t\tzhu.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, game.zhu, result.links[0], result.links[1], game.players.length > 4);\r\n\r\n\t\t\t\t\tif (game.zhu.group == 'shen' && !game.zhu.isUnseen(0)) {\r\n\t\t\t\t\t\tvar list = lib.group2.slice(0);\r\n\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\tif (!lib.group.contains(list[i])) list.splice(i--, 1);\r\n\t\t\t\t\t\t\telse list[i] = ['', '', 'group_' + list[i]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.zhu.chooseButton(['请选择神武将的势力', [list, 'vcard']], true).set('ai', function () {\r\n\t\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (get.is.double(game.zhu.name1)) {\r\n\t\t\t\t\t\tgame.zhu._groupChosen = true;\r\n\t\t\t\t\t\tvar list = get.is.double(game.zhu.name1, true);\r\n\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\tif (!lib.group.contains(list[i])) list.splice(i--, 1);\r\n\t\t\t\t\t\t\telse list[i] = ['', '', 'group_' + list[i]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.zhu.chooseButton(['请选择你的势力', [list, 'vcard']], true).set('ai', function () {\r\n\t\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.goto(3);\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tvar name = result.links[0][2].slice(6);\r\n\t\t\t\t\tgame.zhu.changeGroup(name);\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tvar selectButton = (lib.configOL.double_character ? 2 : 1);\r\n\r\n\t\t\t\t\tvar num, num2 = 0;\r\n\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\tnum = 6;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tnum = Math.floor(event.list.length / (game.players.length - 1));\r\n\t\t\t\t\t\tif (num > 5) {\r\n\t\t\t\t\t\t\tnum = 5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnum2 = event.list.length - num * (game.players.length - 1);\r\n\t\t\t\t\t\tif (lib.configOL.double_nei) {\r\n\t\t\t\t\t\t\tnum2 = Math.floor(num2 / 2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (num2 > 2) {\r\n\t\t\t\t\t\t\tnum2 = 2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i] != game.zhu) {\r\n\t\t\t\t\t\t\tvar num3 = 0;\r\n\t\t\t\t\t\t\tif (event.zhongmode) {\r\n\t\t\t\t\t\t\t\tif (game.players[i].identity == 'nei' || game.players[i].identity == 'zhu') {\r\n\t\t\t\t\t\t\t\t\tnum3 = 2;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (game.players[i].identity == 'nei') {\r\n\t\t\t\t\t\t\t\t\tnum3 = num2;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar str = '选择角色';\r\n\t\t\t\t\t\t\tif (game.players[i].special_identity) {\r\n\t\t\t\t\t\t\t\tstr += '（' + get.translation(game.players[i].special_identity) + '）';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlist.push([game.players[i], [str, [event.list.randomRemove(num + num3 + Number(get.config('choice_ex'))), 'characterx']], selectButton, true]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(list, function (player, result) {\r\n\t\t\t\t\t\tif (game.online || player == game.me) player.init(result.links[0], result.links[1]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tvar shen = [];\r\n\t\t\t\t\tfor (var i in result) {\r\n\t\t\t\t\t\tif (result[i] && result[i].links) {\r\n\t\t\t\t\t\t\tfor (var j = 0; j < result[i].links.length; j++) {\r\n\t\t\t\t\t\t\t\tevent.list2.remove(get.sourceCharacter(result[i].links[j]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i in result) {\r\n\t\t\t\t\t\tif (result[i] == 'ai') {\r\n\t\t\t\t\t\t\tresult[i] = event.list2.randomRemove(lib.configOL.double_character ? 2 : 1);\r\n\t\t\t\t\t\t\tfor (var j = 0; j < result[i].length; j++) {\r\n\t\t\t\t\t\t\t\tvar listx = lib.characterReplace[result[i][j]];\r\n\t\t\t\t\t\t\t\tif (listx && listx.length) result[i][j] = listx.randomGet();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tresult[i] = result[i].links;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (get.is.double(result[i][0]) ||\r\n\t\t\t\t\t\t\tlib.character[result[i][0]] && lib.character[result[i][0]][1] == 'shen' && !lib.character[result[i][0]][4].contains('hiddenSkill')) shen.push(lib.playerOL[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.result2 = result;\r\n\t\t\t\t\tif (shen.length) {\r\n\t\t\t\t\t\tvar list = lib.group2.slice(0);\r\n\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\tif (!lib.group.contains(list[i])) list.splice(i--, 1);\r\n\t\t\t\t\t\t\telse list[i] = ['', '', 'group_' + list[i]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (var i = 0; i < shen.length; i++) {\r\n\t\t\t\t\t\t\tif (get.is.double(result[shen[i].playerid][0])) {\r\n\t\t\t\t\t\t\t\tshen[i]._groupChosen = true;\r\n\t\t\t\t\t\t\t\tshen[i] = [shen[i], ['请选择你的势力', [get.is.double(result[shen[i].playerid][0], true).map(function (i) {\r\n\t\t\t\t\t\t\t\t\treturn ['', '', 'group_' + i];\r\n\t\t\t\t\t\t\t\t}), 'vcard']], 1, true];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse shen[i] = [shen[i], ['请选择神武将的势力', [list, 'vcard']], 1, true];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.me.chooseButtonOL(shen, function (player, result) {\r\n\t\t\t\t\t\t\tif (player == game.me) player.changeGroup(result.links[0][2].slice(6), false, false);\r\n\t\t\t\t\t\t}).set('switchToAuto', function () {\r\n\t\t\t\t\t\t\t_status.event.result = 'ai';\r\n\t\t\t\t\t\t}).set('processAI', function () {\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tbool: true,\r\n\t\t\t\t\t\t\t\tlinks: [_status.event.dialog.buttons.randomGet().link],\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event._result = {};\r\n\t\t\t\t\t\"step 5\"\r\n\t\t\t\t\tif (!result) result = {};\r\n\t\t\t\t\tfor (var i in result) {\r\n\t\t\t\t\t\tif (result[i] && result[i].links) result[i] = result[i].links[0][2].slice(6);\r\n\t\t\t\t\t\telse if (result[i] == 'ai') result[i] = function () {\r\n\t\t\t\t\t\t\tvar player = lib.playerOL[i];\r\n\t\t\t\t\t\t\tvar list = lib.group2.slice(0);\r\n\t\t\t\t\t\t\tif (_status.mode != 'zhong' && game.zhu && game.zhu.group) {\r\n\t\t\t\t\t\t\t\tif (['re_zhangjiao', 'liubei', 're_liubei', 'caocao', 're_caocao', 'sunquan', 're_sunquan', 'zhangjiao', 'sp_zhangjiao', 'caopi', 're_caopi', 'liuchen', 'caorui', 'sunliang', 'sunxiu', 'sunce', 're_sunben', 'ol_liushan', 're_liushan', 'key_akane', 'dongzhuo', 're_dongzhuo', 'ol_dongzhuo', 'jin_simashi'].contains(game.zhu.name)) return game.zhu.group;\r\n\t\t\t\t\t\t\t\tif (['sunhao', 'xin_yuanshao', 're_yuanshao', 're_sunce', 'ol_yuanshao', 'yuanshu', 'jin_simazhao', 'liubian'].contains(game.zhu.name)) {\r\n\t\t\t\t\t\t\t\t\tif (player.identity != 'zhong') list.remove(game.zhu.group);\r\n\t\t\t\t\t\t\t\t\telse return game.zhu.group;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn list.randomGet();\r\n\t\t\t\t\t\t}();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar result2 = event.result2;\r\n\t\t\t\t\tgame.broadcast(function (result, result2) {\r\n\t\t\t\t\t\tfor (var i in result) {\r\n\t\t\t\t\t\t\tif (!lib.playerOL[i].name) {\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0], result[i][1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (result2[i] && result2[i].length) lib.playerOL[i].changeGroup(result2[i], false, false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t}, result2, result);\r\n\r\n\t\t\t\t\tfor (var i in result2) {\r\n\t\t\t\t\t\tif (!lib.playerOL[i].name) {\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result2[i][0], result2[i][1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (result[i] && result[i].length) lib.playerOL[i].changeGroup(result[i], false, false);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (event.special_identity) {\r\n\t\t\t\t\t\tfor (var i in event.special_identity) {\r\n\t\t\t\t\t\t\tgame.zhu.addSkill(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t}, 500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t},\r\n\t\ttranslate: {\r\n\t\t\tzhu: \"主\",\r\n\t\t\tzhong: \"忠\",\r\n\t\t\tmingzhong: \"忠\",\r\n\t\t\tnei: \"内\",\r\n\t\t\tfan: \"反\",\r\n\t\t\tcai: \"猜\",\r\n\t\t\tcai2: \"猜\",\r\n\t\t\trZhu: \"主\",\r\n\t\t\trZhong: \"忠\",\r\n\t\t\trNei: \"内\",\r\n\t\t\trYe: \"野\",\r\n\t\t\trZhu2: \"主帅\",\r\n\t\t\trZhong2: \"前锋\",\r\n\t\t\trNei2: \"细作\",\r\n\t\t\trYe2: \"野心家\",\r\n\t\t\tbZhu: \"主\",\r\n\t\t\tbZhong: \"忠\",\r\n\t\t\tbNei: \"内\",\r\n\t\t\tbYe: \"野\",\r\n\t\t\tbZhu2: \"主帅\",\r\n\t\t\tbZhong2: \"前锋\",\r\n\t\t\tbNei2: \"细作\",\r\n\t\t\tbYe2: \"野心家\",\r\n\t\t\tzhu2: \"主公\",\r\n\t\t\tzhong2: \"忠臣\",\r\n\t\t\tmingzhong2: \"明忠\",\r\n\t\t\tnei2: \"内奸\",\r\n\t\t\tfan2: \"反贼\",\r\n\t\t\trandom2: \"随机\",\r\n\t\t\tidentity_junshi_bg: '师',\r\n\t\t\tidentity_dajiang_bg: '将',\r\n\t\t\tidentity_zeishou_bg: '首',\r\n\t\t\tidentity_junshi: '军师',\r\n\t\t\tidentity_dajiang: '大将',\r\n\t\t\tidentity_zeishou: '贼首',\r\n\t\t\tai_strategy_1: '均衡',\r\n\t\t\tai_strategy_2: '偏反',\r\n\t\t\tai_strategy_3: '偏主',\r\n\t\t\tai_strategy_4: '酱油',\r\n\t\t\tai_strategy_5: '天使',\r\n\t\t\tai_strategy_6: '仇主',\r\n\t\t\tdongcha: '洞察',\r\n\t\t\tdongcha_info: '游戏开始时，随机一名反贼的身份对你可见；准备阶段，你可以弃置场上的一张牌',\r\n\t\t\tsheshen: '舍身',\r\n\t\t\tsheshen_info: '锁定技，主公处于濒死状态即将死亡时，令主公+1体力上限，回复体力至X点（X为你的体力值数），获得你的所有牌，然后你死亡',\r\n\t\t\tyexinbilu: '野心毕露',\r\n\t\t},\r\n\t\telement: {\r\n\t\t\tplayer: {\r\n\t\t\t\tyexinbilu: function () {\r\n\t\t\t\t\tgame.broadcastAll(function (player) {\r\n\t\t\t\t\t\tplayer.showIdentity();\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\tthis.gainMaxHp();\r\n\t\t\t\t\tthis.recover();\r\n\t\t\t\t},\r\n\t\t\t\t$dieAfter: function () {\r\n\t\t\t\t\tif (_status.video) return;\r\n\t\t\t\t\tif (!this.node.dieidentity) {\r\n\t\t\t\t\t\tvar str;\r\n\t\t\t\t\t\tif (this.special_identity) {\r\n\t\t\t\t\t\t\tstr = get.translation(this.special_identity);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tstr = get.translation(this.identity + '2');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar node = ui.create.div('.damage.dieidentity', str, this);\r\n\t\t\t\t\t\tif (str == '野心家') {\r\n\t\t\t\t\t\t\tnode.style.fontSize = '40px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tui.refresh(node);\r\n\t\t\t\t\t\tnode.style.opacity = 1;\r\n\t\t\t\t\t\tthis.node.dieidentity = node;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar trans = this.style.transform;\r\n\t\t\t\t\tif (trans) {\r\n\t\t\t\t\t\tif (trans.indexOf('rotateY') != -1) {\r\n\t\t\t\t\t\t\tthis.node.dieidentity.style.transform = 'rotateY(180deg)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (trans.indexOf('rotateX') != -1) {\r\n\t\t\t\t\t\t\tthis.node.dieidentity.style.transform = 'rotateX(180deg)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tthis.node.dieidentity.style.transform = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.node.dieidentity.style.transform = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdieAfter2: function (source) {\r\n\t\t\t\t\tif (_status.mode == 'purple') {\r\n\t\t\t\t\t\tif (source) {\r\n\t\t\t\t\t\t\tif (this.identity == 'rZhu' || this.identity == 'bZhu') {\r\n\t\t\t\t\t\t\t\tif (this.identity.slice(0, 1) != source.identity.slice(0, 1)) source.recover();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (this.identity == 'rZhong' || this.identity == 'bZhong') {\r\n\t\t\t\t\t\t\t\tif (this.identity.slice(0, 1) != source.identity.slice(0, 1)) source.draw(2);\r\n\t\t\t\t\t\t\t\telse if (source.identity.indexOf('Zhu') == 1) source.discard(source.getCards('h'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (this.identity == 'rNei' || this.identity == 'bNei') {\r\n\t\t\t\t\t\t\t\tif (this.identity.slice(0, 1) == source.identity.slice(0, 1)) source.draw(3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!_status.yeconfirm) {\r\n\t\t\t\t\t\t\t_status.yeconfirm = true;\r\n\t\t\t\t\t\t\tgame.addGlobalSkill('yexinbilu');\r\n\t\t\t\t\t\t\tgame.broadcastAll(function () {\r\n\t\t\t\t\t\t\t\tif (game.me.identity == 'rYe' || game.me.identity == 'bYe') {\r\n\t\t\t\t\t\t\t\t\tvar player = game.findPlayer(function (current) {\r\n\t\t\t\t\t\t\t\t\t\treturn current != game.me && (current.identity == 'bYe' || current.identity == 'rYe');\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tif (player) {\r\n\t\t\t\t\t\t\t\t\t\tplayer.showIdentity();\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.identity == 'fan' && source) source.draw(3);\r\n\t\t\t\t\telse if (this.identity == 'mingzhong' && source) {\r\n\t\t\t\t\t\tif (source.identity == 'zhu') {\r\n\t\t\t\t\t\t\tsource.discard(source.getCards('he'));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tsource.draw(3);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this.identity == 'zhong' && source && source.identity == 'zhu' && source.isZhu) {\r\n\t\t\t\t\t\tsource.discard(source.getCards('he'));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdieAfter: function (source) {\r\n\t\t\t\t\tif (!this.identityShown) {\r\n\t\t\t\t\t\tgame.broadcastAll(function (player, identity, identity2) {\r\n\t\t\t\t\t\t\tplayer.setIdentity(player.identity);\r\n\t\t\t\t\t\t\tplayer.identityShown = true;\r\n\t\t\t\t\t\t\tplayer.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t\tif (identity) {\r\n\t\t\t\t\t\t\t\tplayer.node.identity.firstChild.innerHTML = get.translation(identity + '_bg');\r\n\t\t\t\t\t\t\t\tgame.log(player, '的身份是', '#g' + get.translation(identity));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tgame.log(player, '的身份是', '#g' + get.translation(identity2 + '2'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this, this.special_identity, this.identity);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.special_identity) {\r\n\t\t\t\t\t\tgame.broadcastAll(function (zhu, identity) {\r\n\t\t\t\t\t\t\tzhu.removeSkill(identity);\r\n\t\t\t\t\t\t}, game.zhu, this.special_identity);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.checkResult();\r\n\t\t\t\t\tif (_status.mode == 'purple') {\r\n\t\t\t\t\t\tvar red = [];\r\n\t\t\t\t\t\tvar blue = [];\r\n\t\t\t\t\t\tgame.countPlayer(function (current) {\r\n\t\t\t\t\t\t\tvar identity = current.identity.slice(1);\r\n\t\t\t\t\t\t\tif (identity != 'Zhu') {\r\n\t\t\t\t\t\t\t\tif (current.identity.indexOf('r') == 0) red.push(current);\r\n\t\t\t\t\t\t\t\telse blue.push(current);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (red.length <= 1 && blue.length <= 1) game.broadcastAll(game.showIdentity);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (game.zhu && game.zhu.isZhu) {\r\n\t\t\t\t\t\tif (get.population('zhong') + get.population('nei') == 0 ||\r\n\t\t\t\t\t\t\tget.population('zhong') + get.population('fan') == 0) {\r\n\t\t\t\t\t\t\tgame.broadcastAll(game.showIdentity);\r\n\t\t\t\t\t\t\tif (game.zhu && game.zhu.isAlive()) {\r\n\t\t\t\t\t\t\t\tgame.broadcastAll(function () {\r\n\t\t\t\t\t\t\t\t\tif (get.population('nei') == 1 && get.config('nei_fullscreenpop')) game.me.$fullscreenpop('<span style=\"font-family:xinwei\"><span data-nature=\"fire\">主公</span><span data-nature=\"soil\"> vs </span><span data-nature=\"thunder\">内奸</span></span>', null, null, false);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (game.zhu && game.zhu.$.enhance_zhu && get.population('fan') < 3) {\r\n\t\t\t\t\t\tgame.zhu.removeSkill(game.zhu.$.enhance_zhu);\r\n\t\t\t\t\t\tdelete game.zhu.$.enhance_zhu;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this == game.zhong) {\r\n\t\t\t\t\t\tgame.broadcastAll(function (player) {\r\n\t\t\t\t\t\t\tgame.zhu = player;\r\n\t\t\t\t\t\t\tgame.zhu.identityShown = true;\r\n\t\t\t\t\t\t\tgame.zhu.ai.shown = 1;\r\n\t\t\t\t\t\t\tgame.zhu.setIdentity();\r\n\t\t\t\t\t\t\tgame.zhu.isZhu = true;\r\n\t\t\t\t\t\t\tgame.zhu.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t\tif (lib.config.animation && !lib.config.low_performance) game.zhu.$legend();\r\n\t\t\t\t\t\t\tdelete game.zhong;\r\n\t\t\t\t\t\t\tif (_status.clickingidentity && _status.clickingidentity[0] == game.zhu) {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < _status.clickingidentity[1].length; i++) {\r\n\t\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform = '';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, game.zhu);\r\n\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t\tgame.zhu.playerfocus(1000);\r\n\t\t\t\t\t\t_status.event.trigger('zhuUpdate');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!_status.over) {\r\n\t\t\t\t\t\tvar giveup;\r\n\t\t\t\t\t\tif (get.population('fan') + get.population('nei') == 1) {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\t\tif (game.players[i].identity == 'fan' || game.players[i].identity == 'nei') {\r\n\t\t\t\t\t\t\t\t\tgiveup = game.players[i]; break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (get.population('zhong') + get.population('mingzhong') + get.population('nei') == 0) {\r\n\t\t\t\t\t\t\tgiveup = game.zhu;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (giveup) {\r\n\t\t\t\t\t\t\tgiveup.showGiveup();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tlogAi: function (targets, card) {\r\n\t\t\t\t\tif (this.ai.shown == 1 || this.isMad()) return;\r\n\t\t\t\t\tif (typeof targets == 'number') {\r\n\t\t\t\t\t\tthis.ai.shown += targets;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar effect = 0, c, shown;\r\n\t\t\t\t\t\tvar info = get.info(card);\r\n\t\t\t\t\t\tif (info.ai && info.ai.expose) {\r\n\t\t\t\t\t\t\tif (_status.event.name == '_wuxie') {\r\n\t\t\t\t\t\t\t\tif (_status.event.source && _status.event.source.ai.shown) {\r\n\t\t\t\t\t\t\t\t\tthis.ai.shown += 0.2;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tthis.ai.shown += info.ai.expose;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (targets.length > 0) {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < targets.length; i++) {\r\n\t\t\t\t\t\t\t\tshown = Math.abs(targets[i].ai.shown);\r\n\t\t\t\t\t\t\t\tif (shown < 0.2 || targets[i].identity == 'nei') c = 0;\r\n\t\t\t\t\t\t\t\telse if (shown < 0.4) c = 0.5;\r\n\t\t\t\t\t\t\t\telse if (shown < 0.6) c = 0.8;\r\n\t\t\t\t\t\t\t\telse c = 1;\r\n\t\t\t\t\t\t\t\tvar eff = get.effect(targets[i], card, this);\r\n\t\t\t\t\t\t\t\teffect += eff * c;\r\n\t\t\t\t\t\t\t\tif (eff == 0 && shown == 0 && ['zhong', 'rZhong', 'bZhong'].contains(this.identity) && targets[i] != this) {\r\n\t\t\t\t\t\t\t\t\teffect += 0.1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (effect > 0) {\r\n\t\t\t\t\t\t\tif (effect < 1) c = 0.5;\r\n\t\t\t\t\t\t\telse c = 1;\r\n\t\t\t\t\t\t\tif (targets.length == 1 && targets[0] == this);\r\n\t\t\t\t\t\t\telse if (targets.length == 1) this.ai.shown += 0.2 * c;\r\n\t\t\t\t\t\t\telse this.ai.shown += 0.1 * c;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (effect < 0 && this == game.me && ['nei', 'rYe', 'bYe'].contains(game.me.identity)) {\r\n\t\t\t\t\t\t\tif (targets.length == 1 && targets[0] == this);\r\n\t\t\t\t\t\t\telse if (targets.length == 1) this.ai.shown -= 0.2;\r\n\t\t\t\t\t\t\telse this.ai.shown -= 0.1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this != game.me) this.ai.shown *= 2;\r\n\t\t\t\t\tif (this.ai.shown > 0.95) this.ai.shown = 0.95;\r\n\t\t\t\t\tif (this.ai.shown < -0.5) this.ai.shown = -0.5;\r\n\t\t\t\t\tif (_status.mode == 'purple') return;\r\n\r\n\t\t\t\t\tvar marknow = (!_status.connectMode && this != game.me && get.config('auto_mark_identity') && this.ai.identity_mark != 'finished');\r\n\t\t\t\t\t// if(true){\r\n\t\t\t\t\tif (marknow && _status.clickingidentity && _status.clickingidentity[0] == this) {\r\n\t\t\t\t\t\tfor (var i = 0; i < _status.clickingidentity[1].length; i++) {\r\n\t\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!Array.isArray(targets)) {\r\n\t\t\t\t\t\ttargets = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar effect = 0, c, shown;\r\n\t\t\t\t\tvar zhu = game.zhu;\r\n\t\t\t\t\tif (_status.mode == 'zhong' && !game.zhu.isZhu) {\r\n\t\t\t\t\t\tzhu = game.zhong;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (targets.length == 1 && targets[0] == this) {\r\n\t\t\t\t\t\teffect = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this.identity != 'nei') {\r\n\t\t\t\t\t\tif (this.ai.shown > 0) {\r\n\t\t\t\t\t\t\tif (this.identity == 'fan') {\r\n\t\t\t\t\t\t\t\teffect = -1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\teffect = 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (targets.length > 0) {\r\n\t\t\t\t\t\tfor (var i = 0; i < targets.length; i++) {\r\n\t\t\t\t\t\t\tshown = Math.abs(targets[i].ai.shown);\r\n\t\t\t\t\t\t\tif (shown < 0.2 || targets[i].identity == 'nei') c = 0;\r\n\t\t\t\t\t\t\telse if (shown < 0.4) c = 0.5;\r\n\t\t\t\t\t\t\telse if (shown < 0.6) c = 0.8;\r\n\t\t\t\t\t\t\telse c = 1;\r\n\t\t\t\t\t\t\teffect += get.effect(targets[i], card, this, zhu) * c;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.identity == 'nei') {\r\n\t\t\t\t\t\tif (effect > 0) {\r\n\t\t\t\t\t\t\tif (this.ai.identity_mark == 'fan') {\r\n\t\t\t\t\t\t\t\tif (marknow) this.setIdentity();\r\n\t\t\t\t\t\t\t\tthis.ai.identity_mark = 'finished';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (marknow) this.setIdentity('zhong');\r\n\t\t\t\t\t\t\t\tthis.ai.identity_mark = 'zhong';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (effect < 0 && get.population('fan') > 0) {\r\n\t\t\t\t\t\t\tif (this.ai.identity_mark == 'zhong') {\r\n\t\t\t\t\t\t\t\tif (marknow) this.setIdentity();\r\n\t\t\t\t\t\t\t\tthis.ai.identity_mark = 'finished';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (marknow) this.setIdentity('fan');\r\n\t\t\t\t\t\t\t\tthis.ai.identity_mark = 'fan';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (marknow) {\r\n\t\t\t\t\t\tif (effect > 0 && this.identity != 'fan') {\r\n\t\t\t\t\t\t\tthis.setIdentity('zhong');\r\n\t\t\t\t\t\t\tthis.ai.identity_mark = 'finished';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (effect < 0 && this.identity == 'fan') {\r\n\t\t\t\t\t\t\tthis.setIdentity('fan');\r\n\t\t\t\t\t\t\tthis.ai.identity_mark = 'finished';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// }\r\n\r\n\t\t\t\t},\r\n\t\t\t\tshowIdentity: function () {\r\n\t\t\t\t\tthis.node.identity.classList.remove('guessing');\r\n\t\t\t\t\tthis.identityShown = true;\r\n\t\t\t\t\tthis.ai.shown = 1;\r\n\t\t\t\t\tthis.setIdentity();\r\n\t\t\t\t\tif (this.special_identity) {\r\n\t\t\t\t\t\tthis.node.identity.firstChild.innerHTML = get.translation(this.special_identity + '_bg');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.identity == 'zhu') {\r\n\t\t\t\t\t\tthis.isZhu = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tdelete this.isZhu;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (_status.clickingidentity) {\r\n\t\t\t\t\t\tfor (var i = 0; i < _status.clickingidentity[1].length; i++) {\r\n\t\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tget: {\r\n\t\t\trawAttitude: function (from, to) {\r\n\t\t\t\tvar x = 0, num = 0, temp, i;\r\n\t\t\t\tif (_status.ai.customAttitude) {\r\n\t\t\t\t\tfor (i = 0; i < _status.ai.customAttitude.length; i++) {\r\n\t\t\t\t\t\ttemp = _status.ai.customAttitude[i](from, to);\r\n\t\t\t\t\t\tif (temp != undefined) {\r\n\t\t\t\t\t\t\tx += temp;\r\n\t\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (num) {\r\n\t\t\t\t\treturn x / num;\r\n\t\t\t\t}\r\n\t\t\t\tif (_status.mode == 'purple') {\r\n\t\t\t\t\tvar real = get.realAttitude(from, to);\r\n\t\t\t\t\tif (from == to || to.identityShown || from.$.zhibi && from.$.zhibi.contains(to) || (_status.yeconfirm && ['rYe', 'bYe'].contains(to.identity) && ['rYe', 'bYe'].contains(to.identity))) return real * 1.1;\r\n\t\t\t\t\treturn ((to.ai.shown + 0.1) * real + (from.identity.slice(0, 1) == to.identity.slice(0, 1) ? 3 : -3) * (1 - to.ai.shown))\r\n\t\t\t\t}\r\n\t\t\t\tvar difficulty = 0;\r\n\t\t\t\tif (to == game.me) difficulty = 2 - get.difficulty();\r\n\t\t\t\tif (from == to || to.identityShown || (from.$.dongcha == to) || to.identityShown || from.$.zhibi && from.$.zhibi.contains(to)) {\r\n\t\t\t\t\treturn get.realAttitude(from, to) + difficulty * 1.5;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (from.identity == 'zhong' && to.ai.shown == 0 && from.ai.tempIgnore &&\r\n\t\t\t\t\t\t!from.ai.tempIgnore.contains(to)) {\r\n\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\tif (game.players[i].ai.shown == 0 && game.players[i].identity == 'fan') {\r\n\t\t\t\t\t\t\t\treturn -0.1 + difficulty * 1.5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar aishown = to.ai.shown;\r\n\t\t\t\t\tif (to.identity == 'nei' && to.ai.shown < 1 && (to.ai.identity_mark == 'fan' || to.ai.identity_mark == 'zhong')) {\r\n\t\t\t\t\t\taishown = 0.5;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (aishown == 0 && to.identity != 'fan' && to.identity != 'zhu') {\r\n\t\t\t\t\t\tvar fanshown = true;\r\n\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\tif (game.players[i].identity == 'fan' && game.players[i].ai.shown == 0 && game.players[i] != from) {\r\n\t\t\t\t\t\t\t\tfanshown = false; break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (fanshown) aishown = 0.3;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn get.realAttitude(from, to) * aishown + difficulty * 1.5;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\trealAttitude: function (from, to) {\r\n\t\t\t\tif (_status.mode == 'purple') {\r\n\t\t\t\t\tif (['rZhu', 'rZhong', 'bNei'].contains(from.identity)) {\r\n\t\t\t\t\t\tif (to.identity == 'rZhu') return 8;\r\n\t\t\t\t\t\tif (['rZhong', 'bNei'].contains(to.identity)) return 7;\r\n\t\t\t\t\t\treturn -7;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (['bZhu', 'bZhong', 'rNei'].contains(from.identity)) {\r\n\t\t\t\t\t\tif (to.identity == 'bZhu') return 8;\r\n\t\t\t\t\t\tif (['bZhong', 'rNei'].contains(to.identity)) return 7;\r\n\t\t\t\t\t\treturn -7;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (['rYe', 'bYe'].contains(to.identity)) return 7;\r\n\t\t\t\t\t\tif (['rZhu', 'bZhu'].contains(to.identity) && game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\treturn ['rZhong', 'bZhong', 'rNei', 'bNei'].contains(current.identity);\r\n\t\t\t\t\t\t})) return 6.5;\r\n\t\t\t\t\t\treturn -7;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!game.zhu) {\r\n\t\t\t\t\tif (from.identity == 'nei' || to.identity == 'nei') return -1;\r\n\t\t\t\t\tif (from.identity == to.identity) return 6;\r\n\t\t\t\t\treturn -6;\r\n\t\t\t\t}\r\n\t\t\t\tvar situation = get.situation();\r\n\t\t\t\tvar identity = from.identity;\r\n\t\t\t\tvar identity2 = to.identity;\r\n\t\t\t\tif (identity2 == 'zhu' && !to.isZhu) {\r\n\t\t\t\t\tidentity2 = 'zhong';\r\n\t\t\t\t\tif (from == to) return 10;\r\n\t\t\t\t}\r\n\t\t\t\tif (from != to && to.identity == 'nei' && to.ai.shown < 1 && (to.ai.identity_mark == 'fan' || to.ai.identity_mark == 'zhong')) {\r\n\t\t\t\t\tidentity2 = to.ai.identity_mark;\r\n\t\t\t\t}\r\n\t\t\t\tif (from.identity != 'nei' && from != to && get.population('fan') == 0 && identity2 == 'zhong') {\r\n\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\tif (game.players[i].identity == 'nei' &&\r\n\t\t\t\t\t\t\tgame.players[i].ai.identity_mark == 'zhong' &&\r\n\t\t\t\t\t\t\tgame.players[i].ai.shown < 1) {\r\n\t\t\t\t\t\t\tidentity2 = 'nei'; break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar zhongmode = false;\r\n\t\t\t\tif (!game.zhu.isZhu) {\r\n\t\t\t\t\tzhongmode = true;\r\n\t\t\t\t}\r\n\t\t\t\tswitch (identity) {\r\n\t\t\t\t\tcase 'zhu':\r\n\t\t\t\t\t\tswitch (identity2) {\r\n\t\t\t\t\t\t\tcase 'zhu': return 10;\r\n\t\t\t\t\t\t\tcase 'zhong': case 'mingzhong': return 6;\r\n\t\t\t\t\t\t\tcase 'nei':\r\n\t\t\t\t\t\t\t\tif (game.players.length == 2) return -10;\r\n\t\t\t\t\t\t\t\tif (to.identity == 'zhong') return 0;\r\n\t\t\t\t\t\t\t\tif (get.population('fan') == 0) {\r\n\t\t\t\t\t\t\t\t\tif (to.ai.identity_mark == 'zhong' && to.ai.shown < 1) return 0;\r\n\t\t\t\t\t\t\t\t\treturn -0.5;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (zhongmode && to.ai.sizhong && to.ai.shown < 1) return 6;\r\n\t\t\t\t\t\t\t\tif (get.population('fan') == 1 && get.population('nei') == 1 && game.players.length == 3) {\r\n\t\t\t\t\t\t\t\t\tvar fan;\r\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\tif (game.players[i].identity == 'fan') {\r\n\t\t\t\t\t\t\t\t\t\t\tfan = game.players[i]; break;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (fan) {\r\n\t\t\t\t\t\t\t\t\t\tif (to.hp > 1 && to.hp > fan.hp && to.countCards('he') > fan.countCards('he')) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn -3;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (situation > 1) return 0;\r\n\t\t\t\t\t\t\t\treturn Math.min(3, get.population('fan'));\r\n\t\t\t\t\t\t\tcase 'fan':\r\n\t\t\t\t\t\t\t\tif (get.population('fan') == 1 && get.population('nei') == 1 && game.players.length == 3) {\r\n\t\t\t\t\t\t\t\t\tvar nei;\r\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\tif (game.players[i].identity == 'nei') {\r\n\t\t\t\t\t\t\t\t\t\t\tnei = game.players[i]; break;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (nei) {\r\n\t\t\t\t\t\t\t\t\t\tif (nei.hp > 1 && nei.hp > to.hp && nei.countCards('he') > to.countCards('he')) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn -3;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn -4;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'zhong': case 'mingzhong':\r\n\t\t\t\t\t\tswitch (identity2) {\r\n\t\t\t\t\t\t\tcase 'zhu': return 10;\r\n\t\t\t\t\t\t\tcase 'zhong': case 'mingzhong': return 4;\r\n\t\t\t\t\t\t\tcase 'nei':\r\n\t\t\t\t\t\t\t\tif (get.population('fan') == 0) return -2;\r\n\t\t\t\t\t\t\t\tif (zhongmode && to.ai.sizhong && to.ai.shown < 1) return 6;\r\n\t\t\t\t\t\t\t\treturn Math.min(3, -situation);\r\n\t\t\t\t\t\t\tcase 'fan': return -8;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'nei':\r\n\t\t\t\t\t\tif (identity2 == 'zhu' && game.players.length == 2) return -10;\r\n\t\t\t\t\t\tif (from != to && identity2 != 'zhu' && game.players.length == 3) return -8;\r\n\t\t\t\t\t\tvar strategy = get.aiStrategy();\r\n\t\t\t\t\t\tif (strategy == 4) {\r\n\t\t\t\t\t\t\tif (from == to) return 10;\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar num;\r\n\t\t\t\t\t\tswitch (identity2) {\r\n\t\t\t\t\t\t\tcase 'zhu':\r\n\t\t\t\t\t\t\t\tif (strategy == 6) return -1;\r\n\t\t\t\t\t\t\t\tif (strategy == 5) return 10;\r\n\t\t\t\t\t\t\t\tif (to.hp <= 0) return 10;\r\n\t\t\t\t\t\t\t\tif (get.population('fan') == 1) {\r\n\t\t\t\t\t\t\t\t\tvar fan;\r\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\tif (game.players[i].identity == 'fan') {\r\n\t\t\t\t\t\t\t\t\t\t\tfan = game.players[i]; break;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (fan) {\r\n\t\t\t\t\t\t\t\t\t\tif (to.hp > 1 && to.hp > fan.hp && to.countCards('he') > fan.countCards('he')) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn -3;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tif (situation > 1 || get.population('fan') == 0) num = 0;\r\n\t\t\t\t\t\t\t\t\telse num = get.population('fan') + Math.max(0, 3 - game.zhu.hp);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (strategy == 2) num--;\r\n\t\t\t\t\t\t\t\tif (strategy == 3) num++;\r\n\t\t\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t\t\tcase 'zhong':\r\n\t\t\t\t\t\t\t\tif (strategy == 5) return Math.min(0, -situation);\r\n\t\t\t\t\t\t\t\tif (strategy == 6) return Math.max(-1, -situation);\r\n\t\t\t\t\t\t\t\tif (get.population('fan') == 0) num = -5;\r\n\t\t\t\t\t\t\t\telse if (situation <= 0) num = 0;\r\n\t\t\t\t\t\t\t\telse if (game.zhu && game.zhu.hp < 2) num = 0;\r\n\t\t\t\t\t\t\t\telse if (game.zhu && game.zhu.hp == 2) num = -1;\r\n\t\t\t\t\t\t\t\telse if (game.zhu && game.zhu.hp <= 2 && situation > 1) num = -1;\r\n\t\t\t\t\t\t\t\telse num = -2;\r\n\t\t\t\t\t\t\t\tif (zhongmode && situation < 2) {\r\n\t\t\t\t\t\t\t\t\tnum = 4;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (strategy == 2) num--;\r\n\t\t\t\t\t\t\t\tif (strategy == 3) num++;\r\n\t\t\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t\t\tcase 'mingzhong':\r\n\t\t\t\t\t\t\t\tif (zhongmode) {\r\n\t\t\t\t\t\t\t\t\tif (from.ai.sizhong == undefined) {\r\n\t\t\t\t\t\t\t\t\t\tfrom.ai.sizhong = (Math.random() < 0.5);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (from.ai.sizhong) return 6;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (strategy == 5) return Math.min(0, -situation);\r\n\t\t\t\t\t\t\t\tif (strategy == 6) return Math.max(-1, -situation);\r\n\t\t\t\t\t\t\t\tif (get.population('fan') == 0) num = -5;\r\n\t\t\t\t\t\t\t\telse if (situation <= 0) num = 0;\r\n\t\t\t\t\t\t\t\telse num = -3;\r\n\t\t\t\t\t\t\t\tif (strategy == 2) num--;\r\n\t\t\t\t\t\t\t\tif (strategy == 3) num++;\r\n\t\t\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t\t\tcase 'nei':\r\n\t\t\t\t\t\t\t\tif (from == to) return 10;\r\n\t\t\t\t\t\t\t\tif (from.ai.friend.contains(to)) return 5;\r\n\t\t\t\t\t\t\t\tif (get.population('fan') + get.population('zhong') > 0) return 0;\r\n\t\t\t\t\t\t\t\treturn -5;\r\n\t\t\t\t\t\t\tcase 'fan':\r\n\t\t\t\t\t\t\t\tif (strategy == 5) return Math.max(-1, situation);\r\n\t\t\t\t\t\t\t\tif (strategy == 6) return Math.min(0, situation);\r\n\t\t\t\t\t\t\t\tif ((game.zhu && game.zhu.hp <= 2 && situation < 0) || situation < -1) num = -3;\r\n\t\t\t\t\t\t\t\telse if (situation < 0 || get.population('zhong') + get.population('mingzhong') == 0) num = -2;\r\n\t\t\t\t\t\t\t\telse if ((game.zhu && game.zhu.hp >= 4 && situation > 0) || situation > 1) num = 1;\r\n\t\t\t\t\t\t\t\telse num = 0;\r\n\t\t\t\t\t\t\t\tif (strategy == 2) num++;\r\n\t\t\t\t\t\t\t\tif (strategy == 3) num--;\r\n\t\t\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'fan':\r\n\t\t\t\t\t\tswitch (identity2) {\r\n\t\t\t\t\t\t\tcase 'zhu':\r\n\t\t\t\t\t\t\t\tif (get.population('nei') > 0) {\r\n\t\t\t\t\t\t\t\t\tif (situation == 1) return -6;\r\n\t\t\t\t\t\t\t\t\tif (situation > 1) return -5;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn -8;\r\n\t\t\t\t\t\t\tcase 'zhong':\r\n\t\t\t\t\t\t\t\tif (!zhongmode && game.zhu.hp >= 3 && to.hp == 1) {\r\n\t\t\t\t\t\t\t\t\treturn -10;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn -7;\r\n\t\t\t\t\t\t\tcase 'mingzhong': return -5;\r\n\t\t\t\t\t\t\tcase 'nei':\r\n\t\t\t\t\t\t\t\tif (zhongmode && to.ai.sizhong) return -7;\r\n\t\t\t\t\t\t\t\tif (get.population('fan') == 1) return 0;\r\n\t\t\t\t\t\t\t\tif (get.population('zhong') + get.population('mingzhong') == 0) return -7;\r\n\t\t\t\t\t\t\t\tif (game.zhu && game.zhu.hp <= 2) return -1;\r\n\t\t\t\t\t\t\t\treturn Math.min(3, situation);\r\n\t\t\t\t\t\t\tcase 'fan': return 5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsituation: function (absolute) {\r\n\t\t\t\tvar i, j, player;\r\n\t\t\t\tvar zhuzhong = 0, total = 0, zhu, fan = 0;\r\n\t\t\t\tfor (i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\tplayer = game.players[i];\r\n\t\t\t\t\tvar php = player.hp;\r\n\t\t\t\t\tif (player.hasSkill('benghuai') && php > 4) {\r\n\t\t\t\t\t\tphp = 4;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (php > 6) {\r\n\t\t\t\t\t\tphp = 6;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tj = player.countCards('h') + player.countCards('e') * 1.5 + php * 2;\r\n\t\t\t\t\tif (player.identity == 'zhu') {\r\n\t\t\t\t\t\tzhuzhong += j * 1.2 + 5;\r\n\t\t\t\t\t\ttotal += j * 1.2 + 5;\r\n\t\t\t\t\t\tzhu = j;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (player.identity == 'zhong' || player.identity == 'mingzhong') {\r\n\t\t\t\t\t\tzhuzhong += j * 0.8 + 3;\r\n\t\t\t\t\t\ttotal += j * 0.8 + 3;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (player.identity == 'fan') {\r\n\t\t\t\t\t\tzhuzhong -= j + 4;\r\n\t\t\t\t\t\ttotal += j + 4;\r\n\t\t\t\t\t\tfan += j + 4;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (absolute) return zhuzhong;\r\n\t\t\t\tvar result = parseInt(10 * Math.abs(zhuzhong / total));\r\n\t\t\t\tif (zhuzhong < 0) result = -result;\r\n\t\t\t\tif (!game.zhong) {\r\n\t\t\t\t\tif (zhu < 12 && fan > 30) result--;\r\n\t\t\t\t\tif (zhu < 6 && fan > 15) result--;\r\n\t\t\t\t\tif (zhu < 4) result--;\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t},\r\n\t\t},\r\n\t\tskill: {\r\n\t\t\tyexinbilu: {\r\n\t\t\t\tenable: 'phaseUse',\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn player.identity == 'rYe' || player.identity == 'bYe';\r\n\t\t\t\t},\r\n\t\t\t\tskillAnimation: 'legend',\r\n\t\t\t\tanimationColor: 'thunder',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\tgame.removeGlobalSkill('yexinbilu');\r\n\t\t\t\t\tplayer.yexinbilu();\r\n\t\t\t\t},\r\n\t\t\t\tai: {\r\n\t\t\t\t\torder: 10,\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\tplayer: function (player) {\r\n\t\t\t\t\t\t\treturn 1 - game.countPlayer(function (current) {\r\n\t\t\t\t\t\t\t\treturn current != player && (current.identity == 'rYe' || current.identity == 'bYe') && (current == game.me || current.isOnline());\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tidentity_junshi: {\r\n\t\t\t\tname: '军师',\r\n\t\t\t\tmark: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: '准备阶段开始时，可以观看牌堆顶的三张牌，然后将这些牌以任意顺序置于牌堆顶或牌堆底'\r\n\t\t\t\t},\r\n\t\t\t\ttrigger: { player: 'phaseZhunbeiBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tif (player.isUnderControl()) {\r\n\t\t\t\t\t\tgame.swapPlayerAuto(player);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar num = 3;\r\n\t\t\t\t\tvar cards = get.cards(num);\r\n\t\t\t\t\tevent.cards = cards;\r\n\t\t\t\t\tvar switchToAuto = function () {\r\n\t\t\t\t\t\t_status.imchoosing = false;\r\n\t\t\t\t\t\tif (event.dialog) event.dialog.close();\r\n\t\t\t\t\t\tif (event.control) event.control.close();\r\n\t\t\t\t\t\tvar top = [];\r\n\t\t\t\t\t\tvar judges = player.getCards('j');\r\n\t\t\t\t\t\tvar stopped = false;\r\n\t\t\t\t\t\tif (!player.countCards('h', 'wuxie')) {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < judges.length; i++) {\r\n\t\t\t\t\t\t\t\tvar judge = get.judge(judges[i]);\r\n\t\t\t\t\t\t\t\tcards.sort(function (a, b) {\r\n\t\t\t\t\t\t\t\t\treturn judge(b) - judge(a);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif (judge(cards[0]) < 0) {\r\n\t\t\t\t\t\t\t\t\tstopped = true; break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\ttop.unshift(cards.shift());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar bottom;\r\n\t\t\t\t\t\tif (!stopped) {\r\n\t\t\t\t\t\t\tcards.sort(function (a, b) {\r\n\t\t\t\t\t\t\t\treturn get.value(b, player) - get.value(a, player);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\twhile (cards.length) {\r\n\t\t\t\t\t\t\t\tif (get.value(cards[0], player) <= 5) break;\r\n\t\t\t\t\t\t\t\ttop.unshift(cards.shift());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbottom = cards;\r\n\t\t\t\t\t\tfor (var i = 0; i < top.length; i++) {\r\n\t\t\t\t\t\t\tui.cardPile.insertBefore(top[i], ui.cardPile.firstChild);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (i = 0; i < bottom.length; i++) {\r\n\t\t\t\t\t\t\tui.cardPile.appendChild(bottom[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.popup(get.cnNumber(top.length) + '上' + get.cnNumber(bottom.length) + '下');\r\n\t\t\t\t\t\tgame.log(player, '将' + get.cnNumber(top.length) + '张牌置于牌堆顶');\r\n\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar chooseButton = function (online, player, cards) {\r\n\t\t\t\t\t\tvar event = _status.event;\r\n\t\t\t\t\t\tplayer = player || event.player;\r\n\t\t\t\t\t\tcards = cards || event.cards;\r\n\t\t\t\t\t\tevent.top = [];\r\n\t\t\t\t\t\tevent.bottom = [];\r\n\t\t\t\t\t\tevent.status = true;\r\n\t\t\t\t\t\tevent.dialog = ui.create.dialog('按顺序选择置于牌堆顶的牌（先选择的在上）', cards);\r\n\t\t\t\t\t\tfor (var i = 0; i < event.dialog.buttons.length; i++) {\r\n\t\t\t\t\t\t\tevent.dialog.buttons[i].classList.add('pointerdiv');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.switchToAuto = function () {\r\n\t\t\t\t\t\t\tevent._result = 'ai';\r\n\t\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\t\tevent.control.close();\r\n\t\t\t\t\t\t\t_status.imchoosing = false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tevent.control = ui.create.control('ok', 'pileTop', 'pileBottom', function (link) {\r\n\t\t\t\t\t\t\t\tvar event = _status.event;\r\n\t\t\t\t\t\t\t\tif (link == 'ok') {\r\n\t\t\t\t\t\t\t\t\tif (online) {\r\n\t\t\t\t\t\t\t\t\t\tevent._result = {\r\n\t\t\t\t\t\t\t\t\t\t\ttop: [],\r\n\t\t\t\t\t\t\t\t\t\t\tbottom: []\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < event.top.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\tevent._result.top.push(event.top[i].link);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < event.bottom.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\tevent._result.bottom.push(event.bottom[i].link);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tvar i;\r\n\t\t\t\t\t\t\t\t\t\tfor (i = 0; i < event.top.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\tui.cardPile.insertBefore(event.top[i].link, ui.cardPile.firstChild);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tfor (i = 0; i < event.bottom.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\tui.cardPile.appendChild(event.bottom[i].link);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tfor (i = 0; i < event.dialog.buttons.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (event.dialog.buttons[i].classList.contains('glow') == false &&\r\n\t\t\t\t\t\t\t\t\t\t\t\tevent.dialog.buttons[i].classList.contains('target') == false)\r\n\t\t\t\t\t\t\t\t\t\t\t\tui.cardPile.appendChild(event.dialog.buttons[i].link);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tplayer.popup(get.cnNumber(event.top.length) + '上' + get.cnNumber(event.cards.length - event.top.length) + '下');\r\n\t\t\t\t\t\t\t\t\t\tgame.log(player, '将' + get.cnNumber(event.top.length) + '张牌置于牌堆顶');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\t\t\t\tevent.control.close();\r\n\t\t\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t\t\t_status.imchoosing = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (link == 'pileTop') {\r\n\t\t\t\t\t\t\t\t\tevent.status = true;\r\n\t\t\t\t\t\t\t\t\tevent.dialog.content.childNodes[0].innerHTML = '按顺序选择置于牌堆顶的牌';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tevent.status = false;\r\n\t\t\t\t\t\t\t\t\tevent.dialog.content.childNodes[0].innerHTML = '按顺序选择置于牌堆底的牌';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\tfor (var i = 0; i < event.dialog.buttons.length; i++) {\r\n\t\t\t\t\t\t\tevent.dialog.buttons[i].classList.add('selectable');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.custom.replace.button = function (link) {\r\n\t\t\t\t\t\t\tvar event = _status.event;\r\n\t\t\t\t\t\t\tif (link.classList.contains('target')) {\r\n\t\t\t\t\t\t\t\tlink.classList.remove('target');\r\n\t\t\t\t\t\t\t\tevent.top.remove(link);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (link.classList.contains('glow')) {\r\n\t\t\t\t\t\t\t\tlink.classList.remove('glow');\r\n\t\t\t\t\t\t\t\tevent.bottom.remove(link);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (event.status) {\r\n\t\t\t\t\t\t\t\tlink.classList.add('target');\r\n\t\t\t\t\t\t\t\tevent.top.unshift(link);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tlink.classList.add('glow');\r\n\t\t\t\t\t\t\t\tevent.bottom.push(link);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.custom.replace.window = function () {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < _status.event.dialog.buttons.length; i++) {\r\n\t\t\t\t\t\t\t\t_status.event.dialog.buttons[i].classList.remove('target');\r\n\t\t\t\t\t\t\t\t_status.event.dialog.buttons[i].classList.remove('glow');\r\n\t\t\t\t\t\t\t\t_status.event.top.length = 0;\r\n\t\t\t\t\t\t\t\t_status.event.bottom.length = 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t\tgame.countChoose();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.switchToAuto = switchToAuto;\r\n\r\n\t\t\t\t\tif (event.isMine()) {\r\n\t\t\t\t\t\tchooseButton();\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (event.isOnline()) {\r\n\t\t\t\t\t\tevent.player.send(chooseButton, true, event.player, event.cards);\r\n\t\t\t\t\t\tevent.player.wait();\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.switchToAuto();\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif (event.result == 'ai' || !event.result) {\r\n\t\t\t\t\t\tevent.switchToAuto();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar top = event.result.top || [];\r\n\t\t\t\t\t\tvar bottom = event.result.bottom || [];\r\n\t\t\t\t\t\tfor (var i = 0; i < top.length; i++) {\r\n\t\t\t\t\t\t\tui.cardPile.insertBefore(top[i], ui.cardPile.firstChild);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (i = 0; i < bottom.length; i++) {\r\n\t\t\t\t\t\t\tui.cardPile.appendChild(bottom[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (i = 0; i < event.cards.length; i++) {\r\n\t\t\t\t\t\t\tif (!top.contains(event.cards[i]) && !bottom.contains(event.cards[i])) {\r\n\t\t\t\t\t\t\t\tui.cardPile.appendChild(event.cards[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.popup(get.cnNumber(top.length) + '上' + get.cnNumber(event.cards.length - top.length) + '下');\r\n\t\t\t\t\t\tgame.log(player, '将' + get.cnNumber(top.length) + '张牌置于牌堆顶');\r\n\t\t\t\t\t\tgame.delay(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tidentity_dajiang: {\r\n\t\t\t\tname: '大将',\r\n\t\t\t\tmark: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: '手牌上限+1'\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tmaxHandcard: function (player, num) {\r\n\t\t\t\t\t\treturn num + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tidentity_zeishou: {\r\n\t\t\t\tname: '贼首',\r\n\t\t\t\tmark: true,\r\n\t\t\t\tintro: {\r\n\t\t\t\t\tcontent: '手牌上限-1'\r\n\t\t\t\t},\r\n\t\t\t\tmod: {\r\n\t\t\t\t\tmaxHandcard: function (player, num) {\r\n\t\t\t\t\t\treturn num - 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdongcha: {\r\n\t\t\t\ttrigger: { player: 'phaseBegin' },\r\n\t\t\t\tdirect: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn game.hasPlayer(function (current) {\r\n\t\t\t\t\t\treturn current.countCards('ej');\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tforceunique: true,\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('dongcha'), function (card, player, target) {\r\n\t\t\t\t\t\treturn target.countCards('ej') > 0;\r\n\t\t\t\t\t}).set('ai', function (target) {\r\n\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\tvar att = get.attitude(player, target);\r\n\r\n\t\t\t\t\t\tif (att > 0) {\r\n\t\t\t\t\t\t\tvar js = target.getCards('j');\r\n\t\t\t\t\t\t\tif (js.length) {\r\n\t\t\t\t\t\t\t\tvar jj = js[0].viewAs ? { name: js[0].viewAs } : js[0];\r\n\t\t\t\t\t\t\t\tif (jj.name == 'guohe' || js.length > 1 || get.effect(target, jj, target, player) < 0) {\r\n\t\t\t\t\t\t\t\t\treturn 2 * att;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (target.getEquip('baiyin') && target.isDamaged() &&\r\n\t\t\t\t\t\t\t\tget.recoverEffect(target, player, player) > 0) {\r\n\t\t\t\t\t\t\t\tif (target.hp == 1 && !target.hujia) return 1.6 * att;\r\n\t\t\t\t\t\t\t\tif (target.hp == 2) return 0.01 * att;\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar es = target.getCards('e');\r\n\t\t\t\t\t\tvar noe = target.hasSkillTag('noe');\r\n\t\t\t\t\t\tvar noe2 = (es.length == 1 && es[0].name == 'baiyin' && target.isDamaged());\r\n\t\t\t\t\t\tif (noe || noe2) return 0;\r\n\t\t\t\t\t\tif (att <= 0 && !es.length) return 1.5 * att;\r\n\t\t\t\t\t\treturn -1.5 * att;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tevent.target = result.targets[0];\r\n\t\t\t\t\t\tevent.target.addExpose(0.1);\r\n\t\t\t\t\t\tplayer.logSkill('dongcha', event.target);\r\n\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (event.target) {\r\n\t\t\t\t\t\tplayer.discardPlayerCard('ej', true, event.target);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgroup: ['dongcha_begin', 'dongcha_log'],\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\tbegin: {\r\n\t\t\t\t\t\ttrigger: { global: 'gameStart' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tpopup: false,\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\tvar list = [];\r\n\t\t\t\t\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\t\t\t\t\tif (game.players[i].identity == 'fan') {\r\n\t\t\t\t\t\t\t\t\tlist.push(game.players[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar target = list.randomGet();\r\n\t\t\t\t\t\t\tplayer.$.dongcha = target;\r\n\t\t\t\t\t\t\tif (!_status.connectMode) {\r\n\t\t\t\t\t\t\t\tif (player == game.me) {\r\n\t\t\t\t\t\t\t\t\ttarget.setIdentity('fan');\r\n\t\t\t\t\t\t\t\t\ttarget.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\t\t\t\ttarget.fanfixed = true;\r\n\t\t\t\t\t\t\t\t\tplayer.line(target, 'green');\r\n\t\t\t\t\t\t\t\t\tplayer.popup('dongcha');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tplayer.chooseControl('ok').set('dialog', [get.translation(target) + '是反贼', [[target.name], 'character']]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlog: {\r\n\t\t\t\t\t\ttrigger: { player: 'useCard' },\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tpopup: false,\r\n\t\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\t\treturn event.targets.length == 1 && event.targets[0] == player.$.dongcha && event.targets[0].ai.shown < 0.95;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function () {\r\n\t\t\t\t\t\t\ttrigger.targets[0].addExpose(0.2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsheshen: {\r\n\t\t\t\ttrigger: { global: 'dieBefore' },\r\n\t\t\t\tforced: true,\r\n\t\t\t\tunique: true,\r\n\t\t\t\tforceunique: true,\r\n\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\treturn event.player == game.zhu && player.hp > 0;\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget: 'player',\r\n\t\t\t\tcontent: function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\ttrigger.player.gainMaxHp();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar dh = player.hp - trigger.player.hp;\r\n\t\t\t\t\tif (dh > 0) {\r\n\t\t\t\t\t\ttrigger.player.recover(dh);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar cards = player.getCards('he');\r\n\t\t\t\t\tif (cards.length) {\r\n\t\t\t\t\t\ttrigger.player.gain(cards, player);\r\n\t\t\t\t\t\tplayer.$giveAuto(cards, trigger.player);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\tplayer.die();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\thelp: {\r\n\t\t\t'身份模式': '<div style=\"margin:10px\">选项</div><ul style=\"margin-top:0\"><li>加强主公<br>反贼人数多于2时主公会额外增加一个技能（每个主公的额外技能固定，非常备主公增加天命）<li>特殊身份<br><ul style=\"padding-left:20px;padding-top:5px\"><li>军师：忠臣身份。只要军师存活，主公在准备阶段开始时，可以观看牌堆顶的三张牌，然后将这些牌以任意顺序置于牌堆顶或牌堆底<li>大将：忠臣身份。只要大将存活，主公手牌上限+1<li>贼首：反贼身份，只要贼首存活，主公手牌上限-1</ul></ul>',\r\n\t\t\t'明忠模式': '<div style=\"margin:10px\">明忠模式（忠胆英杰）</div><ul style=\"margin-top:0\"><li>本模式需要8名玩家进行游戏，使用的身份牌为：1主公、2忠臣、4反贼和1内奸。游戏开始时，每名玩家随机获得一个身份，由系统随机选择一名忠臣身份的玩家亮出身份（将忠臣牌正面朝上放在面前），其他身份（包括主公）的玩家不亮出身份。<li>' +\r\n\t\t\t\t'首先由亮出身份的忠臣玩家随机获得六张武将牌，挑选一名角色，并将选好的武将牌展示给其他玩家。之后其余每名玩家随机获得三张武将牌，各自从其中挑选一张同时亮出<li>' +\r\n\t\t\t\t'亮出身份牌的忠臣增加1点体力上限。角色濒死和死亡的结算及胜利条件与普通身份局相同。',\r\n\t\t\t'3v3v2': '<div style=\"margin:10px\">3v3v2模式</div><ul style=\"margin-top:0\"><li>游戏准备<br>本模式需要8名玩家进行游戏。游戏开始前，所有玩家随机分成两组，每组四人，分别称为「冷色阵营」和「暖色阵营」，然后分发身份牌，抽取到「主帅」身份的玩家亮出身份牌。' +\r\n\t\t\t\t'<li>身份牌<br>每组的身份分为四种。<br>主帅（主）和前锋（忠）：联合对方阵营的细作，击杀己方细作，对方阵营的主帅和前锋以及所有的野心家。<br>细作（内）：帮助对方阵营的主帅和前锋，击杀对方细作，己方阵营的主帅和前锋以及所有的野心家。<br>野心家（野）：联合对方阵营中的野心家，击杀所有其他角色，成为最后的生还者。<br>' +\r\n\t\t\t\t'<li>胜负判定<br>冷色主帅，先锋和暖色细作在所有野心家和对方主帅全部阵亡后视为胜利，在冷色主帅阵亡后视为游戏失败。<br>暖色主帅，先锋和冷色细作在所有野心家和对方主帅阵亡后视为胜利，在暖色主帅阵亡后视为失败。<br>野心家在所有不为野心家的角色阵亡后视为胜利，在双方主帅全部阵亡而有非野心家角色存活时失败。<br>当有角色阵亡后，若有角色满足胜利条件，游戏结束。若所有角色均满足失败条件，则游戏平局。若一名角色满足失败条件，即使其满足胜利条件，也视为游戏失败。<br>' +\r\n\t\t\t\t'<li>游戏流程<br>在「游戏准备」中的工作完成后，冷色主帅选择一个势力，然后暖色主帅选择一个其他势力，作为双方各自的势力将池。<br>双方主帅从各自的势力将池中获得两张常备主公武将牌和四张非常备主公武将牌，然后选择一张作为武将牌，将其他的武将牌放回势力将池并洗混。然后双方的其他玩家从各自的势力将池中随机获得五张武将牌，选择一张作为自己的武将牌。<br>暖色主帅成为游戏的一号位，双方主帅各加1点体力和体力上限。七号位和八号位的起始手牌+1。<br>当场上第一次有玩家死亡时，野心家确认彼此的身份牌，然后获得技能〖野心毕露〗：出牌阶段，你可以明置身份牌，加1点体力上限和体力值。若如此做，所有的野心家失去技能〖野心毕露〗<br>' + '<li>击杀奖惩<br>杀死颜色不同的主帅的角色回复1点体力，杀死颜色不同的先锋的角色摸两张牌，杀死颜色相同的细作的角色摸三张牌，杀死颜色相同的先锋的主帅弃置所有手牌。<br>' +\r\n\t\t\t\t'<li>制作团队<br>游戏出品：紫星居<br>游戏设计：食茸貳拾肆<br>游戏开发：食茸貳拾肆、紫髯的小乔、聆星Mine、空城琴音依旧弥漫、丽景原同志、雪之彩翼、拉普拉斯、明月照沟渠<br>程序化：无名杀<br>鸣谢：荆哲、魔风、萨巴鲁酱、这就是秋夜</ul></ul>',\r\n\t\t}\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/identity.js?")},"./src/mode/longlaoguan.js":function(){eval("\r\n\r\ngame.import('mode',function(lib,game,ui,get,ai,_status){\r\n\treturn {\r\n\t\tname:'longlaoguan',\r\n\t\tstart:function(){\r\n\t\t\t\"step 0\"\r\n\t\t\tvar playback=localStorage.getItem(lib.configprefix+'playback');\r\n\t\t\tif(playback){\r\n\t\t\t\tui.create.me();\r\n\t\t\t\tui.arena.style.display='none';\r\n\t\t\t\tui.system.style.display='none';\r\n\t\t\t\t_status.playback=playback;\r\n\t\t\t\tlocalStorage.removeItem(lib.configprefix+'playback');\r\n\t\t\t\tvar store=lib.db.transaction(['video'],'readwrite').objectStore('video');\r\n\t\t\t\tstore.get(parseInt(playback)).onsuccess=function(e){\r\n\t\t\t\t\tif(e.target.result){\r\n\t\t\t\t\t\tgame.playVideoContent(e.target.result.video);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\talert('播放失败：找不到录像');\r\n\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tevent.finish();\r\n\t\t\t}\r\n\t\t\telse if(!_status.connectMode){\r\n\t\t\t\tgame.prepareArena(4);\r\n\t\t\t}\r\n\t\t\t\"step 1\"\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\tgame.waitForPlayer(function(){\r\n\t\t\t\t\t\tlib.configOL.number=4;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\"step 2\"\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\tif(lib.configOL.number<4){\r\n\t\t\t\t\tlib.configOL.number=4;\r\n\t\t\t\t}\r\n\t\t\t\tvar list=[\r\n\t\t\t\t\t//3张独轮车\r\n\t\t\t\t\t[\"spade\",\"5\",\"dulun\"],\r\n\t\t\t\t\t[\"club\",\"9\",\"dulun\"],\r\n\t\t\t\t\t[\"diamond\",\"11\",\"dulun\"],\r\n\t\t\t\t\t//2张穿甲\r\n\t\t\t\t\t[\"heart\",\"13\",\"chuanjia\"],\r\n\t\t\t\t\t[\"club\",\"5\",\"chuanjia\"],\r\n\t\t\t\t\t//\r\n\t\t\t\t\t[\"diamond\",\"1\",\"zhinengdulun\"],\r\n\t\t\t\t\t//\r\n\t\t\t\t\t[\"spade\",\"2\",\"longjiao\"],\r\n\t\t\t\t\t//\r\n\t\t\t\t\t[\"spade\",\"6\",\"longwei\"],\r\n\t\t\t\t\t//\r\n\t\t\t\t\t//[\"heart\",\"10\",\"takeover\"],\r\n\t\t\t\t\t//2张逼宫\r\n\t\t\t\t\t[\"club\",\"9\",\"bigong\"],\r\n\t\t\t\t\t[\"heart\",\"8\",\"bigong\"],\r\n\t\t\t\t];\r\n\t\t\t\tlib.card.list.addArray(list);\r\n\t\t\t\tgame.fixedPile=true;\r\n\t\t\t\tgame.broadcastAll(function(pack1,pack2){\r\n\t\t\t\t\t//lib.connectCardPack.add('mode_longlaoguan');\r\n\t\t\t\t\t//console.log(lib.connectCardPack);\r\n\t\t\t\t\t//console.log(lib.card);\r\n\t\t\t\t\tlib.characterPack.mode_longlaoguan=pack1;\r\n\t\t\t\t\t//lib.card=pack2;\r\n\t\t\t\t\tfor(var i in pack1){\r\n\t\t\t\t\t\tlib.character[i]=pack1[i];\r\n\t\t\t\t\t\tif(!lib.character[i][4]){\r\n\t\t\t\t\t\t\tlib.character[i][4]=[];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!lib.translate[i]){\r\n\t\t\t\t\t\t\tlib.translate[i]=lib.translate[i.slice(3)];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},lib.characterPack.mode_longlaoguan,lib.card);\r\n\t\t\t\tgame.randomMapOL();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tgame.broadcastAll(function(pack1,pack2){\r\n\t\t\t\t\tlib.characterPack.mode_longlaoguan=pack1;\r\n\t\t\t\t\tlib.cardPack.mode_longlaoguan=pack2\r\n\t\t\t\t\tvar list=[\r\n\t\t\t\t\t\t//3张独轮车\r\n\t\t\t\t\t\t[\"spade\",\"5\",\"dulun\"],\r\n\t\t\t\t\t\t[\"club\",\"9\",\"dulun\"],\r\n\t\t\t\t\t\t[\"diamond\",\"11\",\"dulun\"],\r\n\t\t\t\t\t\t//2张穿甲\r\n\t\t\t\t\t\t[\"heart\",\"13\",\"chuanjia\"],\r\n\t\t\t\t\t\t[\"club\",\"5\",\"chuanjia\"],\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t[\"diamond\",\"1\",\"zhinengdulun\"],\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t[\"spade\",\"2\",\"longjiao\"],\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t[\"spade\",\"6\",\"longwei\"],\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t//[\"heart\",\"10\",\"takeover\"],\r\n\t\t\t\t\t\t//2张逼宫\r\n\t\t\t\t\t\t[\"club\",\"9\",\"bigong\"],\r\n\t\t\t\t\t\t[\"heart\",\"8\",\"bigong\"],\r\n\t\t\t\t\t];\r\n\t\t\t\t\tlib.card.list.addArray(list);\r\n\t\t\t\t\tui.create.cardsAsync();\r\n\t\t\t\t\tgame.fixedPile=true;\r\n\t\t\t\t\tfor(var i in pack1){\r\n\t\t\t\t\t\t// if(!lib.configOL.onlyguozhan){\r\n\t\t\t\t\t\t// \tif(lib.character[i.slice(3)]) continue;\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\tlib.character[i]=pack1[i];\r\n\t\t\t\t\t\tif(!lib.character[i][4]){\r\n\t\t\t\t\t\t\tlib.character[i][4]=[];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!lib.translate[i]){\r\n\t\t\t\t\t\t\tlib.translate[i]=lib.translate[i.slice(3)];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},lib.characterPack.mode_longlaoguan,lib.cardPack.mode_longlaoguan);\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacter();\r\n\t\t\t}\r\n\t\t\t\"step 3\"\r\n\t\t\tif(ui.coin){\r\n\t\t\t\t_status.coinCoeff=get.coinCoeff([game.me.name]);\r\n\t\t\t}\r\n\t\t\tgame.showIdentity(true);\r\n\t\t\tvar map={};\r\n\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\tmap[i]=lib.playerOL[i].identity;\r\n\t\t\t}\r\n\t\t\tgame.broadcast(function(map){\r\n\t\t\t\tfor(var i in map){\r\n\t\t\t\t\tlib.playerOL[i].identity=map[i];\r\n\t\t\t\t\tlib.playerOL[i].setIdentity();\r\n\t\t\t\t\tlib.playerOL[i].ai.shown=1;\r\n\t\t\t\t}\r\n\t\t\t},map);\r\n\t\t\t\r\n\t\t\tgame.syncState();\r\n\t\t\tevent.trigger('gameStart');\r\n\t\t\t\r\n\t\t\tvar players=get.players(lib.sort.position);\r\n\t\t\tvar info=[];\r\n\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\tinfo.push({\r\n\t\t\t\t\tname:players[i].name,\r\n\t\t\t\t\tname2:players[i].name2,\r\n\t\t\t\t\tidentity:players[i].identity\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t_status.videoInited=true;\r\n\t\t\tgame.addVideo('init',null,info);\r\n\r\n\t\t\tgame.gameDraw(game.zhu||_status.firstAct||game.me);\r\n\t\t\tif(_status.connectMode&&lib.configOL.change_card) game.replaceHandcards(game.players.slice(0));\r\n\t\t\t\"step 4\"\r\n\t\t\tevent.trigger('phaseLoopBefore');\r\n\t\t\t\"step 5\"\r\n\t\t\tgame.phaseLoopLonglaoguan(game.zhu||_status.firstAct||game.me);\r\n\t\t\tgame.zhu.showGiveup();\r\n\t\t},\r\n\t\tgame:{\r\n\t\t\taddRecord:function(bool){\r\n\t\t\t\tif(typeof bool=='boolean'){\r\n\t\t\t\t\tvar data=lib.config.gameRecord.longlaoguan.data;\r\n\t\t\t\t\tvar identity=game.me.identity;\r\n\t\t\t\t\tif(!data[identity]){\r\n\t\t\t\t\t\tdata[identity]=[0,0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(bool){\r\n\t\t\t\t\t\tdata[identity][0]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tdata[identity][1]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list=['zhu','fan'];\r\n\t\t\t\t\tvar str='';\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(data[list[i]]){\r\n\t\t\t\t\t\t\tstr+=lib.translate[list[i]+'2']+'：'+data[list[i]][0]+'胜'+' '+data[list[i]][1]+'负<br>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.config.gameRecord.longlaoguan.str=str;\r\n\t\t\t\t\tgame.saveConfig('gameRecord',lib.config.gameRecord);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetState:function(){\r\n\t\t\t\tvar state={};\r\n\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\tstate[i]={identity:player.identity};\r\n\t\t\t\t}\r\n\t\t\t\treturn state;\r\n\t\t\t},\r\n\t\t\tupdateState:function(state){\r\n\t\t\t\tfor(var i in state){\r\n\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\tif(player){\r\n\t\t\t\t\t\tplayer.identity=state[i].identity;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetRoomInfo:function(uiintro){\r\n\t\t\t\tuiintro.add('<div class=\"text chat\">双将模式：'+(lib.configOL.double_character?'开启':'关闭'));\r\n\t\t\t\t// uiintro.add('<div class=\"text chat\">屏蔽弱将：'+(lib.configOL.ban_weak?'开启':'关闭'));\r\n\t\t\t\t// var last=uiintro.add('<div class=\"text chat\">屏蔽强将：'+(lib.configOL.ban_strong?'开启':'关闭'));\r\n\t\t\t\tif(lib.configOL.banned.length){\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">禁用武将：'+get.translation(lib.configOL.banned));\r\n\t\t\t\t}\r\n\t\t\t\tif(lib.configOL.bannedcards.length){\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">禁用卡牌：'+get.translation(lib.configOL.bannedcards));\r\n\t\t\t\t}\r\n\t\t\t\tuiintro.style.paddingBottom='8px';\r\n\t\t\t},\r\n\t\t\tgetVideoName:function(){\r\n\t\t\t\tvar str=get.translation(game.me.name);\r\n\t\t\t\tif(game.me.name2){\r\n\t\t\t\t\tstr+='/'+get.translation(game.me.name2);\r\n\t\t\t\t}\r\n\t\t\t\tvar name=[\r\n\t\t\t\t\tstr,\r\n\t\t\t\t\t'龙牢关'+' - '+lib.translate[game.me.identity+'2']\r\n\t\t\t\t];\r\n\t\t\t\treturn name;\r\n\t\t\t},\r\n\t\t\tshowIdentity:function(me){\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t// if(me===false&&game.players[i]==game.me) continue;\r\n\t\t\t\t\tgame.players[i].node.identity.classList.remove('guessing');\r\n\t\t\t\t\tgame.players[i].identityShown=true;\r\n\t\t\t\t\tgame.players[i].ai.shown=1;\r\n\t\t\t\t\tgame.players[i].setIdentity(game.players[i].identity);\r\n\t\t\t\t\tif(game.players[i].identity=='zhu'){\r\n\t\t\t\t\t\tgame.players[i].isZhu=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(_status.clickingidentity){\r\n\t\t\t\t\tfor(var i=0;i<_status.clickingidentity[1].length;i++){\r\n\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform='';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcheckResult:function(){\r\n\t\t\t\tif(game.zhu.isAlive()){\r\n\t\t\t\t\tif(game.players.length>1){\r\n\t\t\t\t\t\tfor(let i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i]==game.zhu){\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(game.players[i].storage.reviving==0||game.players[i].storage.reviving==null){\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if(game.zhu.$.state!='second'){\r\n\t\t\t\t\tgame.zhu.$.state='second'\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcheckOnlineResult:function(player){\r\n\t\t\t\tif(game.zhu.isAlive()){\r\n\t\t\t\t\treturn player.identity=='zhu';\r\n\t\t\t\t}\r\n\t\t\t\telse if(game.zhu.$.state!='second'){\r\n\t\t\t\t\tgame.zhu.$.state='second';\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\telse return player.identity=='fan';\r\n\t\t\t},\r\n\t\t\tchooseCharacter:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.addPlayer=function(player){\r\n\t\t\t\t\tvar list=lib.config.mode_config.identity.identity[game.players.length-3].slice(0);\r\n\t\t\t\t\tvar list2=lib.config.mode_config.identity.identity[game.players.length-2].slice(0);\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++) list2.remove(list[i]);\r\n\t\t\t\t\tplayer.identity=list2[0];\r\n\t\t\t\t\tplayer.setIdentity('cai');\r\n\t\t\t\t};\r\n\t\t\t\tnext.removePlayer=function(){\r\n\t\t\t\t\treturn game.players.randomGet(game.me,game.zhu);\r\n\t\t\t\t};\r\n\t\t\t\tnext.ai=function(player,list,list2,back){\r\n\t\t\t\t\tif(get.config('double_character')){\r\n\t\t\t\t\t\tplayer.init(list[0],list[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.init(list[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(player==game.zhu){\r\n\t\t\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(back){\r\n\t\t\t\t\t\tlist.remove(player.name);\r\n\t\t\t\t\t\tlist.remove(player.name2);\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tback.push(list[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(typeof lib.config.test_game=='string'&&player==game.me.next){\r\n\t\t\t\t\t\tplayer.init(lib.config.test_game);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(get.config('choose_group')&&player.group=='shen'){\r\n\t\t\t\t\t\t\tvar list=lib.group.slice(0);\r\n\t\t\t\t\t\t\tlist.remove('shen');\r\n\t\t\t\t\t\t\tif(list.length) player.group=list.randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.node.name.dataset.nature=get.groupnature(player.group);\r\n\t\t\t\t}\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar list;\r\n\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\tvar list3=[];\r\n\t\t\t\t\tvar identityList=['zhu','fan','fan','fan'];\r\n\t\t\t\t\tvar chosen=lib.config.continue_name||[];\r\n\t\t\t\t\tgame.saveConfig('continue_name');\r\n\t\t\t\t\tevent.chosen=chosen;\r\n\r\n\t\t\t\t\tvar addSetting=function(dialog){\r\n\t\t\t\t\t\tdialog.add('选择身份').classList.add('add-setting');\r\n\t\t\t\t\t\tvar table=document.createElement('div');\r\n\t\t\t\t\t\ttable.classList.add('add-setting');\r\n\t\t\t\t\t\ttable.style.margin='0';\r\n\t\t\t\t\t\ttable.style.width='100%';\r\n\t\t\t\t\t\ttable.style.position='relative';\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar listi=['random','zhu','fan'];\r\n\t\t\t\t\t\tfor(var i=0;i<listi.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.link=listi[i];\r\n\t\t\t\t\t\t\tif(td.link===game.me.identity){\r\n\t\t\t\t\t\t\t\ttd.classList.add('bluebg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.appendChild(td);\r\n\t\t\t\t\t\t\ttd.innerHTML='<span>'+get.translation(listi[i]+'2')+'</span>';\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\t_status.tempNoButton=true;\r\n\t\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\t_status.tempNoButton=false;\r\n\t\t\t\t\t\t\t\t},500);\r\n\t\t\t\t\t\t\t\tvar link=this.link;\r\n\t\t\t\t\t\t\t\tif(game.zhu.name){\r\n\t\t\t\t\t\t\t\t\tif(link!='random'){\r\n\t\t\t\t\t\t\t\t\t\t_status.event.parent.fixedseat=get.distance(game.me,game.zhu,'absolute');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tgame.zhu.uninit();\r\n\t\t\t\t\t\t\t\t\tdelete game.zhu.isZhu;\r\n\t\t\t\t\t\t\t\t\tdelete game.zhu.identityShown;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar current=this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcurrent=seats.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(link=='random'){\r\n\t\t\t\t\t\t\t\t\tlink=['zhu','fan'].randomGet();\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<this.parentNode.childElementCount;i++){\r\n\t\t\t\t\t\t\t\t\t\tif(this.parentNode.childNodes[i].link==link){\r\n\t\t\t\t\t\t\t\t\t\t\tthis.parentNode.childNodes[i].classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tnum=get.config('choice_'+link);\r\n\t\t\t\t\t\t\t\t_status.event.parent.swapnodialog=function(dialog,list){\r\n\t\t\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\t\t\tvar node=dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t\t\tdialog.buttons=ui.create.buttons(list,'character',buttons);\r\n\t\t\t\t\t\t\t\t\tdialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\tfor(var i=0;i<seats.childElementCount;i++){\r\n\t\t\t\t\t\t\t\t\t\tif(get.distance(game.zhu,game.me,'absolute')===seats.childNodes[i].link){\r\n\t\t\t\t\t\t\t\t\t\t\tseats.childNodes[i].classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t_status.event=_status.event.parent;\r\n\t\t\t\t\t\t\t\t_status.event.step=0;\r\n\t\t\t\t\t\t\t\t_status.event.identity=link;\r\n\t\t\t\t\t\t\t\tif(link!=(event.zhongmode?'mingzhong':'zhu')){\r\n\t\t\t\t\t\t\t\t\tseats.previousSibling.style.display='';\r\n\t\t\t\t\t\t\t\t\tseats.style.display='';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tseats.previousSibling.style.display='none';\r\n\t\t\t\t\t\t\t\t\tseats.style.display='none';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(table);\r\n\r\n\t\t\t\t\t\tdialog.add('选择座位').classList.add('add-setting');\r\n\t\t\t\t\t\tvar seats=document.createElement('div');\r\n\t\t\t\t\t\tseats.classList.add('add-setting');\r\n\t\t\t\t\t\tseats.style.margin='0';\r\n\t\t\t\t\t\tseats.style.width='100%';\r\n\t\t\t\t\t\tseats.style.position='relative';\r\n\t\t\t\t\t\tfor(var i=2;i<=game.players.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.innerHTML=get.cnNumber(i,true);\r\n\t\t\t\t\t\t\ttd.link=i-1;\r\n\t\t\t\t\t\t\tseats.appendChild(td);\r\n\t\t\t\t\t\t\tif(get.distance(game.zhu,game.me,'absolute')===i-1){\r\n\t\t\t\t\t\t\t\ttd.classList.add('bluebg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\tif(get.distance(game.zhu,game.me,'absolute')==this.link) return;\r\n\t\t\t\t\t\t\t\tvar current=this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(get.distance(game.players[i],game.me,'absolute')==this.link){\r\n\t\t\t\t\t\t\t\t\t\tgame.swapSeat(game.zhu,game.players[i],false);return;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(seats);\r\n\t\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\t\tseats.previousSibling.style.display='none';\r\n\t\t\t\t\t\t\tseats.style.display='none';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tif(get.is.phoneLayout()) dialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar removeSetting=function(){\r\n\t\t\t\t\t\tvar dialog=_status.event.dialog;\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tdialog.style.height='';\r\n\t\t\t\t\t\t\tdelete dialog._scrollset;\r\n\t\t\t\t\t\t\tvar list=Array.from(dialog.querySelectorAll('.add-setting'));\r\n\t\t\t\t\t\t\twhile(list.length){\r\n\t\t\t\t\t\t\t\tlist.shift().remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.addSetting=addSetting;\r\n\t\t\t\t\tevent.removeSetting=removeSetting;\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tidentityList.randomSort();\r\n\t\t\t\t\tif(event.identity){\r\n\t\t\t\t\t\tidentityList.remove(event.identity);\r\n\t\t\t\t\t\tidentityList.unshift(event.identity);\r\n\t\t\t\t\t\tif(event.fixedseat){\r\n\t\t\t\t\t\t\tvar zhuIdentity='zhu';\r\n\t\t\t\t\t\t\tif(zhuIdentity!=event.identity){\r\n\t\t\t\t\t\t\t\tidentityList.remove(zhuIdentity);\r\n\t\t\t\t\t\t\t\tidentityList.splice(event.fixedseat,0,zhuIdentity);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete event.fixedseat;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete event.identity;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tgame.players[i].identity=identityList[i];\r\n\t\t\t\t\t\t\tgame.players[i].showIdentity();\r\n\t\t\t\t\t\t\tif(identityList[i]=='zhu'){\r\n\t\t\t\t\t\t\t\tgame.zhu=game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(!game.zhu) game.zhu=game.me;\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.zhu.setIdentity();\r\n\t\t\t\t\t\tgame.zhu.identityShown=true;\r\n\t\t\t\t\t\tgame.zhu.isZhu=(game.zhu.identity=='zhu');\r\n\t\t\t\t\t\tgame.zhu.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\t\tgame.me.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(i=='AjatarCoco') continue;\r\n\t\t\t\t\t\tif(i=='KiryuuCoco') continue;\r\n\t\t\t\t\t\tif(chosen.contains(i)) continue;\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\tif(lib.character[i][4]&&lib.character[i][4].contains('zhu')){\r\n\t\t\t\t\t\t\tlist2.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tlist3.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\tlist3.randomSort();\r\n\t\t\t\t\tvar num=get.config('choice_'+game.me.identity);\r\n\t\t\t\t\tlist=event.list.slice(0,num);\r\n\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\tlist=['KiryuuCoco'];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete event.swapnochoose;\r\n\t\t\t\t\tvar dialog;\r\n\t\t\t\t\tif(event.swapnodialog){\r\n\t\t\t\t\t\tdialog=ui.dialog;\r\n\t\t\t\t\t\tevent.swapnodialog(dialog,list);\r\n\t\t\t\t\t\tdelete event.swapnodialog;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar str='选择角色';\r\n\t\t\t\t\t\tif(_status.brawl&&_status.brawl.chooseCharacterStr){\r\n\t\t\t\t\t\t\tstr=_status.brawl.chooseCharacterStr;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog=ui.create.dialog(str,'hidden',[list,'character']);\r\n\t\t\t\t\t\tif(!_status.brawl||!_status.brawl.noAddSetting){\r\n\t\t\t\t\t\t\tif(get.config('change_identity')){\r\n\t\t\t\t\t\t\t\taddSetting(dialog);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdialog.setCaption('选择角色');\r\n\t\t\t\t\tgame.me.setIdentity();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(!event.chosen.length){\r\n\t\t\t\t\t\tgame.me.chooseButton(dialog,true).set('onfree',true).selectButton=function(){\r\n\t\t\t\t\t\t\treturn get.config('double_character')?2:1\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.create.cheat=function(){\r\n\t\t\t\t\t\t_status.createControl=ui.cheat2;\r\n\t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n\t\t\t\t\t\t\tif(ui.cheat2&&ui.cheat2.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\tlist=event.list.slice(0,num);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list,'character',buttons);\r\n\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\tlib.onfree.push(function(){\r\n\t\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n\t\t\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tui.create.cheat2=function(){\r\n\t\t\t\t\t\tui.cheat2=ui.create.control('自由选将',function(){\r\n\t\t\t\t\t\t\tif(this.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=this.backup;\r\n\t\t\t\t\t\t\t\tthis.backup.open();\r\n\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.backup=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=_status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\tthis.dialog=_status.event.dialog;\r\n\t\t\t\t\t\t\t\tthis.dialog.open();\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!_status.brawl||!_status.brawl.chooseCharacterFixed){\r\n\t\t\t\t\t\tif(!ui.cheat&&get.config('change_choice'))\r\n\t\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\t\tif(!ui.cheat2&&get.config('free_choose'))\r\n\t\t\t\t\t\tui.create.cheat2();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar chooseGroup=false;\r\n\t\t\t\t\tif(event.chosen.length){\r\n\t\t\t\t\t\tif(lib.character[event.chosen[0]][1]=='shen'){\r\n\t\t\t\t\t\t\tchooseGroup=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.modchosen){\r\n\t\t\t\t\t\tif(event.modchosen[0]=='random') event.modchosen[0]=result.buttons[0].link;\r\n\t\t\t\t\t\telse event.modchosen[1]=result.buttons[0].link;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(result.buttons.length==2){\r\n\t\t\t\t\t\tevent.choosed=[result.buttons[0].link,result.buttons[1].link];\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link,result.buttons[1].link);\r\n\t\t\t\t\t\tif(lib.character[event.choosed[0]][1]=='shen'){\r\n\t\t\t\t\t\t\tchooseGroup=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.choosed=[result.buttons[0].link];\r\n\t\t\t\t\t\tif(lib.character[event.choosed[0]][1]=='shen'){\r\n\t\t\t\t\t\t\tchooseGroup=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(event.chosen.length){\r\n\t\t\t\t\t\tgame.me.init(event.chosen[0],event.chosen[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.modchosen){\r\n\t\t\t\t\t\tgame.me.init(event.modchosen[0],event.modchosen[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(event.choosed.length==2){\r\n\t\t\t\t\t\tgame.me.init(event.choosed[0],event.choosed[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.me.init(event.choosed[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.remove(game.me.name);\r\n\t\t\t\t\tevent.list.remove(game.me.name2);\r\n\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\tgame.me.hp++;\r\n\t\t\t\t\t\tgame.me.maxHp++;\r\n\t\t\t\t\t\tgame.me.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\t\t\tevent.ai(game.players[i],event.list.splice(0,get.config('choice_'+game.players[i].identity)),null,event.list)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tgame.zhu.init('KiryuuCoco');\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\tgame.broadcast(function(zhu,name,name2){\r\n\t\t\t\t\t\tif(game.zhu!=game.me){\r\n\t\t\t\t\t\t\tzhu.init(name,name2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},game.zhu,game.zhu.name,game.zhu.name2);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar identityList=['zhu','fan','fan','fan'];\r\n\t\t\t\t\tidentityList.randomSort();\r\n\t\t\t\t\tfor(i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].identity=identityList[i];\r\n\t\t\t\t\t\tgame.players[i].showIdentity();\r\n\t\t\t\t\t\tgame.players[i].identityShown=true;\r\n\t\t\t\t\t\tif(identityList[i]=='zhu') game.zhu=game.players[i];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar list;\r\n\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\tvar list3=[];\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tevent.list2=[];\r\n\r\n\t\t\t\t\tvar libCharacter={};\r\n\t\t\t\t\tfor(var i=0;i<lib.configOL.characterPack.length;i++){\r\n\t\t\t\t\t\tvar pack=lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor(var j in pack){\r\n\t\t\t\t\t\t\tif(j=='zuoci') continue;\r\n\t\t\t\t\t\t\tif(i=='AjatarCoco') continue;\r\n\t\t\t\t\t\t\tif(i=='KiryuuCoco') continue;\r\n\t\t\t\t\t\t\tif(lib.character[j]) libCharacter[j]=pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in libCharacter){\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i,libCharacter)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\tevent.list2.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.characterlist=event.list.slice(0);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\t//game.zhu.init('KiryuuCoco')\r\n\t\t\t\t\tgame.broadcastAll(function(player,name){\r\n\t\t\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\t\t\tif(lib.playerOL[i]==player)\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(name,null)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},game.zhu,'KiryuuCoco')\r\n\t\t\t\t\t// game.broadcastAll(function(zhu,name){\r\n\t\t\t\t\t// \tzhu.init(name);\r\n\t\t\t\t\t// \tzhu.update();\r\n\t\t\t\t\t// },game.zhu,'KiryuuCoco')\r\n\t\t\t\t\t// game.broadcast(function(zhu,name,name2){\r\n\t\t\t\t\t// \tif(game.zhu!=game.me){\r\n\t\t\t\t\t// \t\tzhu.init(name,name2);\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// },game.zhu,game.zhu.name,game.zhu.name2);\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tvar selectButton=(lib.configOL.double_character?2:1);\r\n\r\n\t\t\t\t\tvar num,num2=0;\r\n\t\t\t\t\tnum=Math.floor(event.list.length/game.players.length);\r\n\t\t\t\t\tnum2=event.list.length-num*game.players.length;\r\n\t\t\t\t\tif(num>5){\r\n\t\t\t\t\t\tnum=5;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(num2>2){\r\n\t\t\t\t\t\tnum2=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tlist=event.list2.randomGets(5);\r\n\r\n\t\t\t\t\tvar next=game.zhu.next.chooseButton(true);\r\n\t\t\t\t\tnext.set('selectButton',(lib.configOL.double_character?2:1));\r\n\t\t\t\t\tnext.set('createDialog',['选择角色',[list,'character']]);\r\n\t\t\t\t\t// next.set('callback',function(player,result){\r\n\t\t\t\t\t// \tfor(var i in lib.playerOL){\r\n\t\t\t\t\t// \t\tif(lib.playerOL[i]==player)\r\n\t\t\t\t\t// \t\tlib.playerOL[i].init(result.links[0],result.links[1])\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// \t// game.broadcast(function(result,player){\r\n\t\t\t\t\t// \t// \tplayer.init(result.links[0],result.links[1]);\r\n\t\t\t\t\t// \t// \tplayer.update()\r\n\t\t\t\t\t// \t// },result,player)\r\n\t\t\t\t\t// });\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tgame.broadcastAll(function(player,result){\r\n\t\t\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\t\t\tif(lib.playerOL[i]==player)\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result.links[0],result.links[1])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},game.zhu.next,result)\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]&&result[i].links){\r\n\t\t\t\t\t\t\tfor(var j=0;j<result[i].links.length;j++){\r\n\t\t\t\t\t\t\t\tevent.list2.remove(result[i].links[j]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlist=event.list2.randomGets(5);\r\n\t\t\t\t\tvar next=game.zhu.next.next.chooseButton(true);\r\n\t\t\t\t\tnext.set('selectButton',(lib.configOL.double_character?2:1));\r\n\t\t\t\t\tnext.set('createDialog',['选择角色',[list,'character']]);\r\n\t\t\t\t\t// next.set('callback',function(player,result){\r\n\t\t\t\t\t// \tfor(var i in lib.playerOL){\r\n\t\t\t\t\t// \t\tif(lib.playerOL[i]==player)\r\n\t\t\t\t\t// \t\tlib.playerOL[i].init(result.links[0],result.links[1])\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// \t// game.broadcast(function(result,player){\r\n\t\t\t\t\t// \t// \tplayer.init(result.links[0],result.links[1]);\r\n\t\t\t\t\t// \t// \tplayer.update()\r\n\t\t\t\t\t// \t// },result,player)\r\n\t\t\t\t\t// });\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tgame.broadcastAll(function(player,result){\r\n\t\t\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\t\t\tif(lib.playerOL[i]==player)\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result.links[0],result.links[1])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},game.zhu.next.next,result)\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]&&result[i].links){\r\n\t\t\t\t\t\t\tfor(var j=0;j<result[i].links.length;j++){\r\n\t\t\t\t\t\t\t\tevent.list2.remove(result[i].links[j]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].name){\r\n\t\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name);\r\n\t\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t\t\tevent.list2.remove(game.players[i].name);\r\n\t\t\t\t\t\t\tevent.list2.remove(game.players[i].name2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\r\n\t\t\t\t\tlist=event.list2.randomGets(5);\r\n\r\n\t\t\t\t\tvar next=game.zhu.next.next.next.chooseButton(true);\r\n\t\t\t\t\tnext.set('selectButton',(lib.configOL.double_character?2:1));\r\n\t\t\t\t\tnext.set('createDialog',['选择角色',[list,'character']]);\r\n\t\t\t\t\t// next.set('callback',function(player,result){\r\n\t\t\t\t\t// \tfor(var i in lib.playerOL){\r\n\t\t\t\t\t// \t\tif(lib.playerOL[i]==player)\r\n\t\t\t\t\t// \t\tlib.playerOL[i].init(result.links[0],result.links[1])\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// \t// game.broadcast(function(result,player){\r\n\t\t\t\t\t// \t// \tplayer.init(result.links[0],result.links[1]);\r\n\t\t\t\t\t// \t// \tplayer.update()\r\n\t\t\t\t\t// \t// },result,player)\r\n\t\t\t\t\t// });\r\n\t\t\t\t\t\"step 5\"\r\n\t\t\t\t\tgame.broadcastAll(function(player,result){\r\n\t\t\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\t\t\tif(lib.playerOL[i]==player)\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result.links[0],result.links[1])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},game.zhu.next.next.next,result)\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]&&result[i].links){\r\n\t\t\t\t\t\t\tfor(var j=0;j<result[i].links.length;j++){\r\n\t\t\t\t\t\t\t\tevent.list2.remove(result[i].links[j]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].name){\r\n\t\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name);\r\n\t\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name2);\r\n\t\t\t\t\t\t\tevent.list2.remove(game.players[i].name);\r\n\t\t\t\t\t\t\tevent.list2.remove(game.players[i].name2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tphaseLoopLonglaoguan:function(player){\r\n\t\t\t\tvar next=game.createEvent('phaseLoop');\r\n\t\t\t\tnext.player=player;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tfor(var i=0;i<lib.onphase.length;i++){\r\n\t\t\t\t\t\tlib.onphase[i]();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.phase();\r\n\t\t\t\t\tif(_status.roundStart!=game.zhu){\r\n\t\t\t\t\t\t_status.roundStart=game.zhu;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(!game.players.contains(event.player.next)){\r\n\t\t\t\t\t\tevent.player=game.findNext(event.player.next);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.player=event.player.next;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(game.zhu.$.changeState){\r\n\t\t\t\t\t\tevent.player=game.zhu;\r\n\t\t\t\t\t\tgame.zhu.$.changeState=false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.goto(0);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\ttranslate:{\r\n\t\t\tzhu:\"龙\",\r\n\t\t\tfan:\"反抗军\",\r\n\t\t\tzhu2:\"龙皇\",\r\n\t\t\tfan2:\"反抗军\",\r\n\t\t\trandom2:\"随机\",\r\n\r\n\t\t\tKiryuuCoco:'桐生可可',\r\n\t\t\tKiryuuCoco_info:'桐生可可',\r\n\t\t\tAjatarCoco:'恶龙可可',\r\n\t\t\tAjatarCoco_info:'恶龙可可',\r\n\t\t\tzaoankeke: '早安一刀',\r\n\t\t\tzaoankeke_info: '锁定技 当你使用【杀】指定目标后，目标需弃置一张牌；若此【杀】为属性杀，改为交给你一张牌。',\r\n\t\t\tjierizhanbei: '扳手战备',\r\n\t\t\tjierizhanbei_info: '锁定技 你使用过装备牌的回合内手牌上限视为5。回合结束时，若本回合你没有使用过装备牌，你从牌堆内获得一张随机装备牌。',\r\n\t\t\tesuyingye: '滥觞之至',\r\n\t\t\tesuyingye_info: '回合开始时，你可以弃置你场上的一张牌，若为装备区的牌，本回合你下一张牌造成的伤害+1。',\r\n\t\t\telongkeke:'恶龙可可',\r\n\t\t\telongkeke_info: '死亡时，进入恶龙形态',\r\n\t\t\tyanzheshengdun:'演者圣盾',\r\n\t\t\tyanzheshengdun_info:'进入此形态后，你随机获得一个本局未出现的Hololive武将的所有技能，然后增加该武将的体力上限与体力值。',\r\n\t\t\tzhengzhengrishang:'蒸蒸日上',\r\n\t\t\tzhengzhengrishang_info:'锁定技 出牌阶段开始时，你将手牌调整至全场唯一最多。若已为最多，则改为获得一张【逼宫】。一个回合结束时，你将手牌调整至不为全场最少。',\r\n\t\t\tyugaimizhang:'欲盖弥彰',\r\n\t\t\tyugaimizhang_info:'锁定技 你的手牌上限始终为5。一轮开始时，亮出牌堆顶牌，本轮内你成为此花色牌目标的回合结束时，你可以使用一张牌，此牌可以额外指定任意目标。',\r\n\t\t\tzuoyututan:'坐於涂炭',\r\n\t\t\tzuoyututan_info:'锁定技 转换技。一轮开始时，令所有反抗军①随机废除一个装备栏②手牌上限-1③获得一张进入弃牌堆后即移出游戏的【毒】。形态切换后，复原反抗军。',\r\n\t\t\t// _feiyang:\"飞扬\",\r\n\t\t\t// _bahu:\"跋扈\",\r\n\t\t\t// _feiyang_info:\"判定阶段开始时，若你的判定区有牌，则你可以弃置两张手牌，然后弃置你判定区的一张牌。每回合限一次。\",\r\n\t\t\t// _bahu_info:\"锁定技 准备阶段开始时，你摸一张牌。出牌阶段，你可以多使用一张【杀】。\",\r\n\t\t\t// dulun: '独轮车',\r\n\t\t\t// dulun_info: '出牌阶段，对一名反抗军使用，其可以立即使用一张不可被响应的【杀】或摸一张牌。',\r\n\t\t\t// chuanjia: '穿甲弹',\r\n\t\t\t// chuanjia_info: '出牌阶段，对桐生可可使用，本回合其成为【杀】的目标后需弃置装备区内的一张牌。',\r\n\t\t\t// zhinengdulun: '智能独轮车',\r\n\t\t\t// zhinengdulun_info: '回合开始时，你视为使用一张【独轮车】。',\r\n\t\t\t// longjiao: '龙角',\r\n\t\t\t// longjiao_info: '反抗军无法装备。每回合可以额外使用一张【杀】。在反抗军的回合进入弃牌堆时，改为置于牌堆顶。',\r\n\t\t\t// longwei: '龙尾',\r\n\t\t\t// longwei_info: '反抗军无法装备。若为桐生可可形态，则获得“欲盖弥彰”，若为恶龙形态，则获得“滥觞之至”。在反抗军的回合进入弃牌堆时，改为洗入牌堆。',\r\n\t\t\t// takeover: '所向无前',\r\n\t\t\t// takeover_info: '为所有反抗军装备【智能独轮车】，使用后移出游戏。',\r\n\t\t\t// bigong: '逼宫',\r\n\t\t\t// bigong_info: '对一名反抗军使用，令其选择一项：本轮内失去所有技能，或交给桐生可可两张不同类型的牌，使用后移出游戏。',\r\n\t\t\t// bigong_clear: '逼宫后续',\r\n\t\t\t// chuanjia_po: 'fuck',\r\n\r\n\t\t\tzuoyututanLimit: '手牌减少',\r\n\t\t\tmode_longlaoguan_card_config:'龙牢关卡牌',\r\n\t\t},\r\n\t\telement:{\r\n\t\t\tplayer:{\r\n\t\t\t\thasZhuSkill:function(){return false;},\r\n\t\t\t\t$dieAfter:function(){\r\n\t\t\t\t\tif(_status.video) return;\r\n\t\t\t\t\tif(!this.node.dieidentity){\r\n\t\t\t\t\t\tvar str={zhu:'龙皇',fan:'重整'}[this.identity];\r\n\t\t\t\t\t\tvar node=ui.create.div('.damage.dieidentity',str,this);\r\n\t\t\t\t\t\tui.refresh(node);\r\n\t\t\t\t\t\tnode.style.opacity=1;\r\n\t\t\t\t\t\tthis.node.dieidentity=node;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar trans=this.style.transform;\r\n\t\t\t\t\tif(trans){\r\n\t\t\t\t\t\tif(trans.indexOf('rotateY')!=-1){\r\n\t\t\t\t\t\t\tthis.node.dieidentity.style.transform='rotateY(180deg)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(trans.indexOf('rotateX')!=-1){\r\n\t\t\t\t\t\t\tthis.node.dieidentity.style.transform='rotateX(180deg)';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tthis.node.dieidentity.style.transform='';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tthis.node.dieidentity.style.transform='';\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdieAfter:function(source){\r\n\t\t\t\t\tgame.checkResult();\r\n\t\t\t\t},\r\n\t\t\t\tlogAi:function(targets,card){},\r\n\t\t\t\tshowIdentity:function(){\r\n\t\t\t\t\tgame.broadcastAll(function(player,identity){\r\n\t\t\t\t\t\tplayer.identity=identity;\r\n\t\t\t\t\t\tplayer.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\tplayer.identityShown=true;\r\n\t\t\t\t\t\tplayer.ai.shown=1;\r\n\t\t\t\t\t\tplayer.setIdentity();\r\n\t\t\t\t\t\tif(player.identity=='zhu'){\r\n\t\t\t\t\t\t\tplayer.isZhu=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(_status.clickingidentity){\r\n\t\t\t\t\t\t\tfor(var i=0;i<_status.clickingidentity[1].length;i++){\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform='';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},this,this.identity);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcharacterPack:{\r\n\t\t\tmode_longlaoguan:{\r\n\t\t\t\tKiryuuCoco:['female','holo',5,['zaoankeke', 'jierizhanbei','esuyingye','zuoyututan','elongkeke']],\r\n\t\t\t\tAjatarCoco:['female','holo',1,['yanzheshengdun','zaoankeke', 'zhengzhengrishang','yugaimizhang','zuoyututan']]\r\n\t\t\t}\r\n\t\t},\r\n\t\tcardPack:{\r\n\t\t\tmode_longlaoguan:['dulun','chuanjia','zhinengdulun','longjiao','longwei','takeover','bigong']\r\n\t\t},\r\n\t\tget:{\r\n\t\t\trawAttitude:function(from,to){\r\n\t\t\t\tif(from.identity==to.identity) return 10;\r\n\t\t\t\treturn -10;\r\n\t\t\t},\r\n\t\t},\r\n\t\tskill:{\r\n\t\t\t/** 龙皇技能*/\r\n\t\t\tzaoankeke:{\r\n\t\t\t\ttrigger:{player:'useCardToPlayered'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpriority:29,\r\n\t\t\t\tlogTarget:'target',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.target==player)\t\t\t\treturn false;\r\n\t\t\t\t\tif(event.target.countCards('he')==0)\treturn false;\r\n\t\t\t\t\treturn event.card.name =='sha';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\t\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar target=trigger.target;\r\n\r\n\t\t\t\t\tif(trigger.getParent().card.nature)\t\t//如果此杀为属性杀\r\n\t\t\t\t\t{\t\t\t\t\r\n\t\t\t\t\t\tplayer.line(target,'green');\r\n\t\t\t\t\t\ttarget.chooseCard('参加“早安可可”录制，需要交给'+get.translation(player)+'一张牌','he',true).set('ai',function(card){\r\n\t\t\t\t\t\t\tvar name = card.name;\r\n\t\t\t\t\t\t\tif(name=='shan') return 30;\r\n\t\t\t\t\t\t\treturn 100-get.value(card);\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\t\t\t\t\t\t\t\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttarget.chooseToDiscard('参加“早安可可”录制，需要弃置一张牌','he',true).set('ai',function(card){\r\n\t\t\t\t\t\t\tvar name = card.name;\r\n\t\t\t\t\t\t\tif(name=='shan') return 30;\r\n\t\t\t\t\t\t\treturn 100-get.value(card);\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(trigger.getParent().card.nature){\r\n\t\t\t\t\t\tplayer.gain(result.cards,target,'giveAuto');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjierizhanbei:{\r\n\t\t\t\tgroup:['jierizhanbei_useE' , 'jierizhanbei_getE'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tuseE:{\r\n\t\t\t\t\t\tinit:function(player){\r\n\t\t\t\t\t\t\tplayer.$.jierizhanbei=0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttrigger:{player:'useCard'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpriority:17,\r\n\t\t\t\t\t\tusable:1,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn get.type(event.card)=='equip';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.jierizhanbei++;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmod:{\r\n\t\t\t\t\t\t\tmaxHandcard:function(player,num){\r\n\t\t\t\t\t\t\t\tif(player.$.jierizhanbei>0)\treturn 5;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tgetE:{\r\n\t\t\t\t\t\tinit:function (player){\r\n\t\t\t\t\t\t\tplayer.$.jierizhanbei=0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpriority:13,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tvar num = player.$.jierizhanbei\r\n\t\t\t\t\t\t\tif(num!=0){\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tplayer.$.jierizhanbei=0;\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tconsole.log(player.$.jierizhanbei);\r\n\t\t\t\t\t\t\t\tvar getC = get.cardPile2(function(card){\r\n\t\t\t\t\t\t\t\t\treturn get.type(card)=='equip';\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tif(getC){\r\n\t\t\t\t\t\t\t\t\tplayer.gain(getC,'gain2');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tgame.log(player,'牌堆中没有装备牌了');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tesuyingye:{\r\n\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\tforced:false,\r\n\t\t\t\tpriority:31,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player==player&&player.countDiscardableCards(player,'ej')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar nh=trigger.player.countCards('h');\r\n\t\t\t\t\tvar eff=get.effect(trigger.player,{name:'sha',isCard:true},player,player);\r\n\t\t\t\t\tplayer.discardPlayerCard('请开始自己的表演',player,'ej').set('ai',function(button){\r\n\t\t\t\t\t\tvar name=button.link.viewAs||button.link.name;\r\n\t\t\t\t\t\tvar nh=_status.event.nh;\r\n\t\t\t\t\t\tif(name=='lebu'&&nh>trigger.player.hp) return 150;\r\n\t\t\t\t\t\tif(name=='bingliang'&&nh<trigger.player.hp) return 150;\r\n\t\t\t\t\t\treturn 100-get.value(button.link);\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t}).set('nh',nh);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.cards){\r\n\t\t\t\t\t\tvar getC = result.cards[0];\r\n\t\t\t\t\t\tif(get.type(getC) =='equip'){\r\n\t\t\t\t\t\t\tplayer.logSkill('esuyingye');\r\n\t\t\t\t\t\t\tplayer.addTempSkill('esuyingye_addDam');\r\n\t\t\t\t\t\t\tgame.putBuff(player, 'esuyingye', '.player_buff')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\taddDam: {\r\n\t\t\t\t\t\tdirect: true, \r\n\t\t\t\t\t\tsilent: true,\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tsource: 'damageBegin',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function() {\r\n\t\t\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\t\t\tplayer.removeSkill('esuyingye_addDam');\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonremove: function(player, skill) {\r\n\t\t\t\t\t\t\tgame.clearBuff(player, 'esuyingye')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\telongkeke:{\r\n\t\t\t\ttrigger:{player:'dieBefore'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tforceDie:true,\r\n\t\t\t\tskillAnimation:true,\r\n\t\t\t\tanimationColor:'thunder',\r\n\t\t\t\tfilter:function(event){\r\n\t\t\t\t\tevent.player.setAvatar('KiryuuCoco','AjatarCoco');\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontentBefore:function(){\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(event._trigger.reason=='nosource'){\r\n\t\t\t\t\t\tplayer.$.state='second';\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\t\tplayer.revive(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.markSkill('elongkeke');\r\n\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar libCharacter={};\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(var i in lib.character){\r\n\t\t\t\t\t\tif(i=='KiryuuCoco'||i=='AjatarCoco') continue;\r\n\t\t\t\t\t\tif(i=='Civia'||i=='SpadeEcho'||i=='Artia'||i=='Doris'||i=='Yogiri'||i=='Rosalyn') continue;\r\n\t\t\t\t\t\tvar group=lib.character[i][1];\r\n\t\t\t\t\t\t//if(group=='shen') continue;\r\n\t\t\t\t\t\tif(group=='holo'){\r\n\t\t\t\t\t\t\tif(game.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(current.name==i){\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t}).length>0) continue;\r\n\t\t\t\t\t\t\tlist.push(i)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar newPerson=list.randomGets(1);\r\n\t\t\t\t\tgame.broadcastAll(function(player,name){\r\n\t\t\t\t\t\t// for(var i in lib.playerOL){\r\n\t\t\t\t\t\t// \tif(lib.playerOL[i]==game.zhu)\r\n\t\t\t\t\t\t\tplayer.init('AjatarCoco',name)\r\n\t\t\t\t\t\t//}\r\n\t\t\t\t\t},game.zhu,newPerson)\r\n\t\t\t\t\t//player.init('AjatarCoco',newPerson);\r\n\t\t\t\t\tplayer.$.state='second';\r\n\t\t\t\t\tgame.zhu.maxHp=1+Number(lib.character[newPerson][2]);\r\n\t\t\t\t\tgame.zhu.hp=1+Number(lib.character[newPerson][2]);\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tgame.zhu.update();\r\n\t\t\t\t\tgame.zhu.$.changeState=true;\r\n\t\t\t\t\tgame.filterPlayer(function(current){\r\n\t\t\t\t\t\t// if(current.isOut()){\r\n\t\t\t\t\t\t// \treturn false;\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\tif(current==player){\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(current.hasSkill('zuoyututanLimit')){\r\n\t\t\t\t\t\t\tcurrent.removeSkill('zuoyututanLimit');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(let i=1;i<7;i++){\r\n\t\t\t\t\t\t\tif(current.isDisabled(i)){\r\n\t\t\t\t\t\t\t\tcurrent.enableEquip(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tlib.inpile.add('takeover')\r\n\t\t\t\t\tvar takecard=game.createCard2('takeover','heart',10)\r\n\t\t\t\t\tui.cardPile.insertBefore(takecard,ui.cardPile.childNodes[get.rand(0,ui.cardPile.childElementCount-1)]);\r\n\t\t\t\t\tvar evt=_status.event.getParent('phase');\r\n\t\t\t\t\tif(evt){\r\n\t\t\t\t\t\t//game.resetSkills();\r\n\t\t\t\t\t\t_status.event=evt;\r\n\t\t\t\t\t\t_status.event.finish();\r\n\t\t\t\t\t\t// _status.event.untrigger(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t/** 恶龙技能 */\r\n\t\t\tyanzheshengdun:{\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tzhengzhengrishang:{\r\n\t\t\t\ttrigger:{player:'phaseUseBegin'},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player==game.zhu;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(player.isMaxHandcard(false)){\r\n\t\t\t\t\t\tvar takecard=game.createCard2('bigong','heart',1);\r\n\t\t\t\t\t\tplayer.gain(takecard);\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.maxHandcardPlayer=game.filterPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current.isMaxHandcard(false);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tlet getcard = event.maxHandcardPlayer[0].countCards('h')-player.countCards('h');\r\n\t\t\t\t\tplayer.draw(getcard);\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['zhengzhengrishang_endDraw'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tendDraw:{\r\n\t\t\t\t\t\ttrigger:{global:'phaseEnd'},\r\n\t\t\t\t\t\tfrequent:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player==game.zhu;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tif(player.isMinHandcard(false)){\r\n\t\t\t\t\t\t\t\tplayer.draw(1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tevent.goto(0);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.3\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyugaimizhang:{\r\n\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\tforced: true,\r\n\t\t\t\tmark:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.card=get.cards()[0];\r\n\t\t\t\t\tif(player.$.yugaimizhang==undefined) player.$.yugaimizhang=[];\r\n\t\t\t\t\tif(player.$.yugaimizhang.length>0){\r\n\t\t\t\t\t\tgame.cardsDiscard(player.$.yugaimizhang);\r\n\t\t\t\t\t\tplayer.$.yugaimizhang=[];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.$.yugaimizhang=[event.card];\r\n\t\t\t\t\tplayer.syncStorage('yugaimizhang');\r\n\t\t\t\t\t//event.trigger(\"addCardToStorage\");\r\n\t\t\t\t\tgame.cardsGotoSpecial(event.card);\r\n\t\t\t\t\tplayer.showCards(player.$.yugaimizhang,'欲盖弥彰')\r\n\t\t\t\t\t//player.markSkill('yugaimizhang');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['yugaimizhang_limit','yugaimizhang_target'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tlimit:{\r\n\t\t\t\t\t\tmod:{\r\n\t\t\t\t\t\t\tmaxHandcard:function (player,num){\r\n\t\t\t\t\t\t\t\treturn 5;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttarget:{\r\n\t\t\t\t\t\ttrigger:{global:'useCard2'},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.countCards('h')==0) return false;\r\n\t\t\t\t\t\t\tif(!player.$.yugaimizhang){\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(player.$.yugaimizhang.length==0){\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(event.targets&&event.targets[0]==player&&get.suit(event.cards)==get.suit(game.zhu.$.yugaimizhang))\r\n\t\t\t\t\t\t\t\treturn true; \r\n\t\t\t\t\t\t\telse \r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tif(!player.hasSkill('yugaimizhang_use'))\r\n\t\t\t\t\t\t\t\tplayer.addTempSkill('yugaimizhang_use');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tuse:{\r\n\t\t\t\t\t\ttrigger:{global:'phaseEnd'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn (player.countCards('h')>0)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tplayer.chooseButton(['选择一张牌使用', player.getCards('h')], 1).set('filterButton',function(button,player){\r\n\t\t\t\t\t\t\t\tvar bool=game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\treturn player.canUse(button.link,current);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\treturn bool;\r\n\t\t\t\t\t\t\t}).set('ai',function(button){\r\n\t\t\t\t\t\t\t\treturn get.value(button.link,_status.event.player);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\tevent.usecard=result.links[0];\r\n\t\t\t\t\t\t\t\tvar bool=game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\treturn player.canUse(event.usecard,current);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(bool){\r\n\t\t\t\t\t\t\t\t\t//player.chooseTarget(result.links[0],true,false);\r\n\t\t\t\t\t\t\t\t\tvar targetNumber=Infinity;\r\n\t\t\t\t\t\t\t\t\tif(get.type(event.usecard)=='delay'||get.type(event.usecard)=='equip'){\r\n\t\t\t\t\t\t\t\t\t\ttargetNumber=1;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tgame.broadcastAll(\r\n\t\t\t\t\t\t\t\t\t\tplayer.chooseTarget('选择使用目标',[1,Infinity],function(card,player,target){\r\n\t\t\t\t\t\t\t\t\t\t\treturn player.canUse(event.usecard,target);\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tplayer.useCard(event.usecard, result.targets)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'cards',\r\n\t\t\t\t\tonunmark:function(storage,player){\r\n\t\t\t\t\t\tif(storage&&storage.length){\r\n\t\t\t\t\t\t\tplayer.$throw(storage,1000);\r\n\t\t\t\t\t\t\tgame.cardsDiscard(storage);\r\n\t\t\t\t\t\t\tdelete player.$.yugaimizhang;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tzuoyututan:{\r\n\t\t\t\tinit:function (player){\r\n\t\t\t\t\tplayer.$.zuoyututan=1;\r\n\t\t\t\t\tplayer.$.zuoyututanUse=true;\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tlocked:false,\r\n\t\t\t\tzhuanhuanji:true,\r\n\t\t\t\tmarktext:'碳',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:function(storage,player,skill){\r\n\t\t\t\t\t\tif(player.$.zuoyututan==1) return '随机废除一个装备栏';\r\n\t\t\t\t\t\telse if(player.$.zuoyututan==1) return '手牌上限-1';\r\n\t\t\t\t\t\telse return '获得一张进入弃牌堆后即移出游戏的【毒】'\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tgroup:[\"zuoyututan_1\",\"zuoyututan_2\",\"zuoyututan_3\",\"zuoyututan_clear\"],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\t'1':{\r\n\t\t\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.$.zuoyututan!=1){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn !player.hasSkill('zuoyututan_stop');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\tfor(var i=1;i<6;i++){\r\n\t\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.disableEquip=list.randomGet();\r\n\t\t\t\t\t\t\tplayer.markSkill('zuoyututan');\r\n\t\t\t\t\t\t\tgame.log('所有反抗军废除'+get.translation('equip'+event.disableEquip));\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tgame.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(current.isOut()){\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(current==player){\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(!current.isDisabled(event.disableEquip)){\r\n\t\t\t\t\t\t\t\t\tcurrent.disableEquip(event.disableEquip);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tplayer.$.zuoyututan=2;\r\n\t\t\t\t\t\t\tplayer.$.zuoyututanUse=false;\r\n\t\t\t\t\t\t\tplayer.addTempSkill('zuoyututan_stop');\r\n\t\t\t\t\t\t\tplayer.syncStorage('zuoyututan');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'2':{\r\n\t\t\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.$.zuoyututan!=2){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn !player.hasSkill('zuoyututan_stop');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\tfor(var i=1;i<6;i++){\r\n\t\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.disableEquip=list.randomGet();\r\n\t\t\t\t\t\t\tplayer.markSkill('zuoyututan');\r\n\t\t\t\t\t\t\tgame.log('所有反抗军手牌上限-1');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tgame.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(current.isOut()){\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(current==player){\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(current.hasSkill('zuoyututanLimit')){\r\n\t\t\t\t\t\t\t\t\tcurrent.$.zuoyututanLimit++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tcurrent.addSkill('zuoyututanLimit');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tplayer.$.zuoyututan=3;\r\n\t\t\t\t\t\t\tplayer.$.zuoyututanUse=false;\r\n\t\t\t\t\t\t\tplayer.addTempSkill('zuoyututan_stop');\r\n\t\t\t\t\t\t\tplayer.syncStorage('zuoyututan');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'3':{\r\n\t\t\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.$.zuoyututan!=3){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn !player.hasSkill('zuoyututan_stop');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\tfor(var i=1;i<6;i++){\r\n\t\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.disableEquip=list.randomGet();\r\n\t\t\t\t\t\t\tplayer.markSkill('zuoyututan');\r\n\t\t\t\t\t\t\tgame.log('所有反抗军获得一张【毒】');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tgame.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(current.isOut()){\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(current==player){\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar newcard=game.createCard2('du','spade',1);\r\n\t\t\t\t\t\t\t\tgame.zhu.$giveAuto(newcard,current);\r\n\t\t\t\t\t\t\t\tcurrent.gain(newcard);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tplayer.$.zuoyututan=1;\r\n\t\t\t\t\t\t\tplayer.$.zuoyututanUse=false;\r\n\t\t\t\t\t\t\tplayer.addTempSkill('zuoyututan_stop');\r\n\t\t\t\t\t\t\tplayer.syncStorage('zuoyututan');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tclear:{\r\n\t\t\t\t\t\ttrigger:{global:'loseAfter'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(_status.event.getParent('gain')!=={}&&_status.event.getParent('gain')!=null) return false;\r\n\t\t\t\t\t\t\tif(!event.visible) return false;\r\n\t\t\t\t\t\t\tif(event.player==player) return false;\r\n\t\t\t\t\t\t\tfor(var i=0;i<event.cards2.length;i++){\r\n\t\t\t\t\t\t\t\tif(get.name(event.cards2[i])=='du'&&get.suit(event.cards2[i],event.player)=='club'&&get.number(event.cards2[i])==1){\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\t\t\tif(trigger.delay==false) game.delay();\r\n\t\t\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t\t\tvar cards=[];\r\n\t\t\t\t\t\t\tfor(var i=0;i<trigger.cards2.length;i++){\r\n\t\t\t\t\t\t\t\tif(get.name(event.cards2[i])=='du'&&get.suit(event.cards2[i],event.player)=='club'&&get.number(event.cards2[i])==1){\r\n\t\t\t\t\t\t\t\t\tcards.push(trigger.cards2[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(cards.length){\r\n\t\t\t\t\t\t\t\tgame.cardsGotoSpecial(cards);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tstop:{\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tzuoyututanLimit:{\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.$.zuoyututanLimit=1;\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:function(storage,player,skill){\r\n\t\t\t\t\t\treturn '手牌上限减少'+player.$.zuoyututanLimit;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tmarktext:'碳',\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tmaxHandcard:function(player,num){\r\n\t\t\t\t\t\treturn num-player.$.zuoyututanLimit;\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**卡牌技能 */\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t/**从反抗军先锋开始，所以跳过初始第一回合 */\r\n\t\t\t_skipFirstPhase:{\r\n\t\t\t\ttrigger:{global:'phaseBefore'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn (event.player==game.zhu)&&(game.phaseNumber==0);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar evt=_status.event.getParent('phase');\r\n\t\t\t\t\tif(evt){\r\n\t\t\t\t\t\t//game.resetSkills();\r\n\t\t\t\t\t\t_status.event=evt;\r\n\t\t\t\t\t\tgame.phaseNumber=0;\r\n\t\t\t\t\t\t_status.event.finish();\r\n\t\t\t\t\t\t// _status.event.untrigger(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t/**使用技能实现给龙皇插入回合 */\r\n\t\t\t_anotherPhase:{\r\n\t\t\t\ttrigger:{player:'phaseAfter'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t//console.log(_status.event.getParent('phase'));\r\n\t\t\t\t\tif(_status.event.getParent('phase').skill){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(game.zhu.$.state=='second'){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar trueNext=player.next\r\n\t\t\t\t\twhile(trueNext.$.reviving&&trueNext.$.reviving>0){\r\n\t\t\t\t\t\tif(trueNext==game.zhu){\r\n\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttrueNext=trueNext.next\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn player!=game.zhu&&(trueNext!=game.zhu)\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(game.zhu.isOut()){\r\n\t\t\t\t\t\tgame.zhu.in();\r\n\t\t\t\t\t\tgame.broadcastAll(function(splayer){\r\n\t\t\t\t\t\t\t_status.dying.remove(splayer);\r\n\t\t\t\t\t\t},player)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.zhu.insertPhase();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t/**死亡时其他人摸牌 */\r\n\t\t\t_dieAfterDraw:{\r\n\t\t\t\ttrigger:{global:'dieAfter'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player.identity==player.identity;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.chooseDrawRecover(2);\r\n\t\t\t\t\tplayer.showGiveup();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t/**每轮开始的时候重整 */\r\n\t\t\t_revivePlayer:{\r\n\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player==player&&player==game.zhu;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tevent.deadlist=game.dead;\r\n\t\t\t\t\tfor(let i=0;i<event.deadlist.length;i=0){\r\n\t\t\t\t\t\tevent.deadlist[i].storage.reviving=0;\r\n\t\t\t\t\t\tgame.broadcastAll(function(splayer){\r\n\t\t\t\t\t\t\tsplayer.revive(1);\r\n\t\t\t\t\t\t\tfor(let i=1;i<7;i++){\r\n\t\t\t\t\t\t\t\tif(splayer.isDisabled(i)){\r\n\t\t\t\t\t\t\t\t\tsplayer.enableEquip(i);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(splayer.hasSkill('zuoyututanLimit')){\r\n\t\t\t\t\t\t\t\tsplayer.removeSkill('zuoyututanLimit');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},event.deadlist[i])\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// event.deadlist.forEach(element => {\r\n\t\t\t\t\t// });\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.outlist=[];\r\n\t\t\t\t\tfor(let i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].storage.reviving==0){\r\n\t\t\t\t\t\t\tgame.broadcastAll(function(splayer){\r\n\t\t\t\t\t\t\t\tsplayer.out('reviving');\r\n\t\t\t\t\t\t\t},game.players[i])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(game.players[i].isOut()&&game.players[i].storage.reviving>=0) {\r\n\t\t\t\t\t\t\tevent.outlist.add(game.players[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tfor(let i=0;i<event.outlist.length;i++){\r\n\t\t\t\t\t\tif(event.outlist[i].storage.reviving==0){\r\n\t\t\t\t\t\t\tevent.outlist[i].hp=1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(event.outlist[i].hp>=event.outlist[i].maxHp){\r\n\t\t\t\t\t\t\tevent.outlist[i].directgain(get.cards(1));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tevent.outlist[i].hp+=1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.outlist[i].storage.reviving++;\r\n\t\t\t\t\t\tif(event.outlist[i].storage.reviving>5){\r\n\t\t\t\t\t\t\tevent.outlist[i].storage.reviving=null;\r\n\t\t\t\t\t\t\tgame.broadcastAll(function(splayer){\r\n\t\t\t\t\t\t\t\tsplayer.in('reviving');\r\n\t\t\t\t\t\t\t},event.outlist[i])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.outlist[i].update();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\thelp:{\r\n\t\t\t'龙牢关':'<div style=\"margin:10px\">游戏规则</div><ul style=\"margin-top:0\"><li>游戏人数<br>游戏人数为4人。<li>胜利条件<br>反抗军：龙皇死亡。<br>龙皇：所有反抗军死亡且自己存活。'+\r\n\t\t\t'<li>死亡奖惩<br>当有反抗军死亡时，其他反抗军，可以选择摸两张牌或回复一点体力。<li>龙皇专属技能<br><br><br></ul>',\r\n\t\t}\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/longlaoguan.js?")},"./src/mode/single.js":function(){eval("\r\ngame.import('mode',function(lib,game,ui,get,ai,_status){\r\n\treturn {\r\n\t\tname:'single',\r\n\t\tchangbanCharacter:[\r\n\t\t\t\"key_rei\",\"key_yoshino\",\"key_noda\",\"key_nagisa\",\r\n\t\t\t\"re_caocao\",\"re_caozhang\",\"re_diaochan\",\"re_ganning\",\"re_gongsunzan\",\"re_guojia\",\"re_huangyueying\",\"re_lidian\",\"re_lvbu\",\r\n\t\t\t\"re_simayi\",\"sunquan\",\"re_xiahoudun\",\"re_xushu\",\"yuanshu\",\"xf_yiji\",\"re_zhangfei\",\"re_zhangliao\",\"re_xuzhu\",\r\n\t\t\t\"re_zhaoyun\",\"re_zhouyu\",\"re_zhugeliang\",\"ol_xiahouyuan\",\"re_huangzhong\",\"re_weiyan\",\"dianwei\",\"te_yanwen\",\"re_pangde\",\r\n\t\t\t\"re_zhurong\",\"re_sunjian\",\"jiaxu\",\"dengai\",\"re_jiangwei\",\"re_sunben\",\"wangji\",\"wangping\",\"guanqiujian\",\"chendao\",\"ol_yujin\",\r\n\t\t\t\"re_caozhi\",\"xin_masu\",\"re_lingtong\",\"xusheng\",\"re_gaoshun\",\"xunyou\",\"guanzhang\",\"madai\",\"handang\",\"caochong\",\r\n\t\t\t\"re_guohuai\",\"guanping\",\"liufeng\",\"re_zhuran\",\"xin_liru\",\"hanhaoshihuan\",\"zhuhuan\",\"caoxiu\",\"liuchen\",\"re_zhangyi\",\r\n\t\t\t\"re_quancong\",\"sunxiu\",\"sundeng\",\"guohuanghou\",\"re_jikang\",\"xuezong\",\"qinmi\",\"lvdai\",\"re_zhangliang\",\"lingcao\",\r\n\t\t\t\"sunru\",\"zhuling\",\"sp_caoren\",\"fanchou\",\"fuwan\",\"sp_ganning\",\"guanyinping\",\"guosi\",\"heqi\",\"sp_jiangwei\",\"litong\",\r\n\t\t\t\"re_panfeng\",\"sp_pangde\",\"xf_sufei\",\"xf_tangzi\",\"xiahouba\",\"xujing\",\"yuejin\",\"sp_zhangfei\",\"zhangji\",\"zhangyì\",\"dongcheng\",\r\n\t\t],\r\n\t\tsinglePile:[\r\n\t\t\t['spade',5,'sha'],\r\n\t\t\t['spade',7,'sha'],\r\n\t\t\t['spade',8,'sha'],\r\n\t\t\t['spade',10,'sha'],\r\n\t\t\t['heart',10,'sha'],\r\n\t\t\t['heart',11,'sha'],\r\n\t\t\t['club',4,'sha'],\r\n\t\t\t['club',5,'sha'],\r\n\t\t\t['club',6,'sha'],\r\n\t\t\t['club',8,'sha'],\r\n\t\t\t['club',9,'sha'],\r\n\t\t\t['club',10,'sha'],\r\n\t\t\t['club',11,'sha'],\r\n\t\t\t['diamond',6,'sha'],\r\n\t\t\t['diamond',9,'sha'],\r\n\t\t\t['diamond',11,'sha'],\r\n\t\t\t['heart',2,'shan'],\r\n\t\t\t['heart',5,'shan'],\r\n\t\t\t['diamond',2,'shan'],\r\n\t\t\t['diamond',3,'shan'],\r\n\t\t\t['diamond',7,'shan'],\r\n\t\t\t['diamond',8,'shan'],\r\n\t\t\t['diamond',10,'shan'],\r\n\t\t\t['diamond',11,'shan'],\r\n\t\t\t['heart',3,'tao'],\r\n\t\t\t['heart',4,'tao'],\r\n\t\t\t['heart',9,'tao'],\r\n\t\t\t['diamond',12,'tao'],\r\n\t\t\t['club',12,'bingliang'],\r\n\t\t\t['spade',3,'guohe'],\r\n\t\t\t['diamond',12,'guohe'],\r\n\t\t\t['club',3,'guohe'],\r\n\t\t\t['club',1,'juedou'],\r\n\t\t\t['spade',1,'juedou'],\r\n\t\t\t['heart',6,'lebu'],\r\n\t\t\t['spade',1,'nanman'],\r\n\t\t\t['club',7,'shuiyanqijunx'],\r\n\t\t\t['spade',4,'shunshou'],\r\n\t\t\t['spade',11,'shunshou'],\r\n\t\t\t['diamond',4,'shunshou'],\r\n\t\t\t['heart',1,'wanjian'],\r\n\t\t\t['heart',5,'wuxie'],\r\n\t\t\t['club',5,'wuxie'],\r\n\t\t\t['heart',7,'wuzhong'],\r\n\t\t\t['heart',8,'wuzhong'],\r\n\t\t\t['diamond',5,'guanshi'],\r\n\t\t\t['spade',9,'hanbing'],\r\n\t\t\t['spade',6,'qinggang'],\r\n\t\t\t['spade',12,'zhangba'],\r\n\t\t\t['diamond',1,'zhuge'],\r\n\t\t\t['spade',2,'bagua'],\r\n\t\t\t['club',2,'renwang'],\r\n\t\t],\r\n\t\tcharacterSingle:{\r\n\t\t\tcaocao:['male','wei',4,['jianxiong'],['zhu']],\r\n\t\t\tsimayi:['male','wei',3,['fankui','guicai']],\r\n\t\t\txiahoudun:['male','wei',4,['ganglie']],\r\n\t\t\tzhangliao:['male','wei',4,['retuxi']],\r\n\t\t\txuzhu:['male','wei',4,['luoyi','xiechan']],\r\n\t\t\tguojia:['male','wei',3,['tiandu','yiji']],\r\n\t\t\tzhenji:['female','wei',3,['luoshen','sgqingguo']],\r\n\t\t\tliubei:['male','shu',4,['sgrenwang'],['zhu']],\r\n\t\t\tguanyu:['male','shu',4,['wusheng','huwei']],\r\n\t\t\tzhangfei:['male','shu',4,['paoxiao']],\r\n\t\t\tzhugeliang:['male','shu',3,['guanxing','kongcheng']],\r\n\t\t\tzhaoyun:['male','shu',4,['longdan']],\r\n\t\t\tmachao:['male','shu',4,['xiaoxi','tieji']],\r\n\t\t\thuangyueying:['female','shu',3,['jizhi','cangji']],\r\n\t\t\tsunquan:['male','wu',4,['sgzhiheng'],['zhu']],\r\n\t\t\tganning:['male','wu',4,['qixi']],\r\n\t\t\tlvmeng:['male','wu',4,['shenju','botu']],\r\n\t\t\thuanggai:['male','wu',4,['kurou']],\r\n\t\t\tzhouyu:['male','wu',3,['yingzi','fanjian']],\r\n\t\t\tdaqiao:['female','wu',3,['guose','wanrong']],\r\n\t\t\tluxun:['male','wu',3,['qianxun','lianying']],\r\n\t\t\tsunshangxiang:['female','wu',3,['xiaoji','yinli']],\r\n\t\t\t//huatuo:['male','qun',3,['qingnang','jijiu']],\r\n\t\t\tlvbu:['male','qun',4,['wushuang']],\r\n\t\t\tdiaochan:['female','qun',3,['pianyi','biyue']],\r\n\t\t\t\r\n\t\t\txiahouyuan:['male','wei',4,['shensu','suzi']],\r\n\t\t\told_caoren:['male','wei',4,['jushou']],\r\n\t\t\thuangzhong:['male','shu',4,['liegong']],\r\n\t\t\tweiyan:['male','shu',4,['sgkuanggu']],\r\n\t\t\txiaoqiao:['female','wu',3,['tianxiang','hongyan']],\r\n\t\t\told_zhoutai:['male','wu',4,['gzbuqu']],\r\n\t\t\tzhangjiao:['male','qun',3,['leiji','guidao'],['zhu']],\r\n\r\n\t\t\tdianwei:['male','wei',4,['qiangxi']],\r\n\t\t\tyanwen:['male','qun',4,['shuangxiong']],\r\n\t\t\tpangde:['male','qun',4,['xiaoxi','mengjin']],\r\n\r\n\t\t\tmenghuo:['male','shu',4,['manyi','zaiqi']],\r\n\t\t\tzhurong:['female','shu',4,['manyi','lieren']],\r\n\t\t\txuhuang:['male','wei',4,['sgduanliang']],\r\n\t\t\tsunjian:['male','wu',4,['gzyinghun']],\r\n\r\n\t\t\tjiangwei:['male','shu',4,['tiaoxin']],\r\n\t\t\t\r\n\t\t\thejin:['male','qun',4,['mouzhu','yanhuo']],\r\n\t\t\thansui:['male','qun',4,['xiaoxi','niluan']],\r\n\t\t\tniujin:['male','wei',4,['cuorui','liewei']],\r\n\t\t\t\r\n\t\t\tjin_zhangchunhua:['female','jin',3,['huishi','qingleng']],\r\n\t\t\tjin_simayi:['male','jin',3,['smyyingshi','xiongzhi','quanbian']],\r\n\t\t\tjin_wangyuanji:['female','jin',3,['yanxi']],\r\n\t\t\tjin_simazhao:['male','jin',3,['choufa','zhaoran']],\r\n\t\t\tjin_xiahouhui:['female','jin',3,['jyishi','shiduo']],\r\n\t\t\tjin_simashi:['male','jin','3/4',['yimie','tairan']],\r\n\t\t\tzhanghuyuechen:['male','jin',4,['xijue']],\r\n\t\t\tduyu:['male','jin',4,['sanchen','zhaotao']],\r\n\t\t},\r\n\t\tstartBefore:function(){\r\n\t\t\t\r\n\t\t},\r\n\t\tonreinit:function(){\r\n\t\t\t_status.mode=_status.connectMode?lib.configOL.single_mode:get.config('single_mode');\r\n\t\t\tif(_status.mode!='normal') return;\r\n\t\t\tfor(var i in lib.characterSingle){\r\n\t\t\t\tlib.character[i]=lib.characterSingle[i];\r\n\t\t\t\tif(!lib.character[i][4]){\r\n\t\t\t\t\tlib.character[i][4]=[];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(var j in lib.singleTranslate) lib.translate[j]=lib.singleTranslate[j];\r\n\t\t},\r\n\t\tstart:function(){\r\n\t\t\t\"step 0\"\r\n\t\t\tvar playback=localStorage.getItem(lib.configprefix+'playback');\r\n\t\t\tif(playback){\r\n\t\t\t\tui.create.me();\r\n\t\t\t\tui.arena.style.display='none';\r\n\t\t\t\tui.system.style.display='none';\r\n\t\t\t\t_status.playback=playback;\r\n\t\t\t\tlocalStorage.removeItem(lib.configprefix+'playback');\r\n\t\t\t\tvar store=lib.db.transaction(['video'],'readwrite').objectStore('video');\r\n\t\t\t\tstore.get(parseInt(playback)).onsuccess=function(e){\r\n\t\t\t\t\tif(e.target.result){\r\n\t\t\t\t\t\tgame.playVideoContent(e.target.result.video);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\talert('播放失败：找不到录像');\r\n\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tevent.finish();\r\n\t\t\t}\r\n\t\t\telse if(!_status.connectMode){\r\n\t\t\t\tgame.prepareArena(2);\r\n\t\t\t}\r\n\t\t\t\"step 1\"\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\tgame.waitForPlayer(function(){\r\n\t\t\t\t\t\tlib.configOL.number=2;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\"step 2\"\r\n\t\t\t_status.mode=_status.connectMode?lib.configOL.single_mode:get.config('single_mode');\r\n\t\t\tif(_status.mode=='normal'){\r\n\t\t\t\tlib.card.list=lib.singlePile.slice(0);\r\n\t\t\t\tgame.fixedPile=true;\r\n\t\t\t\tgame.broadcastAll(function(singleTranslate,characterSingle,jin){\r\n\t\t\t\t\t_status.mode='normal';\r\n\t\t\t\t\tfor(var j in singleTranslate) lib.translate[j]=singleTranslate[j];\r\n\t\t\t\t\t_status.characterlist=[];\r\n\t\t\t\t\tfor(var i in characterSingle){\r\n\t\t\t\t\t\tif(!jin&&characterSingle[i][1]=='jin') continue;\r\n\t\t\t\t\t\tlib.character[i]=characterSingle[i];\r\n\t\t\t\t\t\tif(!lib.character[i][4]){\r\n\t\t\t\t\t\t\tlib.character[i][4]=[];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_status.characterlist.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t},lib.singleTranslate,lib.characterSingle,_status.connectMode?lib.configOL.enable_jin:get.config('enable_jin'));\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='changban'){\r\n\t\t\t\t_status.characterlist=[];\r\n\t\t\t\tfor(var i=0;i<lib.changbanCharacter.length;i++){\r\n\t\t\t\t\tvar name=lib.changbanCharacter[i];\r\n\t\t\t\t\tif(lib.character[name]&&!lib.filter.characterDisabled(name)) _status.characterlist.push(name);\r\n\t\t\t\t}\r\n\t\t\t\tgame.broadcastAll(function(){\r\n\t\t\t\t\t_status.mode='changban';\r\n\t\t\t\t\tlib.translate.bingliang_info='目标角色判定阶段进行判定：若判定结果不为梅花，则跳过该角色的摸牌阶段。';\r\n\t\t\t\t\tlib.translate.zhuge_info='锁定技，出牌阶段，你使用杀的次数上限+3';\r\n\t\t\t\t});\r\n\t\t\t\tfor(var i=0;i<lib.card.list.length;i++){\r\n\t\t\t\t\tvar card=lib.card.list[i];\r\n\t\t\t\t\tif(card[2]=='muniu'||card[2]=='shandian'||card[2]=='tengjia'&&card[0]=='club'||\r\n\t\t\t\t\tcard[2]=='wuxie'&&card[0]=='diamond'&&card[1]==12) lib.card.list.splice(i--,1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\tlib.configOL.number=2;\r\n\t\t\t\tgame.randomMapOL();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacter();\r\n\t\t\t}\r\n\t\t\t\"step 3\"\r\n\t\t\tif(ui.coin){\r\n\t\t\t\t_status.coinCoeff=get.coinCoeff([game.me.name]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tgame.syncState();\r\n\t\t\tevent.trigger('gameStart');\r\n\t\t\t\r\n\t\t\tvar players=get.players(lib.sort.position);\r\n\t\t\tvar info=[];\r\n\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\tinfo.push({\r\n\t\t\t\t\tname:players[i].name1,\r\n\t\t\t\t\tname2:players[i].name2,\r\n\t\t\t\t\tidentity:players[i].identity\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t_status.videoInited=true;\r\n\t\t\tgame.addVideo('init',null,info);\r\n\r\n\t\t\tgame.gameDraw(game.zhu,function(player){\r\n\t\t\t\tif(_status.mode=='dianjiang') return 4;\r\n\t\t\t\tif(_status.mode=='changban') return player==game.fan?5:4;\r\n\t\t\t\tif(player.hasSkill('cuorui')){\r\n\t\t\t\t\tplayer.logSkill('cuorui');\r\n\t\t\t\t\treturn 2+_status.characterChoice[player.identity].length;\r\n\t\t\t\t}\r\n\t\t\t\treturn player.maxHp;\r\n\t\t\t});\r\n\t\t\t\"step 4\"\r\n\t\t\tevent.trigger('phaseLoopBefore');\r\n\t\t\t\"step 5\"\r\n\t\t\tgame.phaseLoop(game.zhu);\r\n\t\t},\r\n\t\tgame:{\r\n\t\t\taddRecord:function(bool){\r\n\t\t\t\tif(typeof bool=='boolean'){\r\n\t\t\t\t\tvar mode=_status.mode;\r\n\t\t\t\t\tvar data=lib.config.gameRecord.single.data;\r\n\t\t\t\t\tif(!get.is.object(data[mode])) data[mode]={};\r\n\t\t\t\t\tvar data2=data[mode]\r\n\t\t\t\t\tvar identity=game.me.identity;\r\n\t\t\t\t\tif(!data2[identity]){\r\n\t\t\t\t\t\tdata2[identity]=[0,0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(bool){\r\n\t\t\t\t\t\tdata2[identity][0]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tdata2[identity][1]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list=['zhu','fan'];\r\n\t\t\t\t\tvar str='';\r\n\t\t\t\t\tfor(var j in data){\r\n\t\t\t\t\t\tstr+=get.translation(j+2)+'：<br>';\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tif(data[j][list[i]]){\r\n\t\t\t\t\t\t\t\tstr+=lib.translate[list[i]+'2']+'：'+data[j][list[i]][0]+'胜'+' '+data[j][list[i]][1]+'负<br>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.config.gameRecord.single.str=str;\r\n\t\t\t\t\tgame.saveConfig('gameRecord',lib.config.gameRecord);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetState:function(){\r\n\t\t\t\tvar state={};\r\n\t\t\t\tfor(var i in lib.playerOL){\r\n\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\tstate[i]={identity:player.identity};\r\n\t\t\t\t}\r\n\t\t\t\treturn state;\r\n\t\t\t},\r\n\t\t\tupdateState:function(state){\r\n\t\t\t\tfor(var i in state){\r\n\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\tif(player){\r\n\t\t\t\t\t\tplayer.identity=state[i].identity;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetRoomInfo:function(uiintro){\r\n\t\t\t\tif(lib.configOL.single_mode=='normal') uiintro.add('<div class=\"text chat\">晋势力武将：'+(lib.configOL.enable_jin?'开启':'关闭'));\r\n\t\t\t\tif(lib.configOL.bannedcards.length){\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">禁用卡牌：'+get.translation(lib.configOL.bannedcards));\r\n\t\t\t\t}\r\n\t\t\t\tuiintro.style.paddingBottom='8px';\r\n\t\t\t},\r\n\t\t\tgetVideoName:function(){\r\n\t\t\t\tvar str=get.translation(game.me.name);\r\n\t\t\t\tif(game.me.name2){\r\n\t\t\t\t\tstr+='/'+get.translation(game.me.name2);\r\n\t\t\t\t}\r\n\t\t\t\tvar name=[\r\n\t\t\t\t\tstr,\r\n\t\t\t\t\tget.translation(_status.mode+2)+' - '+lib.translate[game.me.identity+'2']\r\n\t\t\t\t];\r\n\t\t\t\treturn name;\r\n\t\t\t},\r\n\t\t\tshowIdentity:function(){},\r\n\t\t\tcheckResult:function(){\r\n\t\t\t\tgame.over((game.me._trueMe||game.me).isAlive());\r\n\t\t\t},\r\n\t\t\tcheckOnlineResult:function(player){\r\n\t\t\t\treturn player.isAlive();\r\n\t\t\t},\r\n\t\t\tchooseCharacterDianjiang:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tgame.me.chooseControl('先手','后手').prompt='请选择自己的行动顺序';\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tvar map=result.control=='先手'?['zhu','fan']:['fan','zhu'];\r\n\t\t\t\t\tgame.me.identity=map[0];\r\n\t\t\t\t\tgame.me.next.identity=map[1];\r\n\t\t\t\t\tgame.me.showIdentity();\r\n\t\t\t\t\tgame.me.next.showIdentity();\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tevent.flipassign=true;\r\n\t\t\t\t\tevent.videoId=lib.status.videoId++;\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(var i in lib.character){\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.characterlist=list;\r\n\t\t\t\t\tvar filter=function(name){\r\n\t\t\t\t\t\treturn !_status.characterlist.contains(name);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar dialog=ui.create.characterDialog('heightset',filter).open();\r\n\t\t\t\t\tdialog.videoId=event.videoId;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tgame.me.chooseButton(true).set('ai',function(button){\r\n\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t}).set('dialog',event.videoId);\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\tgame.me.chooseButton(true).set('ai',function(button){\r\n\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t}).set('dialog',event.videoId);\r\n\t\t\t\t\t\"step 5\"\r\n\t\t\t\t\tgame.me.next.init(result.links[0]);\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacter:function(){\r\n\t\t\t\tif(_status.mode=='dianjiang'){\r\n\t\t\t\t\tgame.chooseCharacterDianjiang();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar num=[0,1].randomGet();\r\n\t\t\t\t\tgame.players[num].identity='zhu';\r\n\t\t\t\t\tgame.players[1-num].identity='fan';\r\n\t\t\t\t\tgame.broadcastAll(function(p,t){\r\n\t\t\t\t\t\tp.enemy=t;t.enemy=p;\r\n\t\t\t\t\t},game.players[0],game.players[1]);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].showIdentity();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t_status.characterChoice={\r\n\t\t\t\t\t\tzhu:_status.characterlist.randomRemove(3),\r\n\t\t\t\t\t\tfan:_status.characterlist.randomRemove(3),\r\n\t\t\t\t\t\tall:_status.characterlist.randomRemove(6),\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.videoIdx=lib.status.videoId++;\r\n\t\t\t\t\tgame.broadcastAll(function(id,list){\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('选择武将',[list.all,'character'],'起始武将',[list[game.me.identity],'character']);\r\n\t\t\t\t\t\tdialog.videoId=id;\r\n\t\t\t\t\t},event.videoIdx,_status.characterChoice);\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tvar next=game.fan.chooseButton(true,1);\r\n\t\t\t\t\tnext.filterButton=function(button){\r\n\t\t\t\t\t\treturn _status.event.canChoose.contains(button.link);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnext.set('onfree',true);\r\n\t\t\t\t\tnext.dialog=event.videoIdx;\r\n\t\t\t\t\tnext.canChoose=_status.characterChoice.all;\r\n\t\t\t\t\tnext.ai=function(){return Math.random()};\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\t_status.characterChoice.fan.addArray(result.links);\r\n\t\t\t\t\t_status.characterChoice.all.removeArray(result.links);\r\n\t\t\t\t\tgame.broadcastAll(function(link,choosing,first,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(choosing==game.me){\r\n\t\t\t\t\t\t\t\tchoosing='你';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tchoosing='对手';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML=choosing+'选择了'+get.translation(link);\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(link.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\t\tif(first){\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result.links,game.fan,true,event.videoIdx);\r\n\t\t\t\t\tvar next=game.zhu.chooseButton(true,2);\r\n\t\t\t\t\tnext.filterButton=function(button){\r\n\t\t\t\t\t\treturn _status.event.canChoose.contains(button.link);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnext.dialog=event.videoIdx;\r\n\t\t\t\t\tnext.canChoose=_status.characterChoice.all;\r\n\t\t\t\t\tnext.ai=function(){return Math.random()};\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\t_status.characterChoice.zhu.addArray(result.links);\r\n\t\t\t\t\t_status.characterChoice.all.removeArray(result.links);\r\n\t\t\t\t\tgame.broadcastAll(function(link,choosing,first,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(choosing==game.me){\r\n\t\t\t\t\t\t\t\tchoosing='你';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tchoosing='对手';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML=choosing+'选择了'+get.translation(link);\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(link.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\t\tif(first){\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result.links,game.zhu,false,event.videoIdx);\r\n\t\t\t\t\tvar next=game.fan.chooseButton(true,2);\r\n\t\t\t\t\tnext.filterButton=function(button){\r\n\t\t\t\t\t\treturn _status.event.canChoose.contains(button.link);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnext.dialog=event.videoIdx;\r\n\t\t\t\t\tnext.canChoose=_status.characterChoice.all;\r\n\t\t\t\t\tnext.ai=function(){return Math.random()};\r\n\t\t\t\t\t\"step 5\"\r\n\t\t\t\t\t_status.characterChoice.fan.addArray(result.links);\r\n\t\t\t\t\t_status.characterChoice.all.removeArray(result.links);\r\n\t\t\t\t\tgame.broadcastAll(function(link,choosing,first,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(choosing==game.me){\r\n\t\t\t\t\t\t\t\tchoosing='你';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tchoosing='对手';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML=choosing+'选择了'+get.translation(link);\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(link.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\t\tif(first){\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result.links,game.fan,true,event.videoIdx);\r\n\t\t\t\t\tvar next=game.zhu.chooseButton(true);\r\n\t\t\t\t\tnext.filterButton=function(button){\r\n\t\t\t\t\t\treturn _status.event.canChoose.contains(button.link);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnext.dialog=event.videoIdx;\r\n\t\t\t\t\tnext.canChoose=_status.characterChoice.all;\r\n\t\t\t\t\tnext.ai=function(){return Math.random()};\r\n\t\t\t\t\t\"step 6\"\r\n\t\t\t\t\t_status.characterChoice.zhu.addArray(result.links);\r\n\t\t\t\t\t_status.characterChoice.all.removeArray(result.links);\r\n\t\t\t\t\tgame.broadcastAll(function(link,choosing,first,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(choosing==game.me){\r\n\t\t\t\t\t\t\t\tchoosing='你';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tchoosing='对手';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML=choosing+'选择了'+get.translation(link);\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(link.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\t\tif(first){\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result.links,game.zhu,false,event.videoIdx);\r\n\t\t\t\t\t\"step 7\"\r\n\t\t\t\t\tgame.broadcastAll('closeDialog',event.videoIdx);\r\n\t\t\t\t\t\"step 8\"\r\n\t\t\t\t\tgame.me.chooseButton(true,['请选择出场武将',[_status.characterChoice[game.me.identity],'character']],_status.mode=='changban'?2:1);\r\n\t\t\t\t\t\"step 9\"\r\n\t\t\t\t\tgame.me.init(result.links[0],_status.mode=='changban'?result.links[1]:null);\r\n\t\t\t\t\t_status.characterChoice[game.me.identity].removeArray(result.links);\r\n\t\t\t\t\tvar list=_status.characterChoice[game.me.enemy.identity].randomRemove(_status.mode=='changban'?2:1);\r\n\t\t\t\t\tgame.me.enemy.init(list[0],list[1]);\r\n\t\t\t\t\t\"step 10\"\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterDianjiangOL:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar map=Math.random()<0.5?['zhu','fan']:['fan','zhu'];\r\n\t\t\t\t\tgame.me.identity=map[0];\r\n\t\t\t\t\tgame.me.next.identity=map[1];\r\n\t\t\t\t\tgame.me.showIdentity();\r\n\t\t\t\t\tgame.me.next.showIdentity();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t//event.flipassign=true;\r\n\t\t\t\t\tevent.videoId=lib.status.videoId++;\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tvar libCharacter={};\r\n\t\t\t\t\tfor(var i=0;i<lib.configOL.characterPack.length;i++){\r\n\t\t\t\t\t\tvar pack=lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor(var j in pack){\r\n\t\t\t\t\t\t\tif(j=='zuoci') continue;\r\n\t\t\t\t\t\t\tif(lib.character[j]) libCharacter[j]=pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in libCharacter){\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i,libCharacter)) continue;\r\n\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function(list,id){\r\n\t\t\t\t\t\t_status.characterlist=list;\r\n\t\t\t\t\t\tvar filter=function(name){\r\n\t\t\t\t\t\t\treturn !_status.characterlist.contains(name);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar dialog=ui.create.characterDialog('heightset',filter).open();\r\n\t\t\t\t\t\tdialog.videoId=id;\r\n\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t},list,event.videoId);\r\n\t\t\t\t\tgame.zhu.chooseButton(true).set('ai',function(button){\r\n\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t}).set('dialog',event.videoId);\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tgame.broadcastAll(function(player,character,id){\r\n\t\t\t\t\t\tplayer.init(character);\r\n\t\t\t\t\t\tif(player==game.me) game.addRecentCharacter(character);\r\n\t\t\t\t\t},game.zhu,result.links[0]);\r\n\t\t\t\t\tgame.fan.chooseButton(true).set('ai',function(button){\r\n\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t}).set('dialog',event.videoId);\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tgame.broadcastAll('closeDialog',event.videoId);\r\n\t\t\t\t\tgame.broadcastAll(function(player,character,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tdialog.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.init(character);\r\n\t\t\t\t\t\tif(player==game.me) game.addRecentCharacter(character);\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},game.fan,result.links[0],event.videoId);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL:function(){\r\n\t\t\t\tif(_status.mode=='dianjiang'){\r\n\t\t\t\t\tgame.chooseCharacterDianjiangOL();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar num=[0,1].randomGet();\r\n\t\t\t\t\tgame.players[num].identity='zhu';\r\n\t\t\t\t\tgame.players[1-num].identity='fan';\r\n\t\t\t\t\tgame.broadcastAll(function(p,t){\r\n\t\t\t\t\t\tp.enemy=t;t.enemy=p;\r\n\t\t\t\t\t},game.players[0],game.players[1]);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].showIdentity();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t_status.characterChoice={\r\n\t\t\t\t\t\tzhu:_status.characterlist.randomRemove(3),\r\n\t\t\t\t\t\tfan:_status.characterlist.randomRemove(3),\r\n\t\t\t\t\t\tall:_status.characterlist.randomRemove(6),\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.videoIdx=lib.status.videoId++;\r\n\t\t\t\t\tgame.broadcastAll(function(id,list){\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog(game.me.identity=='fan'?'选择武将':'请等待对手选择武将',[list.all,'character'],'起始武将',[list[game.me.identity],'character']);\r\n\t\t\t\t\t\tdialog.videoId=id;\r\n\t\t\t\t\t},event.videoIdx,_status.characterChoice);\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tvar next=game.fan.chooseButton(true,1);\r\n\t\t\t\t\tnext.set('filterButton',function(button){\r\n\t\t\t\t\t\treturn _status.event.canChoose.contains(button.link);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.set('dialog',event.videoIdx);\r\n\t\t\t\t\tnext.set('canChoose',_status.characterChoice.all);\r\n\t\t\t\t\tnext.ai=function(){return Math.random()};\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\t_status.characterChoice.fan.addArray(result.links);\r\n\t\t\t\t\t_status.characterChoice.all.removeArray(result.links);\r\n\t\t\t\t\tgame.broadcastAll(function(link,choosing,first,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(choosing==game.me){\r\n\t\t\t\t\t\t\t\tchoosing='你';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tchoosing='对手';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML=choosing+'选择了'+get.translation(link);\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(link.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\t\tif(first){\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result.links,game.fan,true,event.videoIdx);\r\n\t\t\t\t\tvar next=game.zhu.chooseButton(true,2);\r\n\t\t\t\t\tnext.set('filterButton',function(button){\r\n\t\t\t\t\t\treturn _status.event.canChoose.contains(button.link);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.set('dialog',event.videoIdx);\r\n\t\t\t\t\tnext.set('canChoose',_status.characterChoice.all);\r\n\t\t\t\t\tnext.ai=function(){return Math.random()};\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\t_status.characterChoice.zhu.addArray(result.links);\r\n\t\t\t\t\t_status.characterChoice.all.removeArray(result.links);\r\n\t\t\t\t\tgame.broadcastAll(function(link,choosing,first,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(choosing==game.me){\r\n\t\t\t\t\t\t\t\tchoosing='你';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tchoosing='对手';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML=choosing+'选择了'+get.translation(link);\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(link.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\t\tif(first){\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result.links,game.zhu,false,event.videoIdx);\r\n\t\t\t\t\tvar next=game.fan.chooseButton(true,2);\r\n\t\t\t\t\tnext.set('filterButton',function(button){\r\n\t\t\t\t\t\treturn _status.event.canChoose.contains(button.link);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.set('dialog',event.videoIdx);\r\n\t\t\t\t\tnext.set('canChoose',_status.characterChoice.all);\r\n\t\t\t\t\tnext.ai=function(){return Math.random()};\r\n\t\t\t\t\t\"step 5\"\r\n\t\t\t\t\t_status.characterChoice.fan.addArray(result.links);\r\n\t\t\t\t\t_status.characterChoice.all.removeArray(result.links);\r\n\t\t\t\t\tgame.broadcastAll(function(link,choosing,first,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(choosing==game.me){\r\n\t\t\t\t\t\t\t\tchoosing='你';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tchoosing='对手';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML=choosing+'选择了'+get.translation(link);\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(link.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\t\tif(first){\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result.links,game.fan,true,event.videoIdx);\r\n\t\t\t\t\tvar next=game.zhu.chooseButton(true);\r\n\t\t\t\t\tnext.set('filterButton',function(button){\r\n\t\t\t\t\t\treturn _status.event.canChoose.contains(button.link);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.set('dialog',event.videoIdx);\r\n\t\t\t\t\tnext.set('canChoose',_status.characterChoice.all);\r\n\t\t\t\t\tnext.ai=function(){return Math.random()};\r\n\t\t\t\t\t\"step 6\"\r\n\t\t\t\t\t_status.characterChoice.zhu.addArray(result.links);\r\n\t\t\t\t\t_status.characterChoice.all.removeArray(result.links);\r\n\t\t\t\t\tgame.broadcastAll(function(link,choosing,first,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(choosing==game.me){\r\n\t\t\t\t\t\t\t\tchoosing='你';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tchoosing='对手';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML=choosing+'选择了'+get.translation(link);\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(link.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\t\tif(first){\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result.links,game.zhu,false,event.videoIdx);\r\n\t\t\t\t\t\"step 7\"\r\n\t\t\t\t\tgame.broadcastAll('closeDialog',event.videoIdx);\r\n\t\t\t\t\t\"step 8\"\r\n\t\t\t\t\tvar num=_status.mode=='changban'?2:1;\r\n\t\t\t\t\tvar list=[\r\n\t\t\t\t\t[game.zhu,num,true,['选择出场角色',[_status.characterChoice.zhu,'character']]],\r\n\t\t\t\t\t[game.fan,num,true,['选择出场角色',[_status.characterChoice.fan,'character']]]\r\n\t\t\t\t\t];\r\n\t\t\t\t\tgame.me.chooseButtonOL(list,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0],result.links[1]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 9\"\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tvar current=lib.playerOL[i];\r\n\t\t\t\t\t\tif(result[i]=='ai'){\r\n\t\t\t\t\t\t\tresult[i]=_status.characterChoice[current.identity].randomGets(_status.mode=='changban'?2:1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tresult[i]=result[i].links;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_status.characterChoice[current.identity].removeArray(result[i]);\r\n\t\t\t\t\t\tif(!current.name){\r\n\t\t\t\t\t\t\tcurrent.init(result[i][0],result[i][1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function(result){\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tif(!lib.playerOL[i].name){\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0],result[i][1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},result);\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t},\r\n\t\telement:{\r\n\t\t\tplayer:{\r\n\t\t\t\thasZhuSkill:function(){return false;},\r\n\t\t\t\tdieAfter:function(){\r\n\t\t\t\t\tif(_status.mode!='normal'||_status.characterChoice[this.identity].length<=3) game.checkResult();\r\n\t\t\t\t},\r\n\t\t\t\tdieAfter2:function(){\r\n\t\t\t\t\tif(_status.mode!='normal') return;\r\n\t\t\t\t\tvar next=game.createEvent('replacePlayerSingle',false,_status.event.getParent());\r\n\t\t\t\t\tnext.player=this;\r\n\t\t\t\t\tnext.forceDie=true;\r\n\t\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t\tplayer.chooseButton(true,['请选择一名出场武将',[_status.characterChoice[player.identity].slice(0),'character']]).set('forceDie',true);\r\n\t\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\t\tvar source=player;\r\n\t\t\t\t\t\tvar name=result.links[0];\r\n\t\t\t\t\tvar color=source.node.identity.dataset.color;\r\n\r\n\t\t\t\t\tgame.broadcastAll(function(source,name,color){\r\n\t\t\t\t\t\tsource.revive(null,false);\r\n\t\t\t\t\t\tsource.uninit();\r\n\t\t\t\t\t\tsource.init(name);\r\n\t\t\t\t\t\tsource.node.identity.dataset.color=color;\r\n\t\t\t\t\t},source,name,color);\r\n\t\t\t\t\tgame.log(source,'出场');\r\n\r\n\t\t\t\t\tvar num=source.maxHp;\r\n\t\t\t\t\tif(player.hasSkill('cuorui')){\r\n\t\t\t\t\tplayer.logSkill('cuorui');\r\n\t\t\t\t\tnum=2+_status.characterChoice[player.identity].length;\r\n\t\t\t\t}\r\n\t\t\t\t\tsource.draw(num);\r\n\t\t\t\t\tvar evt=event.getParent('dying');\r\n\t\t\t\t\tif(evt&&evt.parent) evt.parent.untrigger(false,source);\r\n\t\t\t\t\tgame.addVideo('reinit',source,[name,color]);\r\n\t\t\t\t\tgame.triggerEnter(source);\r\n\t\t\t\t\t_status.characterChoice[player.identity].remove(name);\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tlogAi:function(targets,card){},\r\n\t\t\t\tshowIdentity:function(){\r\n\t\t\t\t\tgame.broadcastAll(function(player,identity){\r\n\t\t\t\t\t\tplayer.identity=identity;\r\n\t\t\t\t\t\tgame[identity]=player;\r\n\t\t\t\t\t\tplayer.side=identity=='zhu';\r\n\t\t\t\t\t\tplayer.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\tplayer.identityShown=true;\r\n\t\t\t\t\t\tplayer.ai.shown=1;\r\n\t\t\t\t\t\tplayer.setIdentity();\r\n\t\t\t\t\t\tif(player.identity=='zhu'){\r\n\t\t\t\t\t\t\tplayer.isZhu=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(_status.clickingidentity){\r\n\t\t\t\t\t\t\tfor(var i=0;i<_status.clickingidentity[1].length;i++){\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform='';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},this,this.identity);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tget:{\r\n\t\t\tattitude:function(from,to){\r\n\t\t\t\tif(from.identity==to.identity) return 10;\r\n\t\t\t\treturn -10;\r\n\t\t\t},\r\n\t\t},\r\n\t\tskill:{\r\n\t\t\tmanyi:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{target:'useCardToBefore'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.card.name=='nanman';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card){\r\n\t\t\t\t\t\t\tif(card.name=='nanman') return 'zerotarget';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tgroup:'manyi2',\r\n\t\t\t},\r\n\t\t\tmanyi2:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'enterGame',\r\n\t\t\t\t\tglobal:'gameDrawAfter',\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.chooseUseTarget('nanman',get.prompt('manyi'),'视为使用一张【南蛮入侵】').logSkill='manyi';\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\twanrong:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{target:'useCardToTargeted'},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.card.name=='sha';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tsgzhiheng:{\r\n\t\t\t\taudio:'zhiheng',\r\n\t\t\t\tinherit:'zhiheng',\r\n\t\t\t\tselectCard:[1,2],\r\n\t\t\t\tprompt:'弃置至多两张牌并摸等量的牌',\r\n\t\t\t},\r\n\t\t\txiechan:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tlimited:true,\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tskillAnimation:true,\r\n\t\t\t\tanimationColor:'water',\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target!=player&&player.canCompare(target);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.awakenSkill('xiechan');\r\n\t\t\t\t\tplayer.chooseToCompare(target);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool) player.useCard({name:'juedou'},target,'noai');\r\n\t\t\t\t\telse target.useCard({name:'juedou'},player,'noai');\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:1,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(player.countCards('h',function(card){\r\n\t\t\t\t\t\t\t\treturn get.value(card)<=5&&get.number(card)>=12;\r\n\t\t\t\t\t\t\t})&&get.effect(target,{name:'juedou'},player,player)>0) return -1;\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\thuwei:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'enterGame',\r\n\t\t\t\t\tglobal:'gameDrawAfter',\r\n\t\t\t\t},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.chooseUseTarget('shuiyanqijunx',get.prompt('huwei'),'视为使用一张【水淹七军】').logSkill='huwei';\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tsgkuanggu:{\r\n\t\t\t\taudio:'kuanggu',\r\n\t\t\t\ttrigger:{source:'damageSource'},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.isDamaged();\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.judge(function(result){\r\n\t\t\t\t\t\treturn get.color(result)=='black'?2:-2;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool==true) player.recover();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tsuzi:{\r\n\t\t\t\tinherit:'xingshang',\r\n\t\t\t},\r\n\t\t\tcangji:{\r\n\t\t\t\ttrigger:{player:'die'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('e')>0;\r\n\t\t\t\t},\r\n\t\t\t\tforceDie:true,\r\n\t\t\t\tskillAnimation:true,\r\n\t\t\t\tanimationColor:'orange',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar cards=player.getCards('e');\r\n\t\t\t\t\tplayer.cangji_yozuru=cards;\r\n\t\t\t\t\tplayer.lose(cards,ui.special);\r\n\t\t\t\t\tplayer.addSkill('cangji_yozuru');\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tyozuru:{\r\n\t\t\t\t\t\tsub:true,\r\n\t\t\t\t\t\tcharlotte:true,\r\n\t\t\t\t\t\tsuperCharlotte:true,\r\n\t\t\t\t\t\ttrigger:{player:'enterGame'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\t//onremove:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tvar cards=player.cangji_yozuru.slice(0);\r\n\t\t\t\t\t\t\tfor(var i=0;i<cards.length;i++){\r\n\t\t\t\t\t\t\t\tplayer.equip(cards[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplayer.removeSkill('cangji_yozuru');\r\n\t\t\t\t\t\t\tdelete player.cangji_yozuru;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tsgrenwang:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{target:'useCardToTargeted'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player!=player&&event.player.isPhaseUsing()&&(event.card.name=='sha'||get.type(event.card)=='trick');\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(!player.hasSkill('sgrenwang_one')) player.addTempSkill('sgrenwang_one','phaseUseEnd');\r\n\t\t\t\t\telse if(trigger.player.countDiscardableCards(player,'he')){\r\n\t\t\t\t\t\tplayer.discardPlayerCard(trigger.player,'he',get.prompt('sgrenwang')).logSkill=['sgrenwang',trigger.player];\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tsgrenwang_one:{},\r\n\t\t\tsgduanliang:{\r\n\t\t\t\tgroup:'sgduanliang_gdm',\r\n\t\t\t\taudio:'duanliang1',\r\n\t\t\t\tenable:'chooseToUse',\r\n\t\t\t\tfilterCard:function(card){\r\n\t\t\t\t\tif(get.type(card)!='basic'&&get.type(card)!='equip') return false;\r\n\t\t\t\t\treturn get.color(card)=='black';\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.hasSkill('sgduanliang_sss')&&player.countCards('he',{type:['basic','equip'],color:'black'})\r\n\t\t\t\t},\r\n\t\t\t\tposition:'he',\r\n\t\t\t\tviewAs:{name:'bingliang'},\r\n\t\t\t\tprompt:'将一黑色的基本牌或装备牌当兵粮寸断使用',\r\n\t\t\t\tcheck:function(card){return 6-get.value(card)},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:9\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tgdm:{\r\n\t\t\t\t\t\ttrigger:{player:'useCardToPlayered'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tif(trigger.target!=player) player.addTempSkill('sgduanliang_sss');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsss:{},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tsgqingguo:{\r\n\t\t\t\taudio:'qingguo',\r\n\t\t\t\tenable:['chooseToRespond','chooseToUse'],\r\n\t\t\t\tfilterCard:true,\r\n\t\t\t\tviewAs:{name:'shan'},\r\n\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\tif(!player.countCards('e')) return false;\r\n\t\t\t\t},\r\n\t\t\t\tprompt:'将一张装备区中的牌当闪使用或打出',\r\n\t\t\t\tposition:'e',\r\n\t\t\t\tcheck:function(){return 1},\r\n\t\t\t\tai:{\r\n\t\t\t\t\trespondShan:true,\r\n\t\t\t\t\tskillTagFilter:function(player){\r\n\t\t\t\t\t\tif(!player.countCards('e')) return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(target.countCards('e')&&get.tag(card,'respondShan')&&current<0) return 0.6\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tpianyi:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'enterGame'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.getParent('phase').player==player.enemy;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar evt=_status.event.getParent('phase');\r\n\t\t\t\t\tif(evt){\r\n\t\t\t\t\t\tgame.log(player,'结束了',evt.player,'的回合');\r\n\t\t\t\t\t\tgame.resetSkills();\r\n\t\t\t\t\t\t_status.event=evt;\r\n\t\t\t\t\t\t_status.event.finish();\r\n\t\t\t\t\t\t_status.event.untrigger(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tyinli:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{global:'loseEnd'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.player==player||event.player!=_status.currentPhase||event.getParent().name=='useCard') return false;\r\n\t\t\t\t\tfor(var i=0;i<event.cards.length;i++){\r\n\t\t\t\t\t\tif(get.type(event.cards[i])=='equip'&&get.position(event.cards[i])=='d') return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(var i=0;i<trigger.cards.length;i++){\r\n\t\t\t\t\t\tif(get.type(trigger.cards[i])=='equip'&&get.position(trigger.cards[i])=='d') list.push(trigger.cards[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(list.length) player.gain(list,'gain2');\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tshenju:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tmaxHandcard:function(player,num){\r\n\t\t\t\t\t\tif(player.enemy&&player.enemy.hp) return num+player.enemy.hp;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t_changeHandcard:{\r\n\t\t\t\ttrigger:{global:'gameDrawAfter'},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn _status.mode=='changban'&&player.maxHp<=3;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseBool('是否更换手牌？').ai=function(){\r\n\t\t\t\t\t\tvar hs=player.getCards('h');\r\n\t\t\t\t\t\treturn get.value(hs,'raw')<6*hs;\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar hs=player.getCards('h');\r\n\t\t\t\t\t\tplayer.lose(hs,ui.special);\r\n\t\t\t\t\t\tevent.hs=hs;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse event.finish();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar hs=event.hs;\r\n\t\t\t\t\tplayer.draw(hs.length,'nodelay');\r\n\t\t\t\t\tfor(var i=0;i<hs.length;i++){\r\n\t\t\t\t\t\ths[i].fix();\r\n\t\t\t\t\t\tui.cardPile.insertBefore(hs[i],ui.cardPile.childNodes[get.rand(ui.cardPile.childElementCount)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tsingleTranslate:{\r\n\t\t\txiahouyuan:'夏侯渊',\r\n\t\t\thuangzhong:'黄忠',\r\n\t\t\tweiyan:'魏延',\r\n\t\t\txiaoqiao:'小乔',\r\n\t\t\txuhuang:'徐晃',\r\n\t\t\tpangde:'庞德',\r\n\t\t\tzhangjiao:'张角',\r\n\t\t\told_caoren:'曹仁',\r\n\t\t\told_zhoutai:'周泰',\r\n\t\t\tshuiyanqijunx_info:'出牌阶段，对一名其他角色使用。目标角色选择一项：1、弃置装备区里的所有牌；2、受到你造成的1点伤害。',\r\n\t\t\tguohe_info:'出牌阶段，对有牌的一名其他角色使用。你选择一项：①弃置其装备区里的一张牌。②观看其手牌并弃置其中的一张。',\r\n\t\t\tshunshou_info:'出牌阶段，对距离为1且有牌的一名其他角色使用。你获得其的一张牌。',\r\n\t\t},\r\n\t\ttranslate:{\r\n\t\t\tzhu:\"先\",\r\n\t\t\tfan:\"后\",\r\n\t\t\tzhu2:\"先手\",\r\n\t\t\tfan2:\"后手\",\r\n\t\t\tnormal2:'新1v1',\r\n\t\t\tchangban2:'血战长坂坡',\r\n\t\t\tdianjiang2:'点将单挑',\r\n\t\t\t\r\n\t\t\tmanyi:'蛮裔',\r\n\t\t\tmanyi_info:'锁定技，【南蛮入侵】对你无效。当你登场时，你可以视为使用一张【南蛮入侵】。',\r\n\t\t\twanrong:'婉容',\r\n\t\t\twanrong_info:'当你成为【杀】的目标后，你可以摸一张牌。',\r\n\t\t\tsgzhiheng:'制衡',\r\n\t\t\tsgzhiheng_info:'出牌阶段限一次，你可以弃置至多两张牌，然后摸等量的牌。',\r\n\t\t\txiechan:'挟缠',\r\n\t\t\txiechan_info:'限定技，出牌阶段，你可以和对手拼点。若你赢/没赢，你/其视为对其/你使用一张【决斗】。',\r\n\t\t\thuwei:'虎威',\r\n\t\t\thuwei_info:'当你登场时，你可以视为使用一张【水淹七军】。',\r\n\t\t\tsgkuanggu:'狂骨',\r\n\t\t\tsgkuanggu_info:'当你造成伤害后，若你已受伤，你可以进行判定：若结果为黑色，你回复1点体力。',\r\n\t\t\tsuzi:'肃资',\r\n\t\t\tcangji:'藏机',\r\n\t\t\tcangji_info:'当你死亡时，你可以将装备区内的所有牌移动到游戏外。若如此做，你的下一名角色登场时，你将这些牌置入你的装备区。',\r\n\t\t\tsgrenwang:'仁望',\r\n\t\t\tsgrenwang_info:'当你于一名其他角色的出牌阶段内成为该角色使用的【杀】或普通锦囊牌的目标后，若此牌不是其本阶段内对你使用的第一张【杀】或普通锦囊牌，则你可以弃置该角色的一张牌。',\r\n\t\t\tsgduanliang:'断粮',\r\n\t\t\tsgduanliang_info:'出牌阶段，若你本回合内使用牌指定过其他角色为目标，则你可以将一张黑色基本牌或装备牌当做【兵粮寸断】使用。',\r\n\t\t\tsgqingguo:'倾国',\r\n\t\t\tsgqingguo_info:'你可以将一张装备区内的牌当做【闪】使用或打出。',\r\n\t\t\tpianyi:'翩仪',\r\n\t\t\tpianyi_info:'锁定技，当你于对手的回合内登场时，你结束此回合。',\r\n\t\t\tyinli:'姻礼',\r\n\t\t\tyinli_info:'其他角色的装备牌于其回合内进入弃牌堆后，你可以获得之。',\r\n\t\t\tshenju:'慎拒',\r\n\t\t\tshenju_info:'锁定技，你的手牌上限+X（X为你对手的体力值）。',\r\n\t\t},\r\n\t\thelp:{\r\n\t\t'血战长坂':'<div style=\"margin:10px\">游戏规则</div><ul style=\"margin-top:0\"><li>选将阶段<br>双方在游戏开始时由系统随机分配身份。分配到先手身份的玩家优先出牌，分配到后手身份的玩家优先选将。<br>双方各自随机获得3名暗置武将，同时从将池中随机选出6名明置武将，由后手玩家开始，按照一次1张-2张-2张-1张的顺序，轮流选择获得明置武将。之后双方各从自己的6名武将中选择2名分别作为主将和副将进行游戏。<li>胜利条件<br>对方死亡。'+\r\n\t\t\t'<li>双将规则<br>双将主将决定角色的性别和势力，体力上限为主副将体力上限的平均值，向下取整。体力上限为3的角色可在游戏开始后更换一次起始手牌。<li>牌堆<br>牌堆中移除【木牛流马】【闪电】，♣花色的【初始服】和【无懈可击 ♦️Q】️</ul>',\r\n\t\t}\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/single.js?")},"./src/mode/versus.js":function(){eval("\r\ngame.import('mode',function(lib,game,ui,get,ai,_status){\r\n\treturn {\r\n\t\tname:'versus',\r\n\t\tinit:function(){\r\n\t\t\tif(get.config('versus_mode')=='jiange'){\r\n\t\t\t\tlib.characterPack.mode_versus=lib.jiangeboss;\r\n\t\t\t}\r\n\t\t\telse if(get.config('versus_mode')=='siguo'){\r\n\t\t\t\tfor(var i in lib.characterPack.mode_versus){\r\n\t\t\t\t\tlib.character[i]=lib.characterPack.mode_versus[i];\r\n\t\t\t\t}\r\n\t\t\t\tlib.cardPack.mode_versus=['zong','xionghuangjiu','tongzhougongji','lizhengshangyou'];\r\n\t\t\t\tlib.translate.mode_versus_character_config='四国武将';\r\n\t\t\t}\r\n\t\t\tif(!lib.cardPack.mode_versus){\r\n\t\t\t\tdelete lib.card.zong;\r\n\t\t\t\tdelete lib.card.xionghuangjiu;\r\n\t\t\t\tdelete lib.card.tongzhougongji;\r\n\t\t\t\tdelete lib.card.lizhengshangyou;\r\n\t\t\t}\r\n\t\t},\r\n\t\tstart:function(){\r\n\t\t\t\"step 0\"\r\n\t\t\tif(!_status.connectMode || lib.configOL.versus_mode === '4v4'){\r\n\t\t\t\tfor(let i in lib.characterPack){\r\n\t\t\t\t\tif(i=='clubs'){\r\n\t\t\t\t\t\tfor(var j in lib.characterPack[i]){\r\n\t\t\t\t\t\t\tlib.characterPack[i][j][1] = 'clubs';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(i=='vtuber'){\r\n\t\t\t\t\t\tfor(var j in lib.characterPack[i]){\r\n\t\t\t\t\t\t\tlib.characterPack[i][j][1] = 'vtuber';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tfor(var j in lib.characterPack[i]){\r\n\t\t\t\t\t\t\tif(['psp','xuefeng','VirtuaReal','HappyEl','asoul','dotlive','Tencent'].includes(lib.characterPack[i][j][1]))\tlib.characterPack[i][j][1] = 'vtuber';\r\n\t\t\t\t\t\t\telse if(!['holo','nijisanji'].includes(lib.characterPack[i][j][1]))\tlib.characterPack[i][j][1] = 'clubs';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t_status.mode=get.config('versus_mode');\r\n\t\t\tif(_status.connectMode) _status.mode=lib.configOL.versus_mode;\r\n\t\t\tif(_status.brawl&&_status.brawl.submode){\r\n\t\t\t\t_status.mode=_status.brawl.submode;\r\n\t\t\t}\r\n\t\t\tif(lib.config.test_game){\r\n\t\t\t\t_status.mode='standard';\r\n\t\t\t}\r\n\t\t\t\"step 1\"\r\n\t\t\tvar playback=localStorage.getItem(lib.configprefix+'playback');\r\n\t\t\tif(playback){\r\n\t\t\t\tui.create.me();\r\n\t\t\t\tui.arena.style.display='none';\r\n\t\t\t\tui.system.style.display='none';\r\n\t\t\t\t_status.playback=playback;\r\n\t\t\t\tlocalStorage.removeItem(lib.configprefix+'playback');\r\n\t\t\t\tvar store=lib.db.transaction(['video'],'readwrite').objectStore('video');\r\n\t\t\t\tstore.get(parseInt(playback)).onsuccess=function(e){\r\n\t\t\t\t\tif(e.target.result){\r\n\t\t\t\t\t\tgame.playVideoContent(e.target.result.video);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\talert('播放失败：找不到录像');\r\n\t\t\t\t\t\tgame.reload();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tevent.finish();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\tgame.waitForPlayer(function(){\r\n\t\t\t\t\tswitch(lib.configOL.versus_mode){\r\n\t\t\t\t\t\tcase '1v1':lib.configOL.number=2;break;\r\n\t\t\t\t\t\tcase '2v2':lib.configOL.number=4;break;\r\n\t\t\t\t\t\tcase '3v3':lib.configOL.number=6;break;\r\n\t\t\t\t\t\tcase '4v4':case 'guandu':lib.configOL.number=8;break;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='jiange'||_status.mode=='siguo'||_status.mode=='four'||_status.mode=='guandu'){\r\n\t\t\t\tif(_status.mode=='four'&&!get.config('enable_all_cards_four')){\r\n\t\t\t\t\tlib.card.list=lib.cardsFour;\r\n\t\t\t\t\tgame.fixedPile=true;\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='siguo'){\r\n\t\t\t\t\tfor(var i=0;i<lib.card.list.length;i++){\r\n\t\t\t\t\t\tswitch(lib.card.list[i][2]){\r\n\t\t\t\t\t\t\tcase 'tao':lib.card.list[i][2]='zong';break;\r\n\t\t\t\t\t\t\tcase 'jiu':lib.card.list[i][2]='xionghuangjiu';break;\r\n\t\t\t\t\t\t\tcase 'wuzhong':lib.card.list[i][2]='tongzhougongji';break;\r\n\t\t\t\t\t\t\tcase 'wugu':case 'taoyuan':lib.card.list[i][2]='lizhengshangyou';break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='guandu'){\r\n\t\t\t\t\tfor(var i=0;i<lib.card.list.length;i++){\r\n\t\t\t\t\t\tswitch(lib.card.list[i][2]){\r\n\t\t\t\t\t\t\tcase 'wugu':lib.card.list[i][2]='tunliang';break;\r\n\t\t\t\t\t\t\tcase 'nanman':lib.card.list[i][2]='lulitongxin';break;\r\n\t\t\t\t\t\t\tcase 'taoyuan':case 'shandian':lib.card.list[i][2]='yuanjun';break;\r\n\t\t\t\t\t\t\tcase 'muniu':lib.card.list.splice(i--,1);break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tgame.prepareArena(8);\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='two'){\r\n\t\t\t\tgame.prepareArena(4);\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='endless'){\r\n\t\t\t\tgame.prepareArena(2);\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='three'){\r\n\t\t\t\tif(lib.character.wenpin) lib.character.wenpin[3]=['zhenwei_three'];\r\n\t\t\t\tif(lib.character.zhugejin) lib.character.zhugejin[3]=['hongyuan','huanshi_three','mingzhe'];\r\n\t\t\t\tif(lib.character.key_yuzuru){\r\n\t\t\t\t\tlib.character.key_yuzuru[2]=4;\r\n\t\t\t\t\tlib.character.key_yuzuru[3]=['yuzuru_bujin'];\r\n\t\t\t\t}\r\n\t\t\t\tif(lib.character.guanyu) lib.character.guanyu[3]=['wusheng','zhongyi'];\r\n\t\t\t\tif(lib.character.lvbu) lib.character.lvbu[3]=['wushuang','zhanshen'];\r\n\t\t\t\tif(lib.character.xiahoudun) lib.character.xiahoudun[3]=['ganglie_three'];\r\n\t\t\t\tif(!get.config('enable_all_cards')){\r\n\t\t\t\t\tlib.translate.wuzhong_info+='若对方存活角色多于己方，则额外摸一张牌';\r\n\t\t\t\t\tlib.translate.zhuge_info='锁定技 出牌阶段，你使用杀的次数上限+3';\r\n\t\t\t\t\tlib.card.list=lib.cardsThree;\r\n\t\t\t\t\tgame.fixedPile=true;\r\n\t\t\t\t}\r\n\t\t\t\telse if(Array.isArray(lib.config.forbidthreecard)){\r\n\t\t\t\t\tfor(var i=0;i<lib.card.list.length;i++){\r\n\t\t\t\t\t\tif(lib.config.forbidthreecard.contains(lib.card.list[i][2])){\r\n\t\t\t\t\t\t\tlib.card.list.splice(i--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tui.create.cardsAsync();\r\n\t\t\t\tgame.finishCards();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif(lib.storage.choice==undefined) game.save('choice',20);\r\n\t\t\t\tif(lib.storage.zhu==undefined) game.save('zhu',true);\r\n\t\t\t\tif(lib.storage.noreplace_end==undefined) game.save('noreplace_end',true);\r\n\t\t\t\tif(get.config('first_less')==undefined) game.saveConfig('first_less',true,true);\r\n\t\t\t\tif(lib.storage.autoreplaceinnerhtml==undefined) game.save('autoreplaceinnerhtml',true);\r\n\t\t\t\tif(lib.storage.single_control==undefined) game.save('single_control',true);\r\n\t\t\t\tif(lib.storage.number==undefined) game.save('number',3);\r\n\t\t\t\tif(lib.storage.versus_reward==undefined) game.save('versus_reward',3);\r\n\t\t\t\tif(lib.storage.versus_punish==undefined) game.save('versus_punish','弃牌');\r\n\t\t\t\tif(lib.storage.replace_number==undefined) game.save('replace_number',3);\r\n\r\n\t\t\t\tswitch(lib.storage.seat_order){\r\n\t\t\t\t\tcase '交叉':lib.storage.cross_seat=true;lib.storage.random_seat=false;break;\r\n\t\t\t\t\tcase '随机':lib.storage.cross_seat=false;lib.storage.random_seat=true;break;\r\n\t\t\t\t\tdefault:lib.storage.cross_seat=false;lib.storage.random_seat=false;\r\n\t\t\t\t}\r\n\t\t\t\tgame.save('only_zhu',true);\r\n\t\t\t\tui.wuxie.hide();\r\n\t\t\t\tui.create.cardsAsync();\r\n\t\t\t\tgame.finishCards();\r\n\t\t\t}\r\n\t\t\t// game.delay();\r\n\t\t\t\"step 2\"\r\n\t\t\tif(!_status.connectMode&&_status.brawl&&_status.brawl.chooseCharacterBefore){\r\n\t\t\t\t_status.brawl.chooseCharacterBefore();\r\n\t\t\t}\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\tif(_status.mode=='guandu'){\r\n\t\t\t\t\tfor(var i=0;i<lib.card.list.length;i++){\r\n\t\t\t\t\t\tswitch(lib.card.list[i][2]){\r\n\t\t\t\t\t\t\tcase 'wugu':lib.card.list[i][2]='tunliang';break;\r\n\t\t\t\t\t\t\tcase 'nanman':lib.card.list[i][2]='lulitongxin';break;\r\n\t\t\t\t\t\t\tcase 'taoyuan':case 'shandian':lib.card.list[i][2]='yuanjun';break;\r\n\t\t\t\t\t\t\tcase 'muniu':lib.card.list.splice(i--,1);break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(lib.configOL.versus_mode=='1v1'){\r\n\t\t\t\t\tgame.randomMapOL('hidden');\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tgame.randomMapOL();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='guandu'){\r\n\t\t\t\tvar list=[\r\n\t\t\t\t\t['zhu','ezhu','ezhong','zhong','ezhong','zhong','zhong','ezhong'],\r\n\t\t\t\t\t['zhu','ezhong','zhong','ezhu','ezhong','zhong','ezhong','zhong'],\r\n\t\t\t\t\t['zhu','ezhong','zhong','ezhong','zhong','ezhong','zhong','ezhu'],\r\n\t\t\t\t\t['zhu','ezhu','zhong','ezhong','zhong','ezhong','zhong','ezhong'],\r\n\t\t\t\t\t['zhu','ezhong','zhong','ezhong','zhong','ezhu','zhong','ezhong'],\r\n\t\t\t\t].randomGet();\r\n\t\t\t\t\r\n\t\t\t\tvar side=true;\r\n\t\t\t\tvar num=Math.floor(Math.random()*8);\r\n\t\t\t\tlist=list.splice(8-num).concat(list);\r\n\t\t\t\t_status.firstAct=game.players[num];\r\n\t\t\t\tfor(var i=0;i<8;i++){\r\n\t\t\t\t\tif(list[i][0]=='e'){\r\n\t\t\t\t\t\tgame.players[i].side=side;\r\n\t\t\t\t\t\tgame.players[i].identity=list[i].slice(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.players[i].side=!side;\r\n\t\t\t\t\t\tgame.players[i].identity=list[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(game.players[i].identity=='zhu'){\r\n\t\t\t\t\t\tgame[game.players[i].side+'Zhu']=game.players[i];\r\n\t\t\t\t\t\tgame.players[i].isZhu=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.players[i].setIdentity(game.players[i].identity);\r\n\t\t\t\t\tgame.players[i].node.identity.dataset.color=get.translation(game.players[i].side+'Color');\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacterGuandu();\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='four'){\r\n\t\t\t\tconsole.log('ok2');\r\n\t\t\t\t_status.fouralign=[0,1,2,3,4];\r\n\t\t\t\tvar list=[\r\n\t\t\t\t\t['zhong','ezhong','ezhong','zhong','zhong','ezhong','ezhong','zhong'],\r\n\t\t\t\t\t['zhong','ezhong','zhong','ezhong','ezhong','zhong','ezhong','zhong'],\r\n\t\t\t\t\t['zhong','ezhong','ezhong','zhong','ezhong','zhong','zhong','ezhong'],\r\n\t\t\t\t\t['zhong','ezhong','zhong','ezhong','zhong','ezhong','zhong','ezhong'],\r\n\t\t\t\t\t['zhong','ezhong','ezhong','zhong','ezhong','zhong','ezhong','zhong'],\r\n\t\t\t\t][_status.fouralign.randomRemove()];\r\n\t\t\t\tvar rand1=Math.floor(Math.random()*4);\r\n\t\t\t\tvar rand2=Math.floor(Math.random()*4);\r\n\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\tif(list[i]=='zhong'){\r\n\t\t\t\t\t\tif(rand1==0){\r\n\t\t\t\t\t\t\tlist[i]='zhu';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\trand1--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(rand2==0){\r\n\t\t\t\t\t\t\tlist[i]='ezhu';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\trand2--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor(var i in lib.skill){\r\n\t\t\t\t\tif(lib.skill[i].changeSeat){\r\n\t\t\t\t\t\tlib.skill[i]={};\r\n\t\t\t\t\t\tif(lib.translate[i+'_info']){\r\n\t\t\t\t\t\t\tlib.translate[i+'_info']='此模式下不可用';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar side=Math.random()<0.5;\r\n\t\t\t\tvar num=Math.floor(Math.random()*8);\r\n\t\t\t\tlist=list.splice(8-num).concat(list);\r\n\t\t\t\t_status.firstAct=game.players[num];\r\n\t\t\t\tfor(var i=0;i<8;i++){\r\n\t\t\t\t\tif(list[i][0]=='e'){\r\n\t\t\t\t\t\tgame.players[i].side=side;\r\n\t\t\t\t\t\tgame.players[i].identity=list[i].slice(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.players[i].side=!side;\r\n\t\t\t\t\t\tgame.players[i].identity=list[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(game.players[i].identity=='zhu'){\r\n\t\t\t\t\t\tgame[game.players[i].side+'Zhu']=game.players[i];\r\n\t\t\t\t\t\tgame.players[i].isZhu=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.players[i].setIdentity(game.players[i].identity);\r\n\t\t\t\t\tgame.players[i].node.identity.dataset.color=get.translation(game.players[i].side+'Color');\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacterFour();\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='two'){\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacterTwo();\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='endless'){\r\n\t\t\t\tgame.chooseCharacterEndless();\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='siguo'){\r\n\t\t\t\tvar list=['holo','holo','nijisanji','nijisanji','vtuber','vtuber','clubs','clubs'].randomSort();\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tgame.players[i].side=list[i];\r\n\t\t\t\t\tgame.players[i].identity=list[i];\r\n\t\t\t\t\tgame.players[i].setIdentity(list[i]);\r\n\t\t\t\t\tgame.players[i].node.identity.style.display='none';\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t\tgame.players[i].node.action.innerHTML='获即<br>胜将';\r\n\t\t\t\t\tgame.players[i].node.action.style.letterSpacing='0px';\r\n\t\t\t\t\tgame.players[i].node.action.style.lineHeight='22px';\r\n\t\t\t\t\tgame.players[i].node.action.style.top='3px';\r\n\t\t\t\t\tgame.players[i].node.action.style.right='3px';\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacterSiguo();\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='jiange'){\r\n\t\t\t\tvar list=['nijisanjimech','nijisanji','nijisanjiboss','nijisanji','holo','holoboss','holo','holomech'];\r\n\t\t\t\tvar pos=Math.floor(Math.random()*8);\r\n\t\t\t\tfor(var i=0;i<8;i++){\r\n\t\t\t\t\tvar j=pos+i;\r\n\t\t\t\t\tif(j>=8){\r\n\t\t\t\t\t\tj-=8;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(list[i][0]=='h'){\r\n\t\t\t\t\t\tgame.players[j].side=true;\r\n\t\t\t\t\t\tgame.players[j].setIdentity('holo');\r\n\t\t\t\t\t\tgame.players[j].identity='holo';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.players[j].side=false;\r\n\t\t\t\t\t\tgame.players[j].setIdentity('nijisanji');\r\n\t\t\t\t\t\tgame.players[j].identity='nijisanji';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(list[i].indexOf('mech')!=-1){\r\n\t\t\t\t\t\tgame.players[j].type='mech';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(list[i].indexOf('boss')!=-1){\r\n\t\t\t\t\t\tgame.players[j].type='boss';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.players[j].type='human';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t}\r\n\t\t\t\tgame.chooseCharacterJiange();\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='three'){\r\n\t\t\t\tgame.chooseCharacterThree();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tgame.chooseCharacter();\r\n\t\t\t}\r\n\t\t\t\"step 3\"\r\n\t\t\tvar players=get.players(lib.sort.position);\r\n\t\t\tvar info=[];\r\n\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\tinfo.push({\r\n\t\t\t\t\tname:players[i].name1,\r\n\t\t\t\t\tname2:players[i].name2,\r\n\t\t\t\t\tidentity:players[i].node.identity.firstChild.innerHTML,\r\n\t\t\t\t\tcolor:players[i].node.identity.dataset.color\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t_status.videoInited=true;\r\n\t\t\tif(_status.mode=='four'||_status.mode=='jiange'||_status.connectMode||\r\n\t\t\t\t_status.mode=='two'||_status.mode=='siguo'||_status.mode=='endless'){\r\n\t\t\t\tinfo.push(false);\r\n\t\t\t}\r\n\t\t\telse if(_status.mode=='three'){\r\n\t\t\t\tinfo.push(true);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tinfo.push(lib.storage.single_control&&game.players.length>=4);\r\n\t\t\t}\r\n\t\t\tgame.addVideo('init',null,info);\r\n\t\t\tevent.trigger('gameStart');\r\n\t\t\tif(_status.connectMode){\r\n\t\t\t\tif(_status.mode=='1v1'){\r\n\t\t\t\t\t_status.first_less=true;\r\n\t\t\t\t\tgame.gameDraw(_status.firstChoose.next);\r\n\t\t\t\t\tgame.phaseLoop(_status.firstChoose.next);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='2v2'||_status.mode=='3v3'){\r\n\t\t\t\t\t_status.first_less=true;\r\n\t\t\t\t\tvar firstChoose=(_status.firstAct||game.players.randomGet());\r\n\t\t\t\t\tif(firstChoose.next.side==firstChoose.side){\r\n\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.gameDraw(firstChoose,function(player){\r\n\t\t\t\t\t\tif(lib.configOL.replace_handcard&&player==firstChoose.previousSeat){\r\n\t\t\t\t\t\t\treturn 5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 4;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.phaseLoop(firstChoose);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='guandu'){\r\n\t\t\t\t\tgame.gameDraw(_status.firstAct);\r\n\t\t\t\t\tgame.phaseLoop(_status.firstAct);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='4v4'){\r\n\t\t\t\t\tgame.gameDraw(_status.firstAct,function(player){\r\n\t\t\t\t\t\tif(player==_status.firstAct.previousSeat){\r\n\t\t\t\t\t\t\treturn 5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 4;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.replaceHandcards(_status.firstAct.previous,_status.firstAct.previous.previous);\r\n\t\t\t\t\tgame.phaseLoop(_status.firstAct);\r\n\t\t\t\t}\r\n\t\t\t\tevent.finish();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif(_status.mode=='guandu'){\r\n\t\t\t\t\tgame.gameDraw(_status.firstAct,4);\r\n\t\t\t\t\tgame.phaseLoop(_status.firstAct);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='two'){\r\n\t\t\t\t\t_status.first_less=true;\r\n\t\t\t\t\t_status.first_less_forced=true;\r\n\t\t\t\t\tvar firstChoose=_status.firstAct;\r\n\t\t\t\t\tgame.gameDraw(firstChoose,function(player){\r\n\t\t\t\t\t\tif(player==_status.firstAct.previousSeat&&get.config('replace_handcard_two')){\r\n\t\t\t\t\t\t\treturn 5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 4;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.phaseLoop(firstChoose);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='endless'){\r\n\t\t\t\t\t_status.first_less=true;\r\n\t\t\t\t\t_status.first_less_forced=true;\r\n\t\t\t\t\tvar firstChoose=_status.firstAct;\r\n\t\t\t\t\tgame.gameDraw(firstChoose);\r\n\t\t\t\t\tgame.phaseLoop(firstChoose);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='four'){\r\n\t\t\t\t\tgame.gameDraw(_status.firstAct,function(player){\r\n\t\t\t\t\t\tif(player==_status.firstAct.previousSeat){\r\n\t\t\t\t\t\t\treturn 5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 4;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(game.me==_status.firstAct.previous||game.me==_status.firstAct.previous.previous){\r\n\t\t\t\t\t\tgame.me.chooseBool('是否置换手牌？');\r\n\t\t\t\t\t\tevent.replaceCard=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='siguo'){\r\n\t\t\t\t\t_status.siguoai=[\r\n\t\t\t\t\t\t[-7.5,-2,0,-4.5,-6,-7.5],\r\n\t\t\t\t\t\t[-7.5,-2,0,-4.5,-6,-7.5],\r\n\t\t\t\t\t\t[-6,-6,-1,-4.5,-6,-7.5],\r\n\t\t\t\t\t\t[-6,-3,0,-3,-3,-6],\r\n\t\t\t\t\t\t[-6,-3,0,-3,-3,-6],\r\n\t\t\t\t\t\t[-6,-6,-6,-6,-6,-6],\r\n\t\t\t\t\t].randomGet();\r\n\t\t\t\t\tvar firstChoose=_status.firstAct;\r\n\t\t\t\t\tgame.gameDraw(firstChoose);\r\n\t\t\t\t\tgame.phaseLoop(firstChoose);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='jiange'){\r\n\t\t\t\t\tvar firstAct;\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].type=='mech'&&game.players[i].group=='holo'){\r\n\t\t\t\t\t\t\tfirstAct=game.players[i];break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.actlist=[\r\n\t\t\t\t\t\tfirstAct,\r\n\t\t\t\t\t\tfirstAct.next,\r\n\t\t\t\t\t\tfirstAct.previous,\r\n\t\t\t\t\t\tfirstAct.next.next,\r\n\t\t\t\t\t\tfirstAct.previous.previous,\r\n\t\t\t\t\t\tfirstAct.next.next.next,\r\n\t\t\t\t\t\tfirstAct.previous.previous.previous,\r\n\t\t\t\t\t\tfirstAct.next.next.next.next\r\n\t\t\t\t\t];\r\n\t\t\t\t\tgame.gameDraw(firstAct);\r\n\t\t\t\t\tgame.phaseLoopJiange();\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.mode=='three'){\r\n\t\t\t\t\tvar firstAct;\r\n\t\t\t\t\tif(_status.color){\r\n\t\t\t\t\t\tfirstAct=game.enemyZhu;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tfirstAct=game.friendZhu;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.gameDraw(firstAct,4);\r\n\t\t\t\t\tgame.addGlobalSkill('autoswap');\r\n\t\t\t\t\tif(lib.config.show_handcardbutton){\r\n\t\t\t\t\t\tui.versushs=ui.create.system('手牌',null,true);\r\n\t\t\t\t\t\tlib.setPopped(ui.versushs,game.versusHoverHandcards,220);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.phaseLoopThree(firstAct);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tvar firstAct;\r\n\t\t\t\t\tif(lib.storage.zhu){\r\n\t\t\t\t\t\t_status.currentSide=true;\r\n\t\t\t\t\t\tfirstAct=(_status.currentSide==game.me.side)?game.friendZhu:game.enemyZhu;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(!lib.storage.cross_seat&&!lib.storage.random_seat&&lib.storage.number>1){\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length-1;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].side!=game.players[i+1].side){\r\n\t\t\t\t\t\t\t\t\tvar actcount;\r\n\t\t\t\t\t\t\t\t\tif(Math.random()<0.5){\r\n\t\t\t\t\t\t\t\t\t\tactcount=i;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tif(i>=lib.storage.number){\r\n\t\t\t\t\t\t\t\t\t\t\tactcount=i-lib.storage.number;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\tactcount=i+lib.storage.number;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif(actcount>0){\r\n\t\t\t\t\t\t\t\t\t\tactcount--;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tactcount=game.players.length-1;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tfirstAct=game.players[actcount];\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tfirstAct=game.players[Math.floor(Math.random()*game.players.length)];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.gameDraw(firstAct,4);\r\n\t\t\t\t\t_status.first_less=true;\r\n\t\t\t\t\t_status.round=0;\r\n\t\t\t\t\tif(lib.storage.single_control){\r\n\t\t\t\t\t\tgame.addGlobalSkill('autoswap');\r\n\t\t\t\t\t\tif(game.players.length>2&&lib.config.show_handcardbutton){\r\n\t\t\t\t\t\t\tui.versushs=ui.create.system('手牌',null,true);\r\n\t\t\t\t\t\t\tlib.setPopped(ui.versushs,game.versusHoverHandcards,220);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.enemyCount=ui.create.system('杀敌: '+get.cnNumber(0,true),null,true);\r\n\t\t\t\t\t_status.friendCount=ui.create.system('阵亡: '+get.cnNumber(0,true),null,true);\r\n\r\n\t\t\t\t\tlib.setPopped(_status.friendCount,game.versusHoverFriend);\r\n\t\t\t\t\tlib.setPopped(_status.enemyCount,game.versusHoverEnemy);\r\n\r\n\t\t\t\t\tif(lib.storage.zhu){\r\n\t\t\t\t\t\tgame.versusPhaseLoop(firstAct);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.versusPhaseLoop(firstAct);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(_status.mode!='four'){\r\n\t\t\t\t\tevent.finish();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\"step 4\"\r\n\t\t\tif(event.replaceCard&&result.bool){\r\n\t\t\t\tvar hs=game.me.getCards('h');\r\n\t\t\t\tfor(var i=0;i<hs.length;i++){\r\n\t\t\t\t\ths[i].discard(false);\r\n\t\t\t\t}\r\n\t\t\t\tgame.me.directgain(get.cards(hs.length));\r\n\t\t\t}\r\n\t\t\tif(_status.ladder){\r\n\t\t\t\tlib.storage.ladder.current-=40;\r\n\t\t\t\t_status.ladder_tmp=true;\r\n\t\t\t\tgame.save('ladder',lib.storage.ladder);\r\n\t\t\t\tgame.addGlobalSkill('versus_ladder');\r\n\t\t\t}\r\n\t\t\tgame.phaseLoop(_status.firstAct);\r\n\t\t},\r\n\t\tgame:{\r\n\t\t\tgetLadderName:function(score){\r\n\t\t\t\tif(score<900) return '平民';\r\n\t\t\t\tif(score<1000) return '卫士五';\r\n\t\t\t\tif(score<1100) return '卫士四';\r\n\t\t\t\tif(score<1200) return '卫士三';\r\n\t\t\t\tif(score<1300) return '卫士二';\r\n\t\t\t\tif(score<1400) return '卫士一';\r\n\t\t\t\tif(score<1500) return '校尉三';\r\n\t\t\t\tif(score<1600) return '校尉二';\r\n\t\t\t\tif(score<1700) return '校尉一';\r\n\t\t\t\tif(score<1800) return '中郎将三';\r\n\t\t\t\tif(score<1900) return '中郎将二';\r\n\t\t\t\tif(score<2000) return '中郎将一';\r\n\t\t\t\tif(score<2100) return '大将五';\r\n\t\t\t\tif(score<2200) return '大将四';\r\n\t\t\t\tif(score<2300) return '大将三';\r\n\t\t\t\tif(score<2400) return '大将二';\r\n\t\t\t\tif(score<2500) return '大将一';\r\n\t\t\t\treturn '枭雄';\r\n\t\t\t},\r\n\t\t\tcheckOnlineResult:function(player){\r\n\t\t\t\tif(_status.mode=='4v4'||_status.mode=='guandu'){\r\n\t\t\t\t\tvar zhu=game.findPlayer(function(current){\r\n\t\t\t\t\t\treturn current.identity=='zhu';\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn player.side==zhu.side;\r\n\t\t\t\t}\r\n\t\t\t\treturn game.players[0].side==player.side;\r\n\t\t\t},\r\n\t\t\tgetRoomInfo:function(uiintro){\r\n\t\t\t\tif(lib.configOL.versus_mode=='1v1'){\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">侯选人数：'+lib.configOL.choice_num+'人');\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">替补人数：'+lib.configOL.replace_number+'人');\r\n\t\t\t\t}\r\n\t\t\t\telse if(lib.configOL.versus_mode=='2v2'||lib.configOL.versus_mode=='3v3'){\r\n\t\t\t\t\tuiintro.add('<div class=\"text chat\">四号位换牌：'+(lib.configOL.replace_handcard?'开启':'关闭'));\r\n\t\t\t\t}\r\n\t\t\t\tvar last=uiintro.add('<div class=\"text chat\">出牌时限：'+lib.configOL.choose_timeout+'秒');\r\n\t\t\t\t// uiintro.add('<div class=\"text chat\">屏蔽弱将：'+(lib.configOL.ban_weak?'开启':'关闭'));\r\n\t\t\t\t// var last=uiintro.add('<div class=\"text chat\">屏蔽强将：'+(lib.configOL.ban_strong?'开启':'关闭'));\r\n\t\t\t\tif(lib.configOL.banned.length){\r\n\t\t\t\t\tlast=uiintro.add('<div class=\"text chat\">禁用武将：'+get.translation(lib.configOL.banned));\r\n\t\t\t\t}\r\n\t\t\t\tif(lib.configOL.bannedcards.length){\r\n\t\t\t\t\tlast=uiintro.add('<div class=\"text chat\">禁用卡牌：'+get.translation(lib.configOL.bannedcards));\r\n\t\t\t\t}\r\n\t\t\t\tlast.style.paddingBottom='8px';\r\n\t\t\t},\r\n\t\t\tgetVideoName:function(){\r\n\t\t\t\tif(_status.mode=='three'){\r\n\t\t\t\t\tvar zhu=game.findPlayer2(function(current){\r\n\t\t\t\t\t\treturn current.side==game.me.side&&current.identity=='zhu';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar str=(game.me.side?'暖/':'冷/')+get.translation(zhu.previousSeat.name1)+'/'+get.translation(zhu.name1)+'/'+get.translation(zhu.nextSeat.name1);\r\n\t\t\t\t\treturn ['统率三军',str]\r\n\t\t\t\t}\r\n\t\t\t\tvar str=get.translation(game.me.name1);\r\n\t\t\t\tif(game.me.name2){\r\n\t\t\t\t\tstr+='/'+get.translation(game.me.name2);\r\n\t\t\t\t}\r\n\t\t\t\tvar str2;\r\n\t\t\t\tif(game.versusVideoName) str2=game.versusVideoName;\r\n\t\t\t\telse{\r\n \t\t\t\tswitch(_status.mode){\r\n \t\t\t\t\tcase 'two':str2='欢乐成双';break;\r\n \t\t\t\t\tcase 'endless':str2='无尽模式';break;\r\n \t\t\t\t\tcase 'three':str2='统率三军';break;\r\n \t\t\t\t\tcase 'siguo':str2='同舟共济';break;\r\n \t\t\t\t\tcase 'jiange':str2='虹杏战场';break;\r\n \t\t\t\t\tcase 'four':str2='对决 - 4v4';break;\r\n \t\t\t\t\tcase 'guandu':str2='官渡之战';break;\r\n \t\t\t\t\tdefault:str2='对决 - '+lib.storage.number+'v'+lib.storage.number\r\n \t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn [str,str2];\r\n\t\t\t},\r\n\t\t\taddRecord:function(bool){\r\n\t\t\t\tif(typeof bool=='boolean'){\r\n\t\t\t\t\tvar data=lib.config.gameRecord.versus.data;\r\n\t\t\t\t\tvar identity=get.cnNumber(lib.storage.number)+'人';\r\n\t\t\t\t\tif(!data[identity]){\r\n\t\t\t\t\t\tdata[identity]=[0,0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(bool){\r\n\t\t\t\t\t\tdata[identity][0]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tdata[identity][1]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list=['一人','两人','三人'];\r\n\t\t\t\t\tvar str='';\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(data[list[i]]){\r\n\t\t\t\t\t\t\tstr+=list[i]+'：'+data[list[i]][0]+'胜'+' '+data[list[i]][1]+'负<br>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.config.gameRecord.versus.str=str;\r\n\t\t\t\t\tgame.saveConfig('gameRecord',lib.config.gameRecord);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchooseCharacterJiange:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tfor(var i in lib.characterPack.mode_versus){\r\n\t\t\t\t\t\tlib.character[i]=lib.characterPack.mode_versus[i];\r\n\t\t\t\t\t\tif(!lib.character[i][4]){\r\n\t\t\t\t\t\t\tlib.character[i][4]=[];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlib.characterIntro.boss_liedixuande=lib.characterIntro.liubei;\r\n\t\t\t\t\tlib.characterIntro.boss_gongshenyueying=lib.characterIntro.huangyueying;\r\n\t\t\t\t\tlib.characterIntro.boss_tianhoukongming=lib.characterIntro.shen_zhugeliang;\r\n\t\t\t\t\tlib.characterIntro.boss_yuhuoshiyuan=lib.characterIntro.pangtong;\r\n\t\t\t\t\tlib.characterIntro.boss_qiaokuijunyi=lib.characterIntro.zhenghe;\r\n\t\t\t\t\tlib.characterIntro.boss_jiarenzidan=lib.characterIntro.caozhen;\r\n\t\t\t\t\tlib.characterIntro.boss_duanyuzhongda=lib.characterIntro.simayi;\r\n\t\t\t\t\tlib.characterIntro.boss_juechenmiaocai=lib.characterIntro.xiahouyuan;\r\n\t\t\t\t\tlib.characterIntro.boss_kumuyuanrang=lib.characterIntro.xiahoudun;\r\n\t\t\t\t\tlib.characterIntro.boss_baijiwenyuan=lib.characterIntro.zhangliao;\r\n\t\t\t\t\tlib.characterIntro.boss_yihanyunchang=lib.characterIntro.guanyu;\r\n\t\t\t\t\tlib.characterIntro.boss_fuweizilong=lib.characterIntro.zhaoyun;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tfor(var i in lib.skill){\r\n\t\t\t\t\t\tif(lib.skill[i].changeSeat){\r\n\t\t\t\t\t\t\tlib.skill[i]={};\r\n\t\t\t\t\t\t\tif(lib.translate[i+'_info']){\r\n\t\t\t\t\t\t\t\tlib.translate[i+'_info']='此模式下不可用';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list={\r\n\t\t\t\t\t\thololist:[],nijisanjilist:[],\r\n\t\t\t\t\t\tholomech:[],nijisanjimech:[],\r\n\t\t\t\t\t\tholoboss:[],nijisanjiboss:[],\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list=list;\r\n\t\t\t\t\tif(lib.characterPack.boss){\r\n\t\t\t\t\t\tfor(var i in lib.characterPack.boss){\r\n\t\t\t\t\t\t\tif(!lib.character[i]&&lib.characterPack.boss[i][4]){\r\n\t\t\t\t\t\t\t\tif(lib.characterPack.boss[i][4].contains('jiangeboss')||\r\n\t\t\t\t\t\t\t\tlib.characterPack.boss[i][4].contains('jiangemech')){\r\n\t\t\t\t\t\t\t\t\tlib.character[i]=lib.characterPack.boss[i];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i in lib.character){\r\n\t\t\t\t\t\tif(lib.character[i][4]){\r\n\t\t\t\t\t\t\tif(lib.character[i][4].contains('jiangeboss')){\r\n\t\t\t\t\t\t\t\tlist[lib.character[i][1]+'boss'].push(i);continue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(lib.character[i][4].contains('jiangemech')){\r\n\t\t\t\t\t\t\t\tlist[lib.character[i][1]+'mech'].push(i);continue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tif(lib.character[i][1]=='holo'){\r\n\t\t\t\t\t\t\tlist.hololist.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(lib.character[i][1]=='nijisanji'){\r\n\t\t\t\t\t\t\tlist.nijisanjilist.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar dialog;\r\n\t\t\t\t\tswitch(game.me.type){\r\n\t\t\t\t\t\tcase 'human':\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].type!='human'){\r\n\t\t\t\t\t\t\t\t\tgame.players[i].init(list[game.players[i].identity+game.players[i].type].randomRemove());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog=ui.create.dialog('选择角色',[list[game.me.identity+'list'].randomGets(8),'character']);\r\n\t\t\t\t\t\t\tui.create.cheat=function(){\r\n\t\t\t\t\t\t\t\t_status.createControl=ui.cheat2;\r\n\t\t\t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n\t\t\t\t\t\t\t\t\tif(ui.cheat2&&ui.cheat2.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list[game.me.identity+'list'].randomGets(8),'character',buttons);\r\n\t\t\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar createCharacterDialog=function(){\r\n\t\t\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset',function(name){\r\n\t\t\t\t\t\t\t\t\tif(lib.character[name][4]){\r\n\t\t\t\t\t\t\t\t\t\tif(lib.character[name][4].contains('jiangeboss')) return true;\r\n\t\t\t\t\t\t\t\t\t\tif(lib.character[name][4].contains('jiangemech')) return true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif(lib.character[name][1]!=game.me.identity) return true;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\t\t\tlib.onfree.push(createCharacterDialog);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tcreateCharacterDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.create.cheat2=function(){\r\n\t\t\t\t\t\t\t\tui.cheat2=ui.create.control('自由选将',function(){\r\n\t\t\t\t\t\t\t\t\tif(this.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t\t\t_status.event.dialog=this.backup;\r\n\t\t\t\t\t\t\t\t\t\tthis.backup.open();\r\n\t\t\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tthis.backup=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t\t\t_status.event.dialog=_status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\t\t\tthis.dialog=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t\t\tthis.dialog.open();\r\n\t\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!_status.brawl||!_status.brawl.chooseCharacterFixed){\r\n\t\t\t\t\t\t\t\tif(!ui.cheat&&get.config('change_choice')) ui.create.cheat();\r\n\t\t\t\t\t\t\t\tif(!ui.cheat2&&get.config('free_choose')) ui.create.cheat2();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mech':\r\n\t\t\t\t\t\t\tdialog=ui.create.dialog('选择角色',[list[game.me.identity+'mech'],'character']);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'boss':\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].type=='mech'){\r\n\t\t\t\t\t\t\t\t\tgame.players[i].init(list[game.players[i].identity+game.players[i].type].randomRemove());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog=ui.create.dialog('选择角色',[list[game.me.identity+'boss'],'character']);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButton(dialog,true).set('onfree',true).selectButton=function(){\r\n\t\t\t\t\t\tif(get.config('double_character_jiange')) return [2,2];\r\n\t\t\t\t\t\treturn [1,1];\r\n\t\t\t\t\t};\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar double=(result.links.length==2);\r\n\t\t\t\t\tgame.me.init(result.links[0],result.links[1]);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].name1) continue;\r\n\t\t\t\t\t\tif(game.players[i].type!='human'){\r\n\t\t\t\t\t\t\tgame.players[i].init(event.list[game.players[i].identity+game.players[i].type].randomRemove());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(double){\r\n\t\t\t\t\t\t\t\tgame.players[i].init(event.list[game.players[i].identity+'list'].randomRemove(),event.list[game.players[i].identity+'list'].randomRemove());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.players[i].init(event.list[game.players[i].identity+'list'].randomRemove());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.addRecentCharacter(game.me.name,game.me.name2);\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterSiguo:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\t_status.firstAct=game.players.randomGet();\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].node.name.innerHTML=get.verticalStr(get.cnNumber(get.distance(_status.firstAct,game.players[i],'absolute')+1,true)+'号位');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list={\r\n\t\t\t\t\t\tholo:[],nijisanji:[],vtuber:[],clubs:[]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list=list;\r\n\t\t\t\t\tfor(var i in lib.character){\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tif(get.config('siguo_character')=='off'&&lib.characterPack.mode_versus[i]) continue;\r\n\t\t\t\t\t\tif(list[lib.character[i][1]]){\r\n\t\t\t\t\t\t\tlist[lib.character[i][1]].push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar duallist=[];\r\n\t\t\t\t\tif(get.config('siguo_character')=='increase'){\r\n\t\t\t\t\t\tfor(var i in lib.characterPack.mode_versus){\r\n\t\t\t\t\t\t\tif(lib.characterPack.mode_versus[i][1]==game.me.identity){\r\n\t\t\t\t\t\t\t\tduallist.push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(duallist.length&&Math.random()<0.5){\r\n\t\t\t\t\t\tevent.friendChoice=duallist.randomGet();\r\n\t\t\t\t\t\tlist[game.me.identity].remove(event.friendChoice);\r\n\t\t\t\t\t\tduallist.length=0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.friendChoice=list[game.me.identity].randomRemove();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar myChoice=list[game.me.identity].randomGets(7);\r\n\t\t\t\t\tif(duallist.length){\r\n\t\t\t\t\t\tvar myChoiceName=duallist.randomGet();\r\n\t\t\t\t\t\tif(list[game.me.identity].contains(myChoiceName)&&!myChoice.contains(myChoiceName)){\r\n\t\t\t\t\t\t\tmyChoice.randomRemove();\r\n\t\t\t\t\t\t\tmyChoice.push(myChoiceName);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar dialog=ui.create.dialog('选择角色',[myChoice.concat([event.friendChoice]),'character']);\r\n\t\t\t\t\tdialog.buttons[7].node.name.innerHTML=get.verticalStr('队友选择');\r\n\r\n\t\t\t\t\tvar addSetting=function(dialog){\r\n\t\t\t\t\t\tdialog.add('选择座位').classList.add('add-setting');\r\n\t\t\t\t\t\tvar seats=document.createElement('table');\r\n\t\t\t\t\t\tseats.classList.add('add-setting');\r\n\t\t\t\t\t\tseats.style.margin='0';\r\n\t\t\t\t\t\tseats.style.width='100%';\r\n\t\t\t\t\t\tseats.style.position='relative';\r\n\t\t\t\t\t\tfor(var i=1;i<=game.players.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.innerHTML=get.cnNumber(i,true);\r\n\t\t\t\t\t\t\ttd.link=i-1;\r\n\t\t\t\t\t\t\tseats.appendChild(td);\r\n\t\t\t\t\t\t\tif(get.distance(_status.firstAct,game.me,'absolute')===i-1){\r\n\t\t\t\t\t\t\t\ttd.classList.add('bluebg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\tif(get.distance(_status.firstAct,game.me,'absolute')==this.link) return;\r\n\t\t\t\t\t\t\t\tvar current=this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t_status.firstAct=game.me;\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<this.link;i++){\r\n\t\t\t\t\t\t\t\t\t_status.firstAct=_status.firstAct.previous;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\tgame.players[i].node.name.innerHTML=get.verticalStr(get.cnNumber(get.distance(_status.firstAct,game.players[i],'absolute')+1,true)+'号位');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(seats);\r\n\t\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\t\tseats.previousSibling.style.display='none';\r\n\t\t\t\t\t\t\tseats.style.display='none';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tif(get.is.phoneLayout()) dialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar removeSetting=function(){\r\n\t\t\t\t\t\tvar dialog=_status.event.dialog;\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tdialog.style.height='';\r\n\t\t\t\t\t\t\tdelete dialog._scrollset;\r\n\t\t\t\t\t\t\tvar list=Array.from(dialog.querySelectorAll('.add-setting'));\r\n\t\t\t\t\t\t\twhile(list.length){\r\n\t\t\t\t\t\t\t\tlist.shift().remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.addSetting=addSetting;\r\n\t\t\t\t\tevent.removeSetting=removeSetting;\r\n\r\n\t\t\t\t\tif(get.config('change_identity')){\r\n\t\t\t\t\t\taddSetting(dialog);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tui.create.cheat=function(){\r\n\t\t\t\t\t\t_status.createControl=ui.cheat2;\r\n\t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n\t\t\t\t\t\t\tif(ui.cheat2&&ui.cheat2.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\tlist[game.me.identity].add(event.friendChoice);\r\n\t\t\t\t\t\t\tevent.friendChoice=list[game.me.identity].randomRemove();\r\n\t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list[game.me.identity].randomGets(7).concat([event.friendChoice]),'character',buttons);\r\n\t\t\t\t\t\t\t_status.event.dialog.buttons[7].node.name.innerHTML=get.verticalStr('队友选择');\r\n\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar createCharacterDialog=function(){\r\n\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset',function(name){\r\n\t\t\t\t\t\t\t// if(name==event.friendChoice) return true;\r\n\t\t\t\t\t\t\tif(lib.character[name][1]!=game.me.identity) return true;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\tlib.onfree.push(createCharacterDialog);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tcreateCharacterDialog();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.create.cheat2=function(){\r\n\t\t\t\t\t\tui.cheat2=ui.create.control('自由选将',function(){\r\n\t\t\t\t\t\t\tif(this.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=this.backup;\r\n\t\t\t\t\t\t\t\tthis.backup.open();\r\n\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.backup=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=_status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\tthis.dialog=_status.event.dialog;\r\n\t\t\t\t\t\t\t\tthis.dialog.open();\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButton(dialog,true).set('onfree',true).set('filterButton',function(button){\r\n\t\t\t\t\t\tif(button.link==_status.event.friendChoice) return false;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}).set('friendChoice',event.friendChoice);\r\n\t\t\t\t\tif(!ui.cheat&&get.config('change_choice')){\r\n\t\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!ui.cheat2&&get.config('free_choose')){\r\n\t\t\t\t\t\tui.create.cheat2();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\tevent.list[game.me.side].remove(result.links[0]);\r\n\t\t\t\t\tvar added={holo:0,nijisanji:0,vtuber:0,clubs:0};\r\n\t\t\t\t\tvar dualside={holo:[],nijisanji:[],vtuber:[],clubs:[]};\r\n\t\t\t\t\tif(get.config('siguo_character')=='increase'){\r\n\t\t\t\t\t\tfor(var i in lib.characterPack.mode_versus){\r\n\t\t\t\t\t\t\tif(Math.random()<0.5){\r\n\t\t\t\t\t\t\t\tdualside[lib.characterPack.mode_versus[i][1]].push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].node.identity.style.display='';\r\n\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tif(game.players[i].identity==game.me.identity){\r\n\t\t\t\t\t\t\t\tgame.players[i].init(event.friendChoice);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(dualside[game.players[i].side]&&dualside[game.players[i].side].length){\r\n\t\t\t\t\t\t\t\t\tvar enemyChoice=dualside[game.players[i].side];\r\n\t\t\t\t\t\t\t\t\tif(enemyChoice._skipped||Math.random()<0.5){\r\n\t\t\t\t\t\t\t\t\t\tvar enemyChoiceName=enemyChoice.randomRemove();\r\n\t\t\t\t\t\t\t\t\t\tif(event.list[game.players[i].side].contains(enemyChoiceName)){\r\n\t\t\t\t\t\t\t\t\t\t\tgame.players[i].init(enemyChoiceName);\r\n\t\t\t\t\t\t\t\t\t\t\tevent.list[game.players[i].side].remove(enemyChoiceName);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tenemyChoice._skipped=true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(!game.players[i].name1) game.players[i].init(event.list[game.players[i].side].randomRemove());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].addSkill('longchuanzhibao');\r\n\t\t\t\t\t\tif(added[game.players[i].side]==0){\r\n\t\t\t\t\t\t\tif(Math.random()<0.5){\r\n\t\t\t\t\t\t\t\tgame.players[i].gainZhibao();\r\n\t\t\t\t\t\t\t\tadded[game.players[i].side]=1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tadded[game.players[i].side]=-1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(added[game.players[i].side]<0){\r\n\t\t\t\t\t\t\tgame.players[i].gainZhibao();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.firstAct.gainZhibao();\r\n\t\t\t\t\tgame.addRecentCharacter(game.me.name1);\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\r\n\t\t\t\t\tui.longchuanzhibao=ui.create.system('龙船至宝',null,true);\r\n\t\t\t\t\t// ui.longchuanzhibao.style.display='none';\r\n\t\t\t\t\tlib.setPopped(ui.longchuanzhibao,function(){\r\n\t\t\t\t\t\tvar map={holo:0,nijisanji:0,vtuber:0,clubs:0};\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tvar current=game.players[i];\r\n\t\t\t\t\t\t\tmap[current.side]+=current.$.longchuanzhibao;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar uiintro=ui.create.dialog('hidden');\r\n\t\t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\t\tuiintro.addText(get.translation(i)+'势力：'+get.cnNumber(map[i])+'个');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tuiintro.content.lastChild.style.paddingBottom='8px';\r\n\t\t\t\t\t\treturn uiintro;\r\n\t\t\t\t\t},150);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterTwo:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tfor(var i in lib.skill){\r\n\t\t\t\t\t\tif(lib.skill[i].changeSeat){\r\n\t\t\t\t\t\t\tlib.skill[i]={};\r\n\t\t\t\t\t\t\tif(lib.translate[i+'_info']){\r\n\t\t\t\t\t\t\t\tlib.translate[i+'_info']='此模式下不可用';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar bool=Math.random()<0.5;\r\n\t\t\t\t\tvar bool2=Math.random()<0.5;\r\n\t\t\t\t\tvar ref=game.players[0];\r\n\r\n\t\t\t\t\tref.side=bool;\r\n\t\t\t\t\tref.next.side=bool2;\r\n\t\t\t\t\tref.next.next.side=!bool;\r\n\t\t\t\t\tref.previous.side=!bool2;\r\n\r\n\t\t\t\t\tvar firstChoose=game.players.randomGet();\r\n\t\t\t\t\tif(firstChoose.next.side==firstChoose.side){\r\n\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.firstAct=firstChoose;\r\n\t\t\t\t\tfor(var i=0;i<4;i++){\r\n\t\t\t\t\t\tfirstChoose.node.name.innerHTML=get.verticalStr(get.cnNumber(i+1,true)+'号位');\r\n\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=game.players[i].side+'zhu';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//22选将框分配\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tvar list4=[];\r\n\t\t\t\t\tfor(i in lib.characterReplace){\r\n\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\tif(lib.filter.characterDisabled(ix[j])) ix.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(ix.length){\r\n\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(!list4.contains(i)&&!lib.filter.characterDisabled(i)){\r\n\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t\tlist4.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar choose=[];\r\n\t\t\t\t\tevent.list=list;\r\n\t\t\t\t\t_status.characterlist=list4;\r\n\r\n\t\t\t\t\tvar addSetting=function(dialog){\r\n\t\t\t\t\t\tdialog.add('选择座位').classList.add('add-setting');\r\n\t\t\t\t\t\tvar seats=document.createElement('table');\r\n\t\t\t\t\t\tseats.classList.add('add-setting');\r\n\t\t\t\t\t\tseats.style.margin='0';\r\n\t\t\t\t\t\tseats.style.width='100%';\r\n\t\t\t\t\t\tseats.style.position='relative';\r\n\t\t\t\t\t\tfor(var i=1;i<=game.players.length;i++){\r\n\t\t\t\t\t\t\tvar td=ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n\t\t\t\t\t\t\ttd.innerHTML=get.cnNumber(i,true);\r\n\t\t\t\t\t\t\ttd.link=i-1;\r\n\t\t\t\t\t\t\tseats.appendChild(td);\r\n\t\t\t\t\t\t\tif(get.distance(_status.firstAct,game.me,'absolute')===i-1){\r\n\t\t\t\t\t\t\t\ttd.classList.add('bluebg');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttd.addEventListener(lib.config.touchscreen?'touchend':'click',function(){\r\n\t\t\t\t\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\t\t\t\t\tif(_status.justdragged) return;\r\n\t\t\t\t\t\t\t\tif(get.distance(_status.firstAct,game.me,'absolute')==this.link) return;\r\n\t\t\t\t\t\t\t\tvar current=this.parentNode.querySelector('.bluebg');\r\n\t\t\t\t\t\t\t\tif(current){\r\n\t\t\t\t\t\t\t\t\tcurrent.classList.remove('bluebg');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.classList.add('bluebg');\r\n\t\t\t\t\t\t\t\t_status.firstAct=game.me;\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<this.link;i++){\r\n\t\t\t\t\t\t\t\t\t_status.firstAct=_status.firstAct.previous;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar firstChoose=_status.firstAct;\r\n\t\t\t\t\t\t\t\tfirstChoose.next.side=!firstChoose.side;\r\n\t\t\t\t\t\t\t\tfirstChoose.next.next.side=!firstChoose.side;\r\n\t\t\t\t\t\t\t\tfirstChoose.previous.side=firstChoose.side;\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=game.players[i].side+'zhu';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<4;i++){\r\n\t\t\t\t\t\t\t\t\tfirstChoose.node.name.innerHTML=get.verticalStr(get.cnNumber(i+1,true)+'号位');\r\n\t\t\t\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.content.appendChild(seats);\r\n\t\t\t\t\t\tif(game.me==game.zhu){\r\n\t\t\t\t\t\t\tseats.previousSibling.style.display='none';\r\n\t\t\t\t\t\t\tseats.style.display='none';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tdialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t\tif(get.is.phoneLayout()) dialog.add(ui.create.div('.placeholder.add-setting'));\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar removeSetting=function(){\r\n\t\t\t\t\t\tvar dialog=_status.event.dialog;\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tdialog.style.height='';\r\n\t\t\t\t\t\t\tdelete dialog._scrollset;\r\n\t\t\t\t\t\t\tvar list=Array.from(dialog.querySelectorAll('.add-setting'));\r\n\t\t\t\t\t\t\twhile(list.length){\r\n\t\t\t\t\t\t\t\tlist.shift().remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tui.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.addSetting=addSetting;\r\n\t\t\t\t\tevent.removeSetting=removeSetting;\r\n\r\n\t\t\t\t\tvar characterChoice;\r\n\t\t\t\t\tif(_status.brawl&&_status.brawl.chooseCharacter){\r\n\t\t\t\t\t\tcharacterChoice=_status.brawl.chooseCharacter(list,game.me);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tcharacterChoice=list.randomGets(7);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar basenum=1;\r\n\t\t\t\t\tvar basestr='选择角色';\r\n\t\t\t\t\tif(get.config('two_assign')){\r\n\t\t\t\t\t\tbasenum=2;\r\n\t\t\t\t\t\tbasestr='选择你和队友的角色';\r\n\t\t\t\t\t\tevent.two_assign=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(get.config('replace_character_two')){\r\n\t\t\t\t\t\tbasestr+='（含一名替补角色）';\r\n\t\t\t\t\t\t_status.replacetwo=true;\r\n\t\t\t\t\t\tgame.additionaldead=[];\r\n\t\t\t\t\t\tbasenum*=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar dialog=ui.create.dialog(basestr,[characterChoice,'characterx']);\r\n\t\t\t\t\tgame.me.chooseButton(true,dialog,basenum).set('onfree',true);\r\n\t\t\t\t\tif(!_status.brawl||!_status.brawl.noAddSetting){\r\n\t\t\t\t\t\tif(get.config('change_identity')){\r\n\t\t\t\t\t\t\taddSetting(dialog);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tui.create.cheat=function(){\r\n\t\t\t\t\t\t_status.createControl=ui.cheat2;\r\n\t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n\t\t\t\t\t\t\tif(ui.cheat2&&ui.cheat2.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list.randomGets(7),'characterx',buttons);\r\n\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\tlib.onfree.push(function(){\r\n\t\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n\t\t\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.create.cheat2=function(){\r\n\t\t\t\t\t\tui.cheat2=ui.create.control('自由选将',function(){\r\n\t\t\t\t\t\t\tif(this.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=this.backup;\r\n\t\t\t\t\t\t\t\tthis.backup.open();\r\n\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.backup=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=_status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\tthis.dialog=_status.event.dialog;\r\n\t\t\t\t\t\t\t\tthis.dialog.open();\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!_status.brawl||!_status.brawl.chooseCharacterFixed){\r\n\t\t\t\t\t\tif(!ui.cheat&&get.config('change_choice')){\r\n\t\t\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!ui.cheat2&&get.config('free_choose')){\r\n\t\t\t\t\t\t\tui.create.cheat2();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<result.links.length;i++){\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.links[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\tif(_status.replacetwo){\r\n\t\t\t\t\t\tgame.me.replacetwo=result.links[1];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.remove(game.me.name1);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tif(_status.brawl&&_status.brawl.chooseCharacter){\r\n\t\t\t\t\t\t\t\tvar list=_status.brawl.chooseCharacter(event.list,game.players[i]);\r\n\t\t\t\t\t\t\t\tgame.players[i].init(list.randomGet());\r\n\t\t\t\t\t\t\t\tevent.list.remove(game.players[i].name1);\r\n\t\t\t\t\t\t\t\tif(_status.replacetwo){\r\n\t\t\t\t\t\t\t\t\tgame.players[i].replacetwo=list.randomGet(game.players[i].name1);\r\n\t\t\t\t\t\t\t\t\tevent.list.remove(game.players[i].replacetwo);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(event.two_assign&&game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\t\tif(_status.replacetwo){\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].init(result.links[2]);\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].replacetwo=result.links[3];\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].init(result.links[1]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tvar name=event.list.randomRemove();\r\n\t\t\t\t\t\t\t\t\tif(lib.characterReplace[name]&&lib.characterReplace[name].length) name=lib.characterReplace[name].randomGet();\r\n\t\t\t\t\t\t\t\t\tgame.players[i].init(name);\r\n\t\t\t\t\t\t\t\t\tif(_status.replacetwo){\r\n\t\t\t\t\t\t\t\t\t\tvar name2=event.list.randomRemove();\r\n\t\t\t\t\t\t\t\t\t\tif(lib.characterReplace[name2]&&lib.characterReplace[name2].length) name2=lib.characterReplace[name2].randomGet();\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].replacetwo=name2;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].name1);\r\n\t\t\t\t\t\t_status.characterlist.remove(game.players[i].replacetwo);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\r\n\t\t\t\t\tif(get.config('two_phaseswap')){\r\n\t\t\t\t\t\tgame.addGlobalSkill('autoswap');\r\n\t\t\t\t\t\tif(lib.config.show_handcardbutton){\r\n\t\t\t\t\t\t\tui.versushs=ui.create.system('手牌',null,true);\r\n\t\t\t\t\t\t\tlib.setPopped(ui.versushs,game.versusHoverHandcards,220);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterEndless:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tfor(var i in lib.skill){\r\n\t\t\t\t\t\tif(lib.skill[i].changeSeat){\r\n\t\t\t\t\t\t\tlib.skill[i]={};\r\n\t\t\t\t\t\t\tif(lib.translate[i+'_info']){\r\n\t\t\t\t\t\t\t\tlib.translate[i+'_info']='此模式下不可用';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar firstChoose=game.players.randomGet();\r\n\t\t\t\t\t_status.firstAct=firstChoose;\r\n\r\n\t\t\t\t\tfirstChoose.side=false;\r\n\t\t\t\t\tfirstChoose.next.side=true;\r\n\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=game.players[i].side+'zhu';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(!lib.filter.characterDisabled(i)){\r\n\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar choose=[];\r\n\t\t\t\t\tevent.list=list;\r\n\t\t\t\t\t_status.endlessListAll=list.slice(0);\r\n\r\n\t\t\t\t\tvar characterChoice=list.randomGets(6);\r\n\t\t\t\t\tvar dialog=ui.create.dialog('选择角色',[characterChoice,'character']);\r\n\t\t\t\t\tgame.me.chooseButton(true,dialog).set('onfree',true);\r\n\r\n\t\t\t\t\tui.create.cheat=function(){\r\n\t\t\t\t\t\t_status.createControl=ui.cheat2;\r\n\t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n\t\t\t\t\t\t\tif(ui.cheat2&&ui.cheat2.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\tgame.changeCoin(-3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list.randomGets(7),'character',buttons);\r\n\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\tnode.remove();\r\n\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(lib.onfree){\r\n\t\t\t\t\t\tlib.onfree.push(function(){\r\n\t\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n\t\t\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\t\t\tui.cheat2.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\tui.cheat2.classList.remove('disabled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.dialogxx=ui.create.characterDialog('heightset');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.create.cheat2=function(){\r\n\t\t\t\t\t\tui.cheat2=ui.create.control('自由选将',function(){\r\n\t\t\t\t\t\t\tif(this.dialog==_status.event.dialog){\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(50);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=this.backup;\r\n\t\t\t\t\t\t\t\tthis.backup.open();\r\n\t\t\t\t\t\t\t\tdelete this.backup;\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.animate('controlpressdownx',500);\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.remove('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(game.changeCoin){\r\n\t\t\t\t\t\t\t\t\tgame.changeCoin(-10);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.backup=_status.event.dialog;\r\n\t\t\t\t\t\t\t\t_status.event.dialog.close();\r\n\t\t\t\t\t\t\t\t_status.event.dialog=_status.event.parent.dialogxx;\r\n\t\t\t\t\t\t\t\tthis.dialog=_status.event.dialog;\r\n\t\t\t\t\t\t\t\tthis.dialog.open();\r\n\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\t\tui.cheat.classList.add('disabled');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tui.cheat2.classList.add('disabled');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!_status.brawl||!_status.brawl.chooseCharacterFixed){\r\n\t\t\t\t\t\tif(!ui.cheat&&get.config('change_choice')){\r\n\t\t\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!ui.cheat2&&get.config('free_choose')){\r\n\t\t\t\t\t\t\tui.create.cheat2();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(ui.cheat2){\r\n\t\t\t\t\t\tui.cheat2.close();\r\n\t\t\t\t\t\tdelete ui.cheat2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<result.links.length;i++){\r\n\t\t\t\t\t\tgame.addRecentCharacter(result.links[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.init(result.links[0]);\r\n\t\t\t\t\tevent.list.remove(game.me.name1);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tgame.players[i].init(event.list.randomRemove());\r\n\t\t\t\t\t\t\tif(_status.replacetwo){\r\n\t\t\t\t\t\t\t\tgame.players[i].replacetwo=event.list.randomRemove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.endlessList=event.list;\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterFour:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.ai=function(player,list,list2){\r\n\t\t\t\t\tif(player.identity=='zhu'){\r\n\t\t\t\t\t\tlist2.randomSort();\r\n\t\t\t\t\t\tvar choice;\r\n\t\t\t\t\t\tif(Math.random()-0.8<0&&list2.length){\r\n\t\t\t\t\t\t\tchoice=list2[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tchoice=list[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.init(choice);\r\n\t\t\t\t\t\tplayer.hp++;\r\n\t\t\t\t\t\tplayer.maxHp++;\r\n\t\t\t\t\t\tplayer.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(Math.random()<0.5){\r\n\t\t\t\t\t\tvar choice=0;\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tif(lib.character[list[i]][1]==game[player.side+'Zhu'].group){\r\n\t\t\t\t\t\t\t\tchoice=i;break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.init(list[choice]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tplayer.init(list[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.list.remove(player.name1);\r\n\t\t\t\t\tthis.list2.remove(player.name1);\r\n\t\t\t\t}\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tvar i;\r\n\t\t\t\t\tvar list;\r\n\t\t\t\t\tvar list2=[];\r\n\r\n\t\t\t\t\tevent.list=[];\r\n\t\t\t\t\tevent.filterChoice=function(name){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\tif(event.filterChoice(i)) continue;\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tevent.list.push(i);\r\n\t\t\t\t\t\tif(lib.character[i][4]&&lib.character[i][4].contains('zhu')){\r\n\t\t\t\t\t\t\tlist2.push(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_status.brawl&&_status.brawl.chooseCharacterFilter){\r\n\t\t\t\t\t\tevent.list=_status.brawl.chooseCharacterFilter(event.list);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.list.randomSort();\r\n\t\t\t\t\tevent.list2=list2;\r\n\t\t\t\t\tevent.four_assign=get.config('four_assign');\r\n\t\t\t\t\tif(!event.four_assign){\r\n\t\t\t\t\t\tevent.current=_status.firstAct;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.current=_status.firstAct.next;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.flipassign=true;\r\n\t\t\t\t\tif(_status.firstAct.side){\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tgame.players[i].side=!game.players[i].side;\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=get.translation(game.players[i].side+'Color');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(!game.players[i].node.name_seat){\r\n\t\t\t\t\t\t\tgame.players[i].node.name_seat=ui.create.div('.name.name_seat',get.verticalStr(lib.translate['unknown'+get.distance(_status.firstAct,game.players[i],'absolute')]),game.players[i]);\r\n\t\t\t\t\t\t\tgame.players[i].node.name_seat.style.opacity=1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(get.config('ladder')){\r\n\t\t\t\t\t\tvar date=new Date();\r\n\t\t\t\t\t\tif(!lib.storage.ladder){\r\n\t\t\t\t\t\t\tlib.storage.ladder={\r\n\t\t\t\t\t\t\t\tcurrent:900,\r\n\t\t\t\t\t\t\t\ttop:900,\r\n\t\t\t\t\t\t\t\tmonth:date.getMonth()\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tgame.save('ladder',lib.storage.ladder);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(date.getMonth()!=lib.storage.ladder.month&&get.config('ladder_monthly')){\r\n\t\t\t\t\t\t\tlib.storage.ladder.month=date.getMonth();\r\n\t\t\t\t\t\t\tlib.storage.ladder.current=900;\r\n\t\t\t\t\t\t\tgame.save('ladder',lib.storage.ladder);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tui.ladder=ui.create.system(game.getLadderName(lib.storage.ladder.current),null,true);\r\n\t\t\t\t\t\tlib.setPopped(ui.ladder,function(uiintro){\r\n\t\t\t\t\t\t\tvar uiintro=ui.create.dialog('hidden');\r\n\t\t\t\t\t\t\tuiintro.add('<div class=\"text center\">当前分数：<div style=\"width:40px;text-align:left;font-family:xinwei\">'+(lib.storage.ladder.current+(_status.ladder_tmp?40:0))+'</div></div>');\r\n\t\t\t\t\t\t\tuiintro.add('<div class=\"text center\">历史最高：<div style=\"width:40px;text-align:left;font-family:xinwei\">'+lib.storage.ladder.top+'</div></div>');\r\n\t\t\t\t\t\t\tuiintro.content.lastChild.style.paddingBottom='8px';\r\n\t\t\t\t\t\t\treturn uiintro;\r\n\t\t\t\t\t\t},180);\r\n\t\t\t\t\t\t_status.ladder=true;\r\n\t\t\t\t\t\t_status.ladder_mmr=0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.addSetting=function(){\r\n\t\t\t\t\t\tvar cs=function(link,node){\r\n\t\t\t\t\t\t\tgame.swapPlayer(node._link);\r\n\t\t\t\t\t\t\t_status.rechoose=true;\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tgame.players[i].uninit();\r\n\t\t\t\t\t\t\t\tif(game.players[i].node.name_seat) game.players[i].node.name_seat.style.display='';\r\n\t\t\t\t\t\t\t\tgame.players[i].classList.remove('selectedx');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif(!event.seatsbutton){\r\n\t\t\t\t\t\t\tevent.seatsbutton=[\r\n\t\t\t\t\t\t\t\tui.create.control('一号位',cs),\r\n\t\t\t\t\t\t\t\tui.create.control('一号位',cs),\r\n\t\t\t\t\t\t\t\tui.create.control('一号位',cs),\r\n\t\t\t\t\t\t\t\tui.create.control('换边',function(){\r\n\t\t\t\t\t\t\t\t\tif(_status.firstAct.side==game.me.side){\r\n\t\t\t\t\t\t\t\t\t\tcs(null,{_link:_status.firstAct.nextSeat});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tcs(null,{_link:_status.firstAct});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar seats=[];\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i]!=game.me&&game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\tseats.add([1+get.distance(_status.firstAct,game.players[i],'absolute'),game.players[i]]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tseats.sort(function(a,b){\r\n\t\t\t\t\t\t\t\treturn a[0]-b[0];\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var i=0;i<event.seatsbutton.length;i++){\r\n\t\t\t\t\t\t\tif(i<seats.length){\r\n\t\t\t\t\t\t\t\tevent.seatsbutton[i].firstChild.innerHTML=get.cnNumber(seats[i][0],true)+'号位';\r\n\t\t\t\t\t\t\t\tevent.seatsbutton[i].firstChild._link=seats[i][1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif(!get.config('four_assign')&&!get.config('four_phaseswap')){\r\n\t\t\t\t\t\tif(get.config('change_identity')){\r\n\t\t\t\t\t\t\tevent.addSetting();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(get.config('fouralign')&&!event.fouralignbutton){\r\n\t\t\t\t\t\t\tevent.fouralignbutton=ui.create.control('变阵',function(){\r\n\t\t\t\t\t\t\t\tif(!_status.fouralign.length||(_status.fouralign.length==1&&_status.fouralign[0]==0)){\r\n\t\t\t\t\t\t\t\t\t_status.fouralign=[0,1,2,3,4];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar list=[\r\n\t\t\t\t\t\t\t\t\t['zhong','ezhong','ezhong','zhong','zhong','ezhong','ezhong','zhong'],\r\n\t\t\t\t\t\t\t\t\t['zhong','ezhong','zhong','ezhong','ezhong','zhong','ezhong','zhong'],\r\n\t\t\t\t\t\t\t\t\t['zhong','ezhong','ezhong','zhong','ezhong','zhong','zhong','ezhong'],\r\n\t\t\t\t\t\t\t\t\t['zhong','ezhong','zhong','ezhong','zhong','ezhong','zhong','ezhong'],\r\n\t\t\t\t\t\t\t\t\t['zhong','ezhong','ezhong','zhong','ezhong','zhong','ezhong','zhong'],\r\n\t\t\t\t\t\t\t\t][_status.fouralign.shift()];\r\n\t\t\t\t\t\t\t\tvar rand1=Math.floor(Math.random()*4);\r\n\t\t\t\t\t\t\t\tvar rand2=Math.floor(Math.random()*4);\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(list[i]=='zhong'){\r\n\t\t\t\t\t\t\t\t\t\tif(rand1==0){\r\n\t\t\t\t\t\t\t\t\t\t\tlist[i]='zhu';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\trand1--;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tif(rand2==0){\r\n\t\t\t\t\t\t\t\t\t\t\tlist[i]='ezhu';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\trand2--;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tvar side=Math.random()<0.5;\r\n\t\t\t\t\t\t\t\tvar num=game.players.indexOf(_status.firstAct);\r\n\t\t\t\t\t\t\t\tlist=list.splice(8-num).concat(list);\r\n\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<8;i++){\r\n\t\t\t\t\t\t\t\t\tif(list[i][0]=='e'){\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].side=side;\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].identity=list[i].slice(1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].side=!side;\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].identity=list[i];\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].identity=='zhu'){\r\n\t\t\t\t\t\t\t\t\t\tgame[game.players[i].side+'Zhu']=game.players[i];\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].isZhu=true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tgame.players[i].setIdentity(game.players[i].identity);\r\n\t\t\t\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=get.translation(game.players[i].side+'Color');\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].node.name_seat){\r\n\t\t\t\t\t\t\t\t\t\tgame.players[i].node.name_seat.remove();\r\n\t\t\t\t\t\t\t\t\t\tdelete game.players[i].node.name_seat;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t_status.rechoose=true;\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\tgame.players[i].uninit();\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].node.name_seat) game.players[i].node.name_seat.style.display='';\r\n\t\t\t\t\t\t\t\t\tgame.players[i].classList.remove('selectedx');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(event.current==game.me||(event.four_assign&&event.current.side==game.me.side)){\r\n\t\t\t\t\t\tvar dialog=event.xdialog;\r\n\t\t\t\t\t\tif(!dialog){\r\n\t\t\t\t\t\t\tif(get.config('expand_dialog')){\r\n\t\t\t\t\t\t\t\tdialog=event.xdialog||ui.create.characterDialog('heightset',event.filterChoice,'expandall');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tdialog=event.xdialog||ui.create.characterDialog('heightset',event.filterChoice,'precharacter');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar names=[];\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i].name1){\r\n\t\t\t\t\t\t\t\tnames.push(game.players[i].name1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\tif(names.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('unselectable');\r\n\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('noclick');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.me.chooseButton(dialog,true).set('onfree',true).closeDialog=false;\r\n\t\t\t\t\t\tevent.xdialog=dialog;\r\n\t\t\t\t\t\tdialog.static=true;\r\n\t\t\t\t\t\tevent.current.classList.add('selectedx');\r\n\t\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.ai(event.current,event.list.randomGets(3),event.list2);\r\n\t\t\t\t\t\tevent.current.node.name_seat.style.display='none';\r\n\t\t\t\t\t\tif(!event.four_assign){\r\n\t\t\t\t\t\t\tevent.current=event.current.next;\r\n\t\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(_status.rechoose){\r\n\t\t\t\t\t\tdelete _status.rechoose;\r\n\t\t\t\t\t\tevent.goto(0);\r\n\t\t\t\t\t\tvar dialog=event.xdialog;\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tdialog.buttons[i].classList.remove('unselectable');\r\n\t\t\t\t\t\t\t\tdialog.buttons[i].classList.remove('noclick');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(event.seatsbutton){\r\n\t\t\t\t\t\tfor(var i=0;i<event.seatsbutton.length;i++){\r\n\t\t\t\t\t\t\tevent.seatsbutton[i].close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete event.seatsbutton;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.current.classList.remove('selectedx');\r\n\t\t\t\t\tif(event.current.side==game.me.side){\r\n\t\t\t\t\t\tevent.current.init(result.buttons[0].link);\r\n\t\t\t\t\t\tif(event.current==game.me){\r\n\t\t\t\t\t\t\tgame.addRecentCharacter(result.buttons[0].link);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.list.remove(event.current.name1);\r\n\t\t\t\t\t\tevent.list2.remove(event.current.name1);\r\n\t\t\t\t\t\tif(event.current.identity=='zhu'){\r\n\t\t\t\t\t\t\tevent.current.hp++;\r\n\t\t\t\t\t\t\tevent.current.maxHp++;\r\n\t\t\t\t\t\t\tevent.current.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.current.node.name_seat.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(event.four_assign){\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(!game.players[i].name1) break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(i<game.players.length){\r\n\t\t\t\t\t\t\tvar side=event.current.side;\r\n\t\t\t\t\t\t\tevent.current=_status.firstAct.next;\r\n\t\t\t\t\t\t\tif(event.flipassign){\r\n\t\t\t\t\t\t\t\tfor(var iwhile=0;iwhile<8;iwhile++){\r\n\t\t\t\t\t\t\t\t\tevent.current=event.current.next;\r\n\t\t\t\t\t\t\t\t\tif(event.current.side!=side&&!event.current.name1){\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tfor(var iwhile=0;iwhile<8;iwhile++){\r\n\t\t\t\t\t\t\t\t\tevent.current=event.current.previous;\r\n\t\t\t\t\t\t\t\t\tif(event.current.side==side&&!event.current.name1){\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.flipassign=!event.flipassign;\r\n\t\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(!game.players[i].name1){\r\n\t\t\t\t\t\t\t\tevent.ai(game.players[i],event.list.splice(0,3),event.list2);\r\n\t\t\t\t\t\t\t\tgame.players[i].node.name_seat.remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tif(get.config('four_phaseswap')){\r\n\t\t\t\t\t\tgame.addGlobalSkill('autoswap');\r\n\t\t\t\t\t\tif(lib.config.show_handcardbutton){\r\n\t\t\t\t\t\t\tui.versushs=ui.create.system('手牌',null,true);\r\n\t\t\t\t\t\t\tlib.setPopped(ui.versushs,game.versusHoverHandcards,220);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(event.xdialog){\r\n\t\t\t\t\t\tevent.xdialog.close();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// game.addRecentCharacter(game.me.name,game.me.name2);\r\n\t\t\t\t\tui.control.style.transitionDuration='0s';\r\n\t\t\t\t\tui.refresh(ui.control);\r\n\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.control.style.transitionDuration='';\r\n\t\t\t\t\t},500);\r\n\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\tdelete _status.fouralign;\r\n\t\t\t\t\tif(event.fouralignbutton){\r\n\t\t\t\t\t\tevent.fouralignbutton.close();\r\n\t\t\t\t\t\tdelete event.fouralignbutton;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterThree:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(lib.config.continue_name_versus_three){\r\n\t\t\t\t\t\tevent.friendlist=lib.config.continue_name_versus_three.friend;\r\n\t\t\t\t\t\tevent.enemylist=lib.config.continue_name_versus_three.enemy;\r\n\t\t\t\t\t\t_status.color=lib.config.continue_name_versus_three.color;\r\n\t\t\t\t\t\tgame.additionaldead=[];\r\n\t\t\t\t\t\tgame.saveConfig('continue_name_versus_three');\r\n\t\t\t\t\t\tevent.goto(2);\r\n\t\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.chooseCharacterDouble(function(i){\r\n\t\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) return false;\r\n\t\t\t\t\t\t\treturn !lib.filter.characterDisabled(i);\r\n\t\t\t\t\t\t\t// if(get.config('enable_all_three')){\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t\t// else{\r\n\t\t\t\t\t\t\t// \tfor(var j in lib.characterPack){\r\n\t\t\t\t\t\t\t// \t\tif(lib.choiceVtuberkill.contains(j)&&lib.characterPack[j][i])\treturn false;\r\n\t\t\t\t\t\t\t// \t}\r\n\t\t\t\t\t\t\t// \treturn lib.choiceThree.contains(i);\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t},function(i){\r\n\t\t\t\t\t\t\treturn i==1?'主帅':'前锋';\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tgame.addRecentCharacter.apply(this,result.friend);\r\n\t\t\t\t\tevent.friendlist=result.friend;\r\n\t\t\t\t\tevent.enemylist=result.enemy;\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\t_status.friendBackup=event.friendlist.slice(0);\r\n\t\t\t\t\t_status.enemyBackup=event.enemylist.slice(0);\r\n\t\t\t\t\t_status.coinCoeff=get.coinCoeff(event.friendlist);\r\n\r\n\t\t\t\t\tui.create.players(6);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t\t\tgame.players[i].node.action.innerHTML='行动';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.arena.setNumber(7);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].dataset.position=parseInt(game.players[i].dataset.position)+1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.singleHandcard=true;\r\n\t\t\t\t\tui.arena.classList.add('single-handcard');\r\n\t\t\t\t\tui.window.classList.add('single-handcard');\r\n\t\t\t\t\tui.fakeme=ui.create.div('.fakeme.avatar');\r\n\t\t\t\t\t_status.prepareArena=true;\r\n\t\t\t\t\tui.create.me();\r\n\t\t\t\t\tui.me.appendChild(ui.fakeme);\r\n\r\n\t\t\t\t\tgame.friend=[];\r\n\t\t\t\t\tgame.enemy=[];\r\n\r\n\t\t\t\t\tfor(var i in lib.skill){\r\n\t\t\t\t\t\tif(lib.skill[i].changeSeat){\r\n\t\t\t\t\t\t\tlib.skill[i]={};\r\n\t\t\t\t\t\t\tif(lib.translate[i+'_info']){\r\n\t\t\t\t\t\t\t\tlib.translate[i+'_info']='固定位置时不可用';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(i<3){\r\n\t\t\t\t\t\t\tgame.friend.push(game.players[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.enemy.push(game.players[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.friendZhu=game.players[1];\r\n\t\t\t\t\tgame.enemyZhu=game.players[4];\r\n\t\t\t\t\tfor(var i=0;i<3;i++){\r\n\t\t\t\t\t\tgame.friend[i].side=_status.color;\r\n\t\t\t\t\t\tgame.enemy[i].side=!_status.color;\r\n\t\t\t\t\t\tif(game.friendZhu==game.friend[i]){\r\n\t\t\t\t\t\t\tgame.friend[i].identity='zhu';\r\n\t\t\t\t\t\t\tgame.friend[i].setIdentity(_status.color+'Zhu');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.friend[i].identity='zhong';\r\n\t\t\t\t\t\t\tgame.friend[i].setIdentity(_status.color+'Zhong');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(game.enemyZhu==game.enemy[i]){\r\n\t\t\t\t\t\t\tgame.enemy[i].identity='zhu';\r\n\t\t\t\t\t\t\tgame.enemy[i].setIdentity(!_status.color+'Zhu');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.enemy[i].identity='zhong';\r\n\t\t\t\t\t\t\tgame.enemy[i].setIdentity(!_status.color+'Zhong');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.friend[i].init(event.friendlist[i]);\r\n\t\t\t\t\t\tgame.enemy[i].init(event.enemylist[i]);\r\n\t\t\t\t\t\tgame.friend[i].node.identity.dataset.color=get.translation(_status.color+'Color');\r\n\t\t\t\t\t\tgame.enemy[i].node.identity.dataset.color=get.translation(!_status.color+'Color');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.friendZhu.maxHp++;\r\n\t\t\t\t\tgame.friendZhu.hp++;\r\n\t\t\t\t\tgame.friendZhu.update();\r\n\r\n\t\t\t\t\tgame.enemyZhu.maxHp++;\r\n\t\t\t\t\tgame.enemyZhu.hp++;\r\n\t\t\t\t\tgame.enemyZhu.update();\r\n\r\n\t\t\t\t\tgame.onSwapControl();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacter:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.showConfig=true;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tif(lib.config.continue_name_versus){\r\n\t\t\t\t\t\t_status.friend=lib.config.continue_name_versus.friend;\r\n\t\t\t\t\t\t_status.enemy=lib.config.continue_name_versus.enemy;\r\n\t\t\t\t\t\t_status.color=lib.config.continue_name_versus.color;\r\n\t\t\t\t\t\tgame.additionaldead=[];\r\n\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t\tgame.saveConfig('continue_name_versus');\r\n\t\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.check=function(){\r\n\t\t\t\t\t\tthis.dialog.classList.add('fullwidth');\r\n\t\t\t\t\t\tthis.dialog.classList.add('fullheight');\r\n\t\t\t\t\t\tthis.dialog.classList.add('noslide');\r\n\t\t\t\t\t\tfor(var i=0;i<this.dialog.buttons.length;i++) this.dialog.buttons[i].style.opacity=1;\r\n\t\t\t\t\t\tthis.dialog.add('选项');\r\n\t\t\t\t\t\tthis.dialog.versus_zhu=this.dialog.add(ui.create.switcher('versus_zhu',lib.storage.zhu)).querySelector('.toggle');\r\n\t\t\t\t\t\t// this.dialog.versus_only_zhu=this.dialog.add(ui.create.switcher('versus_only_zhu',lib.storage.only_zhu)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.versus_main_zhu=this.dialog.add(ui.create.switcher('versus_main_zhu',lib.storage.main_zhu)).querySelector('.toggle');\r\n\t\t\t\t\t\tif(lib.storage.zhu){\r\n\t\t\t\t\t\t\t// this.dialog.versus_only_zhu.parentNode.classList.remove('disabled');\r\n\t\t\t\t\t\t\tthis.dialog.versus_main_zhu.parentNode.classList.remove('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t// this.dialog.versus_only_zhu.parentNode.classList.add('disabled');\r\n\t\t\t\t\t\t\tthis.dialog.versus_main_zhu.parentNode.classList.add('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// this.dialog.versus_cross_seat=this.dialog.add(ui.create.switcher('versus_cross_seat',lib.storage.cross_seat)).querySelector('.toggle');\r\n\t\t\t\t\t\t// this.dialog.versus_random_seat=this.dialog.add(ui.create.switcher('versus_random_seat',lib.storage.random_seat)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.versus_noreplace_end=this.dialog.add(ui.create.switcher('versus_noreplace_end',lib.storage.noreplace_end)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.versus_assign_enemy=this.dialog.add(ui.create.switcher('versus_assign_enemy',lib.storage.assign_enemy)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.versus_single_control=this.dialog.add(ui.create.switcher('versus_single_control',lib.storage.single_control)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.versus_first_less=this.dialog.add(ui.create.switcher('versus_first_less',get.config('first_less'))).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.versus_reward=this.dialog.add(ui.create.switcher('versus_reward',[0,1,2,3,4],lib.storage.versus_reward)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.versus_punish=this.dialog.add(ui.create.switcher('versus_punish',['弃牌','无','摸牌'],lib.storage.versus_punish)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.versus_seat_order=this.dialog.add(ui.create.switcher('seat_order',['对阵','交叉','随机'],lib.storage.seat_order)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.versus_number=this.dialog.add(ui.create.switcher('versus_number',[1,2,3],lib.storage.number)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.replace_number=this.dialog.add(ui.create.switcher('replace_number',[0,1,2,3,5,7,9,17],lib.storage.replace_number)).querySelector('.toggle');\r\n\t\t\t\t\t\tthis.dialog.choice=this.dialog.add(ui.create.switcher('choice',[12,16,20,24,40,'∞'],lib.storage.choice)).querySelector('.toggle');\r\n\r\n\t\t\t\t\t\t// if(lib.storage.cross_seat){\r\n\t\t\t\t\t\t// \tthis.dialog.versus_random_seat.parentNode.classList.add('disabled');\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t// else{\r\n\t\t\t\t\t\t// \tthis.dialog.versus_random_seat.parentNode.classList.remove('disabled');\r\n\t\t\t\t\t\t// \tif(lib.storage.random_seat){\r\n\t\t\t\t\t\t// \t\tthis.dialog.versus_cross_seat.parentNode.classList.add('disabled');\r\n\t\t\t\t\t\t// \t}\r\n\t\t\t\t\t\t// \telse{\r\n\t\t\t\t\t\t// \t\tthis.dialog.versus_cross_seat.parentNode.classList.remove('disabled');\r\n\t\t\t\t\t\t// \t}\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.confirm=function(){\r\n\t\t\t\t\t\tvar dialog=event.dialog;\r\n\t\t\t\t\t\tvar num=lib.storage.number+lib.storage.replace_number;\r\n\t\t\t\t\t\t_status.friend.splice(num);\r\n\t\t\t\t\t\t_status.enemy.splice(num);\r\n\t\t\t\t\t\tdialog.close();\r\n\t\t\t\t\t\tif(ui.confirm) ui.confirm.close();\r\n\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tui.control.style.transition='all 0s';\r\n\t\t\t\t\tif(get.is.phoneLayout()){\r\n\t\t\t\t\t\tui.control.style.top='calc(100% - 80px)';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(game.layout=='newlayout'){\r\n\t\t\t\t\t\tui.control.style.top='calc(100% - 30px)';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tui.control.style.top='calc(100% - 70px)';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.friend=[];\r\n\t\t\t\t\t_status.enemy=[];\r\n\t\t\t\t\tgame.additionaldead=[];\r\n\t\t\t\t\t_status.color=Math.random()<0.5;\r\n\t\t\t\t\tvar i,list=[];\r\n\t\t\t\t\tfor(i in lib.character){\r\n\t\t\t\t\t\t// if(lib.config.forbidversus.contains(i)) continue;\r\n\t\t\t\t\t\tif(lib.filter.characterDisabled(i)) continue;\r\n\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar groupSort=function(name){\r\n\t\t\t\t\t\tif(['holo'].contains(lib.character[name][1])) return 0;\r\n\t\t\t\t\t\tif(['nijisanji'].contains(lib.character[name][1])) return 1;\r\n\t\t\t\t\t\tif(['vtuber'].contains(lib.character[name][1])) return 2;\r\n\t\t\t\t\t\tif(['clubs'].contains(lib.character[name][1])) return 3;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar sortByGroup=function(a,b){\r\n\t\t\t\t\t\tvar del=groupSort(a)-groupSort(b);\r\n\t\t\t\t\t\tif(del!=0) return del;\r\n\t\t\t\t\t\tif(a.indexOf('_')!=-1){\r\n\t\t\t\t\t\t\ta=a.slice(a.indexOf('_')+1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(b.indexOf('_')!=-1){\r\n\t\t\t\t\t\t\tb=b.slice(b.indexOf('_')+1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn a>b?1:-1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(lib.storage.choice=='∞'){\r\n\t\t\t\t\t\tlist.sort(sortByGroup);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.list=list;\r\n\t\t\t\t\tvar choice=(lib.storage.choice=='∞')?list.length:lib.storage.choice;\r\n\t\t\t\t\tevent.dialog=ui.create.dialog('选择角色',[list.slice(0,choice),'character']);\r\n\t\t\t\t\tevent.dialog.classList.add('fixed');\r\n\t\t\t\t\t// for(var i=0;i<event.dialog.buttons.length;i++){\r\n\t\t\t\t\t// \tevent.dialog.buttons[i].style.transform='scale(0.95)';\r\n\t\t\t\t\t// }\r\n\t\t\t\t\tevent.check();\r\n\t\t\t\t\tui.create.cheat=function(){\r\n\t\t\t\t\t\t_status.createControl=event.fill;\r\n\t\t\t\t\t\tui.cheat=ui.create.control('更换',function(){\r\n\t\t\t\t\t\t\tif(_status.choosefinished){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(lib.storage.choice=='∞'){\r\n\t\t\t\t\t\t\t\tlist.sort(sortByGroup);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tlist.randomSort();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_status.friend.length=0;\r\n\t\t\t\t\t\t\t_status.enemy.length=0;\r\n\t\t\t\t\t\t\tvar choice=(lib.storage.choice=='∞')?list.length:lib.storage.choice;\r\n\r\n\t\t\t\t\t\t\tui.dialog.content.firstChild.innerHTML='选择角色';\r\n\t\t\t\t\t\t\tvar buttons=ui.create.div('.buttons');\r\n\t\t\t\t\t\t\tvar node=_status.event.dialog.buttons[0].parentNode;\r\n\t\t\t\t\t\t\t_status.event.dialog.buttons=ui.create.buttons(list.slice(0,choice),'character',buttons);\r\n\t\t\t\t\t\t\t_status.event.dialog.content.insertBefore(buttons,node);\r\n\t\t\t\t\t\t\tbuttons.animate('start');\r\n\t\t\t\t\t\t\tnode.remove();\r\n\r\n\t\t\t\t\t\t\t// event.check();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdelete _status.createControl;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!ui.cheat&&get.config('change_choice'))\r\n\t\t\t\t\tui.create.cheat();\r\n\t\t\t\t\tif(lib.config.test_game){\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tevent.switchToAuto();\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.switchToAuto=function(){\r\n\t\t\t\t\t\tdelete _status.choosefinished;\r\n\t\t\t\t\t\tevent.fill.close();\r\n\t\t\t\t\t\tvar buttons=_status.event.dialog.buttons.slice(0);\r\n\t\t\t\t\t\tbuttons.randomSort();\r\n\t\t\t\t\t\tfor(var i=0;i<buttons.length;i++){\r\n\t\t\t\t\t\t\tif(buttons[i].classList.contains('glow')||buttons[i].classList.contains('selectedx')){\r\n\t\t\t\t\t\t\t\tbuttons.splice(i,1);i--;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar dialog=_status.event.dialog;\r\n\t\t\t\t\t\tvar max=dialog.versus_number.link+dialog.replace_number.link;\r\n\t\t\t\t\t\tfor(var i=0;i<buttons.length;i++){\r\n\t\t\t\t\t\t\tif(_status.friend.length<max){\r\n\t\t\t\t\t\t\t\t_status.friend.push(buttons[i].link);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(_status.enemy.length<max){\r\n\t\t\t\t\t\t\t\t_status.enemy.push(buttons[i].link);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_status.friend.splice(max);\r\n\t\t\t\t\t\t_status.enemy.splice(max);\r\n\t\t\t\t\t\tdialog.close();\r\n\t\t\t\t\t\tif(ui.confirm) ui.confirm.close();\r\n\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.fill=ui.create.control('补全',event.switchToAuto);\r\n\t\t\t\t\tevent.custom.replace.button=function(button){\r\n\t\t\t\t\t\tif(_status.choose_enemy){\r\n\t\t\t\t\t\t\tif(button.classList.contains('glow')||button.classList.contains('selectedx')||_status.choosefinished) return;\r\n\t\t\t\t\t\t\t_status.choose_enemy=false;\r\n\t\t\t\t\t\t\tif(!_status.color){\r\n\t\t\t\t\t\t\t\tbutton.classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t// button.style.transform='rotate(-3deg)';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tbutton.classList.add('glow');\r\n\t\t\t\t\t\t\t\t// button.style.transform='rotate(-3deg)';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_status.enemy.push(button.link);\r\n\t\t\t\t\t\t\tvar buttons=_status.event.dialog.buttons.slice(0);\r\n\t\t\t\t\t\t\tfor(var i=0;i<buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(buttons[i].classList.contains('glow')||buttons[i].classList.contains('selectedx')){\r\n\t\t\t\t\t\t\t\t\tbuttons.splice(i,1);i--;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(button.classList.contains('glow')||button.classList.contains('selectedx')||_status.choosefinished) return;\r\n\t\t\t\t\t\t\tif(_status.color){\r\n\t\t\t\t\t\t\t\tbutton.classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t// button.style.transform='rotate(-3deg)';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tbutton.classList.add('glow');\r\n\t\t\t\t\t\t\t\t// button.style.transform='rotate(-3deg)';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_status.friend.push(button.link);\r\n\t\t\t\t\t\t\tvar buttons=_status.event.dialog.buttons.slice(0);\r\n\t\t\t\t\t\t\tfor(var i=0;i<buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(buttons[i].classList.contains('glow')||buttons[i].classList.contains('selectedx')){\r\n\t\t\t\t\t\t\t\t\tbuttons.splice(i,1);i--;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(lib.storage.assign_enemy){\r\n\t\t\t\t\t\t\t\t_status.choose_enemy=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tvar button2=buttons[Math.floor(Math.random()*buttons.length)];\r\n\t\t\t\t\t\t\t\tif(_status.color){\r\n\t\t\t\t\t\t\t\t\tbutton2.classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t// button2.style.transform='rotate(-3deg)';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tbutton2.classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t// button2.style.transform='rotate(-3deg)';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t_status.enemy.push(button2.link);\r\n\t\t\t\t\t\t\t\t_status.event.dialog.content.firstChild.innerHTML='对方选择了'+get.translation(button2.link);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.custom.add.window=function(){\r\n\t\t\t\t\t\tvar dialog=_status.event.dialog;\r\n\t\t\t\t\t\tif(_status.friend.length==_status.enemy.length&&_status.friend.length>=dialog.versus_number.link+dialog.replace_number.link){\r\n\t\t\t\t\t\t\tevent.fill.firstChild.innerHTML='开始';\r\n\t\t\t\t\t\t\t_status.choosefinished=true;\r\n\t\t\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.save('zhu',dialog.versus_zhu.link);\r\n\t\t\t\t\t\tif(lib.storage.zhu){\r\n\t\t\t\t\t\t\t// dialog.versus_only_zhu.parentNode.classList.remove('disabled');\r\n\t\t\t\t\t\t\tdialog.versus_main_zhu.parentNode.classList.remove('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t// dialog.versus_only_zhu.parentNode.classList.add('disabled');\r\n\t\t\t\t\t\t\tdialog.versus_main_zhu.parentNode.classList.add('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// game.save('only_zhu',dialog.versus_only_zhu.link);\r\n\t\t\t\t\t\tgame.save('main_zhu',dialog.versus_main_zhu.link);\r\n\t\t\t\t\t\tgame.save('assign_enemy',dialog.versus_assign_enemy.link);\r\n\t\t\t\t\t\tgame.save('seat_order',dialog.versus_seat_order.link);\r\n\t\t\t\t\t\t// game.save('cross_seat',dialog.versus_cross_seat.link);\r\n\t\t\t\t\t\tgame.save('noreplace_end',dialog.versus_noreplace_end.link);\r\n\t\t\t\t\t\tgame.save('single_control',dialog.versus_single_control.link);\r\n\t\t\t\t\t\tswitch(lib.storage.seat_order){\r\n\t\t\t\t\t\t\tcase '交叉':lib.storage.cross_seat=true;lib.storage.random_seat=false;break;\r\n\t\t\t\t\t\t\tcase '随机':lib.storage.cross_seat=false;lib.storage.random_seat=true;break;\r\n\t\t\t\t\t\t\tdefault:lib.storage.cross_seat=false;lib.storage.random_seat=false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.saveConfig('first_less',dialog.versus_first_less.link,true);\r\n\t\t\t\t\t\tgame.save('number',dialog.versus_number.link);\r\n\t\t\t\t\t\tgame.save('versus_reward',dialog.versus_reward.link);\r\n\t\t\t\t\t\tgame.save('versus_punish',dialog.versus_punish.link);\r\n\t\t\t\t\t\tgame.save('replace_number',dialog.replace_number.link);\r\n\t\t\t\t\t\tgame.save('choice',dialog.choice.link);\r\n\t\t\t\t\t\tvar count,i;\r\n\t\t\t\t\t\tif(dialog.buttons.length>lib.storage.choice){\r\n\t\t\t\t\t\t\tcount=dialog.buttons.length-lib.storage.choice;\r\n\t\t\t\t\t\t\tvar removed=[];\r\n\t\t\t\t\t\t\tfor(i=dialog.buttons.length-1;i>=0&&count>0;i--){\r\n\t\t\t\t\t\t\t\tif(dialog.buttons[i].classList.contains('target')==false&&\r\n\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.contains('glow')==false){\r\n\t\t\t\t\t\t\t\t\tdialog.buttons[i].remove();\r\n\t\t\t\t\t\t\t\t\t_status.list.remove(dialog.buttons[i].link);\r\n\t\t\t\t\t\t\t\t\tremoved.push(dialog.buttons[i].link)\r\n\t\t\t\t\t\t\t\t\tdialog.buttons.splice(i,1);\r\n\t\t\t\t\t\t\t\t\tcount--;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(i=0;i<removed.length;i++) _status.list.splice(lib.storage.choice,0,removed[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(dialog.buttons.length<lib.storage.choice||lib.storage.choice=='∞'){\r\n\t\t\t\t\t\t\tvar list=_status.list;\r\n\t\t\t\t\t\t\tvar choice=(lib.storage.choice=='∞')?list.length:lib.storage.choice;\r\n\t\t\t\t\t\t\tvar buttons=dialog.querySelector('.buttons');\r\n\t\t\t\t\t\t\tvar button;\r\n\t\t\t\t\t\t\tfor(i=dialog.buttons.length;i<choice;i++){\r\n\t\t\t\t\t\t\t\tbutton=ui.create.button(list[i],'character',buttons).animate('zoom')\r\n\t\t\t\t\t\t\t\tdialog.buttons.push(button);\r\n\t\t\t\t\t\t\t\tbutton.style.opacity=1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tgame.pause();\r\n\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t_status.friendBackup=_status.friend.slice(0);\r\n\t\t\t\t\t_status.enemyBackup=_status.enemy.slice(0);\r\n\r\n\t\t\t\t\t_status.friendDied=[];\r\n\t\t\t\t\t_status.enemyDied=[];\r\n\t\t\t\t\t_status.totalCount=_status.friend.length;\r\n\t\t\t\t\t_status.coinCoeff=get.coinCoeff(_status.friend);\r\n\r\n\t\t\t\t\t// ui.auto.show();\r\n\t\t\t\t\tui.wuxie.show();\r\n\t\t\t\t\tui.control.style.display='none';\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.control.style.top='';\r\n\t\t\t\t\t\tui.control.style.display='';\r\n\t\t\t\t\t\tui.control.style.transition='';\r\n\t\t\t\t\t},500);\r\n\t\t\t\t\tif(ui.cheat){\r\n\t\t\t\t\t\tui.cheat.close();\r\n\t\t\t\t\t\tdelete ui.cheat;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete _status.list;\r\n\t\t\t\t\tvar num=lib.storage.number;\r\n\t\t\t\t\tui.create.players(num*2);\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tgame.players[i].getId();\r\n\t\t\t\t\t\tgame.players[i].node.action.innerHTML='行动';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(lib.storage.single_control&&game.players.length>=4){\r\n\t\t\t\t\t\tui.arena.setNumber(parseInt(ui.arena.dataset.number)+1);\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tgame.players[i].dataset.position=parseInt(game.players[i].dataset.position)+1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.singleHandcard=true;\r\n\t\t\t\t\t\tui.arena.classList.add('single-handcard');\r\n\t\t\t\t\t\tui.window.classList.add('single-handcard');\r\n\t\t\t\t\t\tui.fakeme=ui.create.div('.fakeme.avatar');\r\n\t\t\t\t\t\t// ui.fakeme.line=lib.element.player.line;\r\n\t\t\t\t\t\t// ui.fakemebg=ui.create.div('.avatar',ui.fakeme).hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.prepareArena=true;\r\n\t\t\t\t\tui.create.me();\r\n\t\t\t\t\tif(ui.fakeme){\r\n\t\t\t\t\t\tui.me.appendChild(ui.fakeme);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar position,i;\r\n\t\t\t\t\tif(lib.storage.zhu&&lib.storage.only_zhu) position=Math.ceil(num/2)-1;\r\n\t\t\t\t\telse position=Math.floor(Math.random()*num)\r\n\t\t\t\t\tgame.friend=[];\r\n\t\t\t\t\tgame.enemy=[];\r\n\t\t\t\t\tif(lib.storage.random_seat){\r\n\t\t\t\t\t\tvar players=game.players.slice(0);\r\n\t\t\t\t\t\tgame.friend.push(game.me);\r\n\t\t\t\t\t\tplayers.remove(game.me);\r\n\t\t\t\t\t\tfor(i=0;i<num-1;i++){\r\n\t\t\t\t\t\t\tgame.friend.push(players.randomRemove());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(i=0;i<num;i++){\r\n\t\t\t\t\t\t\tgame.enemy.push(players.randomRemove());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tfor(var i in lib.skill){\r\n\t\t\t\t\t\t\tif(lib.skill[i].changeSeat){\r\n\t\t\t\t\t\t\t\tlib.skill[i]={};\r\n\t\t\t\t\t\t\t\tif(lib.translate[i+'_info']){\r\n\t\t\t\t\t\t\t\t\tlib.translate[i+'_info']='固定位置时不可用';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(lib.storage.cross_seat){\r\n\t\t\t\t\t\t\tfor(i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(i%2==0){\r\n\t\t\t\t\t\t\t\t\tgame.friend.push(game.players[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tgame.enemy.push(game.players[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tfor(i=0;i<position;i++){\r\n\t\t\t\t\t\t\t\tgame.friend.push(game.players[i-position+num*2]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(i=position;i<num;i++){\r\n\t\t\t\t\t\t\t\tgame.friend.push(game.players[i-position]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor(i=0;i<num;i++){\r\n\t\t\t\t\t\t\t\tgame.enemy.push(game.players[num-position+i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(((position==Math.ceil(num/2)-1&&lib.storage.zhu)||(lib.storage.zhu&&lib.storage.single_control))){\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('按顺序选择出场角色',[_status.friend,'character']);\r\n\t\t\t\t\t\tgame.me.chooseButton(dialog,num,true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(lib.storage.random_seat&&lib.storage.zhu){\r\n\t\t\t\t\t\tif(lib.storage.only_zhu){\r\n\t\t\t\t\t\t\tgame.friendZhu=game.me;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.friendZhu=game.friend.randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.enemyZhu=game.enemy.randomGet();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i=0;i<num;i++){\r\n\t\t\t\t\t\tgame.friend[i].side=_status.color;\r\n\t\t\t\t\t\tgame.enemy[i].side=!_status.color;\r\n\t\t\t\t\t\tif(lib.storage.random_seat&&lib.storage.zhu){\r\n\t\t\t\t\t\t\tif(game.friendZhu==game.friend[i]){\r\n\t\t\t\t\t\t\t\tgame.friend[i].identity='zhu';\r\n\t\t\t\t\t\t\t\tgame.friend[i].setIdentity(_status.color+'Zhu');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.friend[i].identity='zhong';\r\n\t\t\t\t\t\t\t\tgame.friend[i].setIdentity(_status.color+'Zhong');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(game.enemyZhu==game.enemy[i]){\r\n\t\t\t\t\t\t\t\tgame.enemy[i].identity='zhu';\r\n\t\t\t\t\t\t\t\tgame.enemy[i].setIdentity(!_status.color+'Zhu');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.enemy[i].identity='zhong';\r\n\t\t\t\t\t\t\t\tgame.enemy[i].setIdentity(!_status.color+'Zhong');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(game.me==game.friend[i]&&lib.storage.zhu){\r\n\t\t\t\t\t\t\t\tgame.friend[i].identity='zhu';\r\n\t\t\t\t\t\t\t\tgame.friend[i].setIdentity(_status.color+'Zhu');\r\n\t\t\t\t\t\t\t\tgame.friendZhu=game.friend[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.friend[i].identity='zhong';\r\n\t\t\t\t\t\t\t\tgame.friend[i].setIdentity(_status.color+'Zhong');\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(lib.storage.zhu&&get.distance(game.enemy[i],game.me,'pure')==num){\r\n\t\t\t\t\t\t\t\tgame.enemy[i].identity='zhu';\r\n\t\t\t\t\t\t\t\tgame.enemy[i].setIdentity(!_status.color+'Zhu');\r\n\t\t\t\t\t\t\t\tgame.enemyZhu=game.enemy[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.enemy[i].identity='zhong';\r\n\t\t\t\t\t\t\t\tgame.enemy[i].setIdentity(!_status.color+'Zhong');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.friend[i].node.identity.dataset.color=get.translation(_status.color+'Color');\r\n\t\t\t\t\t\tgame.enemy[i].node.identity.dataset.color=get.translation(!_status.color+'Color');\r\n\t\t\t\t\t\t// game.friend[i].node.identity.style.backgroundColor=get.translation(_status.color+'Color');\r\n\t\t\t\t\t\t// game.enemy[i].node.identity.style.backgroundColor=get.translation(!_status.color+'Color');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(lib.storage.zhu&&!game.enemyZhu){\r\n\t\t\t\t\t\tgame.enemy[0].identity='zhu';\r\n\t\t\t\t\t\tgame.enemy[0].setIdentity(!_status.color+'Zhu');\r\n\t\t\t\t\t\tgame.enemyZhu=game.enemy[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tvar num=lib.storage.number;\r\n\t\t\t\t\tif(result&&result.buttons){\r\n\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\tfor(i=0;i<result.buttons.length;i++){\r\n\t\t\t\t\t\t\tlist.push(result.buttons[i].link);\r\n\t\t\t\t\t\t\t_status.friend.remove(result.buttons[i].link);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_status.friend=list.concat(_status.friend);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i=0;i<num;i++){\r\n\t\t\t\t\t\tgame.friend[i].init(_status.friend[i]);\r\n\t\t\t\t\t\tgame.enemy[i].init(_status.enemy[i]);\r\n\r\n\t\t\t\t\t\tgame.friend[i].node.identity.dataset.color=get.translation(_status.color+'Color');\r\n\t\t\t\t\t\tgame.enemy[i].node.identity.dataset.color=get.translation(!_status.color+'Color');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(lib.storage.zhu&&lib.storage.main_zhu){\r\n\t\t\t\t\t\tgame.friendZhu.maxHp++;\r\n\t\t\t\t\t\tgame.friendZhu.hp++;\r\n\t\t\t\t\t\tgame.friendZhu.update();\r\n\r\n\t\t\t\t\t\tgame.enemyZhu.maxHp++;\r\n\t\t\t\t\t\tgame.enemyZhu.hp++;\r\n\t\t\t\t\t\tgame.enemyZhu.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.friend.splice(0,num);\r\n\t\t\t\t\t_status.enemy.splice(0,num);\r\n\t\t\t\t\tif(lib.storage.single_control&&game.players.length>=4){\r\n\t\t\t\t\t\t// ui.fakemebg.show();\r\n\t\t\t\t\t\tgame.onSwapControl();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL:function(){\r\n\t\t\t\tswitch(lib.configOL.versus_mode){\r\n\t\t\t\t\tcase '1v1':game.chooseCharacterOL1();break;\r\n\t\t\t\t\tcase '2v2':game.chooseCharacterOL2();break;\r\n\t\t\t\t\tcase '3v3':game.chooseCharacterOL3();break;\r\n\t\t\t\t\tcase '4v4':game.chooseCharacterOL4();break;\r\n\t\t\t\t\tcase 'guandu':game.chooseCharacterOLGuandu();break;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchooseCharacterOLGuandu:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar list=[\r\n \t\t\t\t\t['zhu','ezhu','ezhong','zhong','ezhong','zhong','zhong','ezhong'],\r\n \t\t\t\t\t['zhu','ezhong','zhong','ezhu','ezhong','zhong','ezhong','zhong'],\r\n \t\t\t\t\t['zhu','ezhong','zhong','ezhong','zhong','ezhong','zhong','ezhu'],\r\n \t\t\t\t\t['zhu','ezhu','zhong','ezhong','zhong','ezhong','zhong','ezhong'],\r\n \t\t\t\t\t['zhu','ezhong','zhong','ezhong','zhong','ezhu','zhong','ezhong'],\r\n \t\t\t\t].randomGet();\r\n\t\t\t\t\r\n \t\t\t\tvar side=true;\r\n \t\t\t\tvar num=Math.floor(Math.random()*8);\r\n \t\t\t\tlist=list.splice(8-num).concat(list);\r\n \t\t\t\tfor(var i=0;i<8;i++){\r\n \t\t\t\t\tif(list[i][0]=='e'){\r\n \t\t\t\t\t\tgame.players[i].side=side;\r\n \t\t\t\t\t\tgame.players[i].identity=list[i].slice(1);\r\n \t\t\t\t\t}\r\n \t\t\t\t\telse{\r\n \t\t\t\t\t\tgame.players[i].side=!side;\r\n \t\t\t\t\t\tgame.players[i].identity=list[i];\r\n \t\t\t\t\t}\r\n \t\t\t\t\tif(game.players[i].identity=='zhu'){\r\n \t\t\t\t\t\tgame[game.players[i].side+'Zhu']=game.players[i];\r\n \t\t\t\t\t\tgame.players[i].isZhu=true;\r\n \t\t\t\t\t}\r\n \t\t\t\t\tgame.players[i].setIdentity(game.players[i].identity);\r\n \t\t\t\t\tgame.players[i].node.identity.dataset.color=get.translation(game.players[i].side+'Color');\r\n \t\t\t\t\tgame.players[i].getId();\r\n \t\t\t\t}\r\n\r\n\t\t\t\t\tvar side=true;\r\n\t\t\t\t\tvar map={};\r\n\t\t\t\t\tvar num=Math.floor(Math.random()*8);\r\n\t\t\t\t\tlist=list.splice(8-num).concat(list);\r\n\t\t\t\t\tfor(var i=0;i<8;i++){\r\n\t\t\t\t\t\tif(list[i][0]=='e'){\r\n\t\t\t\t\t\t\tgame.players[i].side=side;\r\n\t\t\t\t\t\t\tgame.players[i].identity=list[i].slice(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.players[i].side=!side;\r\n\t\t\t\t\t\t\tgame.players[i].identity=list[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmap[game.players[i].playerid]=[game.players[i].side,game.players[i].identity];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar evt=['huoshaowuchao','liangcaokuifa','zhanyanliangzhuwenchou','shishengshibai'].randomGet();\r\n\t\t\t\t\tgame.addGlobalSkill(evt);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar func=function(map,evt){\r\n\t\t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\t\t\tif(player){\r\n\t\t\t\t\t\t\t\tplayer.side=map[i][0];\r\n\t\t\t\t\t\t\t\tplayer.identity=map[i][1];\r\n\t\t\t\t\t\t\t\tplayer.setIdentity();\r\n\t\t\t\t\t\t\t\tplayer.node.identity.dataset.color=get.translation(player.side+'Color');\r\n\t\t\t\t\t\t\t\tif(player.identity=='zhu'){\r\n\t\t\t\t\t\t\t\t\tgame[player.side+'Zhu']=player;\r\n\t\t\t\t\t\t\t\t\tplayer.isZhu=true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n \t\t\t\t\tgame.falseZhu.init('re_caocao');\r\n \t\t\t\t\tgame.trueZhu.init('ol_yuanshao');\r\n \t\t\t\t\tgame.trueZhu.hp++;\r\n \t\t\t\t\tgame.trueZhu.maxHp++;\r\n \t\t\t\t\tgame.falseZhu.hp++;\r\n \t\t\t\t\tgame.falseZhu.maxHp++;\r\n \t\t\t\t\tgame.trueZhu.update();\r\n \t\t\t\t\tgame.falseZhu.update();\r\n\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t\tif(get.is.phoneLayout()){\r\n  \t\t\t\t\tui.guanduInfo=ui.create.div('.touchinfo.left',ui.window);\r\n  \t\t\t\t}\r\n  \t\t\t\telse{\r\n  \t\t\t\t\tui.guanduInfo=ui.create.div(ui.gameinfo);\r\n  \t\t\t\t}\r\n  \t\t\t\tui.guanduInfo.innerHTML='当前事件：'+get.translation(evt);\r\n  \t\t\t\tvar dialog=ui.create.dialog('本局特殊事件：'+get.translation(evt));\r\n  \t\t\t\tdialog.addText(get.translation(evt+'_info'),false);\r\n  \t\t\t\tsetTimeout(function(){\r\n  \t\t\t\t\tdialog.close();\r\n  \t\t\t\t},5000)\r\n\t\t\t\t\t};\r\n\t\t\t\t\tgame.broadcastAll(func,map,evt);\r\n\t\t\t\t\t_status.firstAct=game.falseZhu;\r\n\t\t\t\t\tgame.delay(0,5000);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tevent.falseList=['xunyu','xunyou','re_guojia','re_zhangliao','re_xuhuang','yujin_yujin','caohong','jsp_guanyu','liuye','litong','zangba','re_manchong','re_hanhaoshihuan','chengyu','caoren'].filter(function(name){\r\n\t\t\t\t\t\tif(!Array.isArray(lib.character[name])) return false;\r\n\t\t\t\t\t\tlib.character[name][1]='wei';\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tevent.trueList=['xunchen','gaolan','sp_zhanghe','sp_xuyou','chenlin','re_liubei','yj_jushou','sp_shenpei','tianfeng','yuantanyuanshang','lvkuanglvxiang','xinpi','guotufengji','chunyuqiong'].filter(function(name){\r\n\t\t\t\t\t\tif(!Array.isArray(lib.character[name])) return false;\r\n\t\t\t\t\t\tlib.character[name][1]='qun';\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.broadcast(function(list1,list2){\r\n\t\t\t\t\t\twhile(list1.length){\r\n\t\t\t\t\t\t\tlib.character[list1.shift()][1]='wei';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twhile(list2.length){\r\n\t\t\t\t\t\t\tlib.character[list2.shift()][1]='qun';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},event.falseList,event.trueList);\r\n\t\t\t\t\tevent.map={};\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\tif(current.identity=='zhong'){\r\n\t\t\t\t\t\t\tvar choice=event[current.side+'List'].randomRemove(3);\r\n\t\t\t\t\t\t\tevent.map[current.playerid]=choice;\r\n\t\t\t\t\t\t\tlist.push([current,['请选择武将',[choice,'character']],true]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.me.chooseButtonOL(list,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me){\r\n\t\t\t\t\t\t\tplayer.init(result.links[0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]=='ai'){\r\n\t\t\t\t\t\t\tresult[i]=event.map[i].randomGet();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse result[i]=result[i].links[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function(result){\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},result);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterGuandu:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tgame.falseZhu.init('re_caocao');\r\n\t\t\t\t\tgame.trueZhu.init('ol_yuanshao');\r\n\t\t\t\t\tgame.trueZhu.hp++;\r\n\t\t\t\t\tgame.trueZhu.maxHp++;\r\n\t\t\t\t\tgame.falseZhu.hp++;\r\n\t\t\t\t\tgame.falseZhu.maxHp++;\r\n\t\t\t\t\tgame.trueZhu.update();\r\n\t\t\t\t\tgame.falseZhu.update();\r\n\t\t\t\t\tvar evt=['huoshaowuchao','liangcaokuifa','zhanyanliangzhuwenchou','shishengshibai'].randomGet();\r\n\t\t\t\t\tgame.addGlobalSkill(evt);\r\n\t\t\t\t\tgame.broadcastAll(function(evt){\r\n\t\t\t\t\t\tif(get.is.phoneLayout()){\r\n  \t\t\t\t\tui.guanduInfo=ui.create.div('.touchinfo.left',ui.window);\r\n  \t\t\t\t}\r\n  \t\t\t\telse{\r\n  \t\t\t\t\tui.guanduInfo=ui.create.div(ui.gameinfo);\r\n  \t\t\t\t}\r\n  \t\t\t\tui.guanduInfo.innerHTML='当前事件：'+get.translation(evt);\r\n\t\t\t\t\t},evt);\r\n\t\t\t\t\tgame.me.chooseControl('ok').set('prompt','###本局特殊事件：'+get.translation(evt)+'###'+get.translation(evt+'_info'));\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.falseList=['xunyu','xunyou','re_guojia','re_zhangliao','re_xuhuang','yujin_yujin','caohong','jsp_guanyu','liuye','litong','zangba','re_manchong','re_hanhaoshihuan','chengyu','caoren'].filter(function(name){\r\n\t\t\t\t\t\tif(!Array.isArray(lib.character[name])) return false;\r\n\t\t\t\t\t\tlib.character[name][1]='wei';\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tevent.trueList=['xunchen','gaolan','sp_zhanghe','sp_xuyou','chenlin','re_liubei','yj_jushou','sp_shenpei','tianfeng','yuantanyuanshang','lvkuanglvxiang','xinpi','guotufengji','chunyuqiong'].filter(function(name){\r\n\t\t\t\t\t\tif(!Array.isArray(lib.character[name])) return false;\r\n\t\t\t\t\t\tlib.character[name][1]='qun';\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(game.me.identity!='zhu'){\r\n\t\t\t\t\t\tevent.choose_me=true;\r\n\t\t\t\t\t\tgame.me.chooseButton(['请选择你的武将牌',[event[game.me.side+'List'].randomRemove(3),'character']],true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(event.choose_me) game.me.init(result.links[0]);\r\n\t\t\t\t\tgame.countPlayer(function(current){\r\n\t\t\t\t\t\tif(current!=game.me&&current.identity=='zhong') current.init(event[current.side+'List'].randomRemove(2)[0]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL4:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacter',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar list=[\r\n\t\t\t\t\t\t['zhong','ezhong','ezhong','zhong','zhong','ezhong','ezhong','zhong'],\r\n\t\t\t\t\t\t['zhong','ezhong','zhong','ezhong','ezhong','zhong','ezhong','zhong'],\r\n\t\t\t\t\t\t['zhong','ezhong','ezhong','zhong','ezhong','zhong','zhong','ezhong'],\r\n\t\t\t\t\t\t['zhong','ezhong','zhong','ezhong','zhong','ezhong','zhong','ezhong'],\r\n\t\t\t\t\t\t['zhong','ezhong','ezhong','zhong','ezhong','zhong','ezhong','zhong'],\r\n\t\t\t\t\t].randomGet();\r\n\t\t\t\t\tvar rand1=Math.floor(Math.random()*4);\r\n\t\t\t\t\tvar rand2=Math.floor(Math.random()*4);\r\n\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\tif(list[i]=='zhong'){\r\n\t\t\t\t\t\t\tif(rand1==0){\r\n\t\t\t\t\t\t\t\tlist[i]='zhu';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\trand1--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(rand2==0){\r\n\t\t\t\t\t\t\t\tlist[i]='ezhu';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\trand2--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar side=Math.random()<0.5;\r\n\t\t\t\t\tvar map={};\r\n\t\t\t\t\tvar num=Math.floor(Math.random()*8);\r\n\t\t\t\t\tlist=list.splice(8-num).concat(list);\r\n\t\t\t\t\t_status.firstAct=game.players[num];\r\n\t\t\t\t\tevent.current=_status.firstAct.next;\r\n\t\t\t\t\tfor(var i=0;i<8;i++){\r\n\t\t\t\t\t\tif(list[i][0]=='e'){\r\n\t\t\t\t\t\t\tgame.players[i].side=side;\r\n\t\t\t\t\t\t\tgame.players[i].identity=list[i].slice(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.players[i].side=!side;\r\n\t\t\t\t\t\t\tgame.players[i].identity=list[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmap[game.players[i].playerid]=[game.players[i].side,game.players[i].identity];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_status.firstAct.side){\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tgame.players[i].side=!game.players[i].side;\r\n\t\t\t\t\t\t\tmap[game.players[i].playerid]=[game.players[i].side,game.players[i].identity];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function(current){\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tgame.players[i].node.name_seat=ui.create.div('.name.name_seat',get.verticalStr(lib.translate['unknown'+get.distance(current,game.players[i],'absolute')]),game.players[i]);\r\n\t\t\t\t\t\t\tgame.players[i].node.name_seat.style.opacity=1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},_status.firstAct);\r\n\r\n\t\t\t\t\tvar filterChoice=function(name){\r\n\t\t\t\t\t\tif(name=='zuoci'||name=='miheng') return true;\r\n\t\t\t\t\t\tif(get.is.double(name))\treturn true;\r\n\t\t\t\t\t\tfor(let i of lib.choiceVtuberkill){\r\n\t\t\t\t\t\t\tif(lib.characterPack[i]&&lib.characterPack[i][name]){\r\n\t\t\t\t\t\t\t\tif(!lib.configOL.characterPack.contains(i)) return true;\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.flipassign=true;\r\n\t\t\t\t\tevent.videoId=lib.status.videoId++;\r\n\t\t\t\t\tvar func=function(filter,id,selected,map,choiceVtuberkill){\r\n\t\t\t\t\t\tlib.choiceVtuberkill=choiceVtuberkill;\r\n\t\t\t\t\t\tvar dialog=ui.create.characterDialog('heightset',filter,'expandall').open();\r\n\t\t\t\t\t\tdialog.videoId=id;\r\n\t\t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\t\tvar player=lib.playerOL[i];\r\n\t\t\t\t\t\t\tif(player){\r\n\t\t\t\t\t\t\t\tplayer.side=map[i][0];\r\n\t\t\t\t\t\t\t\tplayer.identity=map[i][1];\r\n\t\t\t\t\t\t\t\tplayer.setIdentity();\r\n\t\t\t\t\t\t\t\tplayer.node.identity.dataset.color=get.translation(player.side+'Color');\r\n\t\t\t\t\t\t\t\tif(player.identity=='zhu'){\r\n\t\t\t\t\t\t\t\t\tgame[player.side+'Zhu']=player;\r\n\t\t\t\t\t\t\t\t\tplayer.isZhu=true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t};\r\n\t\t\t\t\tevent.map=map;\r\n\t\t\t\t\tevent.selected=[];\r\n\t\t\t\t\tgame.broadcastAll(func,filterChoice,event.videoId,event.selected,map,lib.choiceVtuberkill);\r\n\t\t\t\t\t_status.onreconnect=[func,filterChoice,event.videoId,event.selected,map,lib.choiceVtuberkill];\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tgame.broadcastAll(function(player){\r\n\t\t\t\t\t\tplayer.classList.add('selectedx');\r\n\t\t\t\t\t},event.current);\r\n\t\t\t\t\tevent.current.chooseButton(true).set('filterButton',function(button){\r\n\t\t\t\t\t\treturn !_status.event.selected.contains(button.link);\r\n\t\t\t\t\t}).set('ai',function(button){\r\n\t\t\t\t\t\tif(_status.event.player.identity=='zhu'){\r\n\t\t\t\t\t\t\tif(Math.random()<0.8){\r\n\t\t\t\t\t\t\t\tvar info=lib.character[button.link];\r\n\t\t\t\t\t\t\t\tif(!info[4]||!info[4].contains('zhu')){\r\n\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar seed=_status.event.seed;\r\n\t\t\t\t\t\tvar rank=get.rank(button.link,true);\r\n\t\t\t\t\t\tif(seed>0.4){\r\n\t\t\t\t\t\t\treturn (rank>=6)?Math.random():-Math.random();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(seed>0.1){\r\n\t\t\t\t\t\t\treturn (rank>=4&&rank<6)?Math.random():-Math.random();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\treturn (rank<4)?Math.random():-Math.random();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).set('selected',_status.event.selected).set('dialog',event.videoId).set('seed',Math.random());\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tevent.selected.push(result.links[0]);\r\n\t\t\t\t\tgame.broadcastAll(function(player,name,zhu){\r\n\t\t\t\t\t\tplayer.classList.remove('selectedx');\r\n\t\t\t\t\t\tplayer.init(name);\r\n\t\t\t\t\t\tif(player.node.name_seat){\r\n\t\t\t\t\t\t\tplayer.node.name_seat.remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},event.current,result.links[0]);\r\n\t\t\t\t\tif(event.current.identity=='zhu'){\r\n\t\t\t\t\t\tevent.current.hp++;\r\n\t\t\t\t\t\tevent.current.maxHp++;\r\n\t\t\t\t\t\tevent.current.update();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.current.classList.remove('selectedx');\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(!game.players[i].name1) break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(i<game.players.length){\r\n\t\t\t\t\t\tvar side=event.current.side;\r\n\t\t\t\t\t\tevent.current=_status.firstAct.next;\r\n\t\t\t\t\t\tif(event.flipassign){\r\n\t\t\t\t\t\t\tfor(var iwhile=0;iwhile<8;iwhile++){\r\n\t\t\t\t\t\t\t\tevent.current=event.current.next;\r\n\t\t\t\t\t\t\t\tif(event.current.side!=side&&!event.current.name1){\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tfor(var iwhile=0;iwhile<8;iwhile++){\r\n\t\t\t\t\t\t\t\tevent.current=event.current.previous;\r\n\t\t\t\t\t\t\t\tif(event.current.side==side&&!event.current.name1){\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.flipassign=!event.flipassign;\r\n\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\t_status.onreconnect=[function(){\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tvar player=game.players[i];\r\n\t\t\t\t\t\t\tif(player.identity=='zhu'){\r\n\t\t\t\t\t\t\t\tgame[player.side+'Zhu']=player;\r\n\t\t\t\t\t\t\t\tplayer.isZhu=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t\tgame.broadcastAll(function(id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tdialog.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500);\r\n\t\t\t\t\t},event.videoId);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL3:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacterOL',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.additionaldead=[];\r\n\t\t\t\t\tgame.broadcastAll(function(ref,bool){\r\n\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t\tfor(var i=0;i<6;i++){\r\n\t\t\t\t\t\t\tref.side=bool;\r\n\t\t\t\t\t\t\tref=ref.next;\r\n\t\t\t\t\t\t\tbool=!bool;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=game.players[i].side+'zhu';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},game.players[0],Math.random()<0.5);\r\n\t\t\t\t\tif(game.me.side==undefined){\r\n\t\t\t\t\t\tgame.me.side=game.players[0].side;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.onreconnect=[function(){\r\n\t\t\t\t\t\tvar players=game.players.concat(game.dead);\r\n\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\tif(players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\tplayers[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tplayers[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}];\r\n\t\t\t\t\tvar list=get.charactersOL();\r\n\t\t\t\t\tvar choose=[];\r\n\t\t\t\t\tevent.list=list;\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tchoose.push([game.players[i],['选择出场和备用武将',[list.randomRemove(5),'character']],2,true]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(choose,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]=='ai'){\r\n\t\t\t\t\t\t\tresult[i]=event.list.randomRemove(2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tresult[i]=result[i].links;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function(result,func1,func2){\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500)\r\n\t\t\t\t\t\t_status.friendDied=[];\r\n\t\t\t\t\t\t_status.enemyDied=[];\r\n\r\n\t\t\t\t\t\t_status.friend=[];\r\n\t\t\t\t\t\t_status.enemy=[];\r\n\r\n\t\t\t\t\t\t_status.enemyCount=ui.create.system('杀敌: '+get.cnNumber(0,true),null,true);\r\n\t\t\t\t\t\t_status.friendCount=ui.create.system('阵亡: '+get.cnNumber(0,true),null,true);\r\n\r\n\t\t\t\t\t\tlib.setPopped(_status.friendCount,func1);\r\n\t\t\t\t\t\tlib.setPopped(_status.enemyCount,func2);\r\n\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tif(!lib.playerOL[i].name1){\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i][0]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(lib.playerOL[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\t_status.friend.push(result[i][1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t_status.enemy.push(result[i][1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result,game.versusHoverFriend,game.versusHoverEnemy);\r\n\t\t\t\t\t_status.onreconnect=[function(list1,list2,list3,list4,side,func1,func2){\r\n\t\t\t\t\t\tif(side!=game.me.side){\r\n\t\t\t\t\t\t\tvar tmp;\r\n\t\t\t\t\t\t\ttmp=list1;\r\n\t\t\t\t\t\t\tlist1=list2;\r\n\t\t\t\t\t\t\tlist2=tmp;\r\n\t\t\t\t\t\t\ttmp=list3;\r\n\t\t\t\t\t\t\tlist3=list4;\r\n\t\t\t\t\t\t\tlist4=tmp;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_status.friendDied=list1;\r\n\t\t\t\t\t\t_status.enemyDied=list2;\r\n\r\n\t\t\t\t\t\t_status.friend=list3;\r\n\t\t\t\t\t\t_status.enemy=list4;\r\n\r\n\t\t\t\t\t\t_status.enemyCount=ui.create.system('杀敌: '+get.cnNumber(_status.enemyDied.length,true),null,true);\r\n\t\t\t\t\t\t_status.friendCount=ui.create.system('阵亡: '+get.cnNumber(_status.friendDied.length,true),null,true);\r\n\r\n\t\t\t\t\t\tlib.setPopped(_status.friendCount,func1);\r\n\t\t\t\t\t\tlib.setPopped(_status.enemyCount,func2);\r\n\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},_status.friendDied,_status.enemyDied,\r\n\t\t\t\t\t\t_status.friend,_status.enemy,game.me.side,\r\n\t\t\t\t\t\tgame.versusHoverFriend,game.versusHoverEnemy];\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL2:function(){\r\n\t\t\t\tif (get.config('connect_change_choice')) {\r\n\t\t\t\t\tgame.chooseCharacterChangeOL2();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next=game.createEvent('chooseCharacterOL',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar ref=game.players[0];\r\n\t\t\t\t\tvar bool=Math.random()<0.5;\r\n\t\t\t\t\tvar bool2= (lib.configOL.observe_race)?bool:Math.random()<0.5;\r\n\t\t\t\t\tref.side=bool;\r\n\t\t\t\t\tref.next.side=bool2;\r\n\t\t\t\t\tref.next.next.side=!bool;\r\n\t\t\t\t\tref.previous.side=!bool2;\r\n\t\t\t\t\tvar firstChoose = game.players.randomGet();\r\n\t\t\t\t\tif(lib.configOL.observe_race){\r\n\t\t\t\t\t\tfirstChoose = ref.next\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(firstChoose.next.side==firstChoose.side){\r\n\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.firstAct=firstChoose;\r\n\t\t\t\t\tfor(var i=0;i<4;i++){\r\n\t\t\t\t\t\tfirstChoose.node.name.innerHTML=get.verticalStr(get.cnNumber(i+1,true)+'号位');\r\n\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=game.players[i].side+'zhu';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tgame.broadcast(function(ref,bool,bool2,firstChoose){\r\n\t\t\t\t\t\tref.side=bool;\r\n\t\t\t\t\t\tref.next.side=bool2;\r\n\t\t\t\t\t\tref.next.next.side=!bool;\r\n\t\t\t\t\t\tref.previous.side=!bool2;\r\n\t\t\t\t\t\tfor(var i=0;i<4;i++){\r\n\t\t\t\t\t\t\tfirstChoose.node.name.innerHTML=get.verticalStr(get.cnNumber(i+1,true)+'号位');\r\n\t\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=game.players[i].side+'zhu';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t},ref,bool,bool2,_status.firstAct);\r\n\t\t\t\t\t_status.onreconnect=[function(){\r\n\t\t\t\t\t\tvar players=game.players.concat(game.dead);\r\n\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\tif(players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\tplayers[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tplayers[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}];\r\n\t\t\t\t\t\r\n\t\t\t\t\t//22联机分配武将\r\n\t\t\t\t\tvar list=[];\r\n\t\t\t\t\tvar libCharacter={};\r\n\t\t\t\t\tvar list4=[];\r\n\t\t\t\t\tfor(var i=0;i<lib.configOL.characterPack.length;i++){\r\n\t\t\t\t\t\tvar pack=lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor(var j in pack){\r\n\t\t\t\t\t\t\tif(typeof func=='function'&&func(j)) continue;\r\n\t\t\t\t\t\t\tif(lib.connectBanned.contains(j)) continue;\r\n\t\t\t\t\t\t\tif(lib.character[j]) libCharacter[j]=pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(i in lib.characterReplace){\r\n\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\tif(!libCharacter[ix[j]]||lib.filter.characterDisabled(ix[j],libCharacter)) ix.splice(j--,1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(ix.length){\r\n\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t\tlist4.addArray(ix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function(list){\r\n\t\t\t\t\t\tfor(var i in lib.characterReplace){\r\n\t\t\t\t\t\t\tvar ix=lib.characterReplace[i];\r\n\t\t\t\t\t\t\tfor(var j=0;j<ix.length;j++){\r\n\t\t\t\t\t\t\t\tif(!list.contains(ix[j])) ix.splice(j--,1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},list4);\r\n\t\t\t\t\tfor(i in libCharacter){\r\n\t\t\t\t\t\tif(list4.contains(i)||lib.filter.characterDisabled(i,libCharacter)) continue;\r\n\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\tlist4.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar choose=[];\r\n\t\t\t\t\tevent.list=list;\r\n\t\t\t\t\t_status.characterlist=list4;\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tchoose.push([game.players[i],['选择角色',[list.randomRemove(7),'characterx']],true]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.me.chooseButtonOL(choose,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\tif(result[i]=='ai'){\r\n\t\t\t\t\t\t\tvar name=event.list.randomRemove();\r\n\t\t\t\t\t\t\tif(lib.characterReplace[name]&&lib.characterReplace[name].length) name=lib.characterReplace[name].randomGet();\r\n\t\t\t\t\t\t\tresult[i]=name;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tresult[i]=result[i].links[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_status.characterlist.remove(result[i]);\r\n\t\t\t\t\t\tif(!lib.playerOL[i].name1){\r\n\t\t\t\t\t\t\tlib.playerOL[i].init(result[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcast(function(result){\r\n\t\t\t\t\t\tfor(var i in result){\r\n\t\t\t\t\t\t\tif(!lib.playerOL[i].name1){\r\n\t\t\t\t\t\t\t\tlib.playerOL[i].init(result[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t},500)\r\n\t\t\t\t\t},result);\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t},500)\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterChangeOL2: function () {\r\n\t\t\t\tvar next = game.createEvent('chooseCharacter', false);\r\n\t\t\t\tnext.showConfig = true;\r\n\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar ref=game.players[0];\r\n\t\t\t\t\tvar bool=Math.random()<0.5;\r\n\t\t\t\t\tvar bool2= (lib.configOL.observe_race)?bool:Math.random()<0.5;\r\n\t\t\t\t\tref.side=bool;\r\n\t\t\t\t\tref.next.side=bool2;\r\n\t\t\t\t\tref.next.next.side=!bool;\r\n\t\t\t\t\tref.previous.side=!bool2;\r\n\t\t\t\t\tvar firstChoose = lib.configOL.observe_race?game.players[0]:game.players.randomGet();\r\n\t\t\t\t\tif(firstChoose.next.side==firstChoose.side){\r\n\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.firstAct=firstChoose;\r\n\t\t\t\t\tfor(var i=0;i<4;i++){\r\n\t\t\t\t\t\tfirstChoose.node.name.innerHTML=get.verticalStr(get.cnNumber(i+1,true)+'号位');\r\n\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=game.players[i].side+'zhu';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\tgame.broadcast(function(ref,bool,bool2,firstChoose){\r\n\t\t\t\t\t\tref.side=bool;\r\n\t\t\t\t\t\tref.next.side=bool2;\r\n\t\t\t\t\t\tref.next.next.side=!bool;\r\n\t\t\t\t\t\tref.previous.side=!bool2;\r\n\t\t\t\t\t\tfor(var i=0;i<4;i++){\r\n\t\t\t\t\t\t\tfirstChoose.node.name.innerHTML=get.verticalStr(get.cnNumber(i+1,true)+'号位');\r\n\t\t\t\t\t\t\tfirstChoose=firstChoose.next;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.players[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.players[i].node.identity.dataset.color=game.players[i].side+'zhu';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t},ref,bool,bool2,_status.firstAct);\r\n\t\t\t\t\t_status.onreconnect=[function(){\r\n\t\t\t\t\t\tvar players=game.players.concat(game.dead);\r\n\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\tif(players[i].side==game.me.side){\r\n\t\t\t\t\t\t\t\tplayers[i].node.identity.firstChild.innerHTML='友';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tplayers[i].node.identity.firstChild.innerHTML='敌';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}];\r\n\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tevent.videoId = lib.status.videoId++;\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tvar libCharacter = {};\r\n\t\t\t\t\tfor (var i = 0; i < lib.configOL.characterPack.length; i++) {\r\n\t\t\t\t\t\tvar pack = lib.characterPack[lib.configOL.characterPack[i]];\r\n\t\t\t\t\t\tfor (var j in pack) {\r\n\t\t\t\t\t\t\tif (lib.character[j]) libCharacter[j] = pack[j];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (i in libCharacter) {\r\n\t\t\t\t\t\tif (lib.filter.characterDisabled(i, libCharacter)) continue;\r\n\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.broadcastAll(function (list, id) {\r\n\t\t\t\t\t\t_status.characterlist = list;\r\n\t\t\t\t\t\tvar filter = function (name) {\r\n\t\t\t\t\t\t\treturn !_status.characterlist.contains(name);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar dialog = ui.create.characterDialog('heightset', filter).open();\r\n\t\t\t\t\t\tdialog.videoId = id;\r\n\t\t\t\t\t\tui.arena.classList.add('choose-character');\r\n\t\t\t\t\t}, list, event.videoId);\r\n\t\t\t\t\tevent.player = _status.firstAct;\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tevent.player.chooseButton(true).set('ai', function (button) {\r\n\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t}).set('dialog', event.videoId);\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tgame.broadcastAll(function (player, character, id) {\r\n\t\t\t\t\t\tplayer.init(character);\r\n\t\t\t\t\t\tif (player == game.me) game.addRecentCharacter(character);\r\n\t\t\t\t\t}, event.player, result.links[0]);\r\n\t\t\t\t\tevent.player = event.player.next\r\n\t\t\t\t\t\"step 4\"\r\n\t\t\t\t\tif (event.player.name1) {\r\n\t\t\t\t\t\tgame.broadcastAll('closeDialog', event.videoId);\r\n\t\t\t\t\t\tgame.broadcastAll(function (player, character, id) {\r\n\t\t\t\t\t\t\tvar dialog = get.idDialog(id);\r\n\t\t\t\t\t\t\tif (dialog) {\r\n\t\t\t\t\t\t\t\tdialog.close();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t\t\tui.arena.classList.remove('choose-character');\r\n\t\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t\t}, event.player, result.links[0], event.videoId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tevent.goto(2);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseCharacterOL1:function(){\r\n\t\t\t\tvar next=game.createEvent('chooseCharacterOL',false);\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.removeCard('shengdong');\r\n\t\t\t\t\tgame.additionaldead=[];\r\n\t\t\t\t\tvar list=get.charactersOL();\r\n\t\t\t\t\tlist=list.randomGets(parseInt(lib.configOL.choice_num));\r\n\t\t\t\t\tlist.remove('huatuo');\r\n\t\t\t\t\tlist.remove('sunquan');\r\n\t\t\t\t\tevent.videoId=lib.status.videoId++;\r\n\t\t\t\t\tif(Math.random()<0.5){\r\n\t\t\t\t\t\tevent.choosing=game.players[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.choosing=game.players[1];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar createDialog=function(list,id,list1,list2){\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('选择角色',[list,'character']);\r\n\t\t\t\t\t\tdialog.classList.add('fullwidth');\r\n\t\t\t\t\t\tdialog.classList.add('fullheight');\r\n\t\t\t\t\t\tdialog.classList.add('noslide');\r\n\t\t\t\t\t\tdialog.classList.add('fixed');\r\n\t\t\t\t\t\tdialog.videoId=id;\r\n\t\t\t\t\t\tif(list2&&list2){\r\n\t\t\t\t\t\t\tui.arena.classList.add('playerhidden');\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tvar button=dialog.buttons[i];\r\n\t\t\t\t\t\t\t\tif(list1.contains(button.link)){\r\n\t\t\t\t\t\t\t\t\tbutton.classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(list2.contains(button.link)){\r\n\t\t\t\t\t\t\t\t\tbutton.classList.add('glow');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(list1!=game.me){\r\n\t\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML='等待对手选择';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tgame.broadcastAll(createDialog,list,event.videoId,event.choosing);\r\n\t\t\t\t\tgame.players[0].storage.versuslist=[];\r\n\t\t\t\t\tgame.players[1].storage.versuslist=[];\r\n\t\t\t\t\tevent.selected=[];\r\n\t\t\t\t\t_status.firstChoose=event.choosing;\r\n\t\t\t\t\tevent.num=(parseInt(lib.configOL.replace_number)+1)*2;\r\n\t\t\t\t\t_status.onreconnect=[createDialog,list,event.videoId,\r\n\t\t\t\t\t\t_status.firstChoose.$.versuslist,\r\n\t\t\t\t\t\t_status.firstChoose.next.$.versuslist];\r\n\t\t\t\t\tgame.broadcastAll(function(player){\r\n\t\t\t\t\t\tplayer.setIdentity('truezhu');\r\n\t\t\t\t\t\tplayer.next.setIdentity('falsezhu');\r\n\t\t\t\t\t},_status.firstChoose);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar next=event.choosing.chooseButton(event.videoId,1,true);\r\n\t\t\t\t\tnext.set('filterButton',function(button){\r\n\t\t\t\t\t\tif(_status.event.selected.contains(button.link)) return false;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.set('selected',event.selected);\r\n\t\t\t\t\tnext.set('ai',function(){\r\n\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tevent.choosing.$.versuslist.push(result.links[0]);\r\n\t\t\t\t\tgame.broadcastAll(function(link,choosing,first,id){\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tif(choosing==game.me){\r\n\t\t\t\t\t\t\t\tchoosing='你';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tchoosing='对手';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdialog.content.firstChild.innerHTML=choosing+'选择了'+get.translation(link);\r\n\t\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\t\tif(dialog.buttons[i].link==link){\r\n\t\t\t\t\t\t\t\t\tif(first){\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('selectedx');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tdialog.buttons[i].classList.add('glow');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result.links[0],event.choosing,event.choosing==_status.firstChoose,event.videoId);\r\n\t\t\t\t\tevent.selected.push(result.links[0]);\r\n\t\t\t\t\tevent.choosing=event.choosing.next;\r\n\t\t\t\t\tevent.num--;\r\n\t\t\t\t\tif(event.num){\r\n\t\t\t\t\t\tevent.goto(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tgame.delay(2)\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tgame.broadcastAll(function(id){\r\n\t\t\t\t\t\tui.arena.classList.remove('playerhidden');\r\n\t\t\t\t\t\tvar dialog=get.idDialog(id);\r\n\t\t\t\t\t\tif(dialog){\r\n\t\t\t\t\t\t\tdialog.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},event.videoId);\r\n\r\n\t\t\t\t\t_status.friendDied=[];\r\n\t\t\t\t\t_status.enemyDied=[];\r\n\r\n\t\t\t\t\t_status.friend=game.players[0].storage.versuslist;\r\n\t\t\t\t\t_status.enemy=game.players[1].storage.versuslist;\r\n\r\n\t\t\t\t\tdelete game.players[0].storage.versuslist;\r\n\t\t\t\t\tdelete game.players[1].versuslist;\r\n\r\n\t\t\t\t\t_status.enemyCount=ui.create.system('杀敌: '+get.cnNumber(0,true),null,true);\r\n\t\t\t\t\t_status.friendCount=ui.create.system('阵亡: '+get.cnNumber(0,true),null,true);\r\n\r\n\t\t\t\t\tlib.setPopped(_status.friendCount,game.versusHoverFriend);\r\n\t\t\t\t\tlib.setPopped(_status.enemyCount,game.versusHoverEnemy);\r\n\r\n\t\t\t\t\tgame.me.side=true;\r\n\t\t\t\t\tgame.players[0].side=true;\r\n\t\t\t\t\tgame.players[1].side=false;\r\n\r\n\t\t\t\t\tvar func=function(list1,list2,list3,list4,func1,func2,playerid){\r\n\t\t\t\t\t\tif(game.me.playerid==playerid){\r\n\t\t\t\t\t\t\tgame.me.side=true;\r\n\t\t\t\t\t\t\tgame.me.next.side=false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.me.side=false;\r\n\t\t\t\t\t\t\tgame.me.next.side=true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(game.me.side){\r\n\t\t\t\t\t\t\t_status.enemyDied=list1;\r\n\t\t\t\t\t\t\t_status.friendDied=list2;\r\n\r\n\t\t\t\t\t\t\t_status.enemy=list3;\r\n\t\t\t\t\t\t\t_status.friend=list4;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t_status.friendDied=list1;\r\n\t\t\t\t\t\t\t_status.enemyDied=list2;\r\n\r\n\t\t\t\t\t\t\t_status.friend=list3;\r\n\t\t\t\t\t\t\t_status.enemy=list4;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_status.enemyCount=ui.create.system('杀敌: '+get.cnNumber(_status.enemyDied.length,true),null,true);\r\n\t\t\t\t\t\t_status.friendCount=ui.create.system('阵亡: '+get.cnNumber(_status.friendDied.length,true),null,true);\r\n\r\n\t\t\t\t\t\tlib.setPopped(_status.friendCount,func1);\r\n\t\t\t\t\t\tlib.setPopped(_status.enemyCount,func2);\r\n\t\t\t\t\t};\r\n\t\t\t\t\t_status.onreconnect=[func,_status.enemyDied,_status.friendDied,\r\n\t\t\t\t\t\t_status.enemy,_status.friend,game.versusHoverFriend,game.versusHoverEnemy,game.players[0].playerid];\r\n\t\t\t\t\tgame.broadcast(func,_status.enemyDied,_status.friendDied,\r\n\t\t\t\t\t\t_status.enemy,_status.friend,game.versusHoverFriend,game.versusHoverEnemy,game.players[0].playerid);\r\n\r\n\t\t\t\t\tvar list=[[game.players[0],['选择出场角色',[_status.friend,'character']]],[game.players[1],['选择出场角色',[_status.enemy,'character']]]];\r\n\t\t\t\t\tgame.me.chooseButtonOL(list,function(player,result){\r\n\t\t\t\t\t\tif(game.online||player==game.me) player.init(result.links[0]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tvar result1;\r\n\t\t\t\t\tvar friend=result[game.players[0].playerid];\r\n\t\t\t\t\tif(friend&&friend.links&&friend.links.length){\r\n\t\t\t\t\t\tresult1=friend.links[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tresult1=_status.friend.randomGet();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar result2;\r\n\t\t\t\t\tvar enemy=result[game.players[1].playerid];\r\n\t\t\t\t\tif(enemy&&enemy.links&&enemy.links.length){\r\n\t\t\t\t\t\tresult2=enemy.links[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tresult2=_status.enemy.randomGet();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!game.players[0].name1) game.players[0].init(result1);\r\n\t\t\t\t\tif(!game.players[1].name1) game.players[1].init(result2);\r\n\t\t\t\t\t_status.friend.remove(result1);\r\n\t\t\t\t\t_status.enemy.remove(result2);\r\n\t\t\t\t\tgame.broadcast(function(result1,result2){\r\n\t\t\t\t\t\tif(game.me.side){\r\n\t\t\t\t\t\t\tif(!game.me.name1) game.me.init(result1);\r\n\t\t\t\t\t\t\tif(!game.me.next.name1) game.me.next.init(result2);\r\n\t\t\t\t\t\t\t_status.friend.remove(result1);\r\n\t\t\t\t\t\t\t_status.enemy.remove(result2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(!game.me.name1) game.me.init(result2);\r\n\t\t\t\t\t\t\tif(!game.me.next.name1) game.me.next.init(result1);\r\n\t\t\t\t\t\t\t_status.friend.remove(result2);\r\n\t\t\t\t\t\t\t_status.enemy.remove(result1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},result1,result2);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tphaseLoopThree:function(player){\r\n\t\t\t\tvar next=game.createEvent('phaseLoop');\r\n\t\t\t\tnext.player=player;\r\n\t\t\t\tnext.swap=function(player){\r\n\t\t\t\t\tif(player.side==game.me.side){\r\n\t\t\t\t\t\treturn game.enemyZhu;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\treturn game.me;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.classList.add('acted');\r\n\t\t\t\t\tplayer.phase();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(player.identity!='zhu'){\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i].side==player.side&&game.players[i].identity!='zhu'&&\r\n\t\t\t\t\t\t\t\tgame.players[i]!=player&&!game.players[i].classList.contains('acted')){\r\n\t\t\t\t\t\t\t\tgame.players[i].classList.add('acted');\r\n\t\t\t\t\t\t\t\tgame.players[i].phase();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tvar target=event.swap(player);\r\n\t\t\t\t\tvar swap=[],swap2=[];\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].isOut()) continue;\r\n\t\t\t\t\t\tif(!game.players[i].classList.contains('acted')){\r\n\t\t\t\t\t\t\tif(game.players[i].side==target.side){\r\n\t\t\t\t\t\t\t\tswap.push(game.players[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tswap2.push(game.players[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(swap.length==0){\r\n\t\t\t\t\t\tif(swap2.length){\r\n\t\t\t\t\t\t\ttarget=event.swap(target);\r\n\t\t\t\t\t\t\tswap=swap2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].isOut()) continue;\r\n\t\t\t\t\t\t\t\tgame.players[i].classList.remove('acted');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete _status.roundStart;\r\n\t\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(swap.length==1){\r\n\t\t\t\t\t\tevent.directresult=swap[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar rand=Math.random();\r\n\t\t\t\t\t\tvar next=target.chooseTarget('选择行动的角色',true,function(card,player,target2){\r\n\t\t\t\t\t\t\treturn target2.side==target.side&&!target2.classList.contains('acted');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tnext._triggered=null;\r\n\t\t\t\t\t\tnext.includeOut=true;\r\n\t\t\t\t\t\tnext.ai=function(target2){\r\n\t\t\t\t\t\t\tvar num=0;\r\n\t\t\t\t\t\t\tif(target2.countCards('j')){\r\n\t\t\t\t\t\t\t\tnum-=5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(target2.identity!='zhu'){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].identity!='zhu'&&game.players[i]!=target2&&\r\n\t\t\t\t\t\t\t\t\tgame.players[i].side==target2.side&&game.players[i].countCards('j')){\r\n\t\t\t\t\t\t\t\t\t\tnum-=2;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(rand<1/3){\r\n\t\t\t\t\t\t\t\tnum+=1/(target2.hp+1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(rand<2/3){\r\n\t\t\t\t\t\t\t\tnum+=target2.countCards('h')/5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif(event.directresult){\r\n\t\t\t\t\t\tevent.player=event.directresult;\r\n\t\t\t\t\t\tdelete event.directresult;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(result.bool){\r\n\t\t\t\t\t\tevent.player=result.targets[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.goto(0);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tversusPhaseLoop:function(player){\r\n\t\t\t\tvar next=game.createEvent('phaseLoop');\r\n\t\t\t\tnext.player=player;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tif(lib.storage.zhu){\r\n\t\t\t\t\t\tplayer.classList.add('acted');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.phase();\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(lib.storage.zhu){\r\n\t\t\t\t\t\t_status.currentSide=!_status.currentSide;\r\n\t\t\t\t\t\t_status.round++;\r\n\t\t\t\t\t\tif(_status.round>=2*Math.max(game.friend.length,game.enemy.length)){\r\n\t\t\t\t\t\t\t_status.round=0;\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tgame.players[i].classList.remove('acted');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete _status.roundStart;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar list=(_status.currentSide==game.me.side)?game.friend.slice(0):game.enemy.slice(0);\r\n\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\tif(list[i].classList.contains('acted')||list[i].isOut()){\r\n\t\t\t\t\t\t\t\tlist.splice(i,1);i--;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(list.length==0) event.redo();\r\n\t\t\t\t\t\telse if(list.length==1||(game.me!=game.friendZhu&&!lib.storage.single_control)||_status.currentSide!=game.me.side){\r\n\t\t\t\t\t\t\tlist.sort(function(a,b){\r\n\t\t\t\t\t\t\t\tif(a.countCards('j')>b.countCards('j')) return 1;\r\n\t\t\t\t\t\t\t\treturn a.hp-b.hp;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tevent.player=list[0];\r\n\t\t\t\t\t\t\tevent.goto(0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.me.chooseTarget('选择要行动的角色',true,function(card,player,target){\r\n\t\t\t\t\t\t\t\treturn (target.classList.contains('acted')==false&&target.side==game.me.side);\r\n\t\t\t\t\t\t\t}).includeOut=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.player=event.player.next;\r\n\t\t\t\t\t\tevent.goto(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tevent.player=result.targets[0];\r\n\t\t\t\t\tevent.goto(0);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tphaseLoopJiange:function(){\r\n\t\t\t\tvar next=game.createEvent('phaseLoop');\r\n\t\t\t\tnext.num=0;\r\n\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\tif(event.num>=8){\r\n\t\t\t\t\t\tevent.num-=8;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar player=_status.actlist[event.num];\r\n\t\t\t\t\tif(player.isAlive()){\r\n\t\t\t\t\t\tplayer.phase();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.num++;\r\n\t\t\t\t\tevent.redo();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\treplacePlayerOL:function(player){\r\n\t\t\t\tvar next=game.createEvent('replacePlayer',false,_status.event.getParent());\r\n\t\t\t\tnext.source=player;\r\n\t\t\t\tnext.setContent('replacePlayerOL');\r\n\t\t\t},\r\n\t\t\treplacePlayer:function(player){\r\n\t\t\t\tvar next=game.createEvent('replacePlayer',false,_status.event.getParent());\r\n\t\t\t\tnext.source=player;\r\n\t\t\t\tnext.setContent('replacePlayer');\r\n\t\t\t},\r\n\t\t\treplacePlayerTwo:function(player,character){\r\n\t\t\t\tvar next=game.createEvent('replacePlayerTwo',false,_status.event.getParent());\r\n\t\t\t\tnext.source=player;\r\n\t\t\t\tnext.character=character;\r\n\t\t\t\tnext.setContent('replacePlayerTwo');\r\n\t\t\t},\r\n\t\t\tversusClickToSwap:function(e){\r\n\t\t\t\tif(_status.dragged) return;\r\n\t\t\t\tif(this.link==game.me){\r\n\t\t\t\t\tif(!this.classList.contains('buttonclick')){\r\n\t\t\t\t\t\tthis.animate('buttonclick');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if(_status.event.player==game.me&&!_status.auto){\r\n\t\t\t\t\tgame.me.popup('请稍后再换人');\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tgame.modeSwapPlayer(this.link);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tversusHoverEnemy:function(){\r\n\t\t\t\tvar uiintro=ui.create.dialog('hidden');\r\n\r\n\t\t\t\tif(_status.enemyDied.length){\r\n\t\t\t\t\tuiintro.add('已阵亡');\r\n\t\t\t\t\tuiintro.add([_status.enemyDied,'character']);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuiintro.add('未上场');\r\n\t\t\t\tif(_status.enemy.length){\r\n\t\t\t\t\tuiintro.add([_status.enemy,'character']);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tuiintro.add('（无）')\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn uiintro;\r\n\t\t\t},\r\n\t\t\tversusHoverFriend:function(){\r\n\t\t\t\tvar uiintro=ui.create.dialog('hidden');\r\n\r\n\t\t\t\tif(_status.friendDied.length){\r\n\t\t\t\t\tuiintro.add('已阵亡');\r\n\t\t\t\t\tuiintro.add([_status.friendDied,'character']);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuiintro.add('未上场');\r\n\t\t\t\tif(_status.friend.length){\r\n\t\t\t\t\tuiintro.add([_status.friend,'character']);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tuiintro.add('（无）')\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn uiintro;\r\n\t\t\t},\r\n\t\t\tversusHoverHandcards:function(){\r\n\t\t\t\tvar uiintro=ui.create.dialog('hidden');\r\n\t\t\t\tvar added=false;\r\n\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\tif(game.players[i].name&&game.players[i].side==game.me.side&&game.players[i]!=game.me){\r\n\t\t\t\t\t\tadded=true;\r\n\t\t\t\t\t\tuiintro.add(get.translation(game.players[i]));\r\n\t\t\t\t\t\tvar cards=game.players[i].getCards('h');\r\n\t\t\t\t\t\tif(cards.length){\r\n\t\t\t\t\t\t\tuiintro.addSmall(cards,true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tuiintro.add('（无）');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(added) return uiintro;\r\n\t\t\t},\r\n\t\t\tversusCheckEnemy:function(){\r\n\t\t\t\t_status.clicked=true;\r\n\t\t\t\tif(ui.intro){\r\n\t\t\t\t\tui.intro.close();\r\n\t\t\t\t\tif(ui.intro.source=='versusCheckEnemy'){\r\n\t\t\t\t\t\tdelete ui.intro;\r\n\t\t\t\t\t\tui.control.show();\r\n\t\t\t\t\t\tgame.resume2();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tgame.pause2();\r\n\t\t\t\tui.control.hide();\r\n\t\t\t\tui.intro=ui.create.dialog();\r\n\t\t\t\tui.intro.source='versusCheckEnemy';\r\n\r\n\t\t\t\tif(_status.enemyDied.length){\r\n\t\t\t\t\tui.intro.add('已阵亡');\r\n\t\t\t\t\tui.intro.add([_status.enemyDied,'character']);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tui.intro.add('未上场');\r\n\t\t\t\tif(_status.enemy.length){\r\n\t\t\t\t\tui.intro.add([_status.enemy,'character']);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tui.intro.add('（无）')\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tversusCheckFriend:function(){\r\n\t\t\t\t_status.clicked=true;\r\n\t\t\t\tif(ui.intro){\r\n\t\t\t\t\tui.intro.close();\r\n\t\t\t\t\tif(ui.intro.source=='versusCheckFriend'){\r\n\t\t\t\t\t\tdelete ui.intro;\r\n\t\t\t\t\t\tui.control.show();\r\n\t\t\t\t\t\tgame.resume2();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tgame.pause2();\r\n\t\t\t\tui.control.hide();\r\n\t\t\t\tui.intro=ui.create.dialog();\r\n\t\t\t\tui.intro.source='versusCheckFriend';\r\n\r\n\r\n\r\n\r\n\t\t\t\tif(_status.friendDied.length){\r\n\t\t\t\t\tui.intro.add('已阵亡');\r\n\t\t\t\t\tui.intro.add([_status.friendDied,'character']);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tui.intro.add('未上场');\r\n\t\t\t\tif(_status.friend.length){\r\n\t\t\t\t\tui.intro.add([_status.friend,'character']);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tui.intro.add('（无）')\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tversusSwapPlayer:function(){\r\n\t\t\t\tif(ui.intro){\r\n\t\t\t\t\tui.intro.close();\r\n\t\t\t\t\tif(ui.intro.source=='versusSwapPlayer'){\r\n\t\t\t\t\t\tdelete ui.intro;\r\n\t\t\t\t\t\tui.control.show();\r\n\t\t\t\t\t\tgame.resume2();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif((_status.event.player==game.me&&_status.paused)||_status.paused2){\r\n\t\t\t\t\tgame.me.popup('请稍后再换人');\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\t_status.clicked=true;\r\n\t\t\t\t\tif(ui.intro){\r\n\t\t\t\t\t\tui.intro.close();\r\n\t\t\t\t\t\tif(ui.intro.source==this.parentNode){\r\n\t\t\t\t\t\t\tdelete ui.intro;\r\n\t\t\t\t\t\t\tui.control.show();\r\n\t\t\t\t\t\t\tgame.resume2();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.pause2();\r\n\t\t\t\t\tui.control.hide();\r\n\t\t\t\t\tui.intro=ui.create.dialog();\r\n\t\t\t\t\tui.intro.source='versusSwapPlayer';\r\n\t\t\t\t\tvar players=[];\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].side==game.me.side&&game.players[i]!=game.me){\r\n\t\t\t\t\t\t\tplayers.push(game.players[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.intro.add(players,true);\r\n\t\t\t\t\tvar buttons=ui.intro.querySelectorAll('.button');\r\n\t\t\t\t\tfor(var i=0;i<buttons.length;i++){\r\n\t\t\t\t\t\tbuttons[i].addEventListener(lib.config.touchscreen?'touchend':'click',game.versusClickToSwap);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tswitchAutoreplace:function(e){\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\tthis.classList.toggle('on');\r\n\t\t\t\tgame.save('autoreplaceinnerhtml',this.classList.contains('on'));\r\n\t\t\t},\r\n\t\t\tonSwapControl:function(){\r\n\t\t\t\tgame.addVideo('onSwapControl');\r\n\t\t\t\tvar name=game.me.name;\r\n\t\t\t\tif(ui.fakeme&&ui.fakeme.current!=name){\r\n\t\t\t\t\tui.fakeme.current=name;\r\n\t\t\t\t\tif(ui.versushighlight&&ui.versushighlight!=game.me){\r\n\t\t\t\t\t\tui.versushighlight.classList.remove('current_action');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.versushighlight=game.me;\r\n\t\t\t\t\tgame.me.classList.add('current_action');\r\n\r\n\t\t\t\t\tui.fakeme.style.backgroundImage=game.me.node.avatar.style.backgroundImage;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmodeSwapPlayer:function(player){\r\n\t\t\t\tif(_status.mode=='three'||(_status.mode=='standard'&&lib.storage.single_control)){\r\n\t\t\t\t\tgame.swapControl(player);\r\n\t\t\t\t\tgame.onSwapControl();\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tgame.swapPlayer(player);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupdateLineMe:function(opacity,player){\r\n\t\t\t\tif(!player){\r\n\t\t\t\t\tplayer=game.me;\r\n\t\t\t\t}\r\n\t\t\t\tui.lineme.width=ui.window.offsetWidth;\r\n\t\t\t\tui.lineme.height=ui.window.offsetHeight;\r\n\r\n\t\t\t\tvar ctx=ui.linemectx;\r\n\t\t\t\tctx.shadowBlur=5;\r\n\t\t\t\tctx.shadowColor='rgba(0,0,0,0.3)';\r\n\t\t\t\tctx.fillStyle='white';\r\n\t\t\t\tif(typeof opacity!='number'){\r\n\t\t\t\t\topacity=0.5;\r\n\t\t\t\t}\r\n\t\t\t\tctx.strokeStyle='rgba(255,255,255,'+opacity+')';\r\n\t\t\t\tctx.lineWidth=3;\r\n\t\t\t\tctx.setLineDash([8,2]);\r\n\r\n\t\t\t\tctx.beginPath();\r\n\r\n\t\t\t\tvar startx,endx,pos;\r\n                \r\n\t\t\t\tvar endy=game.me.offsetHeight/2+game.me.offsetTop+ui.arena.offsetTop;\r\n\t\t\t\tvar starty=ui.me.offsetTop+ui.arena.offsetTop+ui.me.offsetHeight/2;\r\n\t\t\t\tif(game.me.offsetLeft+game.me.offsetWidth/2<=ui.arena.offsetWidth/2){\r\n\t\t\t\t\tstartx=ui.me.offsetLeft+ui.arena.offsetLeft;\r\n\t\t\t\t\tendx=game.me.offsetLeft+ui.arena.offsetLeft;\r\n\t\t\t\t\tpos=-1;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tstartx=ui.me.offsetLeft+ui.arena.offsetLeft+ui.me.offsetWidth;\r\n\t\t\t\t\tendx=game.me.offsetWidth+game.me.offsetLeft+ui.arena.offsetLeft;\r\n\t\t\t\t\tpos=1;\r\n\t\t\t\t}\r\n\t\t\t\tctx.moveTo(startx,starty);\r\n\t\t\t\tstartx+=pos*ui.arena.offsetLeft/2;\r\n\t\t\t\tctx.quadraticCurveTo(startx,starty,startx,starty-(starty-endy)/2);\r\n\t\t\t\tctx.quadraticCurveTo(startx,endy,endx,endy);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t},\r\n\t\t},\r\n\t\tjiangeboss:{\r\n\t\t\tboss_MinatoAqua: ['female','holo',2,['boss_shenghuang','boss_renzhan', 'boss_kuase'],['jiangeboss','hiddenboss','bossallowed'],'holo'],\r\n\t\t\tboss_KiryuuCoco:['female','holo',5,['boss_zaoankeke', 'boss_jierizhanbei','boss_esuyingye','boss_zuoyututan'],['jiangeboss','hiddenboss','bossallowed'],'holo'],\r\n\r\n\t\t\tboss_HonmaHimawari: ['female','nijisanji',5,['tianqing', 'boss_kuiquan'],['jiangeboss','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\tboss_MitoTsukino:['female','nijisanji',4,['boss_bingdielei','boss_zhenyin'],['jiangeboss','hiddenboss','bossallowed'],'nijisanji'],\r\n\r\n\t\t\tboss_liedixuande:['male','nijisanji',5,['boss_lingfeng','boss_jizhen'],['jiangeboss','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\tboss_gongshenyueying:['female','nijisanji',4,['boss_gongshenjg','boss_jingmiao','boss_zhinang'],['jiangeboss','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\tboss_tianhoukongming:['male','nijisanji',4,['boss_biantian','bazhen'],['jiangeboss','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\t//boss_yuhuoshiyuan:['male','nijisanji',4,['boss_yuhuojg','boss_qiwu','boss_tianyujg'],['jiangeboss','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\tboss_qiaokuijunyi:['male','holo',4,['boss_huodi','boss_jueji'],['jiangeboss','hiddenboss','bossallowed'],'holo'],\r\n\t\t\t//boss_jiarenzidan:['male','holo',5,['boss_chiying','boss_jingfan'],['jiangeboss','hiddenboss','bossallowed'],'holo'],\r\n\t\t\tboss_duanyuzhongda:['male','holo',5,['boss_fanshi','boss_xuanlei','boss_skonghun'],['jiangeboss','hiddenboss','bossallowed'],'holo'],\r\n\t\t\tboss_juechenmiaocai:['male','holo',5,['boss_chuanyun','boss_leili','boss_fengxing'],['jiangeboss','hiddenboss','bossallowed'],'holo'],\r\n\r\n\t\t\tboss_jileibaihu:['male','nijisanji',5,['boss_jiguan','boss_zhenwei','boss_benlei'],['jiangemech','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\tboss_yunpingqinglong:['male','nijisanji',5,['boss_jiguan','boss_mojianjg'],['jiangemech','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\tboss_lingjiaxuanwu:['male','nijisanji',5,['boss_jiguan','yizhong','boss_lingyu'],['jiangemech','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\tboss_chiyuzhuque:['male','nijisanji',5,['boss_jiguan','boss_yuhuojg','boss_tianyun'],['jiangemech','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\tboss_fudibian:['male','holo',5,['boss_jiguan','boss_didongjg'],['jiangemech','hiddenboss','bossallowed'],'holo'],\r\n\t\t\tboss_tuntianchiwen:['male','holo',5,['boss_jiguan','boss_tanshi','boss_tunshi'],['jiangemech','hiddenboss','bossallowed'],'holo'],\r\n\t\t\tboss_shihuosuanni:['male','holo',5,['boss_jiguan','boss_lianyujg'],['jiangemech','hiddenboss','bossallowed'],'holo'],\r\n\t\t\tboss_lieshiyazi:['male','holo',5,['boss_jiguan','boss_nailuo'],['jiangemech','hiddenboss','bossallowed'],'holo'],\r\n\t\t\t\r\n\t\t\tboss_kumuyuanrang:['male','holo',5,['boss_bashi','boss_danjing'],['jiangeboss','hiddenboss','bossallowed'],'holo'],\r\n\t\t\t//boss_baijiwenyuan:['male','holo',5,['boss_jiaoxie'],['jiangeboss','hiddenboss','bossallowed'],'wei'],\r\n\t\t\tboss_yihanyunchang:['male','nijisanji',5,['boss_xiaorui','boss_huchen'],['jiangeboss','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t\t//boss_fuweizilong:['male','nijisanji',5,['boss_fengjian','boss_keding'],['jiangeboss','hiddenboss','bossallowed'],'nijisanji'],\r\n\t\t},\r\n\t\tcardsFour:[\r\n\t\t\t[\"spade\",7,\"sha\"],\r\n\t\t\t[\"spade\",8,\"sha\"],\r\n\t\t\t[\"spade\",8,\"sha\"],\r\n\t\t\t[\"spade\",9,\"sha\"],\r\n\t\t\t[\"spade\",9,\"sha\"],\r\n\t\t\t[\"spade\",10,\"sha\"],\r\n\t\t\t[\"spade\",10,\"sha\"],\r\n\t\t\t[\"club\",2,\"sha\"],\r\n\t\t\t[\"club\",3,\"sha\"],\r\n\t\t\t[\"club\",4,\"sha\"],\r\n\t\t\t[\"club\",5,\"sha\"],\r\n\t\t\t[\"club\",6,\"sha\"],\r\n\t\t\t[\"club\",7,\"sha\"],\r\n\t\t\t[\"club\",8,\"sha\"],\r\n\t\t\t[\"club\",8,\"sha\"],\r\n\t\t\t[\"club\",9,\"sha\"],\r\n\t\t\t[\"club\",9,\"sha\"],\r\n\t\t\t[\"club\",10,\"sha\"],\r\n\t\t\t[\"club\",10,\"sha\"],\r\n\t\t\t[\"club\",11,\"sha\"],\r\n\t\t\t[\"club\",11,\"sha\"],\r\n\t\t\t[\"heart\",10,\"sha\"],\r\n\t\t\t[\"heart\",10,\"sha\"],\r\n\t\t\t[\"heart\",11,\"sha\"],\r\n\t\t\t[\"diamond\",6,\"sha\"],\r\n\t\t\t[\"diamond\",7,\"sha\"],\r\n\t\t\t[\"diamond\",8,\"sha\"],\r\n\t\t\t[\"diamond\",9,\"sha\"],\r\n\t\t\t[\"diamond\",10,\"sha\"],\r\n\t\t\t[\"diamond\",13,\"sha\"],\r\n\t\t\t[\"heart\",2,\"shan\"],\r\n\t\t\t[\"heart\",2,\"shan\"],\r\n\t\t\t[\"heart\",13,\"shan\"],\r\n\t\t\t[\"diamond\",2,\"shan\"],\r\n\t\t\t[\"diamond\",2,\"shan\"],\r\n\t\t\t[\"diamond\",3,\"shan\"],\r\n\t\t\t[\"diamond\",4,\"shan\"],\r\n\t\t\t[\"diamond\",5,\"shan\"],\r\n\t\t\t[\"diamond\",6,\"shan\"],\r\n\t\t\t[\"diamond\",7,\"shan\"],\r\n\t\t\t[\"diamond\",8,\"shan\"],\r\n\t\t\t[\"diamond\",9,\"shan\"],\r\n\t\t\t[\"diamond\",10,\"shan\"],\r\n\t\t\t[\"diamond\",11,\"shan\"],\r\n\t\t\t[\"diamond\",11,\"shan\"],\r\n\t\t\t[\"heart\",3,\"tao\"],\r\n\t\t\t[\"heart\",4,\"tao\"],\r\n\t\t\t[\"heart\",6,\"tao\"],\r\n\t\t\t[\"heart\",7,\"tao\"],\r\n\t\t\t[\"heart\",8,\"tao\"],\r\n\t\t\t[\"heart\",9,\"tao\"],\r\n\t\t\t[\"heart\",12,\"tao\"],\r\n\t\t\t[\"diamond\",12,\"tao\"],\r\n\r\n\t\t\t[\"spade\",2,\"bagua\"],\r\n\t\t\t[\"club\",2,\"bagua\"],\r\n\t\t\t[\"spade\",5,\"jueying\"],\r\n\t\t\t[\"club\",5,\"dilu\"],\r\n\t\t\t[\"heart\",13,\"zhuahuang\"],\r\n\t\t\t[\"heart\",5,\"chitu\"],\r\n\t\t\t[\"spade\",13,\"dawan\"],\r\n\t\t\t[\"diamond\",13,\"zixin\"],\r\n\t\t\t[\"club\",1,\"zhuge\"],\r\n\t\t\t[\"diamond\",1,\"zhuge\"],\r\n\t\t\t[\"spade\",2,\"cixiong\"],\r\n\t\t\t[\"spade\",6,\"qinggang\"],\r\n\t\t\t[\"spade\",5,\"qinglong\"],\r\n\t\t\t[\"spade\",12,\"zhangba\"],\r\n\t\t\t[\"diamond\",5,\"guanshi\"],\r\n\t\t\t[\"diamond\",12,\"fangtian\"],\r\n\t\t\t[\"heart\",5,\"qilin\"],\r\n\r\n\t\t\t[\"heart\",3,\"wugu\"],\r\n\t\t\t[\"heart\",4,\"wugu\"],\r\n\t\t\t[\"heart\",1,\"taoyuan\"],\r\n\t\t\t[\"spade\",7,\"nanman\"],\r\n\t\t\t[\"spade\",13,\"nanman\"],\r\n\t\t\t[\"club\",7,\"nanman\"],\r\n\t\t\t[\"heart\",1,\"wanjian\"],\r\n\t\t\t[\"spade\",1,\"juedou\"],\r\n\t\t\t[\"club\",1,\"juedou\"],\r\n\t\t\t[\"diamond\",1,\"juedou\"],\r\n\t\t\t[\"heart\",7,\"wuzhong\"],\r\n\t\t\t[\"heart\",8,\"wuzhong\"],\r\n\t\t\t[\"heart\",9,\"wuzhong\"],\r\n\t\t\t[\"heart\",11,\"wuzhong\"],\r\n\t\t\t[\"spade\",3,'shunshou'],\r\n\t\t\t[\"spade\",4,'shunshou'],\r\n\t\t\t[\"spade\",11,'shunshou'],\r\n\t\t\t[\"diamond\",3,'shunshou'],\r\n\t\t\t[\"diamond\",4,'shunshou'],\r\n\t\t\t[\"spade\",3,'guohe'],\r\n\t\t\t[\"spade\",4,'guohe'],\r\n\t\t\t[\"spade\",12,'guohe'],\r\n\t\t\t[\"club\",3,'guohe'],\r\n\t\t\t[\"club\",4,'guohe'],\r\n\t\t\t[\"heart\",12,'guohe'],\r\n\t\t\t[\"club\",12,'jiedao'],\r\n\t\t\t[\"club\",13,'jiedao'],\r\n\t\t\t[\"spade\",11,'wuxie'],\r\n\t\t\t[\"club\",12,'wuxie'],\r\n\t\t\t[\"club\",13,'wuxie'],\r\n\t\t\t[\"spade\",6,'lebu'],\r\n\t\t\t[\"club\",6,'lebu'],\r\n\t\t\t[\"heart\",6,'lebu'],\r\n\t\t\t[\"spade\",1,'shandian','thunder'],\r\n\t\t\t[\"spade\",2,'hanbing'],\r\n\t\t\t[\"club\",2,'renwang'],\r\n\t\t\t[\"heart\",12,'shandian','thunder'],\r\n\t\t\t[\"diamond\",12,'wuxie'],\r\n\t\t\t[\"heart\",4,\"sha\",\"fire\"],\r\n\t\t\t[\"heart\",7,\"sha\",\"fire\"],\r\n\t\t\t[\"heart\",10,\"sha\",\"fire\"],\r\n\t\t\t[\"diamond\",4,\"sha\",\"fire\"],\r\n\t\t\t[\"diamond\",5,\"sha\",\"fire\"],\r\n\t\t\t[\"spade\",4,\"sha\",\"thunder\"],\r\n\t\t\t[\"spade\",5,\"sha\",\"thunder\"],\r\n\t\t\t[\"spade\",6,\"sha\",\"thunder\"],\r\n\t\t\t[\"spade\",7,\"sha\",\"thunder\"],\r\n\t\t\t[\"spade\",8,\"sha\",\"thunder\"],\r\n\t\t\t[\"club\",5,\"sha\",\"thunder\"],\r\n\t\t\t[\"club\",6,\"sha\",\"thunder\"],\r\n\t\t\t[\"club\",7,\"sha\",\"thunder\"],\r\n\t\t\t[\"club\",8,\"sha\",\"thunder\"],\r\n\t\t\t[\"heart\",8,\"shan\"],\r\n\t\t\t[\"heart\",9,\"shan\"],\r\n\t\t\t[\"heart\",11,\"shan\"],\r\n\t\t\t[\"heart\",12,\"shan\"],\r\n\t\t\t[\"diamond\",6,\"shan\"],\r\n\t\t\t[\"diamond\",7,\"shan\"],\r\n\t\t\t[\"diamond\",8,\"shan\"],\r\n\t\t\t[\"diamond\",10,\"shan\"],\r\n\t\t\t[\"diamond\",11,\"shan\"],\r\n\t\t\t[\"heart\",5,\"tao\"],\r\n\t\t\t[\"heart\",6,\"tao\"],\r\n\t\t\t[\"diamond\",2,\"tao\"],\r\n\t\t\t[\"diamond\",3,\"tao\"],\r\n\t\t\t[\"diamond\",9,\"jiu\"],\r\n\t\t\t[\"spade\",3,\"jiu\"],\r\n\t\t\t[\"spade\",9,\"jiu\"],\r\n\t\t\t[\"club\",3,\"jiu\"],\r\n\t\t\t[\"club\",9,\"jiu\"],\r\n\r\n\t\t\t[\"diamond\",13,\"hualiu\"],\r\n\t\t\t[\"club\",1,\"baiyin\"],\r\n\t\t\t[\"spade\",2,\"tengjia\"],\r\n\t\t\t[\"club\",2,\"tengjia\"],\r\n\t\t\t[\"spade\",1,\"guding\"],\r\n\t\t\t[\"diamond\",1,\"zhuque\"],\r\n\r\n\t\t\t[\"heart\",2,\"huogong\"],\r\n\t\t\t[\"heart\",3,\"huogong\"],\r\n\t\t\t[\"diamond\",12,\"huogong\"],\r\n\t\t\t[\"spade\",11,\"tiesuo\"],\r\n\t\t\t[\"spade\",12,\"tiesuo\"],\r\n\t\t\t[\"club\",10,\"tiesuo\"],\r\n\t\t\t[\"club\",11,\"tiesuo\"],\r\n\t\t\t[\"club\",12,\"tiesuo\"],\r\n\t\t\t[\"club\",13,\"tiesuo\"],\r\n\t\t\t[\"heart\",13,\"wuxie\"],\r\n\t\t\t[\"heart\",13,\"wuxie\"],\r\n\t\t\t[\"spade\",13,\"wuxie\"],\r\n\t\t\t[\"spade\",10,\"bingliang\"],\r\n\t\t\t[\"club\",4,\"bingliang\"],\r\n\t\t],\r\n\t\tcardsThree:[\r\n\t\t\t[\"spade\",7,\"sha\"],\r\n\t\t\t[\"spade\",8,\"sha\"],\r\n\t\t\t[\"spade\",8,\"sha\"],\r\n\t\t\t[\"spade\",9,\"sha\"],\r\n\t\t\t[\"spade\",9,\"sha\"],\r\n\t\t\t[\"spade\",10,\"sha\"],\r\n\t\t\t[\"spade\",10,\"sha\"],\r\n\t\t\t[\"club\",2,\"sha\"],\r\n\t\t\t[\"club\",3,\"sha\"],\r\n\t\t\t[\"club\",4,\"sha\"],\r\n\t\t\t[\"club\",5,\"sha\"],\r\n\t\t\t[\"club\",6,\"sha\"],\r\n\t\t\t[\"club\",7,\"sha\"],\r\n\t\t\t[\"club\",8,\"sha\"],\r\n\t\t\t[\"club\",8,\"sha\"],\r\n\t\t\t[\"club\",9,\"sha\"],\r\n\t\t\t[\"club\",9,\"sha\"],\r\n\t\t\t[\"club\",10,\"sha\"],\r\n\t\t\t[\"club\",10,\"sha\"],\r\n\t\t\t[\"club\",11,\"sha\"],\r\n\t\t\t[\"club\",11,\"sha\"],\r\n\t\t\t[\"heart\",10,\"sha\"],\r\n\t\t\t[\"heart\",10,\"sha\"],\r\n\t\t\t[\"heart\",11,\"sha\"],\r\n\t\t\t[\"diamond\",6,\"sha\"],\r\n\t\t\t[\"diamond\",7,\"sha\"],\r\n\t\t\t[\"diamond\",8,\"sha\"],\r\n\t\t\t[\"diamond\",9,\"sha\"],\r\n\t\t\t[\"diamond\",10,\"sha\"],\r\n\t\t\t[\"diamond\",13,\"sha\"],\r\n\t\t\t[\"heart\",2,\"shan\"],\r\n\t\t\t[\"heart\",2,\"shan\"],\r\n\t\t\t[\"heart\",13,\"shan\"],\r\n\t\t\t[\"diamond\",2,\"shan\"],\r\n\t\t\t[\"diamond\",2,\"shan\"],\r\n\t\t\t[\"diamond\",3,\"shan\"],\r\n\t\t\t[\"diamond\",4,\"shan\"],\r\n\t\t\t[\"diamond\",5,\"shan\"],\r\n\t\t\t[\"diamond\",6,\"shan\"],\r\n\t\t\t[\"diamond\",7,\"shan\"],\r\n\t\t\t[\"diamond\",8,\"shan\"],\r\n\t\t\t[\"diamond\",9,\"shan\"],\r\n\t\t\t[\"diamond\",10,\"shan\"],\r\n\t\t\t[\"diamond\",11,\"shan\"],\r\n\t\t\t[\"diamond\",11,\"shan\"],\r\n\t\t\t[\"heart\",3,\"tao\"],\r\n\t\t\t[\"heart\",4,\"tao\"],\r\n\t\t\t[\"heart\",6,\"tao\"],\r\n\t\t\t[\"heart\",7,\"tao\"],\r\n\t\t\t[\"heart\",8,\"tao\"],\r\n\t\t\t[\"heart\",9,\"tao\"],\r\n\t\t\t[\"heart\",12,\"tao\"],\r\n\t\t\t[\"diamond\",12,\"tao\"],\r\n\r\n\t\t\t[\"spade\",2,\"bagua\"],\r\n\t\t\t[\"club\",2,\"bagua\"],\r\n\t\t\t[\"spade\",5,\"jueying\"],\r\n\t\t\t[\"club\",5,\"dilu\"],\r\n\t\t\t[\"heart\",13,\"zhuahuang\"],\r\n\t\t\t[\"heart\",5,\"chitu\"],\r\n\t\t\t[\"spade\",13,\"dawan\"],\r\n\t\t\t[\"diamond\",13,\"zixin\"],\r\n\t\t\t[\"club\",1,\"zhuge\"],\r\n\t\t\t[\"diamond\",1,\"zhuge\"],\r\n\t\t\t[\"spade\",2,\"cixiong\"],\r\n\t\t\t[\"spade\",6,\"qinggang\"],\r\n\t\t\t[\"spade\",5,\"qinglong\"],\r\n\t\t\t[\"spade\",12,\"zhangba\"],\r\n\t\t\t[\"diamond\",5,\"guanshi\"],\r\n\t\t\t[\"diamond\",12,\"fangtian\"],\r\n\t\t\t[\"heart\",5,\"qilin\"],\r\n\r\n\t\t\t[\"heart\",3,\"wugu\"],\r\n\t\t\t[\"heart\",4,\"wugu\"],\r\n\t\t\t[\"heart\",1,\"taoyuan\"],\r\n\t\t\t[\"spade\",7,\"nanman\"],\r\n\t\t\t[\"spade\",13,\"nanman\"],\r\n\t\t\t[\"club\",7,\"nanman\"],\r\n\t\t\t[\"heart\",1,\"wanjian\"],\r\n\t\t\t[\"spade\",1,\"juedou\"],\r\n\t\t\t[\"club\",1,\"juedou\"],\r\n\t\t\t[\"diamond\",1,\"juedou\"],\r\n\t\t\t[\"heart\",7,\"wuzhong\"],\r\n\t\t\t[\"heart\",8,\"wuzhong\"],\r\n\t\t\t[\"heart\",9,\"wuzhong\"],\r\n\t\t\t[\"heart\",11,\"wuzhong\"],\r\n\t\t\t[\"spade\",3,'shunshou'],\r\n\t\t\t[\"spade\",4,'shunshou'],\r\n\t\t\t[\"spade\",11,'shunshou'],\r\n\t\t\t[\"diamond\",3,'shunshou'],\r\n\t\t\t[\"diamond\",4,'shunshou'],\r\n\t\t\t[\"spade\",3,'guohe'],\r\n\t\t\t[\"spade\",4,'guohe'],\r\n\t\t\t[\"spade\",12,'guohe'],\r\n\t\t\t[\"club\",3,'guohe'],\r\n\t\t\t[\"club\",4,'guohe'],\r\n\t\t\t[\"heart\",12,'guohe'],\r\n\t\t\t[\"club\",12,'jiedao'],\r\n\t\t\t[\"club\",13,'jiedao'],\r\n\t\t\t[\"spade\",11,'wuxie'],\r\n\t\t\t[\"club\",12,'wuxie'],\r\n\t\t\t[\"club\",13,'wuxie'],\r\n\t\t\t[\"spade\",6,'lebu'],\r\n\t\t\t[\"club\",6,'lebu'],\r\n\t\t\t[\"heart\",6,'lebu'],\r\n\t\t\t[\"spade\",1,'hanbing'],\r\n\t\t\t[\"club\",2,'renwang'],\r\n\r\n\t\t\t[\"heart\",4,\"sha\",\"fire\"],\r\n\t\t\t[\"heart\",7,\"sha\",\"fire\"],\r\n\t\t\t[\"heart\",10,\"sha\",\"fire\"],\r\n\t\t\t[\"diamond\",4,\"sha\",\"fire\"],\r\n\t\t\t[\"diamond\",5,\"sha\",\"fire\"],\r\n\t\t\t[\"spade\",4,\"sha\",\"thunder\"],\r\n\t\t\t[\"spade\",5,\"sha\",\"thunder\"],\r\n\t\t\t[\"spade\",6,\"sha\",\"thunder\"],\r\n\t\t\t[\"spade\",7,\"sha\",\"thunder\"],\r\n\t\t\t[\"spade\",8,\"sha\",\"thunder\"],\r\n\t\t\t[\"club\",5,\"sha\",\"thunder\"],\r\n\t\t\t[\"club\",6,\"sha\",\"thunder\"],\r\n\t\t\t[\"club\",7,\"sha\",\"thunder\"],\r\n\t\t\t[\"club\",8,\"sha\",\"thunder\"],\r\n\t\t\t[\"heart\",8,\"shan\"],\r\n\t\t\t[\"heart\",9,\"shan\"],\r\n\t\t\t[\"heart\",11,\"shan\"],\r\n\t\t\t[\"heart\",12,\"shan\"],\r\n\t\t\t[\"diamond\",6,\"shan\"],\r\n\t\t\t[\"diamond\",7,\"shan\"],\r\n\t\t\t[\"diamond\",8,\"shan\"],\r\n\t\t\t[\"diamond\",10,\"shan\"],\r\n\t\t\t[\"diamond\",11,\"shan\"],\r\n\t\t\t[\"heart\",5,\"tao\"],\r\n\t\t\t[\"heart\",6,\"tao\"],\r\n\t\t\t[\"diamond\",2,\"tao\"],\r\n\t\t\t[\"diamond\",3,\"tao\"],\r\n\t\t\t[\"diamond\",9,\"jiu\"],\r\n\t\t\t[\"spade\",3,\"jiu\"],\r\n\t\t\t[\"spade\",9,\"jiu\"],\r\n\t\t\t[\"club\",3,\"jiu\"],\r\n\t\t\t[\"club\",9,\"jiu\"],\r\n\r\n\t\t\t[\"diamond\",13,\"hualiu\"],\r\n\t\t\t[\"club\",1,\"baiyin\"],\r\n\t\t\t[\"spade\",2,\"tengjia\",],\r\n\t\t\t[\"spade\",1,\"guding\"],\r\n\t\t\t[\"diamond\",1,\"zhuque\"],\r\n\r\n\t\t\t[\"heart\",2,\"huogong\"],\r\n\t\t\t[\"heart\",3,\"huogong\"],\r\n\t\t\t[\"diamond\",12,\"huogong\"],\r\n\t\t\t[\"spade\",11,\"tiesuo\"],\r\n\t\t\t[\"spade\",12,\"tiesuo\"],\r\n\t\t\t[\"club\",10,\"tiesuo\"],\r\n\t\t\t[\"club\",11,\"tiesuo\"],\r\n\t\t\t[\"club\",12,\"tiesuo\"],\r\n\t\t\t[\"club\",13,\"tiesuo\"],\r\n\t\t\t[\"heart\",13,\"wuxie\"],\r\n\t\t\t[\"heart\",13,\"wuxie\"],\r\n\t\t\t[\"spade\",13,\"wuxie\"],\r\n\t\t\t[\"spade\",10,\"bingliang\"],\r\n\t\t\t[\"club\",4,\"bingliang\"],\r\n\t\t],\r\n\t\tchoiceVtuberkill:[\r\n\t\t\t'hololive','nijisanji','vtuber','clubs'\r\n\t\t],\r\n\t\tchoiceThree:[\r\n\t\t\t're_caocao','re_simayi','xiahoudun','re_zhangliao','re_guojia','zhenji','re_xiahouyuan','xuhuang',\r\n\t\t\t'wenpin','re_xuzhu','wangyi','dianwei','re_lidian','xunyou','dengai','wangji',\r\n\t\t\t'zhongyao','yuejin','simalang','zhangchunhua','sp_caoren','luzhi','litong','re_liubei',\r\n\t\t\t'guanyu','re_zhangfei','re_zhugeliang','re_zhaoyun','re_machao','huangyueying','jiangwei','xin_masu',\r\n\t\t\t'liuchen','re_huangzhong','mizhu','old_madai','wangping','xin_fazheng','re_xushu','liyan',\r\n\t\t\t'sp_sunshangxiang','zhoucang','yanyan','mazhong','mayunlu','sunquan','re_ganning','re_huanggai',\r\n\t\t\t're_zhouyu','re_daqiao','sunshangxiang','sunjian','re_xiaoqiao','sunce','re_luxun','zhugejin',\r\n\t\t\t'dingfeng','lingtong','xusheng','yufan','handang','panzhangmazhong','zhugeke',\r\n\t\t\t'zumao','xuezong','re_huatuo','lvbu','diaochan','re_pangde','jiaxu','chengong',\r\n\t\t\t're_gongsunzan','caifuren','gongsunyuan','yj_jushou','sp_liuqi','quyi','caiyong','key_yuzuru'\r\n\t\t],\r\n\t\ttranslate:{\r\n\t\t\tzhu:'主',\r\n\t\t\tzhong:'忠',\r\n\t\t\ttruezhu:\"帅\",\r\n\t\t\tfalsezhu:\"将\",\r\n\t\t\ttrueZhu:\"帅\",\r\n\t\t\tfalseZhu:\"将\",\r\n\t\t\ttrueZhong:\"兵\",\r\n\t\t\tfalseZhong:\"卒\",\r\n\t\t\ttrueColor:\"zhu\",\r\n\t\t\tfalseColor:\"wei\",\r\n\t\t\tversus_zhu_config:'启用主将',\r\n\t\t\tversus_only_zhu_config:'只当主将',\r\n\t\t\tversus_main_zhu_config:'主将死亡后结束',\r\n\t\t\tversus_assign_enemy_config:'指定对手',\r\n\t\t\tversus_cross_seat_config:'交叉座位',\r\n\t\t\tversus_random_seat_config:'随机座位',\r\n\t\t\tversus_noreplace_end_config:'无替补时结束',\r\n\t\t\tversus_single_control_config:'单人控制',\r\n\t\t\tseat_order_config:'座位排列',\r\n\t\t\tversus_first_less_config:'先手少摸牌',\r\n\t\t\tversus_reward_config:'杀敌摸牌',\r\n\t\t\tversus_punish_config:'杀死队友',\r\n\t\t\tversus_number_config:'对阵人数',\r\n\t\t\treplace_number_config:'替补人数',\r\n\t\t\tchoice_config:'候选人数',\r\n\t\t\tmode_versus_character_config:'战场武将',\r\n\t\t\tmode_versus_card_config:'同舟共济',\r\n\r\n\t\t\tboss_liedixuande:'烈帝玄德',\r\n\t\t\tboss_gongshenyueying:'工神月英',\r\n\t\t\tboss_tianhoukongming:'天侯孔明',\r\n\t\t\tboss_yuhuoshiyuan:'浴火士元',\r\n\t\t\tboss_qiaokuijunyi:'巧魁儁乂',\r\n\t\t\tboss_jiarenzidan:'佳人子丹',\r\n\t\t\tboss_duanyuzhongda:'断狱仲达',\r\n\t\t\tboss_juechenmiaocai:'绝尘妙才',\r\n\r\n\t\t\tboss_jileibaihu:'机雷白虎',\r\n\t\t\tboss_yunpingqinglong:'云屏青龙',\r\n\t\t\tboss_lingjiaxuanwu:'灵甲玄武',\r\n\t\t\tboss_chiyuzhuque:'炽羽朱雀',\r\n\t\t\tboss_fudibian:'缚地狴犴',\r\n\t\t\tboss_tuntianchiwen:'吞天螭吻',\r\n\t\t\tboss_shihuosuanni:'食火狻猊',\r\n\t\t\tboss_lieshiyazi:'裂石睚眦',\r\n\t\t\t\r\n\t\t\tboss_kumuyuanrang:'枯目元让',\r\n\t\t\tboss_baijiwenyuan:'百计文远',\r\n\t\t\tboss_yihanyunchang:'翊汉云长',\r\n\t\t\tboss_fuweizilong:'扶危子龙',\r\n\r\n\t\t\t\r\n\t\t\tboss_KiryuuCoco:'邪龙可可',\r\n\t\t\tboss_zaoankeke: '早安一刀',\r\n\t\t\tboss_zaoankeke_info: '锁定技 当你使用【杀】指定目标后，目标需弃置一张牌；若此【杀】为属性杀，则改为交给你一张牌。',\r\n\t\t\tboss_jierizhanbei: '扳手战备',\r\n\t\t\tboss_jierizhanbei_info: '锁定技 你使用过装备牌的回合内手牌上限视为5.回合结束时，若本回合你没有使用过装备牌，你随机从牌堆内获得一张装备牌。',\r\n\t\t\tboss_esuyingye: '滥觞之至',\r\n\t\t\tboss_esuyingye_info: '回合开始时，你可以将你装备区或判定区的一张牌弃置，若为装备区的牌，本回合你下一张牌造成的伤害+1。',\r\n\t\t\tboss_zuoyututan:'坐於涂炭',\r\n\t\t\tboss_zuoyututanLimit: '手牌减少',\r\n\t\t\tboss_zuoyututan_info:'锁定技 转换技 一轮开始时，令所有敌方角色①随机废除一个装备栏②手牌上限-1③获得一张进入弃牌堆后即移出游戏的【毒】。',\r\n\r\n\t\t\tboss_MinatoAqua:'天使阿夸',\r\n\t\t\tboss_shenghuang: '圣皇圣愈',\r\n\t\t\tboss_shenghuang_info: '锁定技 当你进入濒死状态时，更换新的体力牌。你失去过黑色牌的回合结束时，友方角色将体力回复至回合开始时的状态。',\r\n\t\t\tboss_renzhan: '影逝刃斩',\r\n\t\t\tboss_renzhan_info: '每回合限一次。其他角色受到伤害后，若其未濒死，你可以失去1点体力，亮出牌堆顶牌直到出现【杀】，然后获得这些牌，并可以对一名角色使用任意张【杀】，直到其进入濒死状态。',\r\n\t\t\tboss_kuase: '夸色梦想',\r\n\t\t\tboss_kuase_info: '<font color=#f5c>限定技</font> 一个回合结束时，若有角色在回合内回复体力，你可以摸X张牌然后执行一个额外的出牌阶段。（X为所有角色本回合回复的体力值之和）',\r\n\t\t\t\r\n\t\t\tboss_HonmaHimawari:'自在武葵',\r\n\t\t\tboss_kuiquan: '阳光烈焰',\r\n\t\t\tboss_kuiquan_info: '你的【火攻】没有目标数量限制。出牌阶段，你可以将一张牌当的【火攻】使用。当你在【火攻】中弃置了【杀】后，获得目标的展示牌。',\r\n\r\n\t\t\tboss_MitoTsukino:'衔月脱兔',\r\n\t\t\tboss_bingdielei: '狱囚恶蕾',\r\n\t\t\tboss_bingdielei_info:'乙方角色受到伤害或令一名角色进入濒死状态的额定回合结束时，你可以获得一个额外回合。',\r\n\t\t\tboss_zhenyin: '协和音震',\r\n\t\t\tboss_zhenyin_info: '当你使用黑色牌指定目标后，可以将一名目标区域内的一张牌移至其下家，若引起冲突，进行替代并对下家造成 1 点伤害。',\r\n\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\tboss_xiaorui:'骁锐',\r\n\t\t\tboss_xiaorui2:'骁锐',\r\n\t\t\tboss_xiaorui_info:'友方角色于其回合内使用【杀】造成伤害后，其使用【杀】的次数+1。',\r\n\t\t\tboss_huchen:'虎臣',\r\n\t\t\tboss_huchen_info:'锁定技 你摸牌阶段摸牌数+X（X为你击杀的敌方角色数）。',\r\n\t\t\tboss_fengjian:'封缄',\r\n\t\t\tboss_fengjian2:'封缄',\r\n\t\t\tboss_fengjian_info:'受到你伤害的角色于其下个回合结束前，无法使用牌指定你为目标。',\r\n\t\t\tboss_keding:'克定',\r\n\t\t\tboss_keding_info:'当你使用【杀】或普通锦囊牌仅指定唯一目标时，你可以弃置任意张手牌，为其指定等量的额外目标。',\r\n\t\t\tboss_bashi:'拔矢',\r\n\t\t\tboss_bashi_info:'每当你成为其他角色使用的杀或普通锦囊牌的目标时，你可以从正面翻至背面，若如此做，此牌对你无效。',\r\n\t\t\tboss_danjing:'啖睛',\r\n\t\t\tboss_danjing_info:'友方角色进入濒死状态时，若你的体力值大于1，你可以失去1点体力，视为对其使用一张【桃】。',\r\n\t\t\tboss_jiaoxie:'缴械',\r\n\t\t\tboss_jiaoxie_info:'出牌阶段限一次，你可令敌方守城器械交给你一张牌。',\r\n\t\t\tboss_lianyujg:'炼狱',\r\n\t\t\tboss_lianyujg_info:'结束阶段，你可以对所有敌方角色造成1点火焰伤害',\r\n\t\t\tboss_didongjg:'地动',\r\n\t\t\tboss_didongjg_info:'结束阶段，你可以选择一名敌方角色将其武将牌翻面',\r\n\t\t\tboss_mojianjg:'魔箭',\r\n\t\t\tboss_mojianjg_info:'出牌阶段开始时，你可以对所有敌方角色使用一张万箭齐发',\r\n\t\t\tboss_jiguan:'机关',\r\n\t\t\tboss_jiguan_info:'锁定技 你不能成为【乐不思蜀】的目标',\r\n\t\t\tboss_lingyu:'灵愈',\r\n\t\t\tboss_lingyu_info:'结束阶段，你可以将自己的武将牌翻面，然后令所有已受伤的己方其他角色回复1点体力',\r\n\t\t\tboss_tianyun:'天陨',\r\n\t\t\tboss_tianyun_info:'结束阶段，你可以失去1点体力，然后令一名敌方角色随机受到2~3点火焰伤害并弃置其装备区里的所有牌。',\r\n\t\t\tboss_zhenwei:'镇卫',\r\n\t\t\tboss_zhenwei_info:'锁定技 其他己方角色的防御距离+1',\r\n\t\t\tboss_benlei:'奔雷',\r\n\t\t\tboss_benlei_info:'锁定技 准备阶段，你对敌方攻城器械随机造成2~3点雷电伤害。',\r\n\t\t\tboss_nailuo:'奈落',\r\n\t\t\tboss_nailuo_info:'结束阶段，你可以将你的武将牌翻面，令所有敌方角色弃置装备区内的所有牌',\r\n\t\t\tboss_tanshi:'贪食',\r\n\t\t\tboss_tanshi_info:'锁定技 结束阶段开始时，你须弃置一张手牌',\r\n\t\t\tboss_tunshi:'吞噬',\r\n\t\t\tboss_tunshi_info:'锁定技 准备阶段，你对所有手牌数量大于你的敌方角色造成1点伤害',\r\n\t\t\tboss_yuhuojg:'浴火',\r\n\t\t\tboss_yuhuojg_info:'锁定技 每当你受到火焰伤害时，防止此伤害',\r\n\t\t\tboss_qiwu:'栖梧',\r\n\t\t\tboss_qiwu_info:'每当你使用一张梅花牌，你可以令一名友方角色回复一点体力',\r\n\t\t\tboss_tianyujg:'天狱',\r\n\t\t\tboss_tianyujg_info:'锁定技 结束阶段，你令所有未横置的敌方角色横置',\r\n\t\t\tboss_gongshenjg:'工神',\r\n\t\t\tboss_gongshenjg_info:'结束阶段，若已方器械已受伤，你可以为其回复一点体力；否则你可以对敌方器械造成一点火焰伤害',\r\n\t\t\tboss_zhinang:'智囊',\r\n\t\t\tboss_zhinang_info:'准备阶段，你可以亮出牌堆顶的五张牌，你可以将其中锦囊或装备牌交给一名己方角色',\r\n\t\t\tboss_jingmiao:'精妙',\r\n\t\t\tboss_jingmiao_info:'锁定技 每当敌方角色使用的无懈可击生效后，你令其失去1点体力',\r\n\t\t\tboss_biantian:'变天',\r\n\t\t\tboss_biantian_info:'锁定技 准备阶段，你进行一次判定，若为红色，直到下个回合开始前，令敌方所有角色处于“狂风”状态，若为黑色，直到下个回合开始前，令己方所有角色处于“大雾”状态',\r\n\t\t\tboss_biantian2:'大雾',\r\n\t\t\tdawu:'大雾',\r\n\t\t\tboss_biantian3:'狂风',\r\n\t\t\tkuangfeng:'狂风',\r\n\t\t\tboss_lingfeng:'灵锋',\r\n\t\t\tboss_lingfeng_info:'摸牌阶段，你可以改为亮出牌堆顶的两张牌，然后获得之，若这些牌的颜色不同，你令一名敌方角色失去1点体力',\r\n\t\t\tboss_jizhen:'激阵',\r\n\t\t\tboss_jizhen_info:'锁定技 结束阶段，你令所有已受伤的己方角色摸一张牌',\r\n\t\t\tboss_huodi:'惑敌',\r\n\t\t\tboss_huodi_info:'结束阶段，若有武将牌背面朝上的己方角色，你可以令一名敌方角色将其武将牌翻面',\r\n\t\t\tboss_jueji:'绝汲',\r\n\t\t\tboss_jueji_info:'敌方角色摸牌阶段，若其已受伤，你可以令其少摸一张牌',\r\n\t\t\tboss_chuanyun:'穿云',\r\n\t\t\tboss_chuanyun_info:'结束阶段，你可以对体力比你多的一名其他角色造成1点伤害',\r\n\t\t\tboss_leili:'雷厉',\r\n\t\t\tboss_leili_info:'每当你的[杀]造成伤害后，你可以对另一名敌方角色造成1点雷电伤害',\r\n\t\t\tboss_fengxing:'风行',\r\n\t\t\tboss_fengxing_info:'准备阶段，你可以选择一名敌方角色，若如此做，视为对其使用了一张[杀]',\r\n\t\t\tboss_skonghun:'控魂',\r\n\t\t\tboss_skonghun_info:'出牌阶段开始时，若你已损失体力值不小于敌方角色数，你可以对所有敌方角色各造成1点雷电伤害，然后你恢复X点体力（X为受到伤害的角色数）',\r\n\t\t\tboss_fanshi:'反噬',\r\n\t\t\tboss_fanshi_info:'锁定技 结束阶段，你失去1点体力',\r\n\t\t\tboss_xuanlei:'玄雷',\r\n\t\t\tboss_xuanlei_info:'锁定技 准备阶段，令所有判定区内有牌的敌方角色受到1点雷电伤害',\r\n\t\t\tboss_chiying:'持盈',\r\n\t\t\tboss_chiying_info:'锁定技 每当己方角色受到多于1伤害时，你防止其余伤害',\r\n\t\t\tboss_jingfan:'惊帆',\r\n\t\t\tboss_jingfan_info:'锁定技 己方其他角色的进攻距离+1',\r\n\t\t\tlongchuanzhibao:'龙船至宝',\r\n\t\t\tlongchuanzhibao_bg:'船',\r\n\t\t\tzong:'粽',\r\n\t\t\tzong_info:'1. 出牌阶段对自己使用，回复1点体力；2. 自己或队友濒死时对其使用，目标角色回复1点体力',\r\n\t\t\txionghuangjiu:'雄黄酒',\r\n\t\t\txionghuangjiu_info:'1. 出牌阶段对自己使用，本回合使用的下一张【杀】伤害+1；若队友已死亡，改为使本回合使用的下一张牌伤害+1；2. 自己濒死时使用，回复1点体力',\r\n\t\t\ttongzhougongji:'同舟共济',\r\n\t\t\ttongzhougongji_info:'出牌阶段使用，选择一项：1.摸X张牌（X为你所在势力拥有的龙船至宝数）；2.你和队友各摸一张牌',\r\n\t\t\tlizhengshangyou:'力争上游',\r\n\t\t\tlizhengshangyou_info:'出牌阶段对所有角色使用，若目标角色的势力拥有龙船至宝，其回复1点体力，若目标角色的势力没有龙船至宝，其弃置一张牌',\r\n\t\t\ttunliang:'屯粮',\r\n\t\t\ttunliang_info:'出牌阶段，对至多三名角色使用。目标角色各摸一张牌。',\r\n\t\t\tyuanjun:'援军',\r\n\t\t\tyuanjun_info:'出牌阶段，对至多两名已受伤的角色使用。目标角色回复1点体力。',\r\n\t\t\thuoshaowuchao:'火烧乌巢',\r\n\t\t\thuoshaowuchao_info:'锁定技 本局游戏内造成的无属性伤害均视为火属性。',\r\n\t\t\tliangcaokuifa:'粮草匮乏',\r\n\t\t\tliangcaokuifa_info:'锁定技 所有角色摸牌阶段的额定摸牌数-1。当一名角色使用的牌结算完成后，若其因此牌造成了伤害，则其摸一张牌。',\r\n\t\t\tzhanyanliangzhuwenchou:'斩颜良诛文丑',\r\n\t\t\tzhanyanliangzhuwenchou_info:'锁定技 一名角色的回合开始时，其选择一项：视为使用一张不可被【无懈可击】响应的【决斗】，或失去1点体力。',\r\n\t\t\tshishengshibai:'十胜十败',\r\n\t\t\tshishengshibai_info:'锁定技 一名角色使用牌时，若此牌是整局游戏使用的第整十张牌且此牌不为延时锦囊牌或装备牌，则此牌所有目标角色再次成为此牌的目标角色。',\r\n\t\t},\r\n\t\tskill:{\r\n\t\t\t//boss夸\r\n\t\t\tboss_shenghuang:{\r\n\t\t\t\tlocked:true,\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.$.boss_shenghuang=0;\r\n\t\t\t\t},\r\n\t\t\t\tglobal:['boss_shenghuang_put'],\r\n\t\t\t\tgroup:['boss_shenghuang_draw', 'boss_shenghuang_lose', 'boss_shenghuang_ret', 'boss_shenghuang_rec'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tput:{\r\n\t\t\t\t\t\ttrigger:{global:'phaseBegin'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\tpriority:777,\r\n\t\t\t\t\t\tfilter:function (event,player){\r\n\t\t\t\t\t\t\treturn player.hp;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.boss_shenghuang_put = player.hp;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdraw:{\r\n\t\t\t\t\t\tinit:function(player){\r\n\t\t\t\t\t\t\tplayer.$.boss_shenghuang_draw=4;\r\n\t\t\t\t\t\t\tif(player.hasSkill('boss_shenghuang_draw'))  player.markSkill('boss_shenghuang_draw');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmarktext: '圣',\r\n\t\t\t\t\t\tmark: true,\r\n\t\t\t\t\t\tintro: {\r\n\t\t\t\t\t\t\tcontent:'剩余&张数值为2的体力卡',\r\n\t\t\t\t\t\t\tname:'剩余体力卡',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpriority:777,\r\n\t\t\t\t\t\tskillAnimation:true,\r\n\t\t\t\t\t\tanimationColor:'gray',\r\n\t\t\t\t\t\ttrigger:{\r\n\t\t\t\t\t\t\tplayer:\"dying\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfilter:function (event,player){\r\n\t\t\t\t\t\t\treturn player.$.boss_shenghuang_draw>0\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.maxHp=2;\r\n\t\t\t\t\t\t\tplayer.recover(player.maxHp-player.hp);\r\n\t\t\t\t\t\t\tplayer.$.boss_shenghuang_draw--;\r\n\t\t\t\t\t\t\tplayer.syncStorage('boss_shenghuang_draw');\r\n\t\t\t\t\t\t\tif(!player.$.boss_shenghuang_draw){\r\n\t\t\t\t\t\t\t\tplayer.unmarkSkill('boss_shenghuang_draw');\r\n\t\t\t\t\t\t\t\tplayer.removeSkill('boss_shenghuang_draw');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlose:{\r\n\t\t\t\t\t\tmarktext: '愈',\r\n\t\t\t\t\t\tintro: {\r\n\t\t\t\t\t\t\tcontent:'当前回合已失去了黑色牌，在本回合结束时，其他角色将体力回复至回合开始时的状态。',\r\n\t\t\t\t\t\t\tname:'圣皇之愈',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttrigger:{player:'loseAfter'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpriority:777,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(!(event.getParent().cards||event.card))\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\tvar cards = event.getParent().cards;\r\n\t\t\t\t\t\t\tvar bc=0;\r\n\t\t\t\t\t\t\tfor(var i=0;i<cards.length;i++){\r\n\t\t\t\t\t\t\t\tif(get.color(cards[i]) == 'black')\tbc++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn bc;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.boss_shenghuang++;\r\n\t\t\t\t\t\t\tplayer.markSkill('boss_shenghuang_lose');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tret:{\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\tpriority:888,\r\n\t\t\t\t\t\ttrigger:{global:'phaseAfter'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.$.boss_shenghuang;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.boss_shenghuang=0;\r\n\t\t\t\t\t\t\tplayer.unmarkSkill('boss_shenghuang_lose');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\trec:{\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpriority:777,\r\n\t\t\t\t\t\ttrigger:{global:'phaseEnd'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(!player.hasSkill('boss_shenghuang')||!player.$.boss_shenghuang>0)\treturn false;\r\n\t\t\t\t\t\t\tif(!game.hasPlayer(function(cur){\r\n\t\t\t\t\t\t\t\treturn cur.isAlive()&&cur.isFriendOf(player)&&cur.$.boss_shenghuang_put;\r\n\t\t\t\t\t\t\t}))\treturn false;\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tevent.targets = game.filterPlayer(function(cur){\r\n\t\t\t\t\t\t\t\treturn cur.isAlive()&&cur.isFriendOf(player)&&cur!=player&&cur.$.boss_shenghuang_put;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tif(event.targets.length){\r\n\t\t\t\t\t\t\t\tvar target=event.targets.shift();\r\n\t\t\t\t\t\t\t\tvar vq=target.$.boss_shenghuang_put-target.hp;\r\n\t\t\t\t\t\t\t\tif(vq>0){\r\n\t\t\t\t\t\t\t\t\ttarget.recover(vq);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tplayer.line(target,'water');\r\n\t\t\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_renzhan:{\r\n\t\t\t\tpriority:777,\r\n\t\t\t\ttrigger:{global:'damageEnd'},\r\n\t\t\t\tforced:false,\r\n\t\t\t\tusable:1,\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\tif(player.$.boss_shenghuang_draw==0&&player.hp==1)\t\treturn false;\r\n\t\t\t\t\treturn player.getUseValue({name:'sha'})>0;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player!=player&&event.player.hp>0;\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t\tvar card=get.cards()[0];\r\n\t\t\t\t\tvar cards=[card];\r\n\t\t\t\t\twhile(get.name(card)!='sha'){\r\n\t\t\t\t\t\tcard=get.cards()[0];\r\n\t\t\t\t\t\tcards.push(card);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.cards = cards;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.cardsGotoOrdering(event.cards);\r\n\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tplayer.showCards(event.cards,'『瞬息刃斩』亮出牌堆');\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tcards = event.cards;\r\n\t\t\t\t\tgame.log(player,'获得了', cards);\r\n\t\t\t\t\tplayer.gain(cards,'gain2');\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tvar next=player.chooseTarget('###『刃斩』###指定一名角色，对其使用任意张【杀】',function(card,player,target){\r\n\t\t\t\t\t\treturn player!=target;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.set('targetprompt',['RUA']);\r\n\t\t\t\t\tnext.set('forced',false);\r\n\t\t\t\t\tnext.set('ai',function(target){\r\n\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\tvar att=get.attitude(player,target);\r\n\t\t\t\t\t\treturn 10-att;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar target = result.targets[0];\r\n\t\t\t\t\t\tevent.target = target;\r\n\t\t\t\t\t\tgame.log(player,'刃斩的目标为',target);\r\n\t\t\t\t\t\ttarget.addTempSkill('boss_renzhan2','phaseEnd');\r\n\t\t\t\t\t\ttarget.$.boss_renzhan2 = true;\r\n\t\t\t\t\t\tplayer.logSkill('renzhan',target);\r\n\t\t\t\t\t\tplayer.chooseToUse('对'+get.translation(target)+'使用杀',{name:'sha'},target ,-1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tvar target = event.target;\r\n\t\t\t\t\t\tif(target.$.boss_renzhan2&&player.canUse({name:'sha'},target,false)){\r\n\t\t\t\t\t\t\tplayer.chooseToUse('对'+get.translation(target)+'继续使用杀',{name:'sha'},target ,-1);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 7'\r\n\t\t\t\t\tvar target = event.target;\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tif(target.$.boss_renzhan2&&player.canUse({name:'sha'},target,false)){\r\n\t\t\t\t\t\t\tevent.goto(6);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(target){\r\n\t\t\t\t\t\ttarget.unmarkSkill('boss_renzhan2');\r\n\t\t\t\t\t\ttarget.removeSkill('boss_renzhan2');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tmaixie:true,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_renzhan2:{\r\n\t\t\t\tmarktext:\"危\",\r\n\t\t\t\tlocked:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tname:'危',\r\n\t\t\t\t\tcontent:'成为瞬息刃斩的目标',\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tfirstDo:true,\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\ttrigger:{player:'dying'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.isAlive();\r\n\t\t\t\t},\r\n\t\t\t\tonremove:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.$.boss_renzhan2 = false;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_kuase:{\r\n\t\t\t\tunique:true,\r\n\t\t\t\tlimited:true,\r\n\t\t\t\tskillAnimation:true,\r\n\t\t\t\tpriority:888,\r\n\t\t\t\tanimationStr:'夸色☆超级梦想',\r\n\t\t\t\ttrigger:{global:'phaseAfter'},\r\n\t\t\t\tprompt:function(){\r\n\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\treturn '是否发动『阿库娅色☆超级梦想』<br>（本回合所有角色回复体力之和为'+player.$.boss_kuase_date+'点）';\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.$.boss_kuase_date;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn !player.$.boss_shenghuang_draw||player.$.boss_kuase_date>=player.$.boss_shenghuang_draw;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar dream = player.$.boss_kuase_date;\r\n\t\t\t\t\tplayer.draw(dream);\r\n\t\t\t\t\tplayer.getStat().card.sha=0;\r\n\t\t\t\t\tplayer.phaseUse();\r\n\t\t\t\t\tplayer.$.boss_kuase = true;\r\n\t\t\t\t\tplayer.awakenSkill('boss_kuase');\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['boss_kuase_date','boss_kuase_ret'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tdate:{\r\n\t\t\t\t\t\tinit:function(player){\r\n\t\t\t\t\t\t\tplayer.$.boss_kuase_date = 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\tpriority:777,\r\n\t\t\t\t\t\ttrigger:{global:'recoverAfter'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.boss_kuase_date += trigger.num;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tret:{\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tpopup:false,\r\n\t\t\t\t\t\tpriority:666,\r\n\t\t\t\t\t\ttrigger:{global:'phaseAfter'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn player.$.boss_kuase_date;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.boss_kuase_date=0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//boss可可\r\n\t\t\tboss_zaoankeke:{\r\n\t\t\t\ttrigger:{player:'useCardToPlayered'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpriority:29,\r\n\t\t\t\tlogTarget:'target',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.target==player)\t\t\t\treturn false;\r\n\t\t\t\t\tif(event.target.countCards('he')==0)\treturn false;\r\n\t\t\t\t\treturn event.card.name =='sha';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\t\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar target=trigger.target;\r\n\r\n\t\t\t\t\tif(trigger.getParent().card.nature)\t\t//如果此杀为属性杀\r\n\t\t\t\t\t{\t\t\t\t\r\n\t\t\t\t\t\tplayer.line(target,'green');\r\n\t\t\t\t\t\ttarget.chooseCard('参加“早安可可”录制，需要交给'+get.translation(player)+'一张牌','he',true).set('ai',function(card){\r\n\t\t\t\t\t\t\tvar name = card.name;\r\n\t\t\t\t\t\t\tif(name=='shan') return 30;\r\n\t\t\t\t\t\t\treturn 100-get.value(card);\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\t\t\t\t\t\t\t\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttarget.chooseToDiscard('参加“早安可可”录制，需要弃置一张牌','he',true).set('ai',function(card){\r\n\t\t\t\t\t\t\tvar name = card.name;\r\n\t\t\t\t\t\t\tif(name=='shan') return 30;\r\n\t\t\t\t\t\t\treturn 100-get.value(card);\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(trigger.getParent().card.nature){\r\n\t\t\t\t\t\tplayer.gain(result.cards,target,'give');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jierizhanbei:{\r\n\t\t\t\tgroup:['boss_jierizhanbei_useE' , 'boss_jierizhanbei_getE'],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tuseE:{\r\n\t\t\t\t\t\tinit:function(player){\r\n\t\t\t\t\t\t\tplayer.$.boss_jierizhanbei=0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttrigger:{player:'useCard'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpriority:17,\r\n\t\t\t\t\t\tusable:1,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\treturn get.type(event.card)=='equip';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.$.boss_jierizhanbei++;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmod:{\r\n\t\t\t\t\t\t\tmaxHandcard:function(player,num){\r\n\t\t\t\t\t\t\t\tif(player.$.boss_jierizhanbei>0)\treturn 5;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tgetE:{\r\n\t\t\t\t\t\tinit:function (player){\r\n\t\t\t\t\t\t\tplayer.$.boss_jierizhanbei=0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\t\t\tforced:true,\r\n\t\t\t\t\t\tpriority:13,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tvar num = player.$.boss_jierizhanbei\r\n\t\t\t\t\t\t\tif(num!=0){\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tplayer.$.boss_jierizhanbei=0;\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tconsole.log(player.$.boss_jierizhanbei);\r\n\t\t\t\t\t\t\t\tvar getC = get.cardPile2(function(card){\r\n\t\t\t\t\t\t\t\t\treturn get.type(card)=='equip';\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tif(getC){\r\n\t\t\t\t\t\t\t\t\tplayer.gain(getC,'gain2');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tgame.log(player,'牌堆中没有装备牌了');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_esuyingye:{\r\n\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\tforced:false,\r\n\t\t\t\tpriority:31,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player==player&&player.countDiscardableCards(player,'ej')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar nh=trigger.player.countCards('h');\r\n\t\t\t\t\tvar eff=get.effect(trigger.player,{name:'sha',isCard:true},player,player);\r\n\t\t\t\t\tplayer.discardPlayerCard('请开始自己的表演',player,'ej').set('ai',function(button){\r\n\t\t\t\t\t\tvar name=button.link.viewAs||button.link.name;\r\n\t\t\t\t\t\tvar nh=_status.event.nh;\r\n\t\t\t\t\t\tif(name=='lebu'&&nh>trigger.player.hp) return 150;\r\n\t\t\t\t\t\tif(name=='bingliang'&&nh<trigger.player.hp) return 150;\r\n\t\t\t\t\t\treturn 100-get.value(button.link);\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t}).set('nh',nh);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.cards){\r\n\t\t\t\t\t\tvar getC = result.cards[0];\r\n\t\t\t\t\t\tif(get.type(getC) =='equip'){\r\n\t\t\t\t\t\t\tplayer.logSkill('boss_esuyingye');\r\n\t\t\t\t\t\t\tplayer.addTempSkill('boss_esuyingye_addDam');\r\n\t\t\t\t\t\t\tgame.putBuff(player, 'boss_esuyingye', '.player_buff')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsubSkill: {\r\n\t\t\t\t\taddDam: {\r\n\t\t\t\t\t\tdirect: true, \r\n\t\t\t\t\t\tsilent: true,\r\n\t\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\t\tsource: 'damageBegin',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent: function() {\r\n\t\t\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t\t\t\tplayer.removeSkill('boss_esuyingye_addDam');\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonremove: function(player, skill) {\r\n\t\t\t\t\t\t\tgame.clearBuff(player, 'boss_esuyingye')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zuoyututan:{\r\n\t\t\t\tinit:function (player){\r\n\t\t\t\t\tplayer.$.boss_zuoyututan=1;\r\n\t\t\t\t\tplayer.$.boss_zuoyututanUse=true;\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tlocked:false,\r\n\t\t\t\tzhuanhuanji:true,\r\n\t\t\t\tmarktext:'碳',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:function(storage,player,skill){\r\n\t\t\t\t\t\tif(player.$.boss_zuoyututan==1) return '随机废除一个装备栏';\r\n\t\t\t\t\t\telse if(player.$.boss_zuoyututan==1) return '手牌上限-1';\r\n\t\t\t\t\t\telse return '获得一张进入弃牌堆后即移出游戏的【毒】'\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tgroup:[\"boss_zuoyututan_1\",\"boss_zuoyututan_2\",\"boss_zuoyututan_3\",\"boss_zuoyututan_clear\"],\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\t'1':{\r\n\t\t\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.$.boss_zuoyututan!=1){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn !player.hasSkill('boss_zuoyututan_stop');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\tfor(var i=1;i<6;i++){\r\n\t\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.disableEquip=list.randomGet();\r\n\t\t\t\t\t\t\tplayer.markSkill('boss_zuoyututan');\r\n\t\t\t\t\t\t\tgame.log('所有敌方角色废除'+get.translation('equip'+event.disableEquip));\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tgame.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(!current.isEnemyOf(player)){\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(!current.isDisabled(event.disableEquip)){\r\n\t\t\t\t\t\t\t\t\tcurrent.disableEquip(event.disableEquip);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tplayer.$.boss_zuoyututan=2;\r\n\t\t\t\t\t\t\tplayer.$.boss_zuoyututanUse=false;\r\n\t\t\t\t\t\t\tplayer.addTempSkill('boss_zuoyututan_stop');\r\n\t\t\t\t\t\t\tplayer.syncStorage('boss_zuoyututan');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'2':{\r\n\t\t\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.$.boss_zuoyututan!=2){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn !player.hasSkill('boss_zuoyututan_stop');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\tfor(var i=1;i<6;i++){\r\n\t\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.disableEquip=list.randomGet();\r\n\t\t\t\t\t\t\tplayer.markSkill('boss_zuoyututan');\r\n\t\t\t\t\t\t\tgame.log('所有敌方角色手牌上限-1');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tgame.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(!current.isEnemyOf(player)){\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(current.hasSkill('boss_zuoyututanLimit')){\r\n\t\t\t\t\t\t\t\t\tcurrent.$.boss_zuoyututanLimit++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tcurrent.addSkill('boss_zuoyututanLimit');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tplayer.$.boss_zuoyututan=3;\r\n\t\t\t\t\t\t\tplayer.$.boss_zuoyututanUse=false;\r\n\t\t\t\t\t\t\tplayer.addTempSkill('boss_zuoyututan_stop');\r\n\t\t\t\t\t\t\tplayer.syncStorage('boss_zuoyututan');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'3':{\r\n\t\t\t\t\t\ttrigger:{global:'roundStart'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(player.$.boss_zuoyututan!=3){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn !player.hasSkill('boss_zuoyututan_stop');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\tvar list=[];\r\n\t\t\t\t\t\t\tfor(var i=1;i<6;i++){\r\n\t\t\t\t\t\t\t\tlist.push(i);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.disableEquip=list.randomGet();\r\n\t\t\t\t\t\t\tplayer.markSkill('boss_zuoyututan');\r\n\t\t\t\t\t\t\tgame.log('所有敌方角色获得一张【毒】');\r\n\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\tgame.filterPlayer(function(current){\r\n\t\t\t\t\t\t\t\tif(current.isEnemyOf(player)){\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar newcard=game.createCard2('du','spade',1);\r\n\t\t\t\t\t\t\t\tgame.zhu.$giveAuto(newcard,current);\r\n\t\t\t\t\t\t\t\tcurrent.gain(newcard);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\t'step 2'\r\n\t\t\t\t\t\t\tplayer.$.boss_zuoyututan=1;\r\n\t\t\t\t\t\t\tplayer.$.boss_zuoyututanUse=false;\r\n\t\t\t\t\t\t\tplayer.addTempSkill('boss_zuoyututan_stop');\r\n\t\t\t\t\t\t\tplayer.syncStorage('boss_zuoyututan');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tclear:{\r\n\t\t\t\t\t\ttrigger:{global:'loseAfter'},\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(_status.event.getParent('gain')!=={}&&_status.event.getParent('gain')!=null) return false;\r\n\t\t\t\t\t\t\tif(!event.visible) return false;\r\n\t\t\t\t\t\t\tif(event.player==player) return false;\r\n\t\t\t\t\t\t\tfor(var i=0;i<event.cards2.length;i++){\r\n\t\t\t\t\t\t\t\tif(get.name(event.cards2[i])=='du'&&get.suit(event.cards2[i],event.player)=='club'&&get.number(event.cards2[i])==1){\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\t\t\tif(trigger.delay==false) game.delay();\r\n\t\t\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t\t\tvar cards=[];\r\n\t\t\t\t\t\t\tfor(var i=0;i<trigger.cards2.length;i++){\r\n\t\t\t\t\t\t\t\tif(get.name(event.cards2[i])=='du'&&get.suit(event.cards2[i],event.player)=='club'&&get.number(event.cards2[i])==1){\r\n\t\t\t\t\t\t\t\t\tcards.push(trigger.cards2[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(cards.length){\r\n\t\t\t\t\t\t\t\tgame.cardsGotoSpecial(cards);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tstop:{}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_zuoyututanLimit:{\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.$.boss_zuoyututanLimit=1;\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:function(storage,player,skill){\r\n\t\t\t\t\t\treturn '手牌上限减少'+player.$.boss_zuoyututanLimit;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tmarktext:'碳',\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tmaxHandcard:function(player,num){\r\n\t\t\t\t\t\treturn num-player.$.boss_zuoyututanLimit;\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//boss阿葵\r\n\t\t\tboss_kuiquan:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\tenable:'chooseToUse',\r\n\t\t\t\tfilterCard:true,\r\n\t\t\t\tviewAs:{name:'huogong',nature:'fire'},\r\n\t\t\t\tviewAsFilter:function(player){\r\n\t\t\t\t\tif(!player.isPhaseUsing()) return false;\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(card){\r\n\t\t\t\t\tvar player=_status.currentPhase;\r\n\t\t\t\t\tif(player.countCards('h')>player.hp||player.countCards('h',{name:'sha'})>0){\r\n\t\t\t\t\t\tif(card.name=='sha')\treturn 4-get.value(card);\r\n\t\t\t\t\t\treturn 6-get.value(card);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn 3-get.value(card)\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tkuiquan:true,\r\n\t\t\t\t\tfireAttack:true,\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tselectTarget:function(card,player,range){\r\n\t\t\t\t\t\tif(range[1]==-1) return;\r\n\t\t\t\t\t\tif(card.name=='huogong') range[1]+=Infinity;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//boss美兔\r\n\t\t\tboss_bingdielei:{\r\n\t\t\t\tgroup:'boss_bingdielei_damageBy',\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tdamageBy:{\r\n\t\t\t\t\t\ttrigger:{global:['damageBegin4','dying']},\r\n\t\t\t\t\t\tpriority:99,\r\n\t\t\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\t\t\tif(_status.event.getParent('phase').skill)\treturn false;\r\n\t\t\t\t\t\t\tif(event.name=='damage')\treturn event.player.isFriendOf(player);\r\n\t\t\t\t\t\t\telse\treturn event.getParent()&&event.getParent().source&&event.getParent().source.isFriendOf(player);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirect:true,\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\t\t\tif(trigger.delay==false) game.delay();\r\n\t\t\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\t\t\tplayer.logSkill(event.name);\r\n\t\t\t\t\t\t\tplayer.addTempSkill('boss_bingdielei_anotherPhase');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tanotherPhase:{\r\n\t\t\t\t\t\taudio:'bingdielei',\r\n\t\t\t\t\t\ttrigger:{global:'phaseEnd'},\r\n\t\t\t\t\t\tmarktext: '并',\r\n\t\t\t\t\t\tmark:true,\r\n\t\t\t\t\t\tintro: {\r\n\t\t\t\t\t\t\tcontent:'当前回合结束后获得一个额外回合',\r\n\t\t\t\t\t\t\tname:'并蒂恶蕾',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tplayer.markSkill(event.name);\r\n\t\t\t\t\t\t\tgame.delayx();\r\n\t\t\t\t\t\t\tplayer.insertPhase();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_zhenyin: {\r\n\t\t\t\taudio:'zhenyin',\r\n\t\t\t\ttrigger: {\r\n\t\t\t\t\tplayer: 'useCardToPlayered',\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function(event, player) {\r\n\t\t\t\t\tvar num=0;\r\n\t\t\t\t\tevent.targets.forEach(function(tar){\r\n\t\t\t\t\t\tnum+=tar.countCards('ej');\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn event.targets.length\r\n\t\t\t\t\t\t&& num>0\r\n\t\t\t\t\t\t&& get.color(event.card)=='black';\r\n\t\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\tcontent: function() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseTarget('选择『协和音震』的目标',function(card,player,target){\r\n\t\t\t\t\t\treturn _status.event.targets.contains(target);\r\n\t\t\t\t\t}).set('targets',trigger.targets);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.A = result.targets[0];\r\n\t\t\t\t\tevent.B = event.A.next;\r\n\t\t\t\t\tif (!event.A.countCards('hej')) event.finish();\r\n\t\t\t\t\tplayer.choosePlayerCard('hej', event.A).set('ai',function(button){\r\n\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\tvar source = _status.event.target;\r\n\t\t\t\t\t\tvar target = source.next;\r\n\t\t\t\t\t\tvar link = button.link;\r\n\t\t\t\t\t\tif(get.position(link)=='j'){\r\n\t\t\t\t\t\t\tif(target.canAddJudge(link))\treturn get.effect(target,link,player,player);\r\n\t\t\t\t\t\t\telse\treturn get.damageEffect(target,player,player);\r\n\t\t\t\t\t\t}else if(get.position(link)=='e'){\r\n\t\t\t\t\t\t\tvar subtype = get.subtype(link);\r\n\t\t\t\t\t\t\tif(!target.getEquip(subtype))\treturn get.effect(target,link,player,player);\r\n\t\t\t\t\t\t\telse\treturn get.damageEffect(target,player,player);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\tvar card = result.links[0];\r\n\t\t\t\t\t\tvar dam = false;\r\n\t\t\t\t\t\tif(get.position(card)=='e'){\r\n\t\t\t\t\t\t\tvar c = event.B.getEquip(get.subtype(card));\r\n\t\t\t\t\t\t\tif (c) {\r\n\t\t\t\t\t\t\t\tdam = true;\r\n\t\t\t\t\t\t\t\tgame.log(c, '掉落了');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tre = event.B.equip(card);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tvar cname = card.viewAs ? card.viewAs : get.name(card);\r\n\t\t\t\t\t\t\tevent.B.getCards('j').forEach(function(c) {\r\n\t\t\t\t\t\t\t\tif (get.name(c) == cname) {\r\n\t\t\t\t\t\t\t\t\tgame.log(c, '掉落了');\r\n\t\t\t\t\t\t\t\t\tgame.cardsDiscard(c);\r\n\t\t\t\t\t\t\t\t\tdam = true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tevent.B.addJudge({name: cname}, [card]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.A.$give(card, event.B)\r\n\t\t\t\t\t\tif (dam) event.B.damage('nocard');\r\n\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t\r\n\t\t\thuoshaowuchao:{\r\n\t\t\t\ttrigger:{global:'damageBefore'},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tfirstDo:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn !lib.linked.contains(event.nature);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.nature='fire';\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tliangcaokuifa:{\r\n\t\t\t\ttrigger:{player:['useCardAfter','phaseDrawBegin']},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.name=='phaseDraw') return true;\r\n\t\t\t\t\treturn player.getHistory('sourceDamage',function(evt){\r\n\t\t\t\t\t\treturn evt.card==event.card;\r\n\t\t\t\t\t}).length>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(trigger.name=='phaseDraw') trigger.num--;\r\n\t\t\t\t\telse player.draw();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tzhanyanliangzhuwenchou:{\r\n\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.chooseUseTarget({\r\n\t\t\t\t\t\tname:'juedou',\r\n\t\t\t\t\t\tisCard:true,\r\n\t\t\t\t\t\tstorage:{nowuxie:true}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'选择一名角色，视为对其使用【决斗】','或点【取消】失去1点体力');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(!result.bool) player.loseHp();\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tshishengshibai:{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\taiOrder:function(player,card,num){\r\n\t\t\t\t\t\tif(_status.shishengshibai&&_status.shishengshibai%10==9){\r\n\t\t\t\t\t\t\tif(['sha','tao','guohe','shunshou','tunliang','wuzhong','juedou','yuanjun'].contains(card.name)) return num+15;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:['useCard1','useCardToTargeted'],\r\n\t\t\t\t},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tfilter:function(event,player,name){\r\n\t\t\t\t\tif(name=='useCard1') return true;\r\n\t\t\t\t\tif(!event.parent.shishengshibai||event.targets.length!=event.parent.triggeredTargets4.length) return false;\r\n\t\t\t\t\tif(!event.targets||!event.targets.length||['delay','equip'].contains(get.type(event.card))) return false;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(event.triggername=='useCard1'){\r\n\t\t\t\t\t\tif(!_status.shishengshibai) _status.shishengshibai=0;\r\n\t\t\t\t\t\t_status.shishengshibai++;\r\n\t\t\t\t\t\tgame.broadcastAll(function(num){\r\n\t\t\t\t\t\t\tif(ui.guanduInfo) ui.guanduInfo.innerHTML='当前事件：十胜十败（'+num+'）';\r\n\t\t\t\t\t\t},_status.shishengshibai);\r\n\t\t\t\t\t\tif(_status.shishengshibai%10==0) trigger.shishengshibai=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\ttrigger.getParent().targets=trigger.getParent().targets.concat(trigger.targets);\r\n\t\t\t\t\t\ttrigger.getParent().triggeredTargets4=trigger.getParent().triggeredTargets4.concat(trigger.targets);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\tplayer:function(card,player,target){\r\n\t\t\t\t\t\t\tif(_status.shishengshibai&&_status.shishengshibai%10==9&&card.name=='tiesuo') return 'zerotarget';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\txionghuangjiu:{\r\n\t\t\t\ttrigger:{source:'damageBegin1'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.card&&event.card==player.$.xionghuangjiu&&event.notLink();\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t},\r\n\t\t\t\ttemp:true,\r\n\t\t\t\tvanish:true,\r\n\t\t\t\tonremove:function(player){\r\n\t\t\t\t\tgame.addVideo('jiuNode',player,false);\r\n\t\t\t\t\tif(player.node.jiu){\r\n\t\t\t\t\t\tplayer.node.jiu.delete();\r\n\t\t\t\t\t\tplayer.node.jiu2.delete();\r\n\t\t\t\t\t\tdelete player.node.jiu;\r\n\t\t\t\t\t\tdelete player.node.jiu2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete player.$.xionghuangjiu;\r\n\t\t\t\t},\r\n\t\t\t\tgroup:['xionghuangjiu2','xionghuangjiu3']\r\n\t\t\t},\r\n\t\t\txionghuangjiu2:{\r\n\t\t\t\ttrigger:{player:'useCardAfter',global:'phaseAfter'},\r\n\t\t\t\tpriority:2,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.name=='useCard') return (event.card&&event.card==player.$.xionghuangjiu);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\taudio:false,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tgame.broadcastAll(function(player){\r\n\t\t\t\t\t\tplayer.removeSkill('xionghuangjiu');\r\n\t\t\t\t\t},player);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\txionghuangjiu3:{\r\n\t\t\t\ttrigger:{player:'useCard'},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn !player.$.xionghuangjiu;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.$.xionghuangjiu=trigger.card;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlongchuanzhibao:{\r\n\t\t\t\tmark:'auto',\r\n\t\t\t\tnopop:true,\r\n\t\t\t\tinit:function(player){\r\n\t\t\t\t\tplayer.$.longchuanzhibao=0;\r\n\t\t\t\t},\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:function(storage,player){\r\n\t\t\t\t\t\tvar str='已有'+storage+'个龙船至宝，'+get.translation(player.side)+'势力共有';\r\n\t\t\t\t\t\tvar num=storage;\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tif(game.players[i].side==player.side&&game.players[i]!=player){\r\n\t\t\t\t\t\t\t\tnum+=game.players[i].storage.longchuanzhibao;break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstr+=num+'个龙船至宝。新一轮开始时，拥有至少4个龙船至宝的势力获胜';\r\n\t\t\t\t\t\treturn str;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{source:'damageEnd'},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player.$.longchuanzhibao>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.gainZhibao(1,trigger.player);\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t},\r\n\t\t\t\tgroup:'longchuanzhibao_over',\r\n\t\t\t\tsubSkill:{\r\n\t\t\t\t\tover:{\r\n\t\t\t\t\t\ttrigger:{player:'roundStart'},\r\n\t\t\t\t\t\tsilent:true,\r\n\t\t\t\t\t\tfilter:function(){\r\n\t\t\t\t\t\t\tvar map={holo:0,nijisanji:0,vtuber:0,clubs:0};\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tvar current=game.players[i];\r\n\t\t\t\t\t\t\t\tmap[current.side]+=current.$.longchuanzhibao;\r\n\t\t\t\t\t\t\t\tif(map[current.side]>=4){\r\n\t\t\t\t\t\t\t\t\t_status.winside=current.side;\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tgame.players[i].classList.remove('current_action');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar me=game.me._trueMe||game.me;\r\n\t\t\t\t\t\t\tgame.over(_status.winside==me.side);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//剑阁技能\r\n\t\t\tboss_xiaorui:{\r\n\t\t\t\ttrigger:{global:'damageSource'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tlogTarget:'source',\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar target=event.source;\r\n\t\t\t\t\treturn target&&target==_status.currentPhase&&target.isAlive()&&target.isFriendOf(player)&&event.card&&event.card.name=='sha'&&event.getParent().type=='card';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar source=trigger.source;\r\n\t\t\t\t\tsource.addTempSkill('boss_xiaorui2');\r\n\t\t\t\t\tsource.addMark('boss_xiaorui2',1,false);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xiaorui2:{\r\n\t\t\t\tonremove:true,\r\n\t\t\t\tcharlotte:true,\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tcardUsable:function(card,player,num){\r\n\t\t\t\t\t\tif(card.name=='sha') return num+player.countMark('boss_xiaorui2');\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_huchen:{\r\n\t\t\t\ttrigger:{\r\n\t\t\t\t\tplayer:'phaseDrawBegin2',\r\n\t\t\t\t\tsource:'dieAfter',\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.name=='die') return event.player.isEnemyOf(player);\r\n\t\t\t\t\treturn !event.numFixed&&player.countMark('boss_huchen')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(trigger.name=='die') player.addMark('boss_huchen',1);\r\n\t\t\t\t\telse trigger.num+=player.countMark('boss_huchen');\r\n\t\t\t\t},\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'已斩杀过$名敌将',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_fengjian:{\r\n\t\t\t\ttrigger:{source:'damageSource'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player.isAlive();\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.player.addTempSkill('boss_fengjian2',{player:'phaseAfter'});\r\n\t\t\t\t\ttrigger.player.markAuto('boss_fengjian2',[player]);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_fengjian2:{\r\n\t\t\t\tonremove:true,\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'不能对$使用牌',\r\n\t\t\t\t},\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tplayerEnabled:function(card,player,target){\r\n\t\t\t\t\t\tif(player.getStorage('boss_fengjian2').contains(target)) return false;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_keding:{\r\n\t\t\t\ttrigger:{player:'useCard2'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(!event.targets||event.targets.length!=1) return false;\r\n\t\t\t\t\tvar card=event.card;\r\n\t\t\t\t\tif(card.name!='sha'&&get.type(card)!='trick')return false;\r\n\t\t\t\t\tvar info=get.info(card);\r\n\t\t\t\t\tif(info.allowMultiple==false) return false;\r\n\t\t\t\t\tif(!player.countCards('h')) return false;\r\n\t\t\t\t\tif(!info.multitarget){\r\n\t\t\t\t\t\tif(game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\treturn !event.targets.contains(current)&&lib.filter.targetEnabled2(card,player,current)&&lib.filter.targetInRange(card,player,current);\r\n\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar card=trigger.card;\r\n\t\t\t\t\tvar prompt2='弃置任意张手牌，并为'+get.translation(card)+'增加等量的目标';\r\n\t\t\t\t\tvar targets=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn !trigger.targets.contains(current)&&lib.filter.targetEnabled2(card,player,current)&&lib.filter.targetInRange(card,player,current);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar max=0;\r\n\t\t\t\t\tif(!trigger.targets[0].hasSkill('heiguangkai_skill')) max=targets.filter(function(target){\r\n\t\t\t\t\t\treturn get.effect(target,card,player,player)>0;\r\n\t\t\t\t\t}).length;\r\n\t\t\t\t\tplayer.chooseCardTarget({\r\n\t\t\t\t\t\tprompt:get.prompt('boss_keding'),\r\n\t\t\t\t\t\tprompt2:prompt2,\r\n\t\t\t\t\t\tselectCard:function(){\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\tvar targets=_status.event.targets;\r\n\t\t\t\t\t\t\treturn [Math.max(1,ui.selected.targets.length),Math.min(targets.length,player.countCards('h'))];\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tselectTarget:function(){\r\n\t\t\t\t\t\t\treturn ui.selected.cards.length;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tposition:'h',\r\n\t\t\t\t\t\tfilterCard:lib.filter.cardDiscardable,\r\n\t\t\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\t\t\treturn _status.event.targets.contains(target);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttargets:targets,\r\n\t\t\t\t\t\tai1:function(card){\r\n\t\t\t\t\t\t\tif(ui.selected.cards.length>=_status.event.max) return 0;\r\n\t\t\t\t\t\t\treturn 5-get.value(card);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai2:function(target){\r\n\t\t\t\t\t\t\tif(target.hasSkill('heiguangkai_skill')) return 0;\r\n\t\t\t\t\t\t\tvar trigger=_status.event.getTrigger();\r\n\t\t\t\t\t\t\tvar player=_status.event.player;\r\n\t\t\t\t\t\t\treturn get.effect(target,trigger.card,player,player);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmax:max,\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('boss_keding',result.targets);\r\n\t\t\t\t\t\tplayer.discard(result.cards);\r\n\t\t\t\t\t\ttrigger.targets.addArray(result.targets);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_bashi:{\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player!=player&&event.card&&(event.card.name=='sha'||get.type(event.card)=='trick')&&!player.isTurnedOver();\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\tif(event.getParent().excluded.contains(player)) return false;\r\n\t\t\t\t\tif(get.attitude(player,event.player)>0){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(get.tag(event.card,'respondSha')){\r\n\t\t\t\t\t\tif(player.countCards('h',{name:'sha'})==0){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(get.tag(event.card,'respondShan')){\r\n\t\t\t\t\t\tif(player.countCards('h',{name:'shan'})==0){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(get.tag(event.card,'damage')){\r\n\t\t\t\t\t\tif(event.card.name=='shuiyanqijunx') return player.countCards('e')<2;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t//if(player.countCards('h')<2) return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\ttrigger:{target:'useCardToTargeted'},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.turnOver();\r\n\t\t\t\t\ttrigger.getParent().excluded.add(player);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_danjing:{\r\n\t\t\t\ttrigger:{global:'dying'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.hp>1&&event.player.hp<1&&event.player.isFriendOf(player);\r\n\t\t\t\t},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\tvar target=event.player;\r\n\t\t\t\t\treturn get.attitude(player,target)>0&&lib.filter.cardSavable({name:'tao',isCard:true},player,target);\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar card={name:'tao',isCard:true};\r\n\t\t\t\t\tif(lib.filter.cardSavable(card,player,trigger.player)) player.useCard(card,trigger.player);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_jiaoxie:{\r\n\t\t\t\tenable:'phaseUse',\r\n\t\t\t\tusable:1,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn lib.skill.boss_jiaoxie.filterTarget(null,player,current);\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target.isEnemyOf(player)&&target.type=='mech'&&target.countCards('he')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif(!target.countCards('he')) event.finish();\r\n\t\t\t\t\telse target.chooseCard('he',true,'将一张牌交给'+get.translation(player));\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.gain(result.cards,target,'give');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\torder:9,\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(target.countCards('e',function(card){\r\n\t\t\t\t\t\t\t\treturn get.value(card,target)<=0;\r\n\t\t\t\t\t\t\t})>0) return 1;\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_didongjg:{\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_didongjg'),function(card,player,target){\r\n\t\t\t\t\t\treturn target.isEnemyOf(player);\r\n\t\t\t\t\t}).ai=function(target){\r\n\t\t\t\t\t\tvar att=get.attitude(player,target);\r\n\t\t\t\t\t\tif(target.isTurnedOver()){\r\n\t\t\t\t\t\t\tif(att>0){\r\n\t\t\t\t\t\t\t\treturn att+5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(player.isTurnedOver()){\r\n\t\t\t\t\t\t\treturn 5-att;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn -att;\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('boss_didongjg',result.targets);\r\n\t\t\t\t\t\tresult.targets[0].turnOver();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.7\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_lianyujg:{\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tunique:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.players=game.filterPlayer(function(current){\r\n\t\t\t\t\t    return current.isEnemyOf(player);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(event.players.length){\r\n\t\t\t\t\t\tvar current=event.players.shift();\r\n\t\t\t\t\t\tplayer.line(current,'fire');\r\n\t\t\t\t\t\tcurrent.damage('fire');\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:2\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_mojianjg:{\r\n\t\t\t\ttrigger:{player:'phaseUseBegin'},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn player.canUse('wanjian',current)&&current.isEnemyOf(player);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlist.sort(lib.sort.seat);\r\n\t\t\t\t\tplayer.useCard({name:'wanjian'},list);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.8\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_qiwu:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\ttrigger:{player:'useCard'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(get.suit(event.card)=='club'){\r\n\t\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current.isFriendOf(player)&&current.isDamaged();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar noneed=(trigger.card.name=='tao'&&trigger.targets[0]==player&&player.hp==player.maxHp-1);\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_qiwu'),function(card,player,target){\r\n\t\t\t\t\t\treturn target.hp<target.maxHp&&target.isFriendOf(player);\r\n\t\t\t\t\t}).ai=function(target){\r\n\t\t\t\t\t\tvar num=get.attitude(player,target);\r\n\t\t\t\t\t\tif(num>0){\r\n\t\t\t\t\t\t\tif(noneed&&player==target){\r\n\t\t\t\t\t\t\t\tnum=0.5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(target.hp==1){\r\n\t\t\t\t\t\t\t\tnum+=3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(target.hp==2){\r\n\t\t\t\t\t\t\t\tnum+=1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('qiwu',result.targets);\r\n\t\t\t\t\t\tresult.targets[0].recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\texpose:0.3,\r\n\t\t\t\t\tthreaten:1.5\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_tianyujg:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isEnemyOf(player)&&!current.isLinked();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.targets=game.filterPlayer();\r\n\t\t\t\t\tevent.targets.sort(lib.sort.seat);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(event.targets.length){\r\n\t\t\t\t\t\tvar target=event.targets.shift();\r\n\t\t\t\t\t\tif(!target.isLinked()&&target.isEnemyOf(player)){\r\n\t\t\t\t\t\t\tplayer.line(target,'green');\r\n\t\t\t\t\t\t\ttarget.link();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jueji:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{global:'phaseDrawBegin'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.player.isFriendOf(player)){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn event.num>0&&event.player!=player&&event.player.hp<event.player.maxHp;\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.line(trigger.player,'green');\r\n\t\t\t\t\ttrigger.num--;\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\texpose:0.2,\r\n\t\t\t\t\tthreaten:1.4\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_huodi:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isFriendOf(player)&&current.isTurnedOver();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_huodi'),function(card,player,target){\r\n\t\t\t\t\t\treturn !target.isFriendOf(player);\r\n\t\t\t\t\t}).ai=function(target){\r\n\t\t\t\t\t\tif(target.isTurnedOver()) return 0;\r\n\t\t\t\t\t\treturn -get.attitude(player,target);\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('boss_huodi',result.targets);\r\n\t\t\t\t\t\tresult.targets[0].turnOver();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\texpose:0.2\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_chuanyun:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_chuanyun'),function(card,player,target){\r\n\t\t\t\t\t\treturn player.hp<target.hp;\r\n\t\t\t\t\t}).ai=function(target){\r\n\t\t\t\t\t\treturn get.damageEffect(target,player,player);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('boss_chuanyun',result.targets);\r\n\t\t\t\t\t\tresult.targets[0].damage();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_leili:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{source:'damageEnd'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tfilter:function(event){\r\n\t\t\t\t\treturn event.card&&event.card.name=='sha';\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_leili'),function(card,player,target){\r\n\t\t\t\t\t\tif(target==trigger.player) return false;\r\n\t\t\t\t\t\treturn target.isEnemyOf(player);\r\n\t\t\t\t\t}).ai=function(target){\r\n\t\t\t\t\t\treturn get.damageEffect(target,player,player,'thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('boss_leili',result.targets);\r\n\t\t\t\t\t\tresult.targets[0].damage('thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\texpose:0.2,\r\n\t\t\t\t\tthreaten:1.3\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_fengxing:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_fengxing'),function(card,player,target){\r\n\t\t\t\t\t\tif(target.isFriendOf(player)) return false;\r\n\t\t\t\t\t\treturn lib.filter.targetEnabled({name:'sha'},player,target);\r\n\t\t\t\t\t}).ai=function(target){\r\n\t\t\t\t\t\treturn get.effect(target,{name:'sha'},player);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('boss_fengxing');\r\n\t\t\t\t\t\tplayer.useCard({name:'sha'},result.targets,false);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\texpose:0.2,\r\n\t\t\t\t\tthreaten:1.3\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_xuanlei:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isEnemyOf(player)&&current.countCards('j');\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.targets=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isEnemyOf(player)&&current.countCards('j');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tevent.targets.sort(lib.sort.seat);\r\n\t\t\t\t\tplayer.line(event.targets,'thunder');\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(event.targets.length){\r\n\t\t\t\t\t\tevent.targets.shift().damage('thunder');\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_fanshi:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcheck:function(){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_skonghun:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\ttrigger:{player:'phaseUseBegin'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar num=player.maxHp-player.hp;\r\n\t\t\t\t\tif(num==0) return false;\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].side!=player.side){\r\n\t\t\t\t\t\t\tnum--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn num>=0;\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar targets=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isEnemyOf(player);\r\n\t\t\t\t\t});\r\n\t\t\t\t\ttargets.sort(lib.sort.seat);\r\n\t\t\t\t\tevent.targets=targets;\r\n\t\t\t\t\tplayer.line(targets,'thunder');\r\n\t\t\t\t\tevent.num=targets.length;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(event.targets.length){\r\n\t\t\t\t\t\tevent.targets.shift().damage('thunder');\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tplayer.recover(event.num);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:function(player,target){\r\n\t\t\t\t\t\tif(target.hp==1) return 2;\r\n\t\t\t\t\t\tif(target.hp==2&&game.players.length<8) return 1.5;\r\n\t\t\t\t\t\treturn 0.5;\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_chiying:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{global:'damageBegin4'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(event.num<=1) return false;\r\n\t\t\t\t\treturn event.player.isFriendOf(player);\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num=1;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jingfan:{\r\n\t\t\t\tglobal:'boss_jingfan2',\r\n\t\t\t},\r\n\t\t\tboss_jingfan2:{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tglobalFrom:function(from,to,distance){\r\n\t\t\t\t\t\tif(to.isEnemyOf(from)) return;\r\n\t\t\t\t\t\tvar players=game.filterPlayer();\r\n\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\tif(players[i].hasSkill('boss_jingfan')&&\r\n\t\t\t\t\t\t\t\tplayers[i].isFriendOf(from)&&players[i]!=from){\r\n\t\t\t\t\t\t\t\treturn distance-1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_lingyu:{\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\tif(player.isTurnedOver()) return true;\r\n\t\t\t\t\tvar num=0,players=game.filterPlayer();\r\n\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\tif(players[i].hp<players[i].maxHp&&\r\n\t\t\t\t\t\t\tplayers[i].isFriendOf(player)&&get.recoverEffect(players[i])>0){\r\n\t\t\t\t\t\t\tif(players[i].hp==1){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t\t\tif(num>=2) return true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.turnOver();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isDamaged()&&current.isFriendOf(player);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tplayer.line(list,'green');\r\n\t\t\t\t\tevent.targets=list;\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(event.targets.length){\r\n\t\t\t\t\t\tevent.targets.shift().recover();\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.5,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(card.name=='guiyoujie') return [0,1];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_zhenwei:{\r\n\t\t\t\tglobal:'boss_zhenwei2',\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.5\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zhenwei2:{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\tglobalTo:function(from,to,distance){\r\n\t\t\t\t\t\tif(to.isFriendOf(from)) return;\r\n\t\t\t\t\t\tvar players=game.filterPlayer();\r\n\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\tif(players[i].hasSkill('boss_zhenwei')&&\r\n\t\t\t\t\t\t\t\tplayers[i].isFriendOf(to)&&players[i]!=to){\r\n\t\t\t\t\t\t\t\treturn distance+1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_benlei:{\r\n\t\t\t\tmode:['versus'],\r\n\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(_status.mode!='jiange') return false;\r\n\t\t\t\t\tvar players=game.filterPlayer();\r\n\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\tif(players[i].type=='mech'&&players[i].isEnemyOf(player)){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar target=game.findPlayer(function(current){\r\n\t\t\t\t\t\treturn current.type=='mech'&&current.isEnemyOf(player);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(target){\r\n\t\t\t\t\t\tplayer.line(target,'thunder');\r\n\t\t\t\t\t\ttarget.damage(Math.random()>0.4?2:3,'thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:function(player,target){\r\n\t\t\t\t\t\tif(_status.mode=='jiange'){\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].type=='mech'&&game.players[i].isEnemyOf(target)){\r\n\t\t\t\t\t\t\t\t\treturn 2;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_nailuo:{\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\tif(player.isTurnedOver()) return true;\r\n\t\t\t\t\tvar num=0,players=game.filterPlayer();\r\n\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\tif(players[i].isEnemyOf(player)){\r\n\t\t\t\t\t\t\tvar es=players[i].getCards('e');\r\n\t\t\t\t\t\t\tfor(var j=0;j<es.length;j++){\r\n\t\t\t\t\t\t\t\tswitch(get.subtype(es[j])){\r\n\t\t\t\t\t\t\t\t\tcase 'equip1':num+=1;break;\r\n\t\t\t\t\t\t\t\t\tcase 'equip2':num+=2;break;\r\n\t\t\t\t\t\t\t\t\tcase 'equip3':num+=2;break;\r\n\t\t\t\t\t\t\t\t\tcase 'equip4':num+=1;break;\r\n\t\t\t\t\t\t\t\t\tcase 'equip5':num+=1.5;break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_status.mode=='jiange'){\r\n\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\tif(players[i].isFriendOf(player)&&players[i].hasSkill('huodi')){\r\n\t\t\t\t\t\t\t\treturn num>0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn num>=4;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar players=game.filterPlayer();\r\n\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\tif(players[i].isEnemyOf(player)&&players[i].countCards('e')){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.turnOver();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tevent.targets=get.players();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif(event.targets.length){\r\n\t\t\t\t\t\tvar current=event.targets.shift();\r\n\t\t\t\t\t\tif(current.isEnemyOf(player)){\r\n\t\t\t\t\t\t\tvar es=current.getCards('e');\r\n\t\t\t\t\t\t\tif(es.length){\r\n\t\t\t\t\t\t\t\tcurrent.discard(es);\r\n\t\t\t\t\t\t\t\tplayer.line(current,'green');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target){\r\n\t\t\t\t\t\t\tif(card.name=='guiyoujie') return [0,1];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_tanshi:{\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcheck:function(){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn player.countCards('h')>0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.chooseToDiscard('h',true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_tunshi:{\r\n\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tvar nh=player.countCards('h');\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isEnemyOf(player)&&current.countCards('h')>nh;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar nh=player.countCards('h');\r\n\t\t\t\t\tvar targets=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isEnemyOf(player)&&current.countCards('h')>nh;\r\n\t\t\t\t\t});\r\n\t\t\t\t\ttargets.sort(lib.sort.seat);\r\n\t\t\t\t\tevent.targets=targets;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(event.targets.length){\r\n\t\t\t\t\t\tvar current=event.targets.shift();\r\n\t\t\t\t\t\tcurrent.damage();\r\n\t\t\t\t\t\tplayer.line(current,'thunder');\r\n\t\t\t\t\t\tevent.redo();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jiguan:{\r\n\t\t\t\tmod:{\r\n\t\t\t\t\ttargetEnabled:function(card,player,target){\r\n\t\t\t\t\t\tif(card.name=='lebu'){\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_gongshenjg:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tmode:['versus'],\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(_status.mode!='jiange') return false;\r\n\t\t\t\t\tvar players=game.filterPlayer();\r\n\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\tif(players[i].type=='mech'){\r\n\t\t\t\t\t\t\tif(players[i].isEnemyOf(player)) return true;\r\n\t\t\t\t\t\t\tif(players[i].hp<players[i].maxHp) return true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar enemy,players=game.filterPlayer();\r\n\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\tif(players[i].type=='mech'){\r\n\t\t\t\t\t\t\tif(players[i].isFriendOf(player)){\r\n\t\t\t\t\t\t\t\tif(players[i].hp<players[i].maxHp){\r\n\t\t\t\t\t\t\t\t\tplayer.line(players[i],'green');\r\n\t\t\t\t\t\t\t\t\tplayers[i].recover();\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tenemy=players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(enemy){\r\n\t\t\t\t\t\tplayer.line(enemy,'fire');\r\n\t\t\t\t\t\tenemy.damage('fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tboss_jingmiao:{\r\n\t\t\t\ttrigger:{global:'useCardAfter'},\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn event.player.isEnemyOf(player)&&event.card.name=='wuxie';\r\n\t\t\t\t},\r\n\t\t\t\tlogTarget:'player',\r\n\t\t\t\tcheck:function(event,player){\r\n\t\t\t\t\treturn get.attitude(player,event.player)<0;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tplayer.line(trigger.player,'green');\r\n\t\t\t\t\ttrigger.player.loseHp();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\texpose:0.2,\r\n\t\t\t\t\tthreaten:1.3\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_zhinang:{\r\n\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\tfrequent:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.cards=get.cards(5);\r\n\t\t\t\t\tevent.cards2=[];\r\n\t\t\t\t\tfor(var i=0;i<event.cards.length;i++){\r\n\t\t\t\t\t\tvar type=get.type(event.cards[i],'trick');\r\n\t\t\t\t\t\tif(type=='trick'||type=='equip'){\r\n\t\t\t\t\t\t\tevent.cards2.push(event.cards[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!event.isMine()||event.cards2.length==0){\r\n\t\t\t\t\t\tplayer.showCards(event.cards);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(event.cards2.length==0){\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar dialog=ui.create.dialog('将三张牌中的锦囊牌或装备牌交给一己方名角色','hidden');\r\n\t\t\t\t\t\tdialog.add(event.cards);\r\n\t\t\t\t\t\tfor(var i=0;i<dialog.buttons.length;i++){\r\n\t\t\t\t\t\t\tif(event.cards2.contains(dialog.buttons[i].link)){\r\n\t\t\t\t\t\t\t\tdialog.buttons[i].style.opacity=1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tdialog.buttons[i].style.opacity=0.5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar next=player.chooseTarget(true,dialog,function(card,player,target){\r\n\t\t\t\t\t\t\treturn target.isFriendOf(player);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tnext.ai=function(target){\r\n\t\t\t\t\t\t\tvar att=get.attitude(player,target);\r\n\t\t\t\t\t\t\tif(att>0&&target.hasJudge('lebu')){\r\n\t\t\t\t\t\t\t\treturn 0.1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(player.countCards('h')>player.hp){\r\n\t\t\t\t\t\t\t\tif(target==player) return Math.max(1,att-2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(target==player) return att+5;\r\n\t\t\t\t\t\t\treturn att;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result&&result.targets&&result.targets.length){\r\n\t\t\t\t\t\tevent.target=result.targets[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(event.cards2.length){\r\n\t\t\t\t\t\tplayer.line(event.target,'green');\r\n\t\t\t\t\t\tevent.target.gain(event.cards2,'gain2','log');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.3\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_biantian4:{\r\n\t\t\t\ttrigger:{player:'dieBegin'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tpopup:false,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].hasSkill('boss_biantian3')){\r\n\t\t\t\t\t\t\tgame.players[i].removeSkill('boss_biantian3');\r\n\t\t\t\t\t\t\tgame.players[i].popup('boss_biantian3');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(game.players[i].hasSkill('boss_biantian2')){\r\n\t\t\t\t\t\t\tgame.players[i].removeSkill('boss_biantian2');\r\n\t\t\t\t\t\t\tgame.players[i].popup('boss_biantian2');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_biantian:{\r\n\t\t\t\ttrigger:{player:'phaseBegin'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tunique:true,\r\n\t\t\t\taudio:false,\r\n\t\t\t\tgroup:'boss_biantian4',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].hasSkill('boss_biantian3')){\r\n\t\t\t\t\t\t\tgame.players[i].removeSkill('boss_biantian3');\r\n\t\t\t\t\t\t\tgame.players[i].popup('boss_biantian3');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(game.players[i].hasSkill('boss_biantian2')){\r\n\t\t\t\t\t\t\tgame.players[i].removeSkill('boss_biantian2');\r\n\t\t\t\t\t\t\tgame.players[i].popup('boss_biantian2');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.judge(function(card){\r\n\t\t\t\t\t\tvar color=get.color(card);\r\n\t\t\t\t\t\tif(color=='black') return 1;\r\n\t\t\t\t\t\tif(color=='red') return 0;\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tvar targets=[],players=game.filterPlayer();\r\n\t\t\t\t\tif(result.color=='red'){\r\n\t\t\t\t\t\tgame.trySkillAudio('boss_biantianx2');\r\n\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\tif(!players[i].isFriendOf(player)){\r\n\t\t\t\t\t\t\t\tplayers[i].addSkill('boss_biantian3');\r\n\t\t\t\t\t\t\t\tplayers[i].popup('kuangfeng');\r\n\t\t\t\t\t\t\t\ttargets.push(players[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.logSkill('kuangfeng',targets,'fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(result.color=='black'){\r\n\t\t\t\t\t\tgame.trySkillAudio('boss_biantianx1');\r\n\t\t\t\t\t\tfor(var i=0;i<players.length;i++){\r\n\t\t\t\t\t\t\tif(players[i].isFriendOf(player)){\r\n\t\t\t\t\t\t\t\tplayers[i].addSkill('boss_biantian2');\r\n\t\t\t\t\t\t\t\tplayers[i].popup('dawu');\r\n\t\t\t\t\t\t\t\ttargets.push(players[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.logSkill('dawu',targets,'thunder');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.6\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_biantian2:{\r\n\t\t\t\taudio:false,\r\n\t\t\t\ttrigger:{player:'damageBefore'},\r\n\t\t\t\tfilter:function(event){\r\n\t\t\t\t\tif(event.nature!='thunder') return true;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tmark:true,\r\n\t\t\t\tmarktext:'雾',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'已获得大雾标记'\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tnofire:true,\r\n\t\t\t\t\tnodamage:true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(get.tag(card,'damage')&&!get.tag(card,'thunderDamage')) return [0,0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_biantian3:{\r\n\t\t\t\ttrigger:{player:'damageBegin3'},\r\n\t\t\t\tfilter:function(event){\r\n\t\t\t\t\tif(event.nature=='fire') return true;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tmark:true,\r\n\t\t\t\tmarktext:'风',\r\n\t\t\t\tintro:{\r\n\t\t\t\t\tcontent:'已获得狂风标记'\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.num++;\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(get.tag(card,'fireDamage')) return 1.5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_jizhen:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\treturn game.hasPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isFriendOf(player)&&current.isDamaged();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tvar list=game.filterPlayer(function(current){\r\n\t\t\t\t\t\treturn current.isFriendOf(player)&&current.isDamaged();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(list.length){\r\n\t\t\t\t\t\tplayer.line(list,'green');\r\n\t\t\t\t\t\tgame.asyncDraw(list);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.4\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_lingfeng:{\r\n\t\t\t\taudio:2,\r\n\t\t\t\ttrigger:{player:'phaseDrawBefore'},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t\tevent.cards=get.cards(2);\r\n\t\t\t\t\tplayer.showCards(event.cards);\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(get.color(event.cards[0])!=get.color(event.cards[1])){\r\n\t\t\t\t\t\tplayer.chooseTarget('是否令一名敌方角色失去1点体力？',function(card,player,target){\r\n\t\t\t\t\t\t\treturn !target.isFriendOf(player);\r\n\t\t\t\t\t\t}).ai=function(target){\r\n\t\t\t\t\t\t\treturn -get.attitude(player,target);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(result.bool&&result.targets&&result.targets.length){\r\n\t\t\t\t\t\tplayer.line(result.targets,'green');\r\n\t\t\t\t\t\tresult.targets[0].loseHp();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tplayer.gain(event.cards);\r\n\t\t\t\t\tplayer.$draw(event.cards);\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:1.4\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_yuhuojg:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\ttrigger:{player:'damageBegin2'},\r\n\t\t\t\tfilter:function(event){\r\n\t\t\t\t\treturn event.nature=='fire';\r\n\t\t\t\t},\r\n\t\t\t\tforced:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttrigger.cancel();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tnofire:true,\r\n\t\t\t\t\teffect:{\r\n\t\t\t\t\t\ttarget:function(card,player,target,current){\r\n\t\t\t\t\t\t\tif(get.tag(card,'fireDamage')) return 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tboss_tianyun:{\r\n\t\t\t\ttrigger:{player:'phaseEnd'},\r\n\t\t\t\tdirect:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tevent.forceDie=true;\r\n\t\t\t\t\tplayer.chooseTarget(get.prompt('boss_tianyun'),function(card,player,target){\r\n\t\t\t\t\t\treturn target.isEnemyOf(player);\r\n\t\t\t\t\t}).ai=function(target){\r\n\t\t\t\t\t\tif(player.hp<=1) return 0;\r\n\t\t\t\t\t\tif(get.attitude(player,target)>-3) return 0;\r\n\t\t\t\t\t\tvar eff=get.damageEffect(target,player,player,'fire');\r\n\t\t\t\t\t\tif(eff>0){\r\n\t\t\t\t\t\t\treturn eff+target.countCards('e')/2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\tplayer.logSkill('boss_tianyun',result.targets,'fire');\r\n\t\t\t\t\t\tplayer.loseHp();\r\n\t\t\t\t\t\tevent.target=result.targets[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tif(event.target){\r\n\t\t\t\t\t\tevent.target.damage(Math.random()>0.4?2:3,'fire');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\tif(event.target){\r\n\t\t\t\t\t\tvar es=event.target.getCards('e');\r\n\t\t\t\t\t\tif(es.length){\r\n\t\t\t\t\t\t\tevent.target.discard(es);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tthreaten:2\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tversus_ladder:{\r\n\t\t\t\ttrigger:{global:['damageEnd','recoverEnd','dieEnd','gainEnd','phaseDiscardEnd']},\r\n\t\t\t\tsilent:true,\r\n\t\t\t\tfilter:function(event,player){\r\n\t\t\t\t\tif(!_status.ladder) return false;\r\n\t\t\t\t\tif(event._ladder_mmr_counted) return false;\r\n\t\t\t\t\tif(!event.source) return false;\r\n\t\t\t\t\treturn event.source==game.me||event.player==game.me;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tswitch(event.triggername){\r\n\t\t\t\t\t\tcase 'damageEnd':{\r\n\t\t\t\t\t\t\tif(trigger.source.side!=trigger.player.side){\r\n\t\t\t\t\t\t\t\tif(trigger.source==game.me){\r\n\t\t\t\t\t\t\t\t\t_status.ladder_mmr+=0.5*Math.max(1,trigger.num);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t_status.ladder_mmr+=0.2*Math.max(1,trigger.num);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 'recoverEnd':{\r\n\t\t\t\t\t\t\tif(trigger.source!=trigger.player){\r\n\t\t\t\t\t\t\t\tif(trigger.source==game.me){\r\n\t\t\t\t\t\t\t\t\tif(trigger.player.side==game.me.side){\r\n\t\t\t\t\t\t\t\t\t\t_status.ladder_mmr+=0.5*trigger.num;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t_status.ladder_mmr-=0.3*trigger.num;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t_status.ladder_mmr+=0.3*trigger.num;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 'dieEnd':{\r\n\t\t\t\t\t\t\tif(trigger.source==game.me&&trigger.player.side!=game.me.side){\r\n\t\t\t\t\t\t\t\t_status.ladder_mmr+=2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 'gainEnd':{\r\n\t\t\t\t\t\t\tif(trigger.cards&&trigger.cards.length){\r\n\t\t\t\t\t\t\t\tif(trigger.source==game.me&&trigger.player!=game.me){\r\n\t\t\t\t\t\t\t\t\tif(trigger.player.side==game.me.side){\r\n\t\t\t\t\t\t\t\t\t\t_status.ladder_mmr+=0.3*trigger.cards.length;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t_status.ladder_mmr-=0.1*trigger.cards.length;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tif(trigger.source){\r\n\t\t\t\t\t\t\t\t\t\tif(trigger.source.side!=game.me.side){\r\n\t\t\t\t\t\t\t\t\t\t\t_status.ladder_mmr+=0.3*trigger.cards.length;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t_status.ladder_mmr+=0.1*trigger.cards.length;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 'phaseDiscardEnd':{\r\n\t\t\t\t\t\t\tif(trigger.player==player){\r\n\t\t\t\t\t\t\t\tif(trigger.cards&&trigger.cards.length){\r\n\t\t\t\t\t\t\t\t\t_status.ladder_mmr-=0.2*trigger.cards.length;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttrigger._ladder_mmr_counted=true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcard:{\r\n\t\t\ttunliang:{\r\n\t\t\t\taudio:true,\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t\tenable:true,\r\n\t\t\t\tselectTarget:[1,3],\r\n\t\t\t\tfilterTarget:true,\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttarget.draw();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\torder:7.2,\r\n\t\t\t\t\t\tuseful:4.5,\r\n\t\t\t\t\t\tvalue:9.2\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:1,\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\tdraw:1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyuanjun:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t\tselectTarget:[1,2],\r\n\t\t\t\tenable:true,\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target!=player&&target.hp<target.maxHp;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttarget.recover();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\torder:function(card,player){\r\n\t\t\t\t\t\t\tif(player.hasSkillTag('pretao')) return 5;\r\n\t\t\t\t\t\t\treturn 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tuseful:[6,4],\r\n\t\t\t\t\t\tvalue:[6,4],\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\treturn 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\trecover:1,\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tzong:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:'basic',\r\n\t\t\t\tcardcolor:'red',\r\n\t\t\t\tenable:function(card,player){\r\n\t\t\t\t\treturn player.hp<player.maxHp;\r\n\t\t\t\t},\r\n\t\t\t\tsavable:function(card,player,dying){\r\n\t\t\t\t\treturn dying.side==player.side;\r\n\t\t\t\t},\r\n\t\t\t\tselectTarget:-1,\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target==player&&target.hp<target.maxHp;\r\n\t\t\t\t},\r\n\t\t\t\tmodTarget:function(card,player,target){\r\n\t\t\t\t\treturn target.hp<target.maxHp;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\ttarget.recover();\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\torder:function(card,player){\r\n\t\t\t\t\t\t\tif(player.hasSkillTag('pretao')) return 5;\r\n\t\t\t\t\t\t\treturn 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tuseful:[8,6.5,5,4],\r\n\t\t\t\t\t\tvalue:[8,6.5,5,4],\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(target.hp<=0) return 2;\r\n\t\t\t\t\t\t\tvar nd=player.needsToDiscard();\r\n\t\t\t\t\t\t\tvar keep=false;\r\n\t\t\t\t\t\t\tif(nd<=0){\r\n\t\t\t\t\t\t\t\tkeep=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(nd==1&&target.hp>=2&&target.countCards('h','tao')<=1){\r\n\t\t\t\t\t\t\t\tkeep=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar mode=get.mode();\r\n\t\t\t\t\t\t\tif(target.hp>=2&&keep&&target.hasFriend()){\r\n\t\t\t\t\t\t\t\tif(target.hp>2||nd==0) return 0;\r\n\t\t\t\t\t\t\t\tif(target.hp==2){\r\n\t\t\t\t\t\t\t\t\tif(game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\t\tif(target!=current&&get.attitude(target,current)>=3){\r\n\t\t\t\t\t\t\t\t\t\t\tif(current.hp<=1) return true;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\trecover:1,\r\n\t\t\t\t\t\tsave:1,\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txionghuangjiu:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\ttype:\"basic\",\r\n\t\t\t\tenable:function(event,player){\r\n\t\t\t\t\treturn !player.hasSkill('jiu')&&!player.hasSkill('xionghuangjiu');\r\n\t\t\t\t},\r\n\t\t\t\tlianheng:true,\r\n\t\t\t\tlogv:false,\r\n\t\t\t\tsavable:function(card,player,dying){\r\n\t\t\t\t\treturn dying==player;\r\n\t\t\t\t},\r\n\t\t\t\tusable:1,\r\n\t\t\t\tselectTarget:-1,\r\n\t\t\t\tmodTarget:true,\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\treturn target==player;\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tif(target.isDying()){\r\n\t\t\t\t\t\ttarget.recover();\r\n\t\t\t\t\t\tif(_status.currentPhase==target){\r\n\t\t\t\t\t\t\ttarget.getStat().card.jiu--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(cards&&cards.length){\r\n\t\t\t\t\t\t\tcard=cards[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.broadcastAll(function(target,card,gain2){\r\n\t\t\t\t\t\t\tif(get.population(target.side)==1){\r\n\t\t\t\t\t\t\t\ttarget.addSkill('xionghuangjiu');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(!target.$.jiu) target.$.jiu=0;\r\n\t\t\t\t\t\t\t\ttarget.$.jiu++;\r\n\t\t\t\t\t\t\t\ttarget.addSkill('jiu');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.addVideo('jiuNode',target,true);\r\n\t\t\t\t\t\t\tif(!target.node.jiu&&lib.config.jiu_effect){\r\n\t\t\t\t\t\t\t\ttarget.node.jiu=ui.create.div('.playerjiu',target.node.avatar);\r\n\t\t\t\t\t\t\t\ttarget.node.jiu2=ui.create.div('.playerjiu',target.node.avatar2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(gain2&&card.clone&&(card.clone.parentNode==target.parentNode||card.clone.parentNode==ui.arena)){\r\n\t\t\t\t\t\t\t\tcard.clone.moveDelete(target);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},target,card,target==targets[0]);\r\n\t\t\t\t\t\tif(target==targets[0]){\r\n\t\t\t\t\t\t\tif(card.clone&&(card.clone.parentNode==target.parentNode||card.clone.parentNode==ui.arena)){\r\n\t\t\t\t\t\t\t\tgame.addVideo('gain2',target,get.cardsInfo([card]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\tuseful:function(card,i){\r\n\t\t\t\t\t\t\tif(_status.event.player.hp>1){\r\n\t\t\t\t\t\t\t\tif(i==0) return 5;\r\n\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(i==0) return 7.3;\r\n\t\t\t\t\t\t\treturn 3;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tvalue:function(card,player,i){\r\n\t\t\t\t\t\t\tif(player.hp>1){\r\n\t\t\t\t\t\t\t\tif(i==0) return 5;\r\n\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(i==0) return 7.3;\r\n\t\t\t\t\t\t\treturn 3;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\torder:function(){\r\n\t\t\t\t\t\treturn get.order({name:'sha'})+0.2;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tif(target&&target.isDying()) return 2;\r\n\t\t\t\t\t\t\tif(lib.config.mode=='stone'&&!player.isMin()){\r\n\t\t\t\t\t\t\t\tif(player.getActCount()+1>=player.actcount) return 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar shas=player.getCards('h','sha');\r\n\t\t\t\t\t\t\tif(shas.length>1&&player.getCardUsable('sha')>1){\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar card;\r\n\t\t\t\t\t\t\tif(shas.length){\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<shas.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(lib.filter.filterCard(shas[i],target)){\r\n\t\t\t\t\t\t\t\t\t\tcard=shas[i];break;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(player.hasSha()&&player.needsToDiscard()){\r\n\t\t\t\t\t\t\t\tif(player.countCards('h','hufu')!=1){\r\n\t\t\t\t\t\t\t\t\tcard={name:'sha'};\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(card){\r\n\t\t\t\t\t\t\t\tif(game.hasPlayer(function(current){\r\n\t\t\t\t\t\t\t\t\treturn (get.attitude(target,current)<0&&\r\n\t\t\t\t\t\t\t\t\t\ttarget.canUse(card,current,true,true)&&\r\n\t\t\t\t\t\t\t\t\t\t!current.getEquip('baiyin')&&\r\n\t\t\t\t\t\t\t\t\t\tget.effect(current,card,target)>0);\r\n\t\t\t\t\t\t\t\t})){\r\n\t\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\tsave:1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttongzhougongji:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\tcardimage:'lulitongxin',\r\n\t\t\t\tnotarget:true,\r\n\t\t\t\tenable:true,\r\n\t\t\t\ttype:'trick',\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar num=0;\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].side==player.side){\r\n\t\t\t\t\t\t\tif(game.players[i]!=player){\r\n\t\t\t\t\t\t\t\tevent.friend=game.players[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tnum+=game.players[i].storage.longchuanzhibao;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.chooseControl(function(){\r\n\t\t\t\t\t\tif(num>2){\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(num==2&&get.population(player.side)==1){\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}).set('choiceList',[\r\n\t\t\t\t\t\t'摸'+get.cnNumber(num)+'张牌',\r\n\t\t\t\t\t\t'你和队友各摸一张牌'\r\n\t\t\t\t\t]);\r\n\t\t\t\t\tevent.num=num;\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(result.index==0){\r\n\t\t\t\t\t\tif(event.num){\r\n\t\t\t\t\t\t\tplayer.draw(event.num);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(event.friend){\r\n\t\t\t\t\t\t\tplayer.line(event.friend);\r\n\t\t\t\t\t\t\tgame.asyncDraw([player,event.friend]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\torder:7.2,\r\n\t\t\t\t\t\tuseful:4,\r\n\t\t\t\t\t\tvalue:9.2\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:2,\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\tdraw:1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlizhengshangyou:{\r\n\t\t\t\tfullskin:true,\r\n\t\t\t\tcardimage:'lianjunshengyan',\r\n\t\t\t\ttype:'trick',\r\n\t\t\t\tenable:true,\r\n\t\t\t\tselectTarget:-1,\r\n\t\t\t\treverseOrder:true,\r\n\t\t\t\tfilterTarget:function(card,player,target){\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].side==target.side&&game.players[i].storage.longchuanzhibao){\r\n\t\t\t\t\t\t\treturn target.isDamaged();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn target.countCards('he');\r\n\t\t\t\t},\r\n\t\t\t\tcontent:function(){\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tif(game.players[i].side==target.side&&game.players[i].storage.longchuanzhibao){\r\n\t\t\t\t\t\t\ttarget.recover();return;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget.chooseToDiscard('he',true);\r\n\t\t\t\t},\r\n\t\t\t\tai:{\r\n\t\t\t\t\tbasic:{\r\n\t\t\t\t\t\torder:9,\r\n\t\t\t\t\t\tuseful:[3,1],\r\n\t\t\t\t\t\tvalue:0\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult:{\r\n\t\t\t\t\t\ttarget:function(player,target){\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].side==target.side&&game.players[i].storage.longchuanzhibao){\r\n\t\t\t\t\t\t\t\t\treturn 1.5;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttag:{\r\n\t\t\t\t\t\trecover:0.5,\r\n\t\t\t\t\t\tmultitarget:1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\telement:{\r\n\t\t\tcontent:{\r\n\t\t\t\treplacePlayer:function(){\r\n\t\t\t\t\t\"step 0\"\r\n\t\t\t\t\tvar cards=source.getCards('hej');\r\n\t\t\t\t\tif(cards.length){\r\n\t\t\t\t\t\tsource.$throw(cards,1000);\r\n\t\t\t\t\t\tgame.cardsDiscard(cards);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 1\"\r\n\t\t\t\t\tvar list=(source.side==game.me.side)?_status.friend:_status.enemy;\r\n\t\t\t\t\tif(list.length==0){\r\n\t\t\t\t\t\t// if(game.friend.contains(source)){\r\n\t\t\t\t\t\t// \tgame.over(false);\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t// else{\r\n\t\t\t\t\t\t// \tgame.over(true);\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\tgame.friend.remove(source);\r\n\t\t\t\t\t\tgame.enemy.remove(source);\r\n\t\t\t\t\t\tif(game.friend.length==0) game.over(false);\r\n\t\t\t\t\t\telse if(game.enemy.length==0) game.over(true);\r\n\t\t\t\t\t\tif(game.friendZhu&&game.friendZhu.classList.contains('dead')&&game.friend.length){\r\n\t\t\t\t\t\t\tgame.friendZhu=game.friend[0];\r\n\t\t\t\t\t\t\tgame.friendZhu.setIdentity(_status.color+'Zhu');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(game.enemyZhu&&game.enemyZhu.classList.contains('dead')&&game.enemy.length){\r\n\t\t\t\t\t\t\tgame.enemyZhu=game.enemy[0];\r\n\t\t\t\t\t\t\tgame.enemyZhu.setIdentity(!_status.color+'Zhu');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.finish();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(source.side==game.me.side&&list.length>1&&(game.me==game.friendZhu||(lib.storage.zhu&&lib.storage.single_control))&&\r\n\t\t\t\t\t\t!_status.auto){\r\n\t\t\t\t\t\tevent.dialog=ui.create.dialog('选择替补角色',[list,'character']);\r\n\t\t\t\t\t\tevent.filterButton=function(){return true;};\r\n\t\t\t\t\t\tevent.player=game.me;\r\n\t\t\t\t\t\tevent.forced=true;\r\n\t\t\t\t\t\tevent.custom.replace.confirm=function(){\r\n\t\t\t\t\t\t\tevent.character=ui.selected.buttons[0].link;\r\n\t\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\t\tif(ui.confirm) ui.confirm.close();\r\n\t\t\t\t\t\t\tdelete event.player;\r\n\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tevent.character=list[Math.floor(Math.random()*list.length)];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\"step 2\"\r\n\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t_status.friend.remove(event.character);\r\n\t\t\t\t\t_status.enemy.remove(event.character);\r\n\t\t\t\t\tsource.revive(null,false);\r\n\t\t\t\t\tgame.additionaldead.push({\r\n\t\t\t\t\t\tname:source.name,\r\n\t\t\t\t\t\tstat:source.stat\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.addVideo('reinit',source,[event.character,get.translation(source.side+'Color')]);\r\n\t\t\t\t\tsource.uninit();\r\n\t\t\t\t\tsource.init(event.character);\r\n\t\t\t\t\tgame.log(source,'出场');\r\n\t\t\t\t\tsource.node.identity.dataset.color=get.translation(source.side+'Color');\r\n\t\t\t\t\tsource.draw(4);\r\n\t\t\t\t\tvar evt=event.getParent('dying');\r\n\t\t\t\t\tif(evt&&evt.parent){\r\n\t\t\t\t\t\tevt=evt.parent;\r\n\t\t\t\t\t\tevt.untrigger(false,source);\r\n\t\t\t\t\t\tfor(var i=0;i<100;i++){\r\n\t\t\t\t\t\t\tevt=evt.parent;\r\n\t\t\t\t\t\t\tif(evt.player==source){\r\n\t\t\t\t\t\t\t\tevt.finish();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(evt.name=='phase'){\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(lib.storage.single_control){\r\n\t\t\t\t\t\tgame.onSwapControl();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.triggerEnter(source);\r\n\t\t\t\t\t\"step 3\"\r\n\t\t\t\t\t// if(_status.currentPhase==source){\r\n\t\t\t\t\t// \tsource.skip('phase');\r\n\t\t\t\t\t// }\r\n\t\t\t\t},\r\n\t\t\t\treplacePlayerTwo:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar cards=source.getCards('hej');\r\n\t\t\t\t\tif(cards.length){\r\n\t\t\t\t\t\tsource.$throw(cards,1000);\r\n\t\t\t\t\t\tgame.cardsDiscard(cards);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tsource.revive(null,false);\r\n\t\t\t\t\tgame.additionaldead.push({\r\n\t\t\t\t\t\tname:source.name,\r\n\t\t\t\t\t\tstat:source.stat\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.addVideo('reinit',source,[event.character,get.translation(source.side+'Color')]);\r\n\t\t\t\t\tsource.uninit();\r\n\t\t\t\t\tsource.init(event.character);\r\n\t\t\t\t\tgame.log(source,'出场');\r\n\t\t\t\t\t// source.node.identity.dataset.color=source.side+'zhu';\r\n\t\t\t\t\tsource.draw(4);\r\n\t\t\t\t\tvar evt=event.getParent('dying');\r\n\t\t\t\t\tif(evt&&evt.parent){\r\n\t\t\t\t\t\tevt=evt.parent;\r\n\t\t\t\t\t\tevt.untrigger(false,source);\r\n\t\t\t\t\t\tfor(var i=0;i<100;i++){\r\n\t\t\t\t\t\t\tevt=evt.parent;\r\n\t\t\t\t\t\t\tif(evt.player==source){\r\n\t\t\t\t\t\t\t\tevt.finish();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(evt.name=='phase'){\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.triggerEnter(source);\r\n\t\t\t\t},\r\n\t\t\t\treplacePlayerOL:function(){\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar cards=source.getCards('hej');\r\n\t\t\t\t\tif(cards.length){\r\n\t\t\t\t\t\tsource.$throw(cards,1000);\r\n\t\t\t\t\t\tgame.cardsDiscard(cards);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif(event.source.side==game.me.side){\r\n\t\t\t\t\t\tif(_status.friend.length==1){\r\n\t\t\t\t\t\t\tevent.directresult=_status.friend[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(event.source==game.me){\r\n\t\t\t\t\t\t\tif(_status.auto){\r\n\t\t\t\t\t\t\t\tevent.directresult=_status.friend.randomGet();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(!event.source.isOnline()){\r\n\t\t\t\t\t\t\t\tevent.directresult=_status.friend.randomGet();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(_status.enemy.length==1){\r\n\t\t\t\t\t\t\tevent.directresult=_status.enemy[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(!event.source.isOnline()){\r\n\t\t\t\t\t\t\t\tevent.directresult=_status.enemy.randomGet();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!event.directresult){\r\n\t\t\t\t\t\tif(event.source==game.me){\r\n\t\t\t\t\t\t\tevent.dialog=ui.create.dialog('选择替补角色',[_status.friend,'character']);\r\n\t\t\t\t\t\t\tevent.filterButton=function(){return true};\r\n\t\t\t\t\t\t\tevent.player=game.me;\r\n\t\t\t\t\t\t\tevent.forced=true;\r\n\t\t\t\t\t\t\tevent.custom.replace.confirm=function(){\r\n\t\t\t\t\t\t\t\tevent.directresult=ui.selected.buttons[0].link;\r\n\t\t\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\t\t\tif(ui.confirm) ui.confirm.close();\r\n\t\t\t\t\t\t\t\tdelete event.player;\r\n\t\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.switchToAuto=function(){\r\n\t\t\t\t\t\t\t\tevent.directresult=_status.friend.randomGet();\r\n\t\t\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\t\t\tif(ui.confirm) ui.confirm.close();\r\n\t\t\t\t\t\t\t\tdelete event.player;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tevent.source.send(function(player){\r\n\t\t\t\t\t\t\t\tif(_status.auto){\r\n\t\t\t\t\t\t\t\t\t_status.event._result=_status.friend.randomGet();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tvar next=game.createEvent('replacePlayer');\r\n\t\t\t\t\t\t\t\t\tnext.source=player;\r\n\t\t\t\t\t\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\t\t\t\t\tevent.dialog=ui.create.dialog('选择替补角色',[_status.friend,'character']);\r\n\t\t\t\t\t\t\t\t\t\tevent.filterButton=function(){return true};\r\n\t\t\t\t\t\t\t\t\t\tevent.player=event.source;\r\n\t\t\t\t\t\t\t\t\t\tevent.forced=true;\r\n\t\t\t\t\t\t\t\t\t\tevent.custom.replace.confirm=function(){\r\n\t\t\t\t\t\t\t\t\t\t\tevent.result=ui.selected.buttons[0].link;\r\n\t\t\t\t\t\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\t\t\t\t\t\tif(ui.confirm) ui.confirm.close();\r\n\t\t\t\t\t\t\t\t\t\t\tdelete event.player;\r\n\t\t\t\t\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tevent.switchToAuto=function(){\r\n\t\t\t\t\t\t\t\t\t\t\tevent.result=_status.friend.randomGet();\r\n\t\t\t\t\t\t\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\t\t\t\t\t\t\tif(ui.confirm) ui.confirm.close();\r\n\t\t\t\t\t\t\t\t\t\t\tdelete event.player;\r\n\t\t\t\t\t\t\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\tgame.check();\r\n\t\t\t\t\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.resume();\r\n\t\t\t\t\t\t\t},event.source);\r\n\t\t\t\t\t\t\tevent.source.wait();\r\n\t\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tgame.uncheck();\r\n\t\t\t\t\tif(!event.directresult){\r\n\t\t\t\t\t\tif(event.resultOL){\r\n\t\t\t\t\t\t\tevent.directresult=event.resultOL[source.playerid];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!event.directresult||event.directresult=='ai'){\r\n\t\t\t\t\t\t\tif(source.side==game.me.side){\r\n\t\t\t\t\t\t\t\tevent.directresult=_status.friend.randomGet();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tevent.directresult=_status.enemy.randomGet();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar name=event.directresult;\r\n\t\t\t\t\tvar color=source.node.identity.dataset.color;\r\n\t\t\t\t\tgame.additionaldead.push({\r\n\t\t\t\t\t\tname:source.name,\r\n\t\t\t\t\t\tstat:source.stat\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tgame.broadcastAll(function(source,name,color){\r\n\t\t\t\t\t\t_status.friend.remove(name);\r\n\t\t\t\t\t\t_status.enemy.remove(name);\r\n\t\t\t\t\t\tsource.revive(null,false);\r\n\t\t\t\t\t\tsource.uninit();\r\n\t\t\t\t\t\tsource.init(name);\r\n\t\t\t\t\t\tsource.node.identity.dataset.color=color;\r\n\t\t\t\t\t\tif(source==game.me){\r\n\t\t\t\t\t\t\tui.arena.classList.remove('selecting');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},source,name,color);\r\n\t\t\t\t\tgame.log(source,'出场');\r\n\r\n\t\t\t\t\tsource.draw(4);\r\n\t\t\t\t\tvar evt=event.getParent('dying');\r\n\t\t\t\t\tif(evt&&evt.parent){\r\n\t\t\t\t\t\tevt=evt.parent;\r\n\t\t\t\t\t\tevt.untrigger(false,source);\r\n\t\t\t\t\t\tfor(var i=0;i<100;i++){\r\n\t\t\t\t\t\t\tevt=evt.parent;\r\n\t\t\t\t\t\t\tif(evt.player==source){\r\n\t\t\t\t\t\t\t\tevt.finish();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(evt.name=='phase'){\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_status.event.parent.parent.parent.untrigger(false,source);\r\n\t\t\t\t\tgame.addVideo('reinit',source,[name,color]);\r\n\t\t\t\t\tgame.triggerEnter(source);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tplayer:{\r\n\t\t\t\tgainZhibao:function(num,source){\r\n\t\t\t\t\tif(source){\r\n\t\t\t\t\t\tif(num===true||num>source.$.longchuanzhibao){\r\n\t\t\t\t\t\t\tnum=source.$.longchuanzhibao;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(typeof num!='number'){\r\n\t\t\t\t\t\t\tnum=1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!num||typeof num!='number') return this;\r\n\r\n\t\t\t\t\tthis.$.longchuanzhibao+=num;\r\n\t\t\t\t\tthis.updateMark('longchuanzhibao');\r\n\r\n\t\t\t\t\tif(source){\r\n\t\t\t\t\t\tsource.$.longchuanzhibao-=num;\r\n\t\t\t\t\t\tsource.updateMark('longchuanzhibao');\r\n\t\t\t\t\t\tgame.log(this,'从',source,'处获得了'+get.cnNumber(num)+'个','#y龙船至宝');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tgame.log(this,'获得了'+get.cnNumber(num)+'个','#y龙船至宝');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(source&&source.side!=this.side){\r\n\t\t\t\t\t\tthis.draw(num,'nodelay');\r\n\t\t\t\t\t\tvar that=this;\r\n\t\t\t\t\t\tvar friend=game.findPlayer(function(current){\r\n\t\t\t\t\t\t\treturn current.side==that.side&&current!=that;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif(friend){\r\n\t\t\t\t\t\t\tfriend.draw(num,'nodelay');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar map={holo:0,nijisanji:0,vtuber:0,clubs:0};\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tvar current=game.players[i];\r\n\t\t\t\t\t\tmap[current.side]+=current.$.longchuanzhibao;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\tvar current=game.players[i];\r\n\t\t\t\t\t\tif(map[current.side]>=4){\r\n\t\t\t\t\t\t\tcurrent.classList.add('current_action');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tcurrent.classList.remove('current_action');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t},\r\n\t\t\t\tdieAfter2:function(source){\r\n\t\t\t\t\tif(_status.connectMode&&_status.mode!='guandu'){\r\n\t\t\t\t\t\tif(_status.mode=='1v1'||_status.mode=='3v3') return;\r\n\t\t\t\t\t\telse if(_status.mode=='2v2'){\r\n\t\t\t\t\t\t\tvar friend;\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].side==this.side){\r\n\t\t\t\t\t\t\t\t\tfriend=game.players[i];break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(friend){\r\n\t\t\t\t\t\t\t\tvar next=game.createEvent('versusDraw');\r\n\t\t\t\t\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\t\t\tplayer.chooseBool('是否摸一张牌？');\r\n\t\t\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tnext.player=friend;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(_status.mode=='4v4'){\r\n\t\t\t\t\t\t\tif(this.identity=='zhu') return;\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(source){\r\n\t\t\t\t\t\t\t\t\tif(source.side==this.side){\r\n\t\t\t\t\t\t\t\t\t\tif(source.identity=='zhu'){\r\n\t\t\t\t\t\t\t\t\t\t\tsource.discard(source.getCards('he'));\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tvar num1=0,num2=1;\r\n\t\t\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\t\t\tif(game.players[i].side==source.side){\r\n\t\t\t\t\t\t\t\t\t\t\t\tnum1++;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\t\tnum2++;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tsource.draw(2+Math.max(0,num2-num1));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(_status.mode=='four'||_status.mode=='guandu'){\r\n\t\t\t\t\t\t\tif(this.identity=='zhu') return;\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(source){\r\n\t\t\t\t\t\t\t\t\tif(source.side==this.side){\r\n\t\t\t\t\t\t\t\t\t\tif(_status.mode=='guandu'||source.identity=='zhu'){\r\n\t\t\t\t\t\t\t\t\t\t\tsource.discard(source.getCards('he'));\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tif(_status.mode=='guandu') return;\r\n\t\t\t\t\t\t\t\t\t\tvar num1=0,num2=1;\r\n\t\t\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\t\t\tif(game.players[i].side==source.side){\r\n\t\t\t\t\t\t\t\t\t\t\t\tnum1++;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\t\tnum2++;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tsource.draw(2+Math.max(0,num2-num1));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(_status.mode=='two'){\r\n\t\t\t\t\t\t\tvar friend;\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].side==this.side){\r\n\t\t\t\t\t\t\t\t\tfriend=game.players[i];break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(_status.replacetwo){\r\n\t\t\t\t\t\t\t\tif(this.replacetwo){\r\n\t\t\t\t\t\t\t\t\tif(source){\r\n\t\t\t\t\t\t\t\t\t\tif(source.side==this.side){\r\n\t\t\t\t\t\t\t\t\t\t\tvar he=source.getCards('he');\r\n\t\t\t\t\t\t\t\t\t\t\tif(he.length){\r\n\t\t\t\t\t\t\t\t\t\t\t\tsource.discard(he);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\tsource.draw(3);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(friend&&friend.replacetwo){\r\n\t\t\t\t\t\t\t\t\tif(source){\r\n\t\t\t\t\t\t\t\t\t\tif(source.side==this.side){\r\n\t\t\t\t\t\t\t\t\t\t\tvar he=source.getCards('he');\r\n\t\t\t\t\t\t\t\t\t\t\tif(he.length){\r\n\t\t\t\t\t\t\t\t\t\t\t\tsource.discard(he);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\tsource.draw(3);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(friend){\r\n\t\t\t\t\t\t\t\t\tvar next=game.createEvent('versusDraw');\r\n\t\t\t\t\t\t\t\t\tnext.setContent(function(){\r\n\t\t\t\t\t\t\t\t\t\t'step 0'\r\n\t\t\t\t\t\t\t\t\t\tplayer.chooseBool('是否摸一张牌？');\r\n\t\t\t\t\t\t\t\t\t\t'step 1'\r\n\t\t\t\t\t\t\t\t\t\tif(result.bool){\r\n\t\t\t\t\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tnext.player=friend;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(_status.mode=='siguo') return;\r\n\t\t\t\t\t\telse if(_status.mode=='jiange') return;\r\n\t\t\t\t\t\telse if(_status.mode=='three'){\r\n\t\t\t\t\t\t\tif(this.identity=='zhu') return;\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.friend.remove(this);\r\n\t\t\t\t\t\t\t\tgame.enemy.remove(this);\r\n\t\t\t\t\t\t\t\tif(source){\r\n\t\t\t\t\t\t\t\t\tsource.draw(2);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar list=(this.side==game.me.side)?_status.friend:_status.enemy;\r\n\t\t\t\t\t\tif((list.length==0&&lib.storage.noreplace_end)||\r\n\t\t\t\t\t\t(lib.storage.zhu&&lib.storage.main_zhu&&this.identity=='zhu'&&game.players.length>2)){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(game.friend.length==1&&this==game.friend[0]&&_status.friend.length==0){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(game.enemy.length==1&&this==game.enemy[0]&&_status.enemy.length==0){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(source){\r\n\t\t\t\t\t\t\t\tif(source.side!=this.side){\r\n\t\t\t\t\t\t\t\t\tif(lib.storage.versus_reward){\r\n\t\t\t\t\t\t\t\t\t\tsource.draw(lib.storage.versus_reward);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tif(lib.storage.versus_punish=='弃牌'){\r\n\t\t\t\t\t\t\t\t\t\tsource.discard(source.getCards('he'));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse if(lib.storage.versus_punish=='摸牌'&&lib.storage.versus_reward){\r\n\t\t\t\t\t\t\t\t\t\tsource.draw(lib.storage.versus_reward);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdieAfter:function(source){\r\n\t\t\t\t\tif(_status.connectMode){\r\n\t\t\t\t\t\tif(_status.mode=='1v1'||_status.mode=='3v3'){\r\n\t\t\t\t\t\t\tgame.broadcastAll(function(dead){\r\n\t\t\t\t\t\t\t\tif(dead.side==game.me.side){\r\n\t\t\t\t\t\t\t\t\t_status.friendDied.push(dead.name1);\r\n\t\t\t\t\t\t\t\t\t_status.friendCount.innerHTML='阵亡: '+get.cnNumber(_status.friendDied.length,true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t_status.enemyDied.push(dead.name1);\r\n\t\t\t\t\t\t\t\t\t_status.enemyCount.innerHTML='杀敌: '+get.cnNumber(_status.enemyDied.length,true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},this);\r\n\t\t\t\t\t\t\tif(this.side==game.me.side){\r\n\t\t\t\t\t\t\t\tif(_status.friend.length==0){\r\n\t\t\t\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(_status.enemy.length==0){\r\n\t\t\t\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgame.replacePlayerOL(this);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(_status.mode=='2v2'){\r\n\t\t\t\t\t\t\tif(_status.replacetwo){\r\n\t\t\t\t\t\t\t\t// later ?\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar friend;\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].side==this.side){\r\n\t\t\t\t\t\t\t\t\tfriend=game.players[i];break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!friend){\r\n\t\t\t\t\t\t\t\tgame.over(this.side!=game.me.side);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(_status.mode=='4v4'||_status.mode=='guandu'){\r\n\t\t\t\t\t\t\tif(this.identity=='zhu'){\r\n\t\t\t\t\t\t\t\tgame.over(this.side!=game.me.side);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(_status.mode=='guandu'&&source&&source.side!=this.side){\r\n\t\t\t\t\t\t\t\t\tvar hs=this.getCards('h');\r\n\t\t\t\t\t\t\t\t\tif(hs.length) source.gain(hs,this,'giveAuto');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar side1=[],side2=[];\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].side){\r\n\t\t\t\t\t\t\t\t\t\tside1.push(game.players[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tside2.push(game.players[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(side1.length==1){\r\n\t\t\t\t\t\t\t\t\tside1[0].showGiveup();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(side2.length==1){\r\n\t\t\t\t\t\t\t\t\tside2[0].showGiveup();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tvar me=game.me._trueMe||game.me;\r\n\t\t\t\t\t\tif(_status.mode=='four'||_status.mode=='guandu'){\r\n\t\t\t\t\t\t\tif(this.identity=='zhu'){\r\n\t\t\t\t\t\t\t\tgame.over(this.side!=me.side);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(_status.mode=='guandu'&&source&&source.side!=this.side){\r\n\t\t\t\t\t\t\t\t\tvar hs=this.getCards('h');\r\n\t\t\t\t\t\t\t\t\tif(hs.length) source.gain(hs,this,'giveAuto');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar side1=[],side2=[];\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(game.players[i].side){\r\n\t\t\t\t\t\t\t\t\t\tside1.push(game.players[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\tside2.push(game.players[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(me.side){\r\n\t\t\t\t\t\t\t\t\tif(side1.length<=side2.length-2){\r\n\t\t\t\t\t\t\t\t\t\tme.showGiveup();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tif(side1.length>=side2.length+2){\r\n\t\t\t\t\t\t\t\t\t\tme.showGiveup();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(_status.mode=='two'){\r\n\t\t\t\t\t\t\tvar friend;\r\n\t\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\t\tif(game.players[i].side==this.side){\r\n\t\t\t\t\t\t\t\t\tfriend=game.players[i];break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(_status.replacetwo){\r\n\t\t\t\t\t\t\t\tif(this.replacetwo){\r\n\t\t\t\t\t\t\t\t\tgame.replacePlayerTwo(this,this.replacetwo);\r\n\t\t\t\t\t\t\t\t\tdelete this.replacetwo;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if(friend&&friend.replacetwo){\r\n\t\t\t\t\t\t\t\t\tgame.replacePlayerTwo(this,friend.replacetwo);\r\n\t\t\t\t\t\t\t\t\tdelete friend.replacetwo;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tgame.over(this.side!=me.side);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(!friend){\r\n\t\t\t\t\t\t\t\t\tgame.over(this.side!=me.side);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(_status.mode=='siguo'){\r\n\t\t\t\t\t\t\tif(game.players.length==1||(game.players.length==2&&game.players[0].side==game.players[1].side)){\r\n\t\t\t\t\t\t\t\tgame.over(me.side==game.players[0].side);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar assignzhibao=function(){\r\n\t\t\t\t\t\t\t\tvar list=game.players.slice(0);\r\n\t\t\t\t\t\t\t\tvar max=0;\r\n\t\t\t\t\t\t\t\tvar list2=[];\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<arguments.length;i++){\r\n\t\t\t\t\t\t\t\t\tlist.remove(arguments[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(list[i].storage.longchuanzhibao>max){\r\n\t\t\t\t\t\t\t\t\t\tmax=list[i].storage.longchuanzhibao;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<list.length;i++){\r\n\t\t\t\t\t\t\t\t\tif(list[i].storage.longchuanzhibao==max){\r\n\t\t\t\t\t\t\t\t\t\tif(list2.length){\r\n\t\t\t\t\t\t\t\t\t\t\tlist2=list;break;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\tlist2.push(list[i]);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<arguments.length;i++){\r\n\t\t\t\t\t\t\t\t\tfor(var j=0;j<arguments[i].storage.longchuanzhibao;j++){\r\n\t\t\t\t\t\t\t\t\t\tvar current=list2.randomGet();\r\n\t\t\t\t\t\t\t\t\t\tif(!current.$._longchuanzhibao){\r\n\t\t\t\t\t\t\t\t\t\t\tcurrent.$._longchuanzhibao=1;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\tcurrent.$._longchuanzhibao++;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tfor(var j=0;j<list2.length;j++){\r\n\t\t\t\t\t\t\t\t\t\tif(list2[j].storage._longchuanzhibao){\r\n\t\t\t\t\t\t\t\t\t\t\targuments[i].line(list2[j],'green');\r\n\t\t\t\t\t\t\t\t\t\t\tlist2[j].gainZhibao(list2[j].storage._longchuanzhibao,arguments[i]);\r\n\t\t\t\t\t\t\t\t\t\t\tdelete list2[j].storage._longchuanzhibao;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tif(source){\r\n\t\t\t\t\t\t\t\tif(source.side==this.side){\r\n\t\t\t\t\t\t\t\t\tassignzhibao(this,source);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tif(this.$.longchuanzhibao){\r\n\t\t\t\t\t\t\t\t\t\tsource.gainZhibao(true,this);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tassignzhibao(this);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(_status.mode=='jiange'){\r\n\t\t\t\t\t\t\tif(get.population('holo')==0){\r\n\t\t\t\t\t\t\t\tgame.over(me.identity=='nijisanji');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(get.population('nijisanji')==0){\r\n\t\t\t\t\t\t\t\tgame.over(me.identity=='holo');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(_status.mode=='three'){\r\n\t\t\t\t\t\t\tif(this.identity=='zhu'){\r\n\t\t\t\t\t\t\t\tif(game.friend.contains(this)){\r\n\t\t\t\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(this==me){\r\n\t\t\t\t\t\t\t\t\tgame.modeSwapPlayer(game.friendZhu);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tgame.friend.remove(this);\r\n\t\t\t\t\t\t\t\tgame.enemy.remove(this);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(this.side==me.side){\r\n\t\t\t\t\t\t\t_status.friendDied.push(this.name1);\r\n\t\t\t\t\t\t\t_status.friendCount.innerHTML='阵亡: '+get.cnNumber(_status.friendDied.length,true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t_status.enemyDied.push(this.name1);\r\n\t\t\t\t\t\t\t_status.enemyCount.innerHTML='杀敌: '+get.cnNumber(_status.enemyDied.length,true);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar list=(this.side==me.side)?_status.friend:_status.enemy;\r\n\t\t\t\t\t\tif((list.length==0&&lib.storage.noreplace_end)||\r\n\t\t\t\t\t\t(lib.storage.zhu&&lib.storage.main_zhu&&this.identity=='zhu'&&game.players.length>2)){\r\n\t\t\t\t\t\t\tif(game.friend.contains(this)){\r\n\t\t\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(game.friend.length==1&&this==game.friend[0]&&_status.friend.length==0){\r\n\t\t\t\t\t\t\tgame.over(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(game.enemy.length==1&&this==game.enemy[0]&&_status.enemy.length==0){\r\n\t\t\t\t\t\t\tgame.over(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tgame.replacePlayer(this);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tget:{\r\n\t\t\trawAttitude:function(from,to){\r\n\t\t\t\tif(from.side==to.side){\r\n\t\t\t\t\tif(to.identity=='zhu'){\r\n\t\t\t\t\t\tif(_status.connectMode){\r\n\t\t\t\t\t\t\tif(_status.mode=='4v4'||_status.mode=='guandu') return 7;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tif(lib.storage.main_zhu||_status.mode=='four'||_status.mode=='guandu') return 7;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn 6;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tif(_status.mode=='siguo'){\r\n\t\t\t\t\t\tvar list=['holo','nijisanji','vtuber','clubs'];\r\n\t\t\t\t\t\tvar map={holo:0,nijisanji:0,vtuber:0,clubs:0};\r\n\t\t\t\t\t\tvar map2={holo:0,nijisanji:0,vtuber:0,clubs:0};\r\n\t\t\t\t\t\tfor(var i=0;i<game.players.length;i++){\r\n\t\t\t\t\t\t\tvar current=game.players[i];\r\n\t\t\t\t\t\t\tmap[current.side]+=get.condition(current)*get.threaten(current,false,false);\r\n\t\t\t\t\t\t\tmap2[current.side]+=current.$.longchuanzhibao;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar allin=false;\r\n\t\t\t\t\t\tfor(var i in map){\r\n\t\t\t\t\t\t\tif(get.population(i)==1){\r\n\t\t\t\t\t\t\t\tmap[i]/=1.5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(map2[i]>=4){\r\n\t\t\t\t\t\t\t\tallin=i;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(map2[i]==3){\r\n\t\t\t\t\t\t\t\tmap[i]+=10;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if(map2[i]==2){\r\n\t\t\t\t\t\t\t\tmap[i]++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(allin) return to.side==allin?-20:0;\r\n\t\t\t\t\t\tlist.sort(function(a,b){\r\n\t\t\t\t\t\t\treturn map[b]-map[a];\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar id1=list.indexOf(from.side);\r\n\t\t\t\t\t\tvar id2=list.indexOf(to.side);\r\n\t\t\t\t\t\tvar att=-1;\r\n\t\t\t\t\t\tswitch(id1){\r\n\t\t\t\t\t\t\tcase 0:att=_status.siguoai[id2+2];break;\r\n\t\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\t\tswitch(id2){\r\n\t\t\t\t\t\t\t\t\tcase 0:att=_status.siguoai[0];break;\r\n\t\t\t\t\t\t\t\t\tcase 2:att=_status.siguoai[1];break;\r\n\t\t\t\t\t\t\t\t\tcase 3:att=_status.siguoai[2];break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\tswitch(id2){\r\n\t\t\t\t\t\t\t\t\tcase 0:att=_status.siguoai[0];break;\r\n\t\t\t\t\t\t\t\t\tcase 1:att=_status.siguoai[1];break;\r\n\t\t\t\t\t\t\t\t\tcase 3:att=_status.siguoai[2];break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 3:{\r\n\t\t\t\t\t\t\t\tif(id2==0){\r\n\t\t\t\t\t\t\t\t\tatt=_status.siguoai[1];break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tatt=_status.siguoai[2];break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(map2[to.side]>=4){\r\n\t\t\t\t\t\t\tatt-=10;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(map2[to.side]==3){\r\n\t\t\t\t\t\t\tatt-=3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(map2[to.side]==2){\r\n\t\t\t\t\t\t\tatt-=0.5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(to.$.longchuanzhibao){\r\n\t\t\t\t\t\t\treturn att*1.2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn att;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(to.identity=='zhu'){\r\n\t\t\t\t\t\t\tif(_status.connectMode){\r\n\t\t\t\t\t\t\t\tif(_status.mode=='4v4'||_status.mode=='guandu') return -10;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tif(lib.storage.main_zhu||_status.mode=='four'||_status.mode=='guandu') return -10;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn -6;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\thelp:{\r\n\t\t\t'对决模式':\r\n\t\t\t'<div style=\"margin:10px\">同舟共济（四国）</div><ul style=\"margin-top:0\"><li>游戏开始时，每个势力的随机一名角色得到一个龙船至宝，1号位角色所在的势力额外获得一个龙船至宝，场上共5枚龙船至宝。龙船至宝是一个特殊标记。'+\r\n\t\t\t'<li>争夺龙船至宝的方式：当敌人受到了你造成的伤害后，若其有龙船至宝，则你获得其一个龙船至宝。若你杀死了该敌人，则你获得其所有的龙船至宝。'+\r\n\t\t\t'<li>获得龙船至宝时的摸牌：除游戏开始时外，若你从非队友处获得了龙船至宝，则你和队友各摸X张牌。（X为该次获得的龙船至宝数；获得队友的龙船至宝不摸牌）'+\r\n\t\t\t'<li>无来源死亡时：当一名角色死亡时，若没有伤害来源，则其持有的所有龙船至宝交给场上龙船至宝数唯一最多的角色，若没有则随机分配，获得龙船至宝的角色和其队友各摸X张牌。'+\r\n\t\t\t'<li>杀死队友时：当你杀死队友时，则将你和队友持有的所有龙船至宝交给场上龙船至宝数唯一最多的敌人，若没有则随机分配，获得龙船至宝的角色和其队友各摸X张牌。'+\r\n\t\t\t'<li>胜利条件：满足一下任意条件游戏结束：（1）在新的一轮开始时，若你的势力获得的龙船至宝至少为4个，则你和队友获胜；（2）消灭所有敌人。'+\r\n\t\t\t'</ul>'+\r\n\t\t\t'<div style=\"margin:10px\">2v2 替补模式</div><ul style=\"margin-top:0\"><li>选将时额外选择一名替补武将，阵亡时使用自己的替补武将上场，无替补时改为用队友的替补武将，两人均无替补时游戏结束'+\r\n\t\t\t'<li>杀死敌方武将摸3张牌，杀死友方武将弃置所有牌</ul>'+\r\n\t\t\t'<div style=\"margin:10px\">4v4</div><ul style=\"margin-top:0\"><li>双方各有一名主公和三名忠臣，杀死对方主公获胜<li>'+\r\n\t\t\t'8号位游戏开始时额外摸一张牌，7、8号位可在游戏开始时置换一次手牌<li>'+\r\n\t\t\t'杀死对方忠臣摸2+x张牌，x为对方（含刚被杀的忠臣）与己方的存活人数之差；主公杀死己方忠臣须弃置所有牌',\r\n\t\t}\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/versus.js?")},"./src/mode/yindao.js":function(){eval("\r\ngame.import('mode', function (lib, game, ui, get, ai, _status) {\r\n\treturn {\r\n\t\tname: 'yindao',\r\n\t\tchangbanCharacter: [],\r\n\t\tyindaoPile: [\r\n\t\t\t['spade', 5, 'sha'],\r\n\t\t\t['spade', 7, 'sha'],\r\n\t\t\t['spade', 8, 'sha'],\r\n\t\t\t['spade', 10, 'sha'],\r\n\t\t\t['heart', 10, 'sha'],\r\n\t\t\t['heart', 11, 'sha'],\r\n\t\t\t['club', 4, 'sha'],\r\n\t\t\t['club', 5, 'sha'],\r\n\t\t\t['club', 6, 'sha'],\r\n\t\t\t['club', 8, 'sha'],\r\n\t\t\t['club', 9, 'sha'],\r\n\t\t\t['club', 10, 'sha'],\r\n\t\t\t['club', 11, 'sha'],\r\n\t\t\t['diamond', 6, 'sha'],\r\n\t\t\t['diamond', 9, 'sha'],\r\n\t\t\t['diamond', 11, 'sha'],\r\n\t\t\t['heart', 2, 'shan'],\r\n\t\t\t['heart', 5, 'shan'],\r\n\t\t\t['diamond', 2, 'shan'],\r\n\t\t\t['diamond', 3, 'shan'],\r\n\t\t\t['diamond', 7, 'shan'],\r\n\t\t\t['diamond', 8, 'shan'],\r\n\t\t\t['diamond', 10, 'shan'],\r\n\t\t\t['diamond', 11, 'shan'],\r\n\t\t\t['heart', 3, 'tao'],\r\n\t\t\t['heart', 4, 'tao'],\r\n\t\t\t['heart', 9, 'tao'],\r\n\t\t\t['diamond', 12, 'tao'],\r\n\t\t\t['club', 12, 'bingliang'],\r\n\t\t\t['spade', 3, 'guohe'],\r\n\t\t\t['diamond', 12, 'guohe'],\r\n\t\t\t['club', 3, 'guohe'],\r\n\t\t\t['club', 1, 'juedou'],\r\n\t\t\t['spade', 1, 'juedou'],\r\n\t\t\t['heart', 6, 'lebu'],\r\n\t\t\t['spade', 1, 'nanman'],\r\n\t\t\t['club', 7, 'shuiyanqijunx'],\r\n\t\t\t['spade', 4, 'shunshou'],\r\n\t\t\t['spade', 11, 'shunshou'],\r\n\t\t\t['diamond', 4, 'shunshou'],\r\n\t\t\t['heart', 1, 'wanjian'],\r\n\t\t\t['heart', 5, 'wuxie'],\r\n\t\t\t['club', 5, 'wuxie'],\r\n\t\t\t['heart', 7, 'wuzhong'],\r\n\t\t\t['heart', 8, 'wuzhong'],\r\n\t\t\t['diamond', 5, 'guanshi'],\r\n\t\t\t['spade', 9, 'hanbing'],\r\n\t\t\t['spade', 6, 'qinggang'],\r\n\t\t\t['spade', 12, 'zhangba'],\r\n\t\t\t['diamond', 1, 'zhuge'],\r\n\t\t\t['spade', 2, 'bagua'],\r\n\t\t\t['club', 2, 'renwang'],\r\n\t\t],\r\n\t\tcharacterSingle: {},\r\n\t\tstartBefore() {\r\n\t\t\t_status.mode = 'yindao';\r\n\t\t\tfor (var i in lib.characterSingle) {\r\n\t\t\t\tlib.character[i] = lib.characterSingle[i];\r\n\t\t\t\tif (!lib.character[i][4]) {\r\n\t\t\t\t\tlib.character[i][4] = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var j in lib.yindaoTranslate) lib.translate[j] = lib.yindaoTranslate[j];\r\n\t\t\tif (!lib.yindao) lib.yindao = {\r\n\t\t\t\tcompleteNumber: 0,\r\n\t\t\t\taddFellow(name) {\r\n\t\t\t\t\tgame.filterPlayer(cur => {\r\n\t\t\t\t\t\tif (cur !== game.me) cur.dataset.position++\r\n\t\t\t\t\t})\r\n\t\t\t\t\tui.arena.setNumber(game.countPlayer2() + 1);\r\n\t\t\t\t\tgame.fellow = game.addFellow(1, name);\r\n\t\t\t\t\t// game.fellow.gain(get.cards(4));\r\n\t\t\t\t\tgame.fellow.identity = 'fan';\r\n\t\t\t\t\tgame.fellow.setIdentity();\r\n\t\t\t\t\tgame.fellow.identityShown = true;\r\n\t\t\t\t\tgame.fellow.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t_status.event.getParent('phaseLoop').player = game.fellow;\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t},\r\n\t\tstart() {\r\n\t\t\t'step 0'\r\n\t\t\t_status.yindao = true;\r\n\t\t\tvar playback = localStorage.getItem(lib.configprefix + 'playback');\r\n\t\t\tif (playback) {\r\n\t\t\t\tevent.finish();\r\n\t\t\t}\r\n\t\t\telse if (!_status.connectMode) {\r\n\t\t\t\tgame.prepareArena(2);\r\n\t\t\t}\r\n\t\t\t'step 1'\r\n\t\t\t_status.mode = 'yindao';\r\n\t\t\tlib.card.list = lib.yindaoPile.slice(0);\r\n\t\t\t'step 2'\r\n\t\t\tfor (var i = 0; i < game.players.length; i++) {\r\n\t\t\t\tgame.players[i].getId();\r\n\t\t\t}\r\n\t\t\tgame.changeCharacter0();\r\n\t\t\t'step 3'\r\n\t\t\tgame.syncState();\r\n\r\n\t\t\tvar players = get.players(lib.sort.position);\r\n\t\t\tvar info = [];\r\n\t\t\tfor (var i = 0; i < players.length; i++) {\r\n\t\t\t\tinfo.push({\r\n\t\t\t\t\tname: players[i].name1,\r\n\t\t\t\t\tname2: players[i].name2,\r\n\t\t\t\t\tidentity: players[i].identity\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t_status.videoInited = true;\r\n\t\t\tgame.addVideo('init', null, info);\r\n\t\t\t'step 4'\r\n\t\t\tevent.player = game.me;\r\n\t\t\tevent.trigger('gameStart');\r\n\t\t\t'step 5'\r\n\t\t\tif (_status.reYindao) {\r\n\t\t\t\tevent.goto(4);\r\n\t\t\t}\r\n\t\t\tgame.delay(3);\r\n\t\t\t'step 6'\r\n\t\t\tgame.over();\r\n\t\t},\r\n\t\tgame: {\r\n\t\t\tgetVideoName() {\r\n\t\t\t\tvar str = get.translation(game.me.name);\r\n\t\t\t\tif (game.me.name2) {\r\n\t\t\t\t\tstr += '/' + get.translation(game.me.name2);\r\n\t\t\t\t}\r\n\t\t\t\tvar name = [\r\n\t\t\t\t\tstr,\r\n\t\t\t\t\t'引导' + ' - ' + lib.translate[game.me.identity + '2']\r\n\t\t\t\t];\r\n\t\t\t\treturn name;\r\n\t\t\t},\r\n\t\t\tshowIdentity() { },\r\n\t\t\tcheckResult() {\r\n\t\t\t\tgame.over((game.me._trueMe || game.me).isAlive());\r\n\t\t\t},\r\n\t\t\tcheckOnlineResult(player) {\r\n\t\t\t\treturn game.me.isAlive();\r\n\t\t\t},\r\n\t\t\tchangeCharacter0() {\r\n\t\t\t\tvar next = game.createEvent('changeCharacter', false);\r\n\t\t\t\tnext.setContent(function () {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar map = ['zhu', 'fan'];\r\n\t\t\t\t\tgame.me.identity = map[0];\r\n\t\t\t\t\tgame.me.next.identity = map[1];\r\n\t\t\t\t\tgame.me.showIdentity();\r\n\t\t\t\t\tgame.me.next.showIdentity();\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.me.init('Kino');\r\n\t\t\t\t\tgame.me.next.init('shanbao');\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tlib.init.onfree();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t},\r\n\t\telement: {\r\n\t\t\tplayer: {\r\n\t\t\t\thasZhuSkill() { return false; },\r\n\t\t\t\tdieAfter() {\r\n\t\t\t\t\tgame.checkResult();\r\n\t\t\t\t},\r\n\t\t\t\tlogAi(targets, card) { },\r\n\t\t\t\tshowIdentity() {\r\n\t\t\t\t\tgame.broadcastAll(function (player, identity) {\r\n\t\t\t\t\t\tplayer.identity = identity;\r\n\t\t\t\t\t\tgame[identity] = player;\r\n\t\t\t\t\t\tplayer.side = identity == 'zhu';\r\n\t\t\t\t\t\tplayer.node.identity.classList.remove('guessing');\r\n\t\t\t\t\t\tplayer.identityShown = true;\r\n\t\t\t\t\t\tplayer.ai.shown = 1;\r\n\t\t\t\t\t\tplayer.setIdentity();\r\n\t\t\t\t\t\tif (player.identity == 'zhu') {\r\n\t\t\t\t\t\t\tplayer.isZhu = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (_status.clickingidentity) {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < _status.clickingidentity[1].length; i++) {\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].delete();\r\n\t\t\t\t\t\t\t\t_status.clickingidentity[1][i].style.transform = '';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdelete _status.clickingidentity;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this, this.identity);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tget: {\r\n\t\t\tattitude(from, to) {\r\n\t\t\t\tif (from.identity == to.identity) return 10;\r\n\t\t\t\treturn -10;\r\n\t\t\t},\r\n\t\t},\r\n\t\tskill: {\r\n\t\t\t_yindaoA: {\r\n\t\t\t\ttrigger: { player: 'gameStart' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tif (!game.shanbao) {\r\n\t\t\t\t\t\tgame.shanbao = game.me.next\r\n\t\t\t\t\t\tgame.filterPlayer(function (cur) {\r\n\t\t\t\t\t\t\tcur.addTempSkill('fengyin')\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!_status.reYindao) {\r\n\t\t\t\t\t\tui.auto.hide();\r\n\t\t\t\t\t\tgalgame.sce(\"yindaoA0\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t_status.reYindao = false;\r\n\t\t\t\t\t\tgalgame.sce(\"yindaoA1\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tif (!game.dusong) {\r\n\t\t\t\t\t\tlib.yindao.addFellow('dusongziGin')\r\n\t\t\t\t\t\tgame.dusong = game.me.next\r\n\t\t\t\t\t\tgame.dusong.addTempSkill('fengyin')\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tswitch (result.bool) {\r\n\t\t\t\t\t\tcase '纯路人，什么是三国杀？': {\r\n\t\t\t\t\t\t\tgalgame.sce(\"yindaoB\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase '听说过，也玩过类似的桌游': {\r\n\t\t\t\t\t\t\tgalgame.sce(\"yindaoC\");\r\n\t\t\t\t\t\t\t_status.oneYindao = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase '只接触过原版的三国杀': {\r\n\t\t\t\t\t\t\tgalgame.sce(\"yindaoD\");\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase '游戏规则我都懂，教教我怎么进行游戏配置吧': {\r\n\t\t\t\t\t\t\t_status.reYindao = true\r\n\t\t\t\t\t\t\tevent.trigger('yindaoE');\r\n\t\t\t\t\t\t\tevent.goto(0)\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase '进阶教程什么的有在做嘛？': {\r\n\t\t\t\t\t\t\t_status.reYindao = true\r\n\t\t\t\t\t\t\tgalgame.sce(\"yindaoMaking\")\r\n\t\t\t\t\t\t\tevent.goto(0)\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase '跳过引导': {\r\n\t\t\t\t\t\t\tevent.goto(6)\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif (_status.oneYindao) {\r\n\t\t\t\t\t\tevent.trigger('yindaoCard');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tif (_status.oneYindao) {\r\n\t\t\t\t\t\tevent.trigger('yindaoSkill');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tevent.trigger('yindaoF');\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tgalgame.sce(\"over\");\r\n\t\t\t\t\t'step 7'\r\n\t\t\t\t\tswitch (result.bool) {\r\n\t\t\t\t\t\tcase '再引导一次': { _status.reYindao = true; break; }\r\n\t\t\t\t\t\tcase '进入身份模式': {\r\n\t\t\t\t\t\t\tgame.saveConfig('mode', 'identity');\r\n\t\t\t\t\t\t\tgame.reload(); break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase '进入国战模式': {\r\n\t\t\t\t\t\t\tgame.saveConfig('mode', 'guozhan');\r\n\t\t\t\t\t\t\tgame.reload(); break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_yindaoCard: {\r\n\t\t\t\ttrigger: { player: 'yindaoCard' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tEvt.clear = () => {\r\n\t\t\t\t\t\tgame.filterPlayer(function (cur) {\r\n\t\t\t\t\t\t\tcur.recover(4);\r\n\t\t\t\t\t\t\tif(cur.countCards('hej')) cur.lose(cur.getCards('hej'), ui.special);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tEvt.clear()\r\n\t\t\t\t\tplayer.gain(game.createCard('sha'), 'gain2');\r\n\t\t\t\t\tgame.delay(1.5);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgalgame.sce(\"yindaoCard1\");\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (result.bool == '跳过这个部分') {\r\n\t\t\t\t\t\tevent.goto(6);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\tprompt: '###选择手牌中的【杀】，再选择〖扇宝〗，就可以使用出这张【杀】###（一张牌被使用后就会离开手牌区）',\r\n\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\treturn card.name == 'sha' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tplayer.gain(game.createCard('shan'), 'gain2');\r\n\t\t\t\t\tgame.dusong.gain(game.createCard('sha'), 'gain2');\r\n\t\t\t\t\tgame.delay(1.5);\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tgalgame.sce(\"yindaoCard2\");\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tgame.dusong.chooseToUse({\r\n\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\treturn card.name == 'sha' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tEvt.clear()\r\n\t\t\t\t\t'step 7'\r\n\t\t\t\t\tvar dialog = ui.create.dialog('forcebutton');\r\n\t\t\t\t\tdialog.add('基本牌');\r\n\t\t\t\t\tdialog.addSmall([['sha', 'shan', 'tao'], 'vcard']);\r\n\t\t\t\t\tdialog.add('锦囊牌');\r\n\t\t\t\t\tdialog.addSmall([['wuzhong', 'shunshou', 'lebu'], 'vcard']);\r\n\t\t\t\t\tdialog.add('装备牌');\r\n\t\t\t\t\tdialog.addSmall([['zhuge', 'renwang', 'muniu'], 'vcard']);\r\n\t\t\t\t\tevent.dialog = dialog;\r\n\t\t\t\t\tgame.delay();\r\n\t\t\t\t\t'step 8'\r\n\t\t\t\t\tgalgame.sce(\"yindaoCard3\");\r\n\t\t\t\t\t'step 9'\r\n\t\t\t\t\tEvt.clear()\r\n\t\t\t\t\tevent.dialog.close();\r\n\t\t\t\t\tgalgame.sce(\"yindaoCardIndex\");\r\n\t\t\t\t\t'step 10'\r\n\t\t\t\t\tswitch (result.bool) {\r\n\t\t\t\t\t\tcase '装备牌的分类与使用':\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('guding'), 'gain2');\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('sha'), 'gain2');\r\n\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\tcase '通常锦囊牌的使用':\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('wuzhong'), 'gain2');\r\n\t\t\t\t\t\t\tgame.dusong.gain(game.createCard('shan'), 'gain2');\r\n\t\t\t\t\t\t\tevent.going = 2; break;\r\n\t\t\t\t\t\tcase '回合与阶段':\r\n\t\t\t\t\t\t\tvar dialog = ui.create.dialog('forcebutton');\r\n\t\t\t\t\t\t\tdialog.add('每个回合会按阶段进行<br>');\r\n\t\t\t\t\t\t\tdialog.add('回合开始');\r\n\t\t\t\t\t\t\tdialog.addSmall([lib.phaseName.slice(0,1), 'vcard']);\r\n\t\t\t\t\t\t\tdialog.add('回合进行');\r\n\t\t\t\t\t\t\tdialog.addSmall([lib.phaseName.slice(1,lib.phaseName.length-1), 'vcard']);\r\n\t\t\t\t\t\t\tdialog.add('回合结束');\r\n\t\t\t\t\t\t\tdialog.addSmall([[lib.phaseName[lib.phaseName.length-1]], 'vcard']);\r\n\t\t\t\t\t\t\tevent.going = 3; break;\r\n\t\t\t\t\t\tcase '判定与延时锦囊牌的使用':\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('lebu'), 'gain2');\r\n\t\t\t\t\t\t\tevent.going = 4; break;\r\n\t\t\t\t\t\tcase '卡牌的「使用」与「打出」':\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('juedou'), 'gain2');\r\n\t\t\t\t\t\t\tgame.dusong.gain(game.createCard('sha'), 'gain2');\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('sha'), 'gain2');\r\n\t\t\t\t\t\t\tevent.going = 5; break;\r\n\t\t\t\t\t\tcase '无懈可击！':\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('juedou'), 'gain2');\r\n\t\t\t\t\t\t\tgame.dusong.gain(game.createCard('wuxie'), 'gain2');\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('wuxie'), 'gain2');\r\n\t\t\t\t\t\t\tevent.going = 6; break;\r\n\t\t\t\t\t\tcase '跳过这个部分':\r\n\t\t\t\t\t\t\tevent.going = 'skip'; break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(1.5);\r\n\t\t\t\t\t'step 11'\r\n\t\t\t\t\tswitch (event.going) {\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###试试点击手牌中的装备牌来使用它<br>右键点击也可以查看详细信息###（一般的装备牌都是默认使用者为目标，所以没有指定的过程）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn get.type(card) == 'equip' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###来试试使用手牌中的锦囊【无中生有】吧###（锦囊牌的效果千奇百怪，【无中生有】的效果是摸两张牌）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn get.type(card) == 'trick' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 2; break;\r\n\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\tgalgame.sce(\"yindaoCard33\");\r\n\t\t\t\t\t\t\tevent.going = 3; break;\r\n\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\tgalgame.sce(\"yindaoCard34\");\r\n\t\t\t\t\t\t\tevent.going = 4; break;\r\n\t\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###来试试使用手牌中的锦囊【决斗】吧###锦囊【决斗】的效果是让对方打出一张【杀】<br>（“打出”不同于“使用”，只是单纯的声明一张牌，然后将其置入弃牌堆，这个过程没有目标没有效果，但是否完成“打出”这一动作会影响卡牌或技能的效果）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn get.type(card) == 'trick' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 5; break;\r\n\t\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###锦囊【无懈可击】并不能直接使用，而是在一些合适的时机去使用它###（试试使用手牌中除了【无懈可击】的锦囊牌叭）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn get.type(card) == 'trick' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 6; break;\r\n\t\t\t\t\t\tcase 'skip':\r\n\t\t\t\t\t\t\tevent.finish(); break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 12'\r\n\t\t\t\t\tswitch (event.going) {\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###因为你装备了武器【军刀】，所以你的能力获得了强化，现在再对扇宝使用【杀】试试叭~###（【军刀】的效果是：当你使用【杀】对目标角色造成伤害时，若其没有手牌，此伤害+1）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn get.type(card) == 'basic' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###来试试使用手牌中的锦囊牌【过河拆桥】吧###（【过河拆桥】的效果是弃置目标一张牌，用它来瓦解敌人的防御吧！）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn get.type(card) == 'trick' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 2; break;\r\n\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\tevent.going = 3; break;\r\n\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###来试试使用手牌中的延时锦囊牌【乐不思蜀】吧###（【乐不思蜀】的效果是跳过出牌阶段，并且只有在判定结果不为♥时才会生效）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn get.type(card) == 'delay' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 4; break;\r\n\t\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\t\tevent.going = 5; break;\r\n\t\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\t\tevent.going = 6; break;\r\n\t\t\t\t\t\tcase 'skip':\r\n\t\t\t\t\t\t\tevent.finish(); break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 13'\r\n\t\t\t\t\tswitch (event.going) {\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('bagua'), 'gain2');\r\n\t\t\t\t\t\t\tgame.dusong.gain(game.createCard('sha'), 'gain2');\r\n\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\tgalgame.sce(\"yindaoCard42\");\r\n\t\t\t\t\t\t\tevent.going = 2; break;\r\n\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\tevent.going = 3; break;\r\n\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\tevent.going = 4; break;\r\n\t\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\t\tevent.going = 5; break;\r\n\t\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\t\tevent.going = 6; break;\r\n\t\t\t\t\t\tcase 'skip':\r\n\t\t\t\t\t\t\tevent.finish(); break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 14'\r\n\t\t\t\t\tswitch (event.going) {\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###与倾向攻击的武器类装备相对，还有倾向防御的防具类装备，来试试使用手牌中的防具【宣传战】吧###（值得一提的是，每种类型的装备同时只能装备一个）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn get.type(card) == 'equip' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\tgame.shanbao.gain(game.createCard('shan'), 'gain2');\r\n\t\t\t\t\t\t\tevent.going = 2; break;\r\n\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\tevent.going = 3; break;\r\n\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\tevent.going = 4; break;\r\n\t\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\t\tevent.going = 5; break;\r\n\t\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\t\tevent.going = 6; break;\r\n\t\t\t\t\t\tcase 'skip':\r\n\t\t\t\t\t\t\tevent.finish(); break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 15'\r\n\t\t\t\t\tswitch (event.going) {\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\tgame.dusong.chooseToUse({\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn card.name == 'sha' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###来试试有效的使用手牌吧~###（杜松子手中的【闪】已被弃置了，已经没有手段阻止【杀】了）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn get.type(card) == 'basic' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tevent.going = 2; break;\r\n\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\tevent.going = 3; break;\r\n\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\tevent.going = 4; break;\r\n\t\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\t\tevent.going = 5; break;\r\n\t\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\t\tevent.going = 6; break;\r\n\t\t\t\t\t\tcase 'skip':\r\n\t\t\t\t\t\t\tevent.finish(); break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t'step 16'\r\n\t\t\t\t\tswitch (event.going) {\r\n\t\t\t\t\t\tcase 1: case 2: case 3: case 4: case 5: case 6:\r\n\t\t\t\t\t\t\tgame.delay(0.5);\r\n\t\t\t\t\t\t\tevent.goto(9); break;\r\n\t\t\t\t\t\tcase 'skip':\r\n\t\t\t\t\t\t\tevent.finish(); break;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//游戏配置讲解\r\n\t\t\t_yindaoE: {\r\n\t\t\t\ttrigger: { player: 'yindaoE' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tEvt.clear = function () {\r\n\t\t\t\t\t\twhile (ui.controls.length) ui.controls[0].close();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tgalgame.sce(\"yindaoE0\");\r\n\t\t\t\t\tEvt.clear();\r\n\t\t\t\t\tui.create.control('使用移动布局', function () {\r\n\t\t\t\t\t\tif (lib.config.phonelayout) {\r\n\t\t\t\t\t\t\tui.control.firstChild.firstChild.innerHTML = '使用移动布局';\r\n\t\t\t\t\t\t\tgame.saveConfig('phonelayout', false);\r\n\t\t\t\t\t\t\tlib.init.layout('mobile');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tui.control.firstChild.firstChild.innerHTML = '使用默认布局';\r\n\t\t\t\t\t\t\tgame.saveConfig('phonelayout', true);\r\n\t\t\t\t\t\t\tlib.init.layout('mobile');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tui.create.control('继续', game.resume);\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tif (lib.config.touchscreen) {\r\n\t\t\t\t\t\tEvt.clear();\r\n\t\t\t\t\t\tgalgame.sce(\"yindaoE1\");\r\n\t\t\t\t\t\tui.create.control('继续', game.resume);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tif (lib.config.touchscreen) {\r\n\t\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tEvt.clear();\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tevent.trigger('yindaoEplus')\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tEvt.clear()\r\n\t\t\t\t\tlib.cheat.e()\r\n\t\t\t\t\tplayer.draw(3)\r\n\t\t\t\t\tgame.shanbao.useCard(game.createCard('zhangba'), game.shanbao)\r\n\t\t\t\t\tgame.shanbao.useCard(game.createCard('jueying'), game.shanbao)\r\n\t\t\t\t\tgame.shanbao.draw(2)\r\n\t\t\t\t\tgame.dusong.useCard(game.createCard('zixin'), game.dusong)\r\n\t\t\t\t\tgame.dusong.draw(4)\r\n\t\t\t\t\tgame.shanbao.useCard(game.createCard('lebu'), game.dusong)\r\n\t\t\t\t\t'step 7'\r\n\t\t\t\t\tgalgame.sce(\"yindaoE3\");\r\n\t\t\t\t\t'step 8'\r\n\t\t\t\t\tlet map = {\r\n\t\t\t\t\t\t'旧版': 'default',\r\n\t\t\t\t\t\t'默认（初始样式）': 'mobile',\r\n\t\t\t\t\t\t'宽屏': 'long',\r\n\t\t\t\t\t\t'手杀': 'long2',\r\n\t\t\t\t\t\t'新版': 'nova',\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (map[result.bool]) {\r\n\t\t\t\t\t\tlib.init.layout(map[result.bool])\r\n\t\t\t\t\t\tgame.delay(6)\r\n\t\t\t\t\t\tEvt.goto(7)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//菜单信息\r\n\t\t\t_yindaoEplus: {\r\n\t\t\t\ttrigger: { player: 'yindaoEplus' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tui.arena.classList.add('only_dialog');\r\n\t\t\t\t\tEvt.clear = () => {\r\n\t\t\t\t\t\twhile (ui.controls.length) ui.controls[0].close();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tEvt.clear2 = () => {\r\n\t\t\t\t\t\tui.click.configMenu();\r\n\t\t\t\t\t\tui.window.classList.remove('noclick_important');\r\n\t\t\t\t\t\tui.control.classList.remove('noclick_click_important');\r\n\t\t\t\t\t\tui.control.style.top = '';\r\n\t\t\t\t\t\t_status.event.finish()\r\n\t\t\t\t\t\tui.arena.classList.remove('only_dialog');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.window.classList.add('noclick_important');\r\n\t\t\t\t\tui.click.configMenu();\r\n\t\t\t\t\tui.control.classList.add('noclick_click_important');\r\n\t\t\t\t\tui.control.style.top = 'calc(100% - 105px)';\r\n\t\t\t\t\tui.create.control('继续', game.resume);\r\n\t\t\t\t\tui.create.control('跳过关于菜单的介绍', () => {\r\n\t\t\t\t\t\tgame.resume()\r\n\t\t\t\t\t\tEvt.clear2()\r\n\t\t\t\t\t\tgame.resume()\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgalgame.sce(\"yindaoE20\");\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tEvt.clear();\r\n\t\t\t\t\tui.click.menuTab('选项');\r\n\t\t\t\t\tgalgame.sce(\"yindaoE21\");\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tui.click.menuTab('武将');\r\n\t\t\t\t\tgalgame.sce(\"yindaoE22\");\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tui.click.menuTab('卡牌');\r\n\t\t\t\t\tgalgame.sce(\"yindaoE23\");\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tui.click.menuTab('开始');\r\n\t\t\t\t\tgalgame.sce(\"yindaoE24\");\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tui.create.control('继续', game.resume);\r\n\t\t\t\t\tgame.pause();\r\n\t\t\t\t\t'step 7'\r\n\t\t\t\t\tEvt.clear();\r\n\t\t\t\t\tui.click.menuTab('其它');\r\n\t\t\t\t\tgalgame.sce(\"yindaoE25\");\r\n\t\t\t\t\t'step 8'\r\n\t\t\t\t\tEvt.clear2()\r\n\t\t\t\t\tui.create.control('继续介绍其他项目', game.resume);\r\n\t\t\t\t\tgame.pause();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//细致的规则讲解\r\n\t\t\t_yindaoF: {\r\n\t\t\t\ttrigger: { player: 'yindaoF' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tgame.filterPlayer(function (cur) {\r\n\t\t\t\t\t\tcur.recover(4);\r\n\t\t\t\t\t\tcur.link(false)\r\n\t\t\t\t\t\tif(cur.countCards('hej')) cur.lose(cur.getCards('hej'), ui.special);\r\n\t\t\t\t\t})\r\n\t\t\t\t\tgalgame.sce(\"yindaoF0\");\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tgalgame.sce(\"yindaoFIndex\");\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tswitch (result.bool) {\r\n\t\t\t\t\t\tcase '三国杀机制：转换技':\r\n\t\t\t\t\t\t\tgalgame.sce(\"yindaoNewSkill0\")\r\n\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\tcase '无名杀机制：护甲':\r\n\t\t\t\t\t\t\tevent.going = 2; break;\r\n\t\t\t\t\t\tcase 'V杀新增机制：海洋与暗影':\r\n\t\t\t\t\t\t\tevent.going = 3; break;\r\n\t\t\t\t\t\tcase '讲讲V杀游戏配置吧':\r\n\t\t\t\t\t\t\tevent.trigger('yindaoE')\r\n\t\t\t\t\t\t\tevent.going = 4; break;\r\n\t\t\t\t\t\tcase '跳过这个部分':\r\n\t\t\t\t\t\t\tevent.going = 'skip'; break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgame.delay(1.5);\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tswitch (event.going) {\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\tswitch (result.bool) {\r\n\t\t\t\t\t\t\t\tcase '跟随<span class=\\\"aqua\\\">樋口枫</span>学习转换技）':\r\n\t\t\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\t\t\tcase '好的哦~（跟随<span class=\\\"orange\\\">乃琳</span>学习转换技）':\r\n\t\t\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\t\t\tcase '可是转换技我本来就懂啊（“阿瞒……”）':\r\n\t\t\t\t\t\t\t\t\tgalgame.sce(\"yindaoNewSkill1\"); break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tevent.going = 1; break;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\tgame.shanbao.changeHujia()\r\n\t\t\t\t\t\t\tplayer.gain(game.createCard('sha'), 'gain2');\r\n\t\t\t\t\t\t\tevent.going = 2; break;\r\n\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\tevent.going = 3; break;\r\n\t\t\t\t\t\tcase 'skip':\r\n\t\t\t\t\t\t\tevent.finish(); break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tswitch (event.going) {\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\tgalgame.sce(\"yindaoMaking\"); break;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\t\t\tprompt: '###来试试有效的使用手牌吧~###（无甲角色受到的都是实实在在的真实伤害）',\r\n\t\t\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\t\t\treturn card.name == 'sha' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t\t\t}); break;\r\n\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\tevent.trigger('yindaoFplus')\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 4: case 5: case 6:\r\n\t\t\t\t\t\tcase 'skip':\r\n\t\t\t\t\t\t\tevent.finish(); break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tswitch (event.going) {\r\n\t\t\t\t\t\tcase 1: case 2: case 3: case 4: case 5: case 6:\r\n\t\t\t\t\t\t\tevent.goto(1); break;\r\n\t\t\t\t\t\tcase 'skip':\r\n\t\t\t\t\t\t\tevent.finish(); break;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t//海洋和暗影属性\r\n\t\t\t_yindaoFplus: {\r\n\t\t\t\ttrigger: { player: 'yindaoFplus' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tcontent() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tEvt.clear = function () {\r\n\t\t\t\t\t\tgame.filterPlayer(function (cur) {\r\n\t\t\t\t\t\t\tcur.recover(4);\r\n\t\t\t\t\t\t\tcur.link(false)\r\n\t\t\t\t\t\t\tif(cur.countCards('hej')) cur.lose(cur.getCards('hej'), ui.special);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\twhile (ui.controls.length) ui.controls[0].close();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tEvt.clear()\r\n\t\t\t\t\tgame.shanbao.changeHujia()\r\n\t\t\t\t\tgame.shanbao.link()\r\n\t\t\t\t\tgame.dusong.link()\r\n\t\t\t\t\tplayer.gain(game.createCard({ name: 'sha', nature: 'ocean' }), 'gain2');\r\n\t\t\t\t\tplayer.gain(game.createCard({ name: 'sha', nature: 'fire' }), 'gain2');\r\n\t\t\t\t\t'step 1'\r\n\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\tprompt: '###来试试有效的使用手牌吧~###海洋属性的杀会造成海洋属性伤害，对护甲有特攻效果哦（但是触发特攻效果时伤害不会引爆铁索）',\r\n\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\treturn card.name == 'sha' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t})\r\n\t\t\t\t\t'step 2'\r\n\t\t\t\t\tui.create.control('下一个', game.resume);\r\n\t\t\t\t\tui.create.control('再来一遍', () => {\r\n\t\t\t\t\t\tgame.resume()\r\n\t\t\t\t\t\tEvt.goto(0)\r\n\t\t\t\t\t\tgame.resume()\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.pause()\r\n\t\t\t\t\t'step 3'\r\n\t\t\t\t\tEvt.clear()\r\n\t\t\t\t\tgame.shanbao.draw(3)\r\n\t\t\t\t\tgame.shanbao.gain(game.createCard('shan'), 'gain2')\r\n\t\t\t\t\tgame.dusong.gain(game.createCard('shan'), 'gain2')\r\n\t\t\t\t\tplayer.gain(game.createCard({ name: 'sha', nature: 'yami' }), 'gain2');\r\n\t\t\t\t\tplayer.gain(game.createCard('sha'), 'gain2');\r\n\t\t\t\t\t'step 4'\r\n\t\t\t\t\tplayer.chooseToUse({\r\n\t\t\t\t\t\tprompt: '###来试试有效的使用手牌吧~###暗影属性的杀会造成暗影属性伤害，可以强制命中手牌多于你的角色！（但是触发强制命中时伤害不会引爆铁索）',\r\n\t\t\t\t\t\tfilterCard(card, player) {\r\n\t\t\t\t\t\t\treturn card.name == 'sha' && lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\taddCount: false,\r\n\t\t\t\t\t\tforced: true,\r\n\t\t\t\t\t})\r\n\t\t\t\t\t'step 5'\r\n\t\t\t\t\tui.create.control('结束', game.resume);\r\n\t\t\t\t\tui.create.control('再来一遍', () => {\r\n\t\t\t\t\t\tgame.resume()\r\n\t\t\t\t\t\tEvt.goto(3)\r\n\t\t\t\t\t\tgame.resume()\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgame.pause()\r\n\t\t\t\t\t'step 6'\r\n\t\t\t\t\tEvt.clear()\r\n\t\t\t\t\tgame.delay(2)\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_yindaoWuxie: {\r\n\t\t\t\ttrigger: { global: 'wuxieAfter' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\treturn player == game.me && !player.$.studyWuxie;\r\n\t\t\t\t},\r\n\t\t\t\tcontent() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.$.studyWuxie = true;\r\n\t\t\t\t\tgalgame.sce(\"yindaoWuxie\");\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_yindaoRespond: {\r\n\t\t\t\ttrigger: { global: 'chooseToRespond' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\treturn player == game.me && !player.$.studyRespond;\r\n\t\t\t\t},\r\n\t\t\t\tcontent() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tplayer.$.studyRespond = true;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t_yindaDraw: {\r\n\t\t\t\ttrigger: { global: 'drawBegin' },\r\n\t\t\t\tsilent: true,\r\n\t\t\t\tpopup: false,\r\n\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\treturn player == game.me;\r\n\t\t\t\t},\r\n\t\t\t\tcontent() {\r\n\t\t\t\t\t'step 0'\r\n\t\t\t\t\tvar list = []\r\n\t\t\t\t\tvar evt = trigger.getParent('_yindaoCard');\r\n\t\t\t\t\tif (evt && evt.name == '_yindaoCard') {\r\n\t\t\t\t\t\tif (evt.going == 2)\r\n\t\t\t\t\t\t\tlist = [game.createCard('guohe'), game.createCard('sha')]\r\n\t\t\t\t\t}\r\n\t\t\t\t\twhile (list.length) {\r\n\t\t\t\t\t\tui.cardPile.insertBefore(list.pop(), ui.cardPile.firstChild);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tyindaoTranslate: {\r\n\t\t\tzhu: \"先\",\r\n\t\t\tfan: \"后\",\r\n\t\t\tzhu2: \"先手\",\r\n\t\t\tfan2: \"后手\",\r\n\t\t},\r\n\t};\r\n});\r\n\n\n//# sourceURL=webpack://vtuberkill/./src/mode/yindao.js?")}},__webpack_module_cache__={};function __webpack_require__(t){var r=__webpack_module_cache__[t];if(void 0!==r)return r.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return __webpack_require__.d(r,{a:r}),r},__webpack_require__.d=function(t,r){for(var n in r)__webpack_require__.o(r,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},__webpack_require__.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/mode/_entry.js")})();